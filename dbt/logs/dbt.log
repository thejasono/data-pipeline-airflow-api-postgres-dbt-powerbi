[0m18:40:12.855836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f96d0>]}


============================== 18:40:12.871351 | f9744f38-c30a-4bfe-a9ab-64432f3a73d5 ==============================
[0m18:40:12.871351 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:40:12.875622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:40:12.905924 [info ] [MainThread]: dbt version: 1.8.2
[0m18:40:12.911358 [info ] [MainThread]: python version: 3.11.9
[0m18:40:12.914776 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:40:12.917363 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m18:40:12.926036 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 7
  ------------------------------
  4  |     dev:
  5  |       type: postgres
  6  |       host: postgres
  7  |       user: {{ env_var('POSTGRES_USER') }}
  8  |       password: {{ env_var('POSTGRES_PASSWORD') }}
  9  |       port: 5432
  10 |       dbname: {{ env_var('POSTGRES_DB') }}
  
  Raw Error:
  ------------------------------
  while constructing a mapping
    in "<unicode string>", line 7, column 13
  found unhashable key
    in "<unicode string>", line 7, column 14
[0m18:40:12.931153 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.112251274, "process_user_time": 2.127118, "process_kernel_time": 0.336856, "process_mem_max_rss": "98236", "process_in_blocks": "192", "command_success": false, "process_out_blocks": "0"}
[0m18:40:12.934686 [debug] [MainThread]: Command `dbt debug` failed at 18:40:12.934104 after 0.12 seconds
[0m18:40:12.937532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec99c0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f25d0>]}
[0m18:40:12.940137 [debug] [MainThread]: Flushing usage events
[0m18:44:46.842281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703d2c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5b890>]}


============================== 18:44:46.852333 | 44eb3e1a-3e47-4d17-a12f-e22dc7d028e4 ==============================
[0m18:44:46.852333 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:44:46.855284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:46.872514 [info ] [MainThread]: dbt version: 1.8.2
[0m18:44:46.874468 [info ] [MainThread]: python version: 3.11.9
[0m18:44:46.876570 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:44:46.878929 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m18:44:46.887525 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 8
  ------------------------------
  5  |       type: postgres
  6  |       host: postgres
  7  |       user: {{
  
  Raw Error:
  ------------------------------
  while parsing a flow node
  did not find expected node content
    in "<unicode string>", line 8, column 1
[0m18:44:46.893735 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.08303495, "process_user_time": 2.137301, "process_kernel_time": 0.293355, "process_mem_max_rss": "98540", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:44:46.895927 [debug] [MainThread]: Command `dbt debug` failed at 18:44:46.895694 after 0.09 seconds
[0m18:44:46.898267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c604d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5a410>]}
[0m18:44:46.901012 [debug] [MainThread]: Flushing usage events
[0m18:54:56.576875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c733ff750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c73550ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c733ffb90>]}


============================== 18:54:56.598694 | e96bab67-7b8a-44f7-aa8e-0bb63317c1e0 ==============================
[0m18:54:56.598694 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:54:56.601738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:54:57.498599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7333ab90>]}
[0m18:54:57.688347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7520dcd0>]}
[0m18:54:57.693066 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:54:58.010532 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:54:58.018471 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:54:58.020752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7295edd0>]}
[0m18:54:58.862219 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:54:58.872352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c721f2850>]}
[0m18:54:58.946351 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_customers' in the 'models' section of file 'models/models.yml'
[0m18:54:59.487133 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.api_bi_project.dim_customer' (models/marts/dim_customer.sql) depends on a node named 'stg_customers' which was not found
[0m18:54:59.498063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6772404, "process_user_time": 8.461257, "process_kernel_time": 1.87641, "process_mem_max_rss": "162112", "process_in_blocks": "6760", "process_out_blocks": "2432", "command_success": false}
[0m18:54:59.503026 [debug] [MainThread]: Command `dbt run` failed at 18:54:59.502623 after 4.68 seconds
[0m18:54:59.505558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c73442110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c73405050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7191add0>]}
[0m18:54:59.508451 [debug] [MainThread]: Flushing usage events
[0m18:55:13.316705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2843990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2842350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2a34950>]}


============================== 18:55:13.327585 | 2ccff660-5748-4493-9ac1-e5f12b461412 ==============================
[0m18:55:13.327585 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:55:13.330265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:13.550886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2883b50>]}
[0m18:55:13.620054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf4596e10>]}
[0m18:55:13.622943 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:55:13.790843 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:55:13.796730 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:55:13.798176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf1ffe6d0>]}
[0m18:55:15.481995 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:55:15.483670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf17cb1d0>]}
[0m18:55:15.498865 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_customers' in the 'models' section of file 'models/models.yml'
[0m18:55:15.750321 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.api_bi_project.dim_customer' (models/marts/dim_customer.sql) depends on a node named 'stg_customers' which was not found
[0m18:55:15.753186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5240617, "process_user_time": 4.92323, "process_kernel_time": 0.564835, "process_mem_max_rss": "162124", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:55:15.755244 [debug] [MainThread]: Command `dbt run` failed at 18:55:15.755049 after 2.53 seconds
[0m18:55:15.756903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf0f1f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf0f712d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf29447d0>]}
[0m18:55:15.759589 [debug] [MainThread]: Flushing usage events
[0m18:57:39.508620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8ca52e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8ca7a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8ca92350>]}


============================== 18:57:39.517807 | ddfdf513-cf14-4f60-b3f8-9c704866948b ==============================
[0m18:57:39.517807 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:57:39.519321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --select stg_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:57:39.730819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8cb0ea50>]}
[0m18:57:39.886233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8e7bf810>]}
[0m18:57:39.888933 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:57:40.036819 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:57:40.040922 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:57:40.042436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8c18a1d0>]}
[0m18:57:41.230930 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:57:41.232989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8b9f0ad0>]}
[0m18:57:41.750864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8b9e14d0>]}
[0m18:57:41.966926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8d678dd0>]}
[0m18:57:41.969993 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:57:41.972709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8e484f50>]}
[0m18:57:41.980364 [info ] [MainThread]: 
[0m18:57:41.989144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:41.996912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:57:42.085111 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:57:42.086616 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:57:42.087764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:42.105996 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m18:57:42.109554 [debug] [ThreadPool]: On list_db: Close
[0m18:57:42.112721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m18:57:42.114905 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m18:57:42.123556 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:57:42.125071 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m18:57:42.126292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:42.139546 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m18:57:42.141528 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:57:42.143054 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m18:57:42.146868 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m18:57:42.149156 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:57:42.150573 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:57:42.152262 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:57:42.155136 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:57:42.156929 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m18:57:42.165751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_analytics)
[0m18:57:42.167400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m18:57:42.177090 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:42.181039 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:42.183361 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:57:42.185528 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:57:42.187365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:42.188691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:42.202900 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m18:57:42.204012 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:57:42.205893 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:42.207188 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:42.208508 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:57:42.209921 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:57:42.217854 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m18:57:42.218383 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:57:42.221085 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:57:42.224288 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:57:42.226102 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:57:42.227109 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:57:42.237739 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.239197 [debug] [MainThread]: On master: BEGIN
[0m18:57:42.240388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:42.253410 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m18:57:42.255547 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.257742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:42.287577 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m18:57:42.290737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb88c82410>]}
[0m18:57:42.292557 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:42.294914 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.296616 [debug] [MainThread]: On master: BEGIN
[0m18:57:42.299540 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:57:42.302136 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.304170 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.306687 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.309515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:42.311037 [debug] [MainThread]: On master: Close
[0m18:57:42.313095 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:42.317368 [info ] [MainThread]: 
[0m18:57:42.334797 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:57:42.337862 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:57:42.342377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m18:57:42.347504 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:57:42.369846 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:57:42.408892 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:57:42.529486 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:57:42.569338 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.571036 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:57:42.572662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:42.587773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m18:57:42.591099 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.593436 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:57:42.603351 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m18:57:42.613974 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.615609 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:57:42.620819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:57:42.644046 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:42.645804 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.647065 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:42.650730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:57:42.663647 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:57:42.675088 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.678185 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:57:42.683535 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:57:42.689610 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:57:42.694618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8b131490>]}
[0m18:57:42.697318 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.35s]
[0m18:57:42.700704 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:57:42.707258 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.709781 [debug] [MainThread]: On master: BEGIN
[0m18:57:42.711212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:42.726944 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m18:57:42.729399 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.731648 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.733773 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.735878 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:42.738250 [debug] [MainThread]: On master: Close
[0m18:57:42.739760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:42.741486 [debug] [MainThread]: Connection 'list_db_public_analytics' was properly closed.
[0m18:57:42.742758 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:57:42.744875 [info ] [MainThread]: 
[0m18:57:42.751044 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m18:57:42.754942 [debug] [MainThread]: Command end result
[0m18:57:42.847969 [info ] [MainThread]: 
[0m18:57:42.850492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:42.852585 [info ] [MainThread]: 
[0m18:57:42.856768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:57:42.862209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4378366, "process_user_time": 4.895015, "process_kernel_time": 0.505442, "process_mem_max_rss": "122712", "process_in_blocks": "2040", "process_out_blocks": "0"}
[0m18:57:42.869491 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:42.865929 after 3.44 seconds
[0m18:57:42.880613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb90b21450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb90adf2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb90b017d0>]}
[0m18:57:42.884649 [debug] [MainThread]: Flushing usage events
[0m18:57:50.714857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb59565f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5a907c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5a115310>]}


============================== 18:57:50.723203 | 5c274f54-5180-48a0-b576-b49ab3a6ab72 ==============================
[0m18:57:50.723203 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:57:50.725705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --select stg_customers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:50.914944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb589fc8d0>]}
[0m18:57:50.994951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5b2bb510>]}
[0m18:57:50.997253 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:57:51.150967 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:57:51.449188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:51.450934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:51.519298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb57d43bd0>]}
[0m18:57:51.684209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb581e88d0>]}
[0m18:57:51.686107 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:57:51.687842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5798c050>]}
[0m18:57:51.691632 [info ] [MainThread]: 
[0m18:57:51.693789 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:51.697531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:57:51.767868 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:57:51.769368 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:57:51.770563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:51.786384 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m18:57:51.789329 [debug] [ThreadPool]: On list_db: Close
[0m18:57:51.797997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m18:57:51.800001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m18:57:51.808706 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:51.812278 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:51.813945 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:57:51.815931 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:57:51.817603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:51.818964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:51.832257 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m18:57:51.834177 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:57:51.835965 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:51.838058 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:51.839908 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:57:51.841351 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:57:51.848190 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:57:51.849423 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:57:51.852383 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:57:51.854922 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:57:51.857109 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:57:51.858366 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:57:51.872217 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.874227 [debug] [MainThread]: On master: BEGIN
[0m18:57:51.876195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:51.888894 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m18:57:51.890648 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.892434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:51.921925 [debug] [MainThread]: SQL status: SELECT 1 in 0.028 seconds
[0m18:57:51.925026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb58918f50>]}
[0m18:57:51.926650 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:51.928510 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.929766 [debug] [MainThread]: On master: BEGIN
[0m18:57:51.931513 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:57:51.933613 [debug] [MainThread]: On master: COMMIT
[0m18:57:51.935468 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.936720 [debug] [MainThread]: On master: COMMIT
[0m18:57:51.938252 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:51.939481 [debug] [MainThread]: On master: Close
[0m18:57:51.941076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:51.942631 [info ] [MainThread]: 
[0m18:57:51.962130 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:57:51.964807 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:57:51.967806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m18:57:51.970023 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:57:51.980653 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:57:51.995585 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:57:52.102920 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:57:52.115035 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.116468 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:57:52.117777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:52.128974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:57:52.130896 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.132494 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:57:52.137223 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:57:52.145637 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.147043 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:57:52.149257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:57:52.153314 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.154371 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:57:52.155851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:57:52.172731 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:52.173979 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.174948 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:52.179155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:57:52.188217 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:57:52.195919 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.197277 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:57:52.204626 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m18:57:52.208976 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:57:52.212257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb56615250>]}
[0m18:57:52.214150 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.24s]
[0m18:57:52.216740 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:57:52.222064 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.223946 [debug] [MainThread]: On master: BEGIN
[0m18:57:52.225595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:52.240400 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m18:57:52.245021 [debug] [MainThread]: On master: COMMIT
[0m18:57:52.247185 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.248873 [debug] [MainThread]: On master: COMMIT
[0m18:57:52.250873 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:52.253012 [debug] [MainThread]: On master: Close
[0m18:57:52.255286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:52.256591 [debug] [MainThread]: Connection 'list_db_public_staging' was properly closed.
[0m18:57:52.258113 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:57:52.259829 [info ] [MainThread]: 
[0m18:57:52.261237 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m18:57:52.263564 [debug] [MainThread]: Command end result
[0m18:57:52.331767 [info ] [MainThread]: 
[0m18:57:52.333722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:52.335649 [info ] [MainThread]: 
[0m18:57:52.337380 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:57:52.340322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7041295, "process_user_time": 3.505124, "process_kernel_time": 0.50181, "process_mem_max_rss": "119352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:57:52.342559 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:52.342322 after 1.71 seconds
[0m18:57:52.344538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5d654290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5d64c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5d6da990>]}
[0m18:57:52.346206 [debug] [MainThread]: Flushing usage events
[0m18:58:24.783637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbf96bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbf96b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbf96bad0>]}


============================== 18:58:24.880207 | df65290b-011a-4f79-b180-771b7512f53b ==============================
[0m18:58:24.880207 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:58:24.897412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m18:58:25.528300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4d833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c526a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6291750>]}


============================== 18:58:25.542083 | d00eada9-057c-40cd-803e-12a0e3e4c779 ==============================
[0m18:58:25.542083 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:58:25.544913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m18:58:25.685497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbfa03c90>]}
[0m18:58:25.797081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc16bf450>]}
[0m18:58:25.799577 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:25.925005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4dc7010>]}
[0m18:58:26.005969 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:58:26.028370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6b0b9d0>]}
[0m18:58:26.032981 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:26.496318 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:58:27.167757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:27.169758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:27.333422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbe961390>]}
[0m18:58:27.564549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:27.569323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:27.720048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c35a2810>]}
[0m18:58:27.819935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbd913ed0>]}
[0m18:58:27.822208 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:58:27.824195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbe575290>]}
[0m18:58:27.835758 [info ] [MainThread]: 
[0m18:58:27.841813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:27.858773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:27.861467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:28.014300 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.015466 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.017762 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.022339 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.025134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.026986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.069380 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.044 seconds
[0m18:58:28.098726 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.132715 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.106 seconds
[0m18:58:28.137871 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.141057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m18:58:28.146063 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m18:58:28.157820 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:58:28.163778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c2d17fd0>]}
[0m18:58:28.166456 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m18:58:28.167034 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:58:28.171013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c397c910>]}
[0m18:58:28.170950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.181116 [info ] [MainThread]: 
[0m18:58:28.183648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:28.189025 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m18:58:28.191875 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:58:28.193625 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m18:58:28.197535 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:58:28.196744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:28.200569 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:58:28.202031 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:58:28.204090 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:58:28.208114 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:58:28.209826 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m18:58:28.198543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:28.217178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_staging)
[0m18:58:28.220091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m18:58:28.243451 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.250679 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.252425 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:58:28.255389 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:58:28.260407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.262781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.281708 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:58:28.284986 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.286128 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:58:28.287877 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:58:28.289844 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.293631 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:58:28.297286 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m18:58:28.301859 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:58:28.303165 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:58:28.304065 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:58:28.306983 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:58:28.311209 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:58:28.330699 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.331673 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.333198 [debug] [MainThread]: On master: BEGIN
[0m18:58:28.331672 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.335090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:28.333173 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.335563 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.337778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.340036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.355397 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m18:58:28.360578 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.363656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:28.369474 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.032 seconds
[0m18:58:28.370431 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.030 seconds
[0m18:58:28.385768 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.400516 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.424140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m18:58:28.426257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m18:58:28.440629 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.463416 [debug] [MainThread]: SQL status: SELECT 1 in 0.094 seconds
[0m18:58:28.454866 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.478698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbd941490>]}
[0m18:58:28.470247 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:58:28.497966 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:28.497436 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:58:28.562045 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.515216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.578264 [debug] [MainThread]: On master: BEGIN
[0m18:58:28.571545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.631628 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:58:28.656092 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m18:58:28.693459 [debug] [ThreadPool]: SQL status: BEGIN in 0.122 seconds
[0m18:58:28.687662 [debug] [MainThread]: On master: COMMIT
[0m18:58:28.818268 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.773800 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.799065 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.841515 [debug] [MainThread]: On master: COMMIT
[0m18:58:28.835796 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:58:28.862178 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:58:28.883372 [debug] [MainThread]: On master: Close
[0m18:58:28.861305 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:58:28.913452 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.030 seconds
[0m18:58:28.918288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:28.953505 [info ] [MainThread]: 
[0m18:58:28.921906 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m18:58:28.953578 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:58:29.158010 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:58:29.092214 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:58:29.162255 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:58:29.192652 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:58:29.257036 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:58:29.164198 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:58:29.238209 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:58:29.310472 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.302545 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m18:58:29.314233 [debug] [MainThread]: On master: BEGIN
[0m18:58:29.309555 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m18:58:29.325316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:29.313202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m18:58:29.321795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m18:58:29.328453 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:58:29.355556 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:58:29.333243 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:58:29.370309 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.378160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:29.344105 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:58:29.355749 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:58:29.424565 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:58:29.430983 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:58:29.437576 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:58:29.463364 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:58:29.507282 [debug] [MainThread]: SQL status: SELECT 1 in 0.121 seconds
[0m18:58:29.500144 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:58:29.552686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c178a6d0>]}
[0m18:58:29.569123 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:29.583185 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.622211 [debug] [MainThread]: On master: BEGIN
[0m18:58:29.628528 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:58:29.631293 [debug] [MainThread]: On master: COMMIT
[0m18:58:29.640166 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.629903 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:58:29.663717 [debug] [MainThread]: On master: COMMIT
[0m18:58:29.687423 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:58:29.696202 [debug] [MainThread]: On master: Close
[0m18:58:29.703894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:29.724818 [info ] [MainThread]: 
[0m18:58:29.785904 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:58:29.787276 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:58:29.788664 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:58:29.784388 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:58:29.789270 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:58:29.791718 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:58:29.806798 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m18:58:29.816396 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:58:29.821530 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m18:58:29.828072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m18:58:29.833450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m18:58:29.837007 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:58:29.853549 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:29.858582 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:58:29.861961 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:29.847166 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:58:29.868628 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:29.887595 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:58:29.852475 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:58:29.932912 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:29.866990 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:58:29.935139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:29.948550 [debug] [Thread-3 (]: SQL status: BEGIN in 0.077 seconds
[0m18:58:29.937679 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:58:29.955211 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:58:29.976238 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:58:30.005582 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:58:30.016657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m18:58:30.060952 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.114897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:30.125889 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.160601 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:58:30.142295 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:58:30.160597 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:58:30.164016 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:58:30.178647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.065 seconds
[0m18:58:30.212412 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m18:58:30.227438 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m18:58:30.216310 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:58:30.239545 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.302408 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.319993 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.349419 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:58:30.356039 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:58:30.381162 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:58:30.467207 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m18:58:30.488276 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:58:30.504179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:58:30.656712 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:58:30.528471 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.673592 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:58:30.677086 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:58:30.691337 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.715773 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:58:30.735146 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:58:30.792580 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.749658 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:58:30.771336 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:58:30.826411 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:58:30.828114 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.832968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:30.800857 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.837122 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.841653 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:58:30.827816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:58:30.882872 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:58:30.902593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:30.914984 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m18:58:30.856236 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:58:30.926989 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:30.970425 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.882891 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:58:30.935381 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:58:30.980893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m18:58:30.985342 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:31.018524 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m18:58:31.037846 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.024659 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:58:31.042236 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:58:31.038927 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.074424 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:31.113029 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:58:31.116471 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:58:31.125137 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:58:31.045827 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m18:58:31.147396 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m18:58:31.094365 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:58:31.141000 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m18:58:31.190981 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:31.218382 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:31.239955 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:58:31.220945 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m18:58:31.241475 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.123 seconds
[0m18:58:31.237455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m18:58:31.244291 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:58:31.294725 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "stg_sessions" already exists

[0m18:58:31.302518 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.258080 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m18:58:31.317772 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "stg_payments" already exists

[0m18:58:31.304495 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:31.328799 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: ROLLBACK
[0m18:58:31.338504 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:58:31.350933 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:31.336360 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:58:31.357162 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: ROLLBACK
[0m18:58:31.357652 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m18:58:31.362588 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.367202 [debug] [Thread-3 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m18:58:31.374584 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m18:58:31.378407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "stg_customers__dbt_backup" already exists

[0m18:58:31.381359 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m18:58:31.383166 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:58:31.395305 [debug] [Thread-3 (]: Postgres adapter: Rolling back transaction.
[0m18:58:31.398920 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: ROLLBACK
[0m18:58:31.394279 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:58:31.402198 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m18:58:31.399866 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:58:31.420796 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:58:31.429956 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m18:58:31.426309 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:58:31.467048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m18:58:31.434727 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:58:31.474735 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m18:58:31.444931 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:58:31.503381 [debug] [Thread-3 (]: Database Error in model stg_sessions (models/staging/stg_sessions.sql)
  relation "stg_sessions" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_sessions.sql
[0m18:58:31.479446 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc3b8450>]}
[0m18:58:31.494783 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:58:31.518982 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc32aad0>]}
[0m18:58:31.514082 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:58:31.526695 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 2.15s]
[0m18:58:31.536038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbe5cffd0>]}
[0m18:58:31.515738 [debug] [Thread-2 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "stg_payments" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_payments.sql
[0m18:58:31.539628 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 2.20s]
[0m18:58:31.546371 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:58:31.537545 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c168fcd0>]}
[0m18:58:31.553088 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 2.22s]
[0m18:58:31.552655 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "stg_customers__dbt_backup" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_customers.sql
[0m18:58:31.556488 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:58:31.555788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c178f7d0>]}
[0m18:58:31.561869 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m18:58:31.562264 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public_staging.stg_sessions ............... [[31mERROR[0m in 1.69s]
[0m18:58:31.569120 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:58:31.573951 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m18:58:31.569035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c2d37510>]}
[0m18:58:31.577851 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m18:58:31.585468 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m18:58:31.574661 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public_staging.stg_payments ............... [[31mERROR[0m in 1.73s]
[0m18:58:31.597310 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m18:58:31.584259 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:58:31.603655 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m18:58:31.602648 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public_staging.stg_customers .............. [[31mERROR[0m in 1.73s]
[0m18:58:31.620254 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m18:58:31.633812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m18:58:31.630832 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:58:31.649344 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m18:58:31.648722 [error] [MainThread]: CANCEL query model.api_bi_project.stg_customers ................................ [[31mCANCEL[0m]
[0m18:58:31.654459 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:58:31.653957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m18:58:31.674699 [error] [MainThread]: CANCEL query model.api_bi_project.stg_payments ................................. [[31mCANCEL[0m]
[0m18:58:31.656890 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m18:58:31.707060 [error] [MainThread]: CANCEL query model.api_bi_project.stg_sessions ................................. [[31mCANCEL[0m]
[0m18:58:31.714962 [info ] [MainThread]: 
[0m18:58:31.717973 [error] [MainThread]:   Database Error in model stg_sessions (models/staging/stg_sessions.sql)
  relation "stg_sessions" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_sessions.sql
[0m18:58:31.720828 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:31.697744 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.723210 [debug] [MainThread]: On master: BEGIN
[0m18:58:31.700063 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m18:58:31.725559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:31.723125 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.741747 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m18:58:31.759756 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m18:58:31.770176 [debug] [MainThread]: On master: COMMIT
[0m18:58:31.772524 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:31.774715 [debug] [MainThread]: On master: COMMIT
[0m18:58:31.777710 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m18:58:31.777849 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:58:31.782425 [debug] [MainThread]: On master: Close
[0m18:58:31.786060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:31.798106 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:58:31.800486 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m18:58:31.802143 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m18:58:31.809789 [info ] [MainThread]: 
[0m18:58:31.815283 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m18:58:31.820657 [debug] [MainThread]: Command end result
[0m18:58:31.809545 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m18:58:31.831658 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m18:58:31.853266 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.856464 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.876396 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m18:58:31.903134 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.907180 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m18:58:31.910636 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.914942 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:58:31.916132 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:31.926557 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m18:58:31.918781 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m18:58:31.929830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:31.932090 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:31.945043 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m18:58:31.950681 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.955788 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m18:58:31.961650 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m18:58:31.964200 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m18:58:31.967070 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:31.968720 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.972122 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m18:58:31.979628 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m18:58:32.007682 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.022 seconds
[0m18:58:32.024900 [info ] [MainThread]: 
[0m18:58:32.029553 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m18:58:32.033446 [info ] [MainThread]: 
[0m18:58:32.036539 [error] [MainThread]:   Database Error in model stg_sessions (models/staging/stg_sessions.sql)
  relation "stg_sessions" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_sessions.sql
[0m18:58:32.033514 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:32.039740 [info ] [MainThread]: 
[0m18:58:32.040519 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m18:58:32.053400 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.054069 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:58:32.055407 [info ] [MainThread]: 
[0m18:58:32.057681 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.059627 [info ] [MainThread]: 
[0m18:58:32.072874 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.075508 [info ] [MainThread]: 
[0m18:58:32.075926 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:58:32.077641 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.077349 [debug] [Thread-3 (]: SQL status: SELECT 4334 in 0.085 seconds
[0m18:58:32.081337 [info ] [MainThread]: 
[0m18:58:32.085499 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.088550 [info ] [MainThread]: 
[0m18:58:32.098363 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 TOTAL=6
[0m18:58:32.102716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.0074825, "process_user_time": 8.175208, "process_kernel_time": 1.328208, "process_mem_max_rss": "162124", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:32.107311 [debug] [MainThread]: Command `dbt run` failed at 18:58:32.107026 after 7.01 seconds
[0m18:58:32.110606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c66a8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4ddea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c8be7310>]}
[0m18:58:32.113263 [debug] [MainThread]: Flushing usage events
[0m18:58:32.080518 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:32.301200 [debug] [Thread-4 (]: SQL status: SELECT 5677 in 0.330 seconds
[0m18:58:32.306987 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:32.308390 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:58:32.331972 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:32.333857 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m18:58:32.336519 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m18:58:32.337398 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:58:32.339200 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:58:32.340534 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:58:32.343932 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m18:58:32.347739 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:58:32.352984 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:58:32.361576 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:32.364085 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:32.367002 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:32.369321 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m18:58:32.371008 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:58:32.373331 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:58:32.377028 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:58:32.383517 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m18:58:32.384826 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m18:58:32.387611 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m18:58:32.393581 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m18:58:32.397591 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m18:58:32.399338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc312850>]}
[0m18:58:32.401783 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:32.404754 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:32.406854 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.75s]
[0m18:58:32.408565 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m18:58:32.409835 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m18:58:32.411553 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m18:58:32.413791 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:58:32.414975 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:58:32.418682 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m18:58:32.421738 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m18:58:32.423640 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbfa4dcd0>]}
[0m18:58:32.425093 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc334b50>]}
[0m18:58:32.426550 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4334[0m in 0.79s]
[0m18:58:32.428693 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5677[0m in 0.82s]
[0m18:58:32.430636 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m18:58:32.432498 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m18:58:32.438310 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:32.439682 [debug] [MainThread]: On master: BEGIN
[0m18:58:32.440955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:32.457809 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m18:58:32.460733 [debug] [MainThread]: On master: COMMIT
[0m18:58:32.462494 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:32.464277 [debug] [MainThread]: On master: COMMIT
[0m18:58:32.465941 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:58:32.468309 [debug] [MainThread]: On master: Close
[0m18:58:32.470358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:32.472172 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:58:32.476579 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m18:58:32.481738 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m18:58:32.484305 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m18:58:32.487708 [info ] [MainThread]: 
[0m18:58:32.491712 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m18:58:32.505632 [debug] [MainThread]: Command end result
[0m18:58:32.836516 [info ] [MainThread]: 
[0m18:58:32.844842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:32.849549 [info ] [MainThread]: 
[0m18:58:32.858277 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:58:32.865222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.294006, "process_user_time": 9.290483, "process_kernel_time": 1.348898, "process_mem_max_rss": "162112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:32.868127 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:32.867871 after 8.30 seconds
[0m18:58:32.870202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc38233d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc38a3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc37f1850>]}
[0m18:58:32.873351 [debug] [MainThread]: Flushing usage events
[0m18:58:42.097445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edeff510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edf3dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edeffe90>]}


============================== 18:58:42.107499 | 99bc51c4-4d7e-4194-b19b-66b14bc62a30 ==============================
[0m18:58:42.107499 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:58:42.110501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:58:42.461879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ef1e3e10>]}
[0m18:58:42.581837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595efc93890>]}
[0m18:58:42.584323 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:42.803295 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:58:43.790368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:43.792543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:43.886520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ecdc36d0>]}
[0m18:58:44.295238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ec5e7e50>]}
[0m18:58:44.298795 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:58:44.303179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ed592210>]}
[0m18:58:44.317154 [info ] [MainThread]: 
[0m18:58:44.321403 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:44.335216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m18:58:44.337767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m18:58:44.501386 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:44.502405 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:44.510961 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:58:44.513177 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:58:44.515016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:44.518138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:44.541520 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m18:58:44.548347 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:44.549267 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:58:44.551947 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:58:44.553653 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:44.555855 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:58:44.559732 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m18:58:44.564193 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m18:58:44.570136 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:58:44.574594 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:58:44.577502 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:58:44.582295 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:58:44.605459 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.609399 [debug] [MainThread]: On master: BEGIN
[0m18:58:44.613697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:44.634323 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m18:58:44.643287 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.646392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:44.741315 [debug] [MainThread]: SQL status: SELECT 3 in 0.090 seconds
[0m18:58:44.750320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ec5be190>]}
[0m18:58:44.760538 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:44.776301 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.778704 [debug] [MainThread]: On master: BEGIN
[0m18:58:44.780867 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:58:44.783039 [debug] [MainThread]: On master: COMMIT
[0m18:58:44.784824 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.786013 [debug] [MainThread]: On master: COMMIT
[0m18:58:44.787627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:44.789302 [debug] [MainThread]: On master: Close
[0m18:58:44.791282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:44.792743 [info ] [MainThread]: 
[0m18:58:44.820499 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:44.822450 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:44.823854 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:44.825772 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:44.827838 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m18:58:44.830578 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m18:58:44.836737 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m18:58:44.847293 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m18:58:44.854541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m18:58:44.861396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m18:58:44.866817 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m18:58:44.870663 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m18:58:44.873309 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:44.877609 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:44.889674 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:44.894778 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:44.970026 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:44.977645 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.010864 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.015273 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.054293 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:45.070379 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:45.097859 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:45.113886 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.121828 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.137262 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:45.143508 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.153365 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:45.163570 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:45.165797 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m18:58:45.167156 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.170646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:45.172681 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.175463 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m18:58:45.177854 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.191773 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m18:58:45.202452 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:58:45.205080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:58:45.206386 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m18:58:45.209104 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:45.212001 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:45.214210 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:45.221063 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m18:58:45.225403 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m18:58:45.229383 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.230561 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m18:58:45.233894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m18:58:45.237080 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m18:58:45.238349 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:58:45.241264 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m18:58:45.242154 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.249657 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m18:58:45.252287 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m18:58:45.253886 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.255500 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m18:58:45.257250 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m18:58:45.258226 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m18:58:45.259304 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m18:58:45.263137 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.41s]
[0m18:58:45.265424 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.39s]
[0m18:58:45.271231 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:45.272253 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:58:45.275640 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:45.278954 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.286775 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m18:58:45.290311 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.291388 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m18:58:45.292897 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m18:58:45.295368 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m18:58:45.297331 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m18:58:45.300747 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m18:58:45.302436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m18:58:45.305506 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.44s]
[0m18:58:45.306966 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:58:45.309001 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m18:58:45.310179 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.312260 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:45.314692 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.317571 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.46s]
[0m18:58:45.338282 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.341628 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.356287 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.360274 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:45.366714 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m18:58:45.369948 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:45.371992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m18:58:45.374369 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m18:58:45.377197 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.378910 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.379877 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.381387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m18:58:45.387865 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.395213 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.406480 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.408183 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:45.419955 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.423356 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.426689 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m18:58:45.427797 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.431244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:45.437628 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m18:58:45.440027 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.443367 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:45.454564 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:45.473228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m18:58:45.493436 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.577579 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.594781 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.624224 [debug] [Thread-4 (]: SQL status: BEGIN in 0.170 seconds
[0m18:58:45.643117 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m18:58:45.655851 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.664627 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:58:45.666143 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:58:45.673223 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.677526 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m18:58:45.679297 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m18:58:45.682521 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m18:58:45.687755 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m18:58:45.690678 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.698745 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m18:58:45.702603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:45.705894 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.40s]
[0m18:58:45.711504 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:58:45.725435 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m18:58:45.742307 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.752430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:45.757599 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.45s]
[0m18:58:45.762164 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m18:58:45.765906 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:45.773181 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.777532 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.779554 [info ] [Thread-1 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m18:58:45.781722 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:45.783968 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m18:58:45.786330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m18:58:45.790618 [debug] [Thread-2 (]: SQL status: BEGIN in 0.038 seconds
[0m18:58:45.789471 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m18:58:45.797941 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:45.799390 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:58:45.801415 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.806526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m18:58:45.838574 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:45.849069 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m18:58:45.864199 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m18:58:45.878950 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:45.885874 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m18:58:45.901651 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:45.902459 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m18:58:45.904742 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.53s]
[0m18:58:45.910072 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:58:45.912313 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:45.914188 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.915648 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:45.917942 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:58:45.924724 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:45.926145 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.077180 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:46.086143 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.70s]
[0m18:58:46.097448 [info ] [Thread-3 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:58:46.104414 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:46.107503 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m18:58:46.111626 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:46.135606 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.161425 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m18:58:46.165533 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:46.178996 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.181099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:46.185556 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m18:58:46.192597 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:46.214934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m18:58:46.220467 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:46.224061 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.226005 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:58:46.227227 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m18:58:46.236162 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.240052 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:46.244904 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:58:46.254384 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:58:46.263111 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m18:58:46.276865 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m18:58:46.280642 [info ] [Thread-1 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.49s]
[0m18:58:46.289204 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:46.298646 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.032 seconds
[0m18:58:46.301828 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.307861 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m18:58:46.310532 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:58:46.315252 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m18:58:46.317393 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:46.322724 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.52s]
[0m18:58:46.332774 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:46.364405 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m18:58:46.378204 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.380439 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:58:46.420523 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.038 seconds
[0m18:58:46.423360 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:58:46.425042 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:58:46.427256 [info ] [Thread-3 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.32s]
[0m18:58:46.429849 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.434925 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:46.436778 [debug] [MainThread]: On master: BEGIN
[0m18:58:46.438576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:46.456154 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m18:58:46.460770 [debug] [MainThread]: On master: COMMIT
[0m18:58:46.463225 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:46.465267 [debug] [MainThread]: On master: COMMIT
[0m18:58:46.467163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:46.468446 [debug] [MainThread]: On master: Close
[0m18:58:46.469899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:46.471454 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m18:58:46.473103 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m18:58:46.474574 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:58:46.476475 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m18:58:46.477989 [info ] [MainThread]: 
[0m18:58:46.480170 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m18:58:46.486536 [debug] [MainThread]: Command end result
[0m18:58:45.140200 [info ] [MainThread]: 
[0m18:58:45.142777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:45.145825 [info ] [MainThread]: 
[0m18:58:45.162477 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:58:45.168659 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.752155, "process_user_time": 7.612468, "process_kernel_time": 0.946069, "process_mem_max_rss": "162124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:45.175858 [debug] [MainThread]: Command `dbt test` succeeded at 18:58:45.175461 after 4.76 seconds
[0m18:58:45.178170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595f1b974d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edde5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595f1b984d0>]}
[0m18:58:45.180120 [debug] [MainThread]: Flushing usage events
[0m19:00:08.822446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faab7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faf98890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faadfed0>]}


============================== 19:00:08.831116 | 6740db6a-a7e6-42a7-abc7-36e0a4e71f71 ==============================
[0m19:00:08.831116 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:00:08.832490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m19:00:09.127439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faa42b10>]}
[0m19:00:09.247762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fc84b110>]}
[0m19:00:09.260894 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:00:09.433557 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:00:09.866180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:09.868534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:09.927811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f99c8090>]}
[0m19:00:10.077742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f9111390>]}
[0m19:00:10.079835 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:00:10.081295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fab30650>]}
[0m19:00:10.084745 [info ] [MainThread]: 
[0m19:00:10.086661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:10.092715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:10.094194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:10.172063 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:10.172622 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:10.174068 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:10.175581 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:10.177153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:10.178476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:10.193806 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m19:00:10.194469 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m19:00:10.196709 [debug] [ThreadPool]: On list_db: Close
[0m19:00:10.198963 [debug] [ThreadPool]: On list_db: Close
[0m19:00:10.205518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:00:10.206978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:00:10.216126 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:10.220589 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:10.222157 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:00:10.223576 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:00:10.224839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:10.225959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:10.240894 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m19:00:10.241806 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m19:00:10.243442 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:10.245125 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:10.246776 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:00:10.248581 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:00:10.257160 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m19:00:10.257807 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:00:10.260478 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:00:10.263499 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:00:10.265690 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:00:10.266820 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:00:10.277456 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.279104 [debug] [MainThread]: On master: BEGIN
[0m19:00:10.280786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:10.297967 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:00:10.300059 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.302215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:10.338300 [debug] [MainThread]: SQL status: SELECT 3 in 0.034 seconds
[0m19:00:10.341519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faa267d0>]}
[0m19:00:10.343077 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:10.345316 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.346397 [debug] [MainThread]: On master: BEGIN
[0m19:00:10.348102 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:00:10.350257 [debug] [MainThread]: On master: COMMIT
[0m19:00:10.351977 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.353223 [debug] [MainThread]: On master: COMMIT
[0m19:00:10.354894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:10.356421 [debug] [MainThread]: On master: Close
[0m19:00:10.358505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:10.362518 [info ] [MainThread]: 
[0m19:00:10.375678 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:00:10.376509 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:00:10.377642 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:00:10.379240 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:00:10.380692 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:00:10.382214 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:00:10.383560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:00:10.384607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:00:10.386103 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:00:10.387457 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:00:10.388590 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:00:10.390075 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:00:10.398341 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:00:10.402110 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:00:10.405661 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:00:10.413177 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:00:10.414226 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:00:10.421216 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:00:10.468688 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:00:10.469360 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:00:10.474178 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:00:10.482409 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.484153 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.485723 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:00:10.486894 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.488773 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:00:10.490858 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:10.492964 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:00:10.494837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:10.497800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:10.509661 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m19:00:10.511529 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.512952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:00:10.513979 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:00:10.516088 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.517073 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:00:10.523837 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:00:10.525709 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:00:10.528538 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.539191 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.542544 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:00:10.544335 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:00:10.545074 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:00:10.548138 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.553110 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.553827 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:00:10.557664 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.559286 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:00:10.564568 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.566327 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:00:10.569069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.569892 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:00:10.572313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.575938 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.578383 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.598871 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:10.599621 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:00:10.603774 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.605162 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.608024 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:00:10.608848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:00:10.610746 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:10.613499 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.616283 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:10.621219 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:10.621933 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m19:00:10.623415 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.625309 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.634310 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:00:10.635843 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:10.637505 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:10.647514 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.651137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:00:10.652450 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m19:00:10.653359 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:00:10.658630 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:00:10.662876 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:00:10.667790 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.668587 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:00:10.670736 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.672310 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:00:10.677435 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:00:10.679368 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:00:10.684541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f74d05d0>]}
[0m19:00:10.685455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:00:10.689764 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.30s]
[0m19:00:10.690733 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:00:10.693768 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:00:10.695540 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:00:10.697986 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:00:10.699698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75d15d0>]}
[0m19:00:10.703493 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:00:10.705814 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75616d0>]}
[0m19:00:10.710876 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.32s]
[0m19:00:10.712679 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:00:10.714511 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.32s]
[0m19:00:10.716598 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:00:10.718732 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_revenue_daily'
[0m19:00:10.721471 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:00:10.724103 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:00:10.725185 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:00:10.727387 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:00:10.728660 [info ] [Thread-2 (]: 5 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:00:10.733040 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.735118 [info ] [Thread-1 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:00:10.737098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m19:00:10.739796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_marketing_attribution)
[0m19:00:10.741430 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:00:10.743134 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:00:10.750739 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:00:10.756232 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.757045 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:00:10.795267 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.796254 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:00:10.798376 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:00:10.804305 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.813846 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:00:10.816455 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.818884 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:00:10.821552 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.822909 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:10.825187 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:00:10.826634 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.830129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:10.833274 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:00:10.836780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:10.844416 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m19:00:10.847545 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.849077 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:00:10.850581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:00:10.852998 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.854787 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m19:00:10.856869 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:00:10.859860 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.863803 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:00:10.878921 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.012 seconds
[0m19:00:10.957136 [debug] [Thread-1 (]: SQL status: SELECT 5677 in 0.095 seconds
[0m19:00:10.957745 [debug] [Thread-4 (]: SQL status: SELECT 4334 in 0.106 seconds
[0m19:00:10.959905 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.963620 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.971971 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.973828 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:00:10.975237 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:00:10.976412 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:00:10.978060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.979104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:00:10.980436 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.984105 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.987891 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.991940 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.993397 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:00:10.995170 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:00:10.996434 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:00:10.998315 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.999559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:11.001321 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:00:11.007140 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:11.010300 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:11.013678 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:11.015297 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:11.016853 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:11.018370 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:11.019824 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:11.021129 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:11.022415 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:11.042618 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m19:00:11.044088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m19:00:11.044971 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m19:00:11.049235 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:00:11.054745 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:00:11.060977 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:00:11.068582 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:11.070923 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:11.073608 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:11.075560 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:00:11.077259 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:00:11.078634 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:00:11.085477 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:00:11.086328 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:00:11.087109 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:00:11.089737 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:00:11.092271 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:00:11.094708 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:00:11.097620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f74de210>]}
[0m19:00:11.099313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75f2610>]}
[0m19:00:11.101465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75d95d0>]}
[0m19:00:11.103687 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.36s]
[0m19:00:11.105793 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5677[0m in 0.36s]
[0m19:00:11.107682 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4334[0m in 0.38s]
[0m19:00:11.109927 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:00:11.112027 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:00:11.113844 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:00:11.121355 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:11.123258 [debug] [MainThread]: On master: BEGIN
[0m19:00:11.124926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:11.139597 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m19:00:11.141590 [debug] [MainThread]: On master: COMMIT
[0m19:00:11.143405 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:11.145004 [debug] [MainThread]: On master: COMMIT
[0m19:00:11.147167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:11.148650 [debug] [MainThread]: On master: Close
[0m19:00:11.150618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:11.152588 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:00:11.154343 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:00:11.155779 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m19:00:11.157168 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:00:11.159031 [info ] [MainThread]: 
[0m19:00:11.160887 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m19:00:11.164007 [debug] [MainThread]: Command end result
[0m19:00:11.258311 [info ] [MainThread]: 
[0m19:00:11.260180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:11.262479 [info ] [MainThread]: 
[0m19:00:11.264846 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:00:11.267194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5231435, "process_user_time": 4.620106, "process_kernel_time": 0.574659, "process_mem_max_rss": "162128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:11.268900 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:11.268714 after 2.52 seconds
[0m19:00:11.270454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fe750510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fe93aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fe9c7590>]}
[0m19:00:11.273328 [debug] [MainThread]: Flushing usage events
[0m19:00:17.579068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30e863290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3126483d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f310173d50>]}


============================== 19:00:17.593697 | a3ea5c44-01ad-4e27-b513-4ee41ab75508 ==============================
[0m19:00:17.593697 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:00:17.597698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:18.039783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30df69e10>]}
[0m19:00:18.129681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3105e6f90>]}
[0m19:00:18.132090 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:00:18.296542 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:00:18.695612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:18.697605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:18.777525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30d38de90>]}
[0m19:00:18.980829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30cbc37d0>]}
[0m19:00:18.983465 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:00:18.985627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30d3526d0>]}
[0m19:00:18.997568 [info ] [MainThread]: 
[0m19:00:19.001035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:19.012972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:00:19.017838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:00:19.153318 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:19.154158 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:19.155665 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:00:19.157856 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:00:19.159800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:19.161045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:19.175892 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m19:00:19.176805 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m19:00:19.178395 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:19.180299 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:19.181948 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:00:19.183535 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:00:19.189865 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:00:19.193904 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:00:19.195740 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:00:19.196515 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m19:00:19.203814 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:00:19.213805 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:00:19.227188 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.229176 [debug] [MainThread]: On master: BEGIN
[0m19:00:19.230627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:19.246903 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:00:19.248752 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.252638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:19.318491 [debug] [MainThread]: SQL status: SELECT 3 in 0.034 seconds
[0m19:00:19.321005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30f489010>]}
[0m19:00:19.331754 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:19.343535 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.345309 [debug] [MainThread]: On master: BEGIN
[0m19:00:19.347774 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:00:19.350152 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.352611 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.353981 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.355647 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:19.357240 [debug] [MainThread]: On master: Close
[0m19:00:19.360000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:19.362357 [info ] [MainThread]: 
[0m19:00:19.379265 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.379958 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.380761 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.381950 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.383478 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:00:19.385008 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:00:19.386741 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:00:19.388389 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:00:19.390265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:00:19.392081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:00:19.394408 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:00:19.397600 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:00:19.399857 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.401859 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.403717 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.406037 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.452542 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.455535 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.470457 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.477161 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.487312 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.489430 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.497477 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.511064 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.515733 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.521241 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.530286 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.536522 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.547514 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.550381 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.551743 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:00:19.553092 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.554345 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.555616 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:00:19.557608 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:19.559136 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:00:19.560422 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:00:19.561991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:19.565019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:19.567114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:19.576863 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:00:19.580936 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.587444 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:00:19.589730 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m19:00:19.594045 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.595630 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:00:19.597399 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:00:19.598749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:00:19.601273 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:00:19.603763 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.613035 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:00:19.615260 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.618686 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:00:19.621687 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:00:19.623460 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:00:19.627279 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.23s]
[0m19:00:19.628863 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:00:19.635579 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.637106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m19:00:19.639685 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:00:19.642155 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:19.646090 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:00:19.648664 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:00:19.650136 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.033 seconds
[0m19:00:19.651259 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:00:19.653469 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:00:19.655155 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.26s]
[0m19:00:19.658455 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:00:19.660817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:00:19.663638 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.27s]
[0m19:00:19.665577 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.668073 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:00:19.669015 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:19.671207 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.673441 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:19.676431 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.28s]
[0m19:00:19.685681 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.687632 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:19.689399 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:00:19.691460 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.695382 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:00:19.697781 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:00:19.700490 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:19.703154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:00:19.705405 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:19.706788 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:19.708215 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:00:19.709741 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:19.718618 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.723474 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.725420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:00:19.734695 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.740605 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:19.750581 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.755816 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:19.757139 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.764648 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:19.763587 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.768274 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:00:19.770126 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:19.776391 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.778813 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:19.784612 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.795813 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.800927 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.803191 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:00:19.805012 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.806958 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:00:19.809431 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m19:00:19.810566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:19.812612 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:00:19.814572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:19.817161 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.820311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:19.823918 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:00:19.835690 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m19:00:19.845857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m19:00:19.864576 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m19:00:19.929361 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:00:19.941282 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.954069 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.964296 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.971306 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:00:19.974485 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:00:19.977511 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:00:19.979373 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:00:19.989445 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:00:19.990273 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:00:19.995160 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:00:19.996516 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:00:19.999419 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.34s]
[0m19:00:20.004482 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:00:20.018733 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:00:20.025780 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:00:20.032867 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:20.035915 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:00:20.038425 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:00:20.040370 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:00:20.041901 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.044887 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.35s]
[0m19:00:20.047891 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.34s]
[0m19:00:20.051643 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.33s]
[0m19:00:20.053856 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:00:20.056044 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:20.057729 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:20.059221 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:20.060840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:00:20.063173 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.064358 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.066351 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.067705 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:00:20.068824 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:00:20.078372 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.079994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:00:20.081139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:00:20.083306 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.084506 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.090472 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.100469 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.102882 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.105771 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.189454 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.197353 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.196728 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.205485 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.213813 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.215635 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.217566 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:00:20.218719 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.220683 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:00:20.223200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:20.225266 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:00:20.226439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:20.229464 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:20.245985 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m19:00:20.251698 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m19:00:20.253841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m19:00:20.255723 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.257566 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.259325 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.262022 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:00:20.264811 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:00:20.267293 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:00:20.272842 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:00:20.277239 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:00:20.282791 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:00:20.287168 [info ] [Thread-3 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.23s]
[0m19:00:20.291349 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m19:00:20.296338 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.303172 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:00:20.308610 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:00:20.313925 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.23s]
[0m19:00:20.319433 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.330161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m19:00:20.335997 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:00:20.338448 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:00:20.341992 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.26s]
[0m19:00:20.348680 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.354334 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.356309 [debug] [MainThread]: On master: BEGIN
[0m19:00:20.358508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:20.376554 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:00:20.379013 [debug] [MainThread]: On master: COMMIT
[0m19:00:20.380983 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.383323 [debug] [MainThread]: On master: COMMIT
[0m19:00:20.386279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:20.388038 [debug] [MainThread]: On master: Close
[0m19:00:20.389859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:20.391620 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:00:20.395044 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m19:00:20.397710 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:00:20.399670 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:00:20.401490 [info ] [MainThread]: 
[0m19:00:20.403774 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m19:00:20.409989 [debug] [MainThread]: Command end result
[0m19:00:20.478711 [info ] [MainThread]: 
[0m19:00:20.480396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:20.482311 [info ] [MainThread]: 
[0m19:00:20.484409 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:00:20.486693 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9928796, "process_user_time": 5.101693, "process_kernel_time": 0.714862, "process_mem_max_rss": "162136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:20.488386 [debug] [MainThread]: Command `dbt test` succeeded at 19:00:20.488192 after 2.99 seconds
[0m19:00:20.489743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30eb99490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30e8bb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f312704790>]}
[0m19:00:20.491812 [debug] [MainThread]: Flushing usage events
[0m19:17:05.649561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7d5b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7d83990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba8edd290>]}


============================== 19:17:05.734559 | 86b06e64-5545-46ee-87d9-ba93b6910123 ==============================
[0m19:17:05.734559 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:17:05.736775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m19:17:06.175858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7d58250>]}
[0m19:17:06.268410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7df3750>]}
[0m19:17:06.270942 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:17:06.463527 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:17:07.179046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:07.181381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:07.346941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba71cc510>]}
[0m19:17:07.701684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba61e96d0>]}
[0m19:17:07.704706 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:17:07.714042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba697c990>]}
[0m19:17:07.728855 [info ] [MainThread]: 
[0m19:17:07.732088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:07.762708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:17:07.765334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:17:07.950683 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:17:07.951631 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:17:07.953056 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:17:07.954812 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:17:07.956984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:07.958803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:07.985609 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.024 seconds
[0m19:17:07.986809 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.028 seconds
[0m19:17:07.992390 [debug] [ThreadPool]: On list_db: Close
[0m19:17:07.997324 [debug] [ThreadPool]: On list_db: Close
[0m19:17:08.005590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:17:08.007010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:17:08.015965 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:08.020214 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:08.022081 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:17:08.023429 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:17:08.024665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:08.025805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:08.042405 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:17:08.043107 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m19:17:08.045301 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:08.047255 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:08.048710 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:17:08.050596 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:17:08.061536 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m19:17:08.062636 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m19:17:08.066072 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:17:08.069453 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:17:08.071446 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:17:08.073221 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:17:08.086703 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.089374 [debug] [MainThread]: On master: BEGIN
[0m19:17:08.090938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:08.105774 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:17:08.108101 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.110474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:08.168885 [debug] [MainThread]: SQL status: SELECT 3 in 0.056 seconds
[0m19:17:08.171495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba6190b90>]}
[0m19:17:08.173406 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:08.176096 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.178290 [debug] [MainThread]: On master: BEGIN
[0m19:17:08.180920 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:17:08.183285 [debug] [MainThread]: On master: COMMIT
[0m19:17:08.185210 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.187074 [debug] [MainThread]: On master: COMMIT
[0m19:17:08.189325 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:08.192203 [debug] [MainThread]: On master: Close
[0m19:17:08.195478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:08.207907 [info ] [MainThread]: 
[0m19:17:08.236940 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:17:08.238120 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:17:08.239626 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:17:08.241186 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:17:08.242824 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:17:08.244681 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:17:08.246857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:17:08.249584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:17:08.251836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_db, now model.api_bi_project.stg_sessions)
[0m19:17:08.253605 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:17:08.255329 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:17:08.257368 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:17:08.269471 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:17:08.273642 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:17:08.279726 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:17:08.290109 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:17:08.298695 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:17:08.300108 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:17:08.379290 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:17:08.381005 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:17:08.378656 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:17:08.389671 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.391344 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.392277 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.393415 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:17:08.394776 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:17:08.396209 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:17:08.397598 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:17:08.398827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:08.400016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:08.422614 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m19:17:08.428852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:08.431117 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.432594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m19:17:08.434355 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.436335 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:17:08.438465 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.440452 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:17:08.449744 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:17:08.454467 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m19:17:08.455163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:17:08.456389 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:17:08.466927 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.472112 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.478581 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.480339 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:17:08.481886 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:17:08.483370 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:17:08.486683 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.489626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.490641 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:17:08.495331 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.500480 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.509016 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.511352 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:17:08.513769 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:17:08.515794 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:17:08.518565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.521543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.523136 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.545375 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:17:08.547536 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:17:08.551084 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:17:08.552837 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.554646 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.556727 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.558575 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:17:08.560129 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:17:08.562067 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:17:08.568180 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m19:17:08.569340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:17:08.577607 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m19:17:08.592879 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:17:08.597375 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:17:08.601836 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:17:08.610919 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.612833 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.614663 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.616101 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:17:08.617707 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:17:08.619185 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:17:08.625600 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:17:08.626608 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m19:17:08.627258 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m19:17:08.631076 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:17:08.633963 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:17:08.636488 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:17:08.640086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba475dc50>]}
[0m19:17:08.642056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba4637850>]}
[0m19:17:08.648498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba475ea10>]}
[0m19:17:08.650336 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.39s]
[0m19:17:08.653020 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.39s]
[0m19:17:08.655422 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.40s]
[0m19:17:08.657751 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:17:08.660053 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:17:08.661765 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:17:08.663940 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m19:17:08.665821 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:17:08.667206 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:17:08.669097 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:17:08.670676 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:17:08.672246 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:17:08.673887 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m19:17:08.675670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m19:17:08.677551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m19:17:08.679825 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:17:08.684242 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:17:08.688312 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:17:08.698057 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:17:08.709592 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.722823 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.743720 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:17:08.752960 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:17:08.754016 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m19:17:08.831649 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.834481 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.861962 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:17:08.878813 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.881303 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.882518 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:17:08.883450 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:08.885634 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:17:08.887492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:08.889760 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:17:08.891579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:08.896054 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:17:08.907167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:17:08.913608 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.918655 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m19:17:08.927965 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:17:08.932544 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.933849 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m19:17:08.939325 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:17:08.942168 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:08.954265 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:17:09.075062 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.117 seconds
[0m19:17:09.305468 [debug] [Thread-1 (]: SQL status: SELECT 4334 in 0.369 seconds
[0m19:17:09.324835 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.335695 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.337336 [debug] [Thread-2 (]: SQL status: SELECT 5677 in 0.390 seconds
[0m19:17:09.340562 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:17:09.347828 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:17:09.370870 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.401342 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:17:09.414758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.418236 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:17:09.428775 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.444064 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.447941 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.449017 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:17:09.451688 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:17:09.460759 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.464779 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.467366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.469839 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:17:09.487090 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:17:09.492882 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:17:09.496477 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.498669 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.501608 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.506926 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:17:09.509587 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:17:09.511989 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:17:09.514634 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.519518 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:17:09.520720 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m19:17:09.522241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:17:09.530845 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m19:17:09.532165 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:17:09.539675 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:17:09.546978 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:17:09.555414 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.559083 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.562795 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.565432 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:17:09.567960 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:17:09.570159 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:17:09.585151 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m19:17:09.586404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m19:17:09.587594 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m19:17:09.592229 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:17:09.596718 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:17:09.603087 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m19:17:09.606098 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba4550910>]}
[0m19:17:09.616754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba4727390>]}
[0m19:17:09.621132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7dc24d0>]}
[0m19:17:09.625069 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5677[0m in 0.93s]
[0m19:17:09.631195 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4334[0m in 0.94s]
[0m19:17:09.636069 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.95s]
[0m19:17:09.639847 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:17:09.642664 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:17:09.645045 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m19:17:09.659640 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:09.665147 [debug] [MainThread]: On master: BEGIN
[0m19:17:09.667159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:09.688088 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:17:09.711727 [debug] [MainThread]: On master: COMMIT
[0m19:17:09.722377 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:09.728210 [debug] [MainThread]: On master: COMMIT
[0m19:17:09.731332 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:09.735817 [debug] [MainThread]: On master: Close
[0m19:17:09.741362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:09.743591 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m19:17:09.745893 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:17:09.748074 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:17:09.750222 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:17:09.752784 [info ] [MainThread]: 
[0m19:17:09.755013 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m19:17:09.759347 [debug] [MainThread]: Command end result
[0m19:17:10.031329 [info ] [MainThread]: 
[0m19:17:10.037118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:10.040797 [info ] [MainThread]: 
[0m19:17:10.046050 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:17:10.057317 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5796432, "process_user_time": 7.739481, "process_kernel_time": 2.538942, "process_mem_max_rss": "162176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:17:10.065273 [debug] [MainThread]: Command `dbt run` succeeded at 19:17:10.064860 after 4.59 seconds
[0m19:17:10.072288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbabc135d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbabc93550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbabb48510>]}
[0m19:17:10.076890 [debug] [MainThread]: Flushing usage events
[0m19:17:20.052413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b1d72b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b226e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b31faf90>]}


============================== 19:17:20.064791 | 61d4581b-5781-49b4-b9f9-1cd62dab5ab6 ==============================
[0m19:17:20.064791 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:17:20.066667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:17:20.437410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b1d73e10>]}
[0m19:17:20.529528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b3adb890>]}
[0m19:17:20.531901 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:17:20.777729 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:17:21.854868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:21.857961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:22.005366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b23394d0>]}
[0m19:17:22.329695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b0dc0ed0>]}
[0m19:17:22.331697 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:17:22.333448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b0d66090>]}
[0m19:17:22.339160 [info ] [MainThread]: 
[0m19:17:22.341684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:22.351434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:17:22.353134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:17:22.437336 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:22.438602 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:22.440471 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:17:22.442551 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:17:22.448219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:22.450154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:22.473015 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m19:17:22.474775 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m19:17:22.476590 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:22.478338 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:22.480115 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:17:22.482459 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:17:22.492131 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:17:22.492978 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:17:22.497061 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:17:22.501415 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:17:22.503736 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:17:22.505483 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:17:22.523083 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.525365 [debug] [MainThread]: On master: BEGIN
[0m19:17:22.527125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:22.545205 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:17:22.547242 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.549080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:22.599282 [debug] [MainThread]: SQL status: SELECT 3 in 0.048 seconds
[0m19:17:22.603682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b1553310>]}
[0m19:17:22.606058 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:22.608421 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.609901 [debug] [MainThread]: On master: BEGIN
[0m19:17:22.612217 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:17:22.614371 [debug] [MainThread]: On master: COMMIT
[0m19:17:22.616652 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.618360 [debug] [MainThread]: On master: COMMIT
[0m19:17:22.620488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:17:22.622135 [debug] [MainThread]: On master: Close
[0m19:17:22.624660 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:22.626579 [info ] [MainThread]: 
[0m19:17:22.645882 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:22.646814 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:22.647779 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:22.648986 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:22.650471 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:17:22.652380 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:17:22.653940 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:17:22.655297 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:17:22.657078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:17:22.658745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:17:22.660363 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:17:22.661834 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:17:22.663588 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:22.665581 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:22.667609 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:22.669127 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:22.696877 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.714786 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.736102 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.745708 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.779293 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:22.780359 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:22.787823 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:22.794642 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:22.828553 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.839527 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.843370 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.849485 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.859037 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.861383 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.862862 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.864027 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:17:22.865079 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.866737 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:17:22.869310 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:17:22.871984 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:17:22.874217 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:17:22.876136 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:17:22.878701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:22.882326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:22.899847 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:22.904450 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:22.906826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:22.917176 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.923049 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.924457 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m19:17:22.934524 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.937622 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:17:22.941493 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:17:22.948824 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.953502 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:17:22.976520 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:17:22.987599 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m19:17:23.012440 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.049 seconds
[0m19:17:23.018806 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m19:17:23.074254 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:17:23.080507 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.056 seconds
[0m19:17:23.089252 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:17:23.094527 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:17:23.098208 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:17:23.102816 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:17:23.106105 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:17:23.110525 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:17:23.115796 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.45s]
[0m19:17:23.120357 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:17:23.123676 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.46s]
[0m19:17:23.129263 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.47s]
[0m19:17:23.139923 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:23.145982 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.49s]
[0m19:17:23.151417 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:23.154232 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:23.158058 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.163957 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:23.166087 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.168475 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.170945 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:17:23.173820 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.176538 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:17:23.181660 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:17:23.185688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:17:23.187716 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:17:23.190195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:17:23.192387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:17:23.194339 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.197655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:17:23.199242 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.200846 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.209012 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.210488 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.216733 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.224323 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.232827 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.239262 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.240472 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.246005 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.246793 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.247369 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.251000 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.257349 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.261867 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.264406 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.267857 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:17:23.269191 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:17:23.271876 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.275181 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.276729 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.277937 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:17:23.279445 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:17:23.281197 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:17:23.282661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:17:23.286206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m19:17:23.287119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:23.288929 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:23.292241 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.298204 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:17:23.302072 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:23.306504 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:17:23.308566 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m19:17:23.310101 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:17:23.312136 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.313174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m19:17:23.314102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m19:17:23.316380 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.13s]
[0m19:17:23.318546 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:17:23.320547 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.322282 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.324658 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.328088 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:17:23.329697 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:17:23.330545 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:17:23.332344 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.338066 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:17:23.341047 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:17:23.342152 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m19:17:23.344154 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:17:23.349013 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:17:23.351590 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:17:23.354942 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:17:23.357122 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:17:23.359892 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:17:23.361940 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.17s]
[0m19:17:23.364344 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:17:23.366220 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.369156 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.17s]
[0m19:17:23.371471 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.374223 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.18s]
[0m19:17:23.389514 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.391028 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.392533 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.394317 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.397307 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.399564 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:17:23.403224 [info ] [Thread-2 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:17:23.405363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:17:23.407603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:17:23.408813 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.410890 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.413041 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.417131 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.426139 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.445603 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.455042 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.655124 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.656284 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.659573 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.661648 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:17:23.669021 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.671861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:17:23.679410 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.682183 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:17:23.683562 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.685435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:17:23.688349 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:17:23.690550 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:17:23.694324 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:23.700592 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.706665 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:17:23.714112 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m19:17:23.717700 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.718971 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:17:23.721855 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:17:23.724373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m19:17:23.729219 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:17:23.734763 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.741339 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:17:23.738653 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:17:23.746707 [info ] [Thread-3 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.39s]
[0m19:17:23.752755 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.755592 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m19:17:23.763755 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:17:23.767806 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:17:23.771268 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.37s]
[0m19:17:23.775085 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.795192 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.051 seconds
[0m19:17:23.801741 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:17:23.807193 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:17:23.810819 [info ] [Thread-2 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.40s]
[0m19:17:23.816418 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.824225 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.828033 [debug] [MainThread]: On master: BEGIN
[0m19:17:23.831393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:23.857376 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m19:17:23.860943 [debug] [MainThread]: On master: COMMIT
[0m19:17:23.863317 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.865715 [debug] [MainThread]: On master: COMMIT
[0m19:17:23.868837 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:23.871227 [debug] [MainThread]: On master: Close
[0m19:17:23.873774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:23.875883 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075' was properly closed.
[0m19:17:23.878959 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:17:23.881611 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:17:23.885036 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:17:23.887573 [info ] [MainThread]: 
[0m19:17:23.889692 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m19:17:23.895021 [debug] [MainThread]: Command end result
[0m19:17:23.967151 [info ] [MainThread]: 
[0m19:17:23.968824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:23.970144 [info ] [MainThread]: 
[0m19:17:23.971709 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:17:23.974419 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.0955963, "process_user_time": 7.380141, "process_kernel_time": 1.450621, "process_mem_max_rss": "162176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:17:23.976560 [debug] [MainThread]: Command `dbt test` succeeded at 19:17:23.976260 after 4.10 seconds
[0m19:17:23.977837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b5c28650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b5a43550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b5a434d0>]}
[0m19:17:23.979035 [debug] [MainThread]: Flushing usage events
[0m17:21:47.709395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955bd1b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955bd1b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955c8d4290>]}


============================== 17:21:47.721033 | 96e3421e-6958-43b3-8f61-a5c885b326ef ==============================
[0m17:21:47.721033 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:21:47.723390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:48.409138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955bdec690>]}
[0m17:21:48.728181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955daaf550>]}
[0m17:21:48.734291 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:21:49.043175 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:21:49.781592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:49.784018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:49.848504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955abc3f90>]}
[0m17:21:50.189642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955a7b8850>]}
[0m17:21:50.192655 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m17:21:50.194397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955afa8790>]}
[0m17:21:50.199274 [info ] [MainThread]: 
[0m17:21:50.202324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:50.241967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:21:50.243347 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:21:50.334800 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:21:50.335362 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:21:50.337088 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:21:50.338982 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:21:50.340365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:50.342040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:50.366841 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m17:21:50.368068 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m17:21:50.372489 [debug] [ThreadPool]: On list_db: Close
[0m17:21:50.376658 [debug] [ThreadPool]: On list_db: Close
[0m17:21:50.383375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m17:21:50.385770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m17:21:50.400036 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:21:50.405067 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:21:50.407534 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:21:50.409030 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:21:50.411290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:50.413598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:50.432445 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m17:21:50.434850 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m17:21:50.435948 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:21:50.438741 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:21:50.441480 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:21:50.443101 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:21:50.459711 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m17:21:50.460950 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.014 seconds
[0m17:21:50.465293 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:21:50.471387 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:21:50.473587 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:21:50.476270 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:21:50.497119 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.498874 [debug] [MainThread]: On master: BEGIN
[0m17:21:50.500567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:50.517835 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:21:50.519790 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.522161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:50.578259 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m17:21:50.581908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955a31a3d0>]}
[0m17:21:50.583965 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:50.586582 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.588717 [debug] [MainThread]: On master: BEGIN
[0m17:21:50.591018 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:21:50.593069 [debug] [MainThread]: On master: COMMIT
[0m17:21:50.595317 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.596653 [debug] [MainThread]: On master: COMMIT
[0m17:21:50.598688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:21:50.601050 [debug] [MainThread]: On master: Close
[0m17:21:50.603396 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:50.608003 [info ] [MainThread]: 
[0m17:21:50.626822 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m17:21:50.627689 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m17:21:50.629066 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m17:21:50.631343 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m17:21:50.633430 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m17:21:50.635151 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m17:21:50.636514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m17:21:50.637918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m17:21:50.639557 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m17:21:50.641082 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m17:21:50.642522 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m17:21:50.643710 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m17:21:50.652121 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m17:21:50.655964 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m17:21:50.660070 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m17:21:50.669588 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m17:21:50.670463 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m17:21:50.679147 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m17:21:50.739140 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m17:21:50.740850 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m17:21:50.747033 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m17:21:50.771160 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.772392 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.774390 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m17:21:50.775899 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.778347 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m17:21:50.780916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:50.783474 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m17:21:50.785645 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:50.789684 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:50.801960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:21:50.804613 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.807020 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m17:21:50.808813 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m17:21:50.812142 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.814560 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m17:21:50.816907 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m17:21:50.818940 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.821413 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m17:21:50.843938 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m17:21:50.845684 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:21:50.847341 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m17:21:50.857933 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.864947 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.871003 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.872696 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:21:50.874619 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m17:21:50.876686 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:21:50.881447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:21:50.884214 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.884759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.890515 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.895215 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.902811 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.903915 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:21:50.905679 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m17:21:50.907612 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:21:50.909659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.911450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.912948 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.935217 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:21:50.937870 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:21:50.940280 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:21:50.941648 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.944108 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.945419 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.946688 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:21:50.947822 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:21:50.948860 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:21:50.952549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:50.953330 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:50.954682 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:21:50.963687 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m17:21:50.968258 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m17:21:50.973072 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m17:21:50.983047 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.985034 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.987706 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.989980 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:21:50.991393 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m17:21:50.992648 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m17:21:51.002457 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:21:51.003445 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:21:51.004158 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m17:21:51.008450 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m17:21:51.012007 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m17:21:51.014863 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m17:21:51.018482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759559b6e950>]}
[0m17:21:51.020514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955a33ac10>]}
[0m17:21:51.022886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955879db50>]}
[0m17:21:51.025287 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.38s]
[0m17:21:51.029061 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.38s]
[0m17:21:51.031591 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.39s]
[0m17:21:51.033534 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m17:21:51.035925 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m17:21:51.038084 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m17:21:51.040326 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.042219 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m17:21:51.044217 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m17:21:51.046045 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m17:21:51.047593 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m17:21:51.049124 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m17:21:51.050744 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m17:21:51.052802 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m17:21:51.056015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m17:21:51.057812 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.059323 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m17:21:51.060777 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m17:21:51.066615 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.072220 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.077169 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m17:21:51.100656 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m17:21:51.102095 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m17:21:51.103030 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.150654 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.155915 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m17:21:51.163522 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.182913 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.183928 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.184692 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.186025 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m17:21:51.187626 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m17:21:51.190536 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m17:21:51.193279 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:51.195483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:51.197256 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:51.215726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m17:21:51.219389 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m17:21:51.223839 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m17:21:51.226490 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.230205 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.232615 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.238358 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m17:21:51.241939 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m17:21:51.244850 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m17:21:51.283510 [debug] [Thread-2 (]: SQL status: SELECT 1007 in 0.035 seconds
[0m17:21:51.402869 [debug] [Thread-3 (]: SQL status: SELECT 4356 in 0.153 seconds
[0m17:21:51.405604 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.411354 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.412065 [debug] [Thread-4 (]: SQL status: SELECT 5706 in 0.161 seconds
[0m17:21:51.413204 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m17:21:51.414554 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m17:21:51.419365 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.421825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.423229 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.423831 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m17:21:51.429191 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.433447 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.435641 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.436359 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:21:51.438409 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m17:21:51.442973 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.444977 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.446709 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.447819 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m17:21:51.459208 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:21:51.463143 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:21:51.465935 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.466676 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.468025 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.471309 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:21:51.472584 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:21:51.474141 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:21:51.475795 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.478970 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:51.479659 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:21:51.480242 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:51.484817 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m17:21:51.489997 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m17:21:51.490622 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m17:21:51.495764 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.497844 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.502543 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m17:21:51.504234 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m17:21:51.505560 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m17:21:51.507488 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.511187 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m17:21:51.519476 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:21:51.520437 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m17:21:51.521165 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.012 seconds
[0m17:21:51.523552 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m17:21:51.525641 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m17:21:51.528569 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m17:21:51.530910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955854c650>]}
[0m17:21:51.532492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955afa2150>]}
[0m17:21:51.534043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759559b9fbd0>]}
[0m17:21:51.535787 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5706[0m in 0.48s]
[0m17:21:51.539943 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4356[0m in 0.48s]
[0m17:21:51.542342 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1007[0m in 0.48s]
[0m17:21:51.544664 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.546856 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m17:21:51.549513 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m17:21:51.555996 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:51.558313 [debug] [MainThread]: On master: BEGIN
[0m17:21:51.559960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:51.573954 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:21:51.576433 [debug] [MainThread]: On master: COMMIT
[0m17:21:51.578016 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:51.579594 [debug] [MainThread]: On master: COMMIT
[0m17:21:51.581653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:21:51.583274 [debug] [MainThread]: On master: Close
[0m17:21:51.585474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:51.586701 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m17:21:51.589668 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m17:21:51.591868 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m17:21:51.594879 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m17:21:51.597380 [info ] [MainThread]: 
[0m17:21:51.598876 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m17:21:51.601555 [debug] [MainThread]: Command end result
[0m17:21:51.779150 [info ] [MainThread]: 
[0m17:21:51.782508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:51.784209 [info ] [MainThread]: 
[0m17:21:51.787431 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:21:51.791075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3329277, "process_user_time": 5.759368, "process_kernel_time": 1.733841, "process_mem_max_rss": "156604", "process_in_blocks": "37048", "process_out_blocks": "0"}
[0m17:21:51.794442 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:51.794024 after 4.34 seconds
[0m17:21:51.798270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955fc2b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955fb5b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955fb5b350>]}
[0m17:21:51.800171 [debug] [MainThread]: Flushing usage events
[0m17:21:59.548474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58293990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a582cc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58293610>]}


============================== 17:21:59.560141 | 2ad8e13c-8c55-4208-9442-0fb5219775b7 ==============================
[0m17:21:59.560141 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:21:59.562738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:59.904276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58312790>]}
[0m17:22:00.026173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a59ffb910>]}
[0m17:22:00.030633 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:22:00.188040 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:22:00.533474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:22:00.535391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:22:00.595542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58498c90>]}
[0m17:22:00.785376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a569aff90>]}
[0m17:22:00.788754 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m17:22:00.791926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58eda590>]}
[0m17:22:00.799304 [info ] [MainThread]: 
[0m17:22:00.802021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:22:00.813090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m17:22:00.815672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m17:22:00.957165 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:22:00.958018 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:22:00.959623 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:22:00.962417 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:22:00.964977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:00.967170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:00.991121 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m17:22:00.996877 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m17:22:01.001063 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:22:01.005056 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:22:01.011393 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:22:01.018642 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:22:01.036997 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m17:22:01.038537 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m17:22:01.042552 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:22:01.049110 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:22:01.052068 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:22:01.055742 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:22:01.072126 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.074630 [debug] [MainThread]: On master: BEGIN
[0m17:22:01.076626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:01.098301 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m17:22:01.100927 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.102859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:22:01.148198 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m17:22:01.151184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a569eb010>]}
[0m17:22:01.152785 [debug] [MainThread]: On master: ROLLBACK
[0m17:22:01.155934 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.157436 [debug] [MainThread]: On master: BEGIN
[0m17:22:01.159385 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:22:01.161045 [debug] [MainThread]: On master: COMMIT
[0m17:22:01.162761 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.164516 [debug] [MainThread]: On master: COMMIT
[0m17:22:01.166203 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:22:01.167645 [debug] [MainThread]: On master: Close
[0m17:22:01.170272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:01.173808 [info ] [MainThread]: 
[0m17:22:01.193725 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.194856 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.195536 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.196131 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.197169 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m17:22:01.201791 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m17:22:01.204654 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m17:22:01.206870 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m17:22:01.211047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m17:22:01.213577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m17:22:01.215572 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m17:22:01.217486 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m17:22:01.220968 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.222908 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.224366 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.225897 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.253058 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.267014 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.279135 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.286921 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.311508 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.312510 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.343387 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.350501 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.351856 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.352545 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.359669 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.371651 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.383748 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.386335 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m17:22:01.388419 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:22:01.391007 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.395484 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m17:22:01.399646 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:22:01.404629 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.407448 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m17:22:01.415056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:01.416505 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.417874 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m17:22:01.420165 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m17:22:01.425164 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m17:22:01.427714 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.431721 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.433929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:01.435845 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m17:22:01.437884 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m17:22:01.442243 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m17:22:01.446205 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:22:01.449381 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.450793 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:22:01.461980 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m17:22:01.464913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:22:01.466717 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m17:22:01.472544 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m17:22:01.475661 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m17:22:01.478102 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.482399 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m17:22:01.486538 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.27s]
[0m17:22:01.489101 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m17:22:01.491549 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.27s]
[0m17:22:01.497932 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.502088 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.504856 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.507064 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.507986 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m17:22:01.509657 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m17:22:01.512622 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m17:22:01.516740 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m17:22:01.517971 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.037 seconds
[0m17:22:01.519305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m17:22:01.521944 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:22:01.524606 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m17:22:01.527177 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m17:22:01.529044 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.531052 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.533366 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.32s]
[0m17:22:01.535666 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m17:22:01.543619 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.551176 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.553063 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.556180 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.34s]
[0m17:22:01.559972 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.562240 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.564169 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m17:22:01.566269 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.568510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m17:22:01.570584 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m17:22:01.571981 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.573513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m17:22:01.582112 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.583756 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.585208 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.586978 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.597089 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.601455 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.607674 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.612910 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.619993 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.629038 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.634751 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.637493 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.638581 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.641553 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m17:22:01.643810 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:22:01.644845 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.647326 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:01.650504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:01.652932 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m17:22:01.658501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:01.662884 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.665182 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m17:22:01.666934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:01.670932 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m17:22:01.672194 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m17:22:01.674261 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.677343 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.679607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:22:01.681072 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:22:01.683003 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m17:22:01.684638 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.686790 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m17:22:01.690608 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m17:22:01.692491 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:22:01.693404 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:22:01.695466 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.701377 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:22:01.702407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:22:01.707229 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m17:22:01.709977 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m17:22:01.711713 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:22:01.715688 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:22:01.718496 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m17:22:01.721961 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:22:01.720859 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.20s]
[0m17:22:01.726776 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:22:01.729169 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.21s]
[0m17:22:01.734881 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m17:22:01.736979 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.739813 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.17s]
[0m17:22:01.745648 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.748058 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m17:22:01.749789 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:01.752310 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.754511 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:01.756348 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.18s]
[0m17:22:01.757463 [info ] [Thread-4 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m17:22:01.759791 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:01.761574 [info ] [Thread-3 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m17:22:01.763551 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.765054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m17:22:01.766419 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m17:22:01.768933 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m17:22:01.772421 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:01.774086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m17:22:01.775406 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:01.787510 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:01.789138 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:01.797153 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:01.807497 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:01.827908 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:01.829119 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:01.841994 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:01.936613 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:01.937800 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:01.945267 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:01.964103 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:01.965101 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:01.965899 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:01.967143 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:22:01.969321 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m17:22:01.971765 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m17:22:01.973375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:01.975398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:01.977182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:01.993616 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m17:22:01.995071 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m17:22:01.999025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m17:22:02.000555 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:02.002897 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:02.005055 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:02.007670 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:02.009420 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:02.011362 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:02.018056 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:22:02.030019 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:22:02.031893 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m17:22:02.034224 [info ] [Thread-4 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.27s]
[0m17:22:02.040067 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m17:22:02.041307 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:02.050629 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:22:02.055734 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m17:22:02.058399 [info ] [Thread-3 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.29s]
[0m17:22:02.061017 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:02.070367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m17:22:02.074609 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m17:22:02.076286 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m17:22:02.077970 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.30s]
[0m17:22:02.080308 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:02.085209 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:02.086682 [debug] [MainThread]: On master: BEGIN
[0m17:22:02.087957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:02.101223 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:22:02.103518 [debug] [MainThread]: On master: COMMIT
[0m17:22:02.105999 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:02.107921 [debug] [MainThread]: On master: COMMIT
[0m17:22:02.109966 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:22:02.111689 [debug] [MainThread]: On master: Close
[0m17:22:02.114830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:02.118166 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m17:22:02.121872 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m17:22:02.124091 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m17:22:02.126756 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m17:22:02.128855 [info ] [MainThread]: 
[0m17:22:02.131218 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m17:22:02.141177 [debug] [MainThread]: Command end result
[0m17:22:02.224541 [info ] [MainThread]: 
[0m17:22:02.227481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:02.230710 [info ] [MainThread]: 
[0m17:22:02.236199 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:22:02.239747 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7902374, "process_user_time": 4.901896, "process_kernel_time": 0.867624, "process_mem_max_rss": "156608", "process_in_blocks": "1224", "process_out_blocks": "0"}
[0m17:22:02.241524 [debug] [MainThread]: Command `dbt test` succeeded at 17:22:02.241359 after 2.79 seconds
[0m17:22:02.242950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a5c148650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a5bf63550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a5bf634d0>]}
[0m17:22:02.244870 [debug] [MainThread]: Flushing usage events
[0m18:41:22.861455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce73403730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce715e4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce715e7130>]}


============================== 18:41:22.869302 | 2c2d2177-7511-42f5-9857-353c50d08655 ==============================
[0m18:41:22.869302 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:41:22.871761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:23.211563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce73bd1f00>]}
[0m18:41:23.325445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce71689e70>]}
[0m18:41:23.328693 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:41:23.344938 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:41:23.465474 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:41:23.467557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6fd5eda0>]}
[0m18:41:25.389431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6ea90d90>]}
[0m18:41:25.618507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6fbcf2e0>]}
[0m18:41:25.620521 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:41:25.622380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6fbcea10>]}
[0m18:41:25.627126 [info ] [MainThread]: 
[0m18:41:25.631973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:25.636118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:41:25.638883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:41:25.674763 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:41:25.688728 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:41:25.689874 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:41:25.691547 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:41:25.693614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:25.696141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:25.718368 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:41:25.723105 [debug] [ThreadPool]: On list_db: Close
[0m18:41:25.723907 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:41:25.729485 [debug] [ThreadPool]: On list_db: Close
[0m18:41:25.734030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m18:41:25.735463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m18:41:25.737873 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m18:41:25.740477 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m18:41:25.752123 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:41:25.758147 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:41:25.760507 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m18:41:25.762387 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m18:41:25.764688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.766416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.785954 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.788388 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:41:25.791746 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m18:41:25.794232 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.798286 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:41:25.799451 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:41:25.803279 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:41:25.805574 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m18:41:25.807352 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:41:25.809989 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:41:25.810838 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:41:25.816157 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:41:25.820514 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:41:25.821747 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:41:25.823692 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:41:25.825495 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m18:41:25.829538 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:41:25.832651 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m18:41:25.839148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_analytics)
[0m18:41:25.841549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_staging)
[0m18:41:25.860528 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:41:25.865046 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:41:25.866992 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:41:25.868799 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:41:25.870372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.871599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.894489 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.898134 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:41:25.900646 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:41:25.902386 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.905223 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:41:25.906965 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:41:25.910844 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:25.914468 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:41:25.915274 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:25.917147 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:41:25.919834 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:41:25.923442 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:41:25.931375 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.932932 [debug] [MainThread]: On master: BEGIN
[0m18:41:25.934036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:25.946833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.949077 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.950892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:25.978247 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:25.980754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e8ff1c0>]}
[0m18:41:25.981843 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:25.983349 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.984478 [debug] [MainThread]: On master: BEGIN
[0m18:41:25.987146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.989455 [debug] [MainThread]: On master: COMMIT
[0m18:41:25.991208 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.992804 [debug] [MainThread]: On master: COMMIT
[0m18:41:25.994712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:25.996526 [debug] [MainThread]: On master: Close
[0m18:41:25.998437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:26.000271 [info ] [MainThread]: 
[0m18:41:26.021344 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:41:26.022259 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:41:26.023274 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:41:26.025367 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:41:26.028467 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m18:41:26.032511 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m18:41:26.036501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m18:41:26.051449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m18:41:26.056929 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:41:26.063732 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:41:26.067260 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:41:26.069918 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:41:26.088035 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:41:26.095784 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:41:26.100805 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:41:26.112346 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 18:41:26.072325 => 18:41:26.111211
[0m18:41:26.114656 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 18:41:26.089852 => 18:41:26.113910
[0m18:41:26.116059 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 18:41:26.097327 => 18:41:26.115494
[0m18:41:26.120688 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:41:26.123155 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:41:26.126088 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:41:26.267916 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:41:26.269809 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:41:26.273870 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:41:26.294353 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.295406 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.297113 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:41:26.299078 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:41:26.301056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:26.303467 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:41:26.306385 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.310097 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:41:26.316091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:26.318493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.322874 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.324066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.329337 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:41:26.331350 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.334365 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.337040 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:41:26.338780 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.339823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:26.342484 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:41:26.350287 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:26.354318 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.362661 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:26.366571 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.368418 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:41:26.373910 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.375373 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:41:26.377776 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:41:26.378560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.381355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.388801 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.403225 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:41:26.405917 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:41:26.408832 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:41:26.410050 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.411126 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.412499 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.414205 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:41:26.416611 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:41:26.419203 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:41:26.424673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.425645 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.426359 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.442481 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:41:26.447445 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m18:41:26.455070 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m18:41:26.465945 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.468813 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.471876 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.473720 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:41:26.475693 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m18:41:26.477226 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m18:41:26.479859 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:26.481810 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:26.486931 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 18:41:26.129490 => 18:41:26.486441
[0m18:41:26.487682 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:26.491007 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 18:41:26.159336 => 18:41:26.490663
[0m18:41:26.492772 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:41:26.496770 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 18:41:26.206569 => 18:41:26.496309
[0m18:41:26.498646 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:41:26.501199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e954f10>]}
[0m18:41:26.502938 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:41:26.505744 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e92cc10>]}
[0m18:41:26.508423 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.47s]
[0m18:41:26.512363 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e9eb3a0>]}
[0m18:41:26.515151 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.46s]
[0m18:41:26.517756 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:41:26.520868 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.46s]
[0m18:41:26.524590 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:41:26.528462 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m18:41:26.530435 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:41:26.535876 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m18:41:26.537459 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m18:41:26.546238 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m18:41:26.554867 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m18:41:26.561347 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m18:41:26.570240 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m18:41:26.577638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m18:41:26.581450 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m18:41:26.586671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m18:41:26.589144 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m18:41:26.598755 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m18:41:26.600513 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m18:41:26.607352 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.621756 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.641733 [debug] [Thread-2 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 18:41:26.611295 => 18:41:26.640884
[0m18:41:26.642735 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 18:41:26.603052 => 18:41:26.642203
[0m18:41:26.643546 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (compile): 18:41:26.591112 => 18:41:26.643149
[0m18:41:26.645749 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m18:41:26.648477 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m18:41:26.652759 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m18:41:26.704895 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.705922 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.711529 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m18:41:26.733482 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.734826 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.735810 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.737799 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m18:41:26.740043 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m18:41:26.742285 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m18:41:26.744959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:26.749453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:26.751317 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:41:26.770546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.771852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.773860 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.778996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.781189 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.784576 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m18:41:26.787229 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.789800 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m18:41:26.793341 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m18:41:26.803752 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:26.812375 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:26.814394 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.815125 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:26.835815 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.896648 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m18:41:26.905904 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.908256 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m18:41:26.912315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.922319 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m18:41:26.932903 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.943828 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:41:26.946525 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.951797 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:41:26.954593 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.959244 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:41:26.961237 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.962798 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:41:26.964432 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.965939 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:41:26.968698 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:41:26.970298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.973650 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:27.070243 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m18:41:27.070958 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:27.075208 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m18:41:27.079563 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:27.084263 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m18:41:27.087035 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:27.088458 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m18:41:27.090423 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:27.091716 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m18:41:27.093698 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:27.094191 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m18:41:27.096371 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:27.098586 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 18:41:26.679746 => 18:41:27.098322
[0m18:41:27.100652 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:27.103538 [debug] [Thread-2 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 18:41:26.655397 => 18:41:27.103299
[0m18:41:27.105226 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m18:41:27.107757 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (execute): 18:41:26.706285 => 18:41:27.107529
[0m18:41:27.109170 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m18:41:27.111400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e830f40>]}
[0m18:41:27.112606 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m18:41:27.114784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e87b310>]}
[0m18:41:27.116696 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.54s]
[0m18:41:27.121182 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e831180>]}
[0m18:41:27.122798 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.53s]
[0m18:41:27.125203 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m18:41:27.127703 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.56s]
[0m18:41:27.130879 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m18:41:27.134550 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m18:41:27.142972 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:27.146501 [debug] [MainThread]: On master: BEGIN
[0m18:41:27.147835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:27.163828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:27.166269 [debug] [MainThread]: On master: COMMIT
[0m18:41:27.168356 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:27.172869 [debug] [MainThread]: On master: COMMIT
[0m18:41:27.175110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:27.176514 [debug] [MainThread]: On master: Close
[0m18:41:27.179124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:27.180869 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m18:41:27.182136 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m18:41:27.183172 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m18:41:27.184060 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m18:41:27.185349 [info ] [MainThread]: 
[0m18:41:27.187719 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m18:41:27.192984 [debug] [MainThread]: Command end result
[0m18:41:27.258335 [info ] [MainThread]: 
[0m18:41:27.260447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:27.263765 [info ] [MainThread]: 
[0m18:41:27.266493 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:41:27.272038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7244477, "process_user_time": 6.017698, "process_kernel_time": 0.746721, "process_mem_max_rss": "112664", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m18:41:27.274302 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:27.274045 after 4.73 seconds
[0m18:41:27.275914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce73403730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e860550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e860970>]}
[0m18:41:27.277723 [debug] [MainThread]: Flushing usage events
[0m18:43:28.224946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ec07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7cde8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7cdeb130>]}


============================== 18:43:28.238699 | ce44aad2-e82c-4efc-bfc0-b5bb15dab15a ==============================
[0m18:43:28.238699 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:43:28.241323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:43:28.619213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7f3d5f00>]}
[0m18:43:28.757928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ce8de70>]}
[0m18:43:28.760687 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:43:28.777994 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:43:29.084883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:29.088076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:29.106085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b1ec0d0>]}
[0m18:43:29.147233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b2f2b00>]}
[0m18:43:29.151429 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:43:29.154435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b2f2c50>]}
[0m18:43:29.160637 [info ] [MainThread]: 
[0m18:43:29.164024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:29.170458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m18:43:29.173517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m18:43:29.197883 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:43:29.201738 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:43:29.203480 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:43:29.205342 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:43:29.208911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:29.213279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:29.235063 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.237266 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.238473 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:43:29.240200 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:43:29.241633 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:43:29.243831 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:43:29.252226 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:43:29.253098 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:43:29.255808 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:43:29.258645 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:43:29.260685 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:43:29.262278 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:43:29.276091 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.278149 [debug] [MainThread]: On master: BEGIN
[0m18:43:29.279606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:29.297610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.299846 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.301479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:29.339670 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:43:29.345316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b2f2680>]}
[0m18:43:29.347390 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:29.349830 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.352084 [debug] [MainThread]: On master: BEGIN
[0m18:43:29.355593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.357977 [debug] [MainThread]: On master: COMMIT
[0m18:43:29.359938 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.361527 [debug] [MainThread]: On master: COMMIT
[0m18:43:29.363633 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:29.365208 [debug] [MainThread]: On master: Close
[0m18:43:29.367725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:29.371233 [info ] [MainThread]: 
[0m18:43:29.393843 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.394947 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.395926 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.396870 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.398145 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m18:43:29.401420 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m18:43:29.408348 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m18:43:29.414915 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m18:43:29.419102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m18:43:29.424761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m18:43:29.430255 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m18:43:29.435639 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m18:43:29.438399 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.440414 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.442591 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.444083 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.493621 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.500428 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.517545 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.525551 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.550998 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (compile): 18:43:29.501202 => 18:43:29.549860
[0m18:43:29.552327 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (compile): 18:43:29.518816 => 18:43:29.551796
[0m18:43:29.554086 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.557178 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.571186 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (compile): 18:43:29.445598 => 18:43:29.570446
[0m18:43:29.572205 [debug] [Thread-2 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (compile): 18:43:29.469892 => 18:43:29.571716
[0m18:43:29.602904 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.607583 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.609038 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.610959 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.618647 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.625005 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.647220 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.649212 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.651678 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m18:43:29.654042 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m18:43:29.655468 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.657354 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.658484 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:43:29.660804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:43:29.662910 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m18:43:29.665528 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m18:43:29.672186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:29.680034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:29.685942 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.688232 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.690148 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.692932 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.695735 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m18:43:29.698235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.699979 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m18:43:29.704570 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.706224 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.708534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.711901 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m18:43:29.713000 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.717253 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (execute): 18:43:29.558977 => 18:43:29.716796
[0m18:43:29.719265 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.725248 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (execute): 18:43:29.585346 => 18:43:29.724280
[0m18:43:29.726379 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.728499 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m18:43:29.730765 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m18:43:29.732522 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m18:43:29.735763 [debug] [Thread-2 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (execute): 18:43:29.620290 => 18:43:29.735402
[0m18:43:29.737784 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m18:43:29.740588 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m18:43:29.742527 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m18:43:29.743982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.747393 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.32s]
[0m18:43:29.750945 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.32s]
[0m18:43:29.754889 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m18:43:29.761210 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (execute): 18:43:29.614560 => 18:43:29.760418
[0m18:43:29.764623 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.768041 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.772549 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.35s]
[0m18:43:29.780260 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m18:43:29.786005 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:29.789472 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:29.792854 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.796703 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m18:43:29.798670 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m18:43:29.801991 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m18:43:29.807954 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:29.816197 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.40s]
[0m18:43:29.821049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m18:43:29.827437 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:43:29.832284 [info ] [Thread-2 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m18:43:29.838241 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.841436 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:29.846128 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:29.850144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m18:43:29.854835 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:29.873234 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:29.896909 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:29.899263 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:29.902026 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m18:43:30.103368 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.106740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m18:43:30.110860 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:30.127206 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.130125 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 18:43:29.875662 => 18:43:30.129185
[0m18:43:30.132090 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (compile): 18:43:29.858094 => 18:43:30.131157
[0m18:43:30.133797 [debug] [Thread-2 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (compile): 18:43:29.912477 => 18:43:30.133235
[0m18:43:30.135976 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:30.138169 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:30.140854 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:30.151667 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:30.159965 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:30.165985 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.170165 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (compile): 18:43:30.112959 => 18:43:30.169175
[0m18:43:30.173073 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:30.191232 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.196140 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:30.197925 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.201364 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m18:43:30.211243 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:30.212402 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m18:43:30.217025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:30.219847 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m18:43:30.223255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:30.230159 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:30.231642 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.239033 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:43:30.241940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:30.245841 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.251200 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:30.254667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.256420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.258623 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m18:43:30.261414 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:30.263275 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.267245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.268490 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.270023 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:43:30.272857 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m18:43:30.275585 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.280651 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (execute): 18:43:30.153638 => 18:43:30.280305
[0m18:43:30.285169 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m18:43:30.286086 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.286750 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.288299 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m18:43:30.294227 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 18:43:30.142834 => 18:43:30.293705
[0m18:43:30.295247 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.297990 [debug] [Thread-2 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (execute): 18:43:30.161889 => 18:43:30.297667
[0m18:43:30.300090 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m18:43:30.301174 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m18:43:30.304264 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (execute): 18:43:30.175205 => 18:43:30.303790
[0m18:43:30.305906 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m18:43:30.310275 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.49s]
[0m18:43:30.313457 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m18:43:30.315518 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:43:30.318403 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m18:43:30.320873 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:30.338506 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.329226 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:43:30.335676 [info ] [Thread-2 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.49s]
[0m18:43:30.324603 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.50s]
[0m18:43:30.345389 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m18:43:30.353046 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.25s]
[0m18:43:30.357688 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:30.364424 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:30.369223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m18:43:30.371860 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:30.374127 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.380979 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.384521 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.389607 [info ] [Thread-2 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m18:43:30.395957 [info ] [Thread-4 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:43:30.425807 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.427440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m18:43:30.431314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m18:43:30.435378 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.441373 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.460044 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.468728 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.476115 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (compile): 18:43:30.402364 => 18:43:30.475179
[0m18:43:30.478960 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.488913 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.491911 [debug] [Thread-4 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (compile): 18:43:30.461738 => 18:43:30.491042
[0m18:43:30.493662 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (compile): 18:43:30.443467 => 18:43:30.492788
[0m18:43:30.496004 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.498396 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.506398 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.511463 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.516150 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.518190 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m18:43:30.520303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:30.532281 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.534387 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.536310 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:43:30.538635 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m18:43:30.540783 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.542071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:30.545542 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:30.548131 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.553206 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:30.557684 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.567731 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (execute): 18:43:30.481543 => 18:43:30.566789
[0m18:43:30.569820 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.571131 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.572398 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m18:43:30.574360 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.575971 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.579355 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m18:43:30.580619 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:30.587205 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:30.594588 [info ] [Thread-3 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.22s]
[0m18:43:30.603139 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.605683 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.607223 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.612489 [debug] [Thread-4 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (execute): 18:43:30.500046 => 18:43:30.611707
[0m18:43:30.619313 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (execute): 18:43:30.507861 => 18:43:30.618418
[0m18:43:30.622626 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:43:30.628744 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m18:43:30.633602 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:43:30.636429 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m18:43:30.640399 [info ] [Thread-4 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.21s]
[0m18:43:30.652264 [info ] [Thread-2 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.22s]
[0m18:43:30.657576 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.663689 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.683880 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:30.688585 [debug] [MainThread]: On master: BEGIN
[0m18:43:30.692566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:30.719926 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.723191 [debug] [MainThread]: On master: COMMIT
[0m18:43:30.725574 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:30.727956 [debug] [MainThread]: On master: COMMIT
[0m18:43:30.731052 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:30.733630 [debug] [MainThread]: On master: Close
[0m18:43:30.739840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:30.742792 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m18:43:30.745812 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m18:43:30.748686 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m18:43:30.753620 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:43:30.756745 [info ] [MainThread]: 
[0m18:43:30.759436 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m18:43:30.768105 [debug] [MainThread]: Command end result
[0m18:43:30.828587 [info ] [MainThread]: 
[0m18:43:30.832791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:30.842728 [info ] [MainThread]: 
[0m18:43:30.847002 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:43:30.852750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7141833, "process_user_time": 4.53214, "process_kernel_time": 0.621912, "process_mem_max_rss": "106684", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m18:43:30.862118 [debug] [MainThread]: Command `dbt test` succeeded at 18:43:30.860915 after 2.72 seconds
[0m18:43:30.865289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ec07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b0f2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ce8de70>]}
[0m18:43:30.869222 [debug] [MainThread]: Flushing usage events
[0m19:00:16.588724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741547d77730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741545fc76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741545fc7640>]}


============================== 19:00:16.622237 | 25ce20cc-8458-4e5e-b336-3459a6e5e091 ==============================
[0m19:00:16.622237 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:00:16.625391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:17.057277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154600dd50>]}
[0m19:00:17.281638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154607ec80>]}
[0m19:00:17.284922 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:00:17.313596 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:00:17.648072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:17.649784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:17.663583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415443540d0>]}
[0m19:00:17.712944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154451aaa0>]}
[0m19:00:17.716713 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:00:17.722117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154451abf0>]}
[0m19:00:17.730003 [info ] [MainThread]: 
[0m19:00:17.734148 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:17.747342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:17.750438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:17.799698 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:17.802592 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:17.804138 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:17.806373 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:17.809176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:17.811900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:17.840393 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:00:17.841446 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:00:17.844391 [debug] [ThreadPool]: On list_db: Close
[0m19:00:17.847236 [debug] [ThreadPool]: On list_db: Close
[0m19:00:17.852609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m19:00:17.855185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m19:00:17.860067 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m19:00:17.864671 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m19:00:17.876704 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:00:17.881101 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:00:17.882657 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m19:00:17.884209 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m19:00:17.885639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:17.887718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:17.906771 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:17.911117 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:17.912383 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:00:17.914726 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:00:17.917112 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m19:00:17.923202 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m19:00:17.926854 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:00:17.927747 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:00:17.931593 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:00:17.934780 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:00:17.938661 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:00:17.941310 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:00:17.943955 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:00:17.948053 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:00:17.953353 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:00:17.956135 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m19:00:17.973333 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:00:17.975475 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m19:00:17.982250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_staging)
[0m19:00:17.984706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_analytics)
[0m19:00:17.999702 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:18.003750 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:18.006171 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:00:18.008818 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:00:18.011050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:18.015397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:18.037657 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.040658 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:18.043289 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.046744 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:00:18.049770 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:18.058386 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:00:18.062197 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:18.070137 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:00:18.072523 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:18.073937 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:00:18.078004 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:00:18.087226 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:00:18.102121 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.104401 [debug] [MainThread]: On master: BEGIN
[0m19:00:18.106066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:18.128633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.131199 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.133842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:18.200204 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:18.203584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415443ba0e0>]}
[0m19:00:18.205265 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:18.206864 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.208755 [debug] [MainThread]: On master: BEGIN
[0m19:00:18.213114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.216382 [debug] [MainThread]: On master: COMMIT
[0m19:00:18.218420 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.220402 [debug] [MainThread]: On master: COMMIT
[0m19:00:18.222294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.223673 [debug] [MainThread]: On master: Close
[0m19:00:18.226144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:18.230132 [info ] [MainThread]: 
[0m19:00:18.256411 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:00:18.258481 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:00:18.260076 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:00:18.262750 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:00:18.268713 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:00:18.272918 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:00:18.277727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m19:00:18.282987 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m19:00:18.290159 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:00:18.292779 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:00:18.297222 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:00:18.299362 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:00:18.317043 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:00:18.321186 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:00:18.326400 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:00:18.342900 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 19:00:18.322903 => 19:00:18.341817
[0m19:00:18.344614 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 19:00:18.303474 => 19:00:18.343952
[0m19:00:18.348113 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:00:18.350501 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 19:00:18.317966 => 19:00:18.349830
[0m19:00:18.352262 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:00:18.384315 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:00:18.452060 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:00:18.455927 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:00:18.468302 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:00:18.478734 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.481398 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.482620 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:00:18.484531 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.486131 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:00:18.488976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:18.491294 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:00:18.494494 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:18.498053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:18.516752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.523266 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.526712 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.529023 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.531436 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:00:18.534556 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.536832 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.547540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:00:18.549743 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:00:18.551598 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:00:18.680913 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.687861 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:00:18.690421 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:00:18.692010 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:00:18.693235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:18.703433 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.713349 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.745286 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:00:18.746850 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:18.748958 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:00:18.751422 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:18.752431 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.758957 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:18.760406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:18.762660 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:18.764177 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.766941 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:18.770708 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:18.772454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.775256 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.823151 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.828190 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:00:18.829265 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:18.839890 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:00:18.851447 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.856688 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.858107 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.860423 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:00:18.863924 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:00:18.877066 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:00:18.881650 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:00:18.884787 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:00:18.888387 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.893673 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 19:00:18.414481 => 19:00:18.893401
[0m19:00:18.897369 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 19:00:18.353567 => 19:00:18.896727
[0m19:00:18.900664 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:00:18.902617 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:00:18.904563 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:00:18.909689 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:00:18.912029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544789270>]}
[0m19:00:18.918409 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415444485e0>]}
[0m19:00:18.924763 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 19:00:18.456694 => 19:00:18.924055
[0m19:00:18.929425 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.64s]
[0m19:00:18.933362 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.63s]
[0m19:00:18.938407 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:00:18.942166 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:00:18.948065 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:00:18.952455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544403ac0>]}
[0m19:00:18.961295 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m19:00:18.965531 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:00:18.971667 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.67s]
[0m19:00:18.990966 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:00:18.995375 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:00:19.003417 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:00:19.008493 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m19:00:19.014990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_marketing_attribution)
[0m19:00:19.021658 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:00:19.023317 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:00:19.026176 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:00:19.030565 [info ] [Thread-3 (]: 6 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:00:19.050003 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:00:19.058782 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.061298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m19:00:19.068115 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:00:19.077709 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.082398 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 19:00:19.052440 => 19:00:19.081184
[0m19:00:19.084537 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (compile): 19:00:19.036623 => 19:00:19.083333
[0m19:00:19.087130 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:00:19.091179 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m19:00:19.099572 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 19:00:19.069901 => 19:00:19.098899
[0m19:00:19.138813 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:00:19.140549 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.143098 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:00:19.157059 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.164392 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.166169 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.169101 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:00:19.170681 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.172661 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:00:19.174956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:19.179955 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:00:19.190901 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:19.202559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:19.216483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.225480 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.233901 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.235371 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:00:19.238858 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.250367 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:00:19.255021 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.269871 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.271936 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:19.281288 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:00:19.307443 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.309550 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:19.325389 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:00:19.355115 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.367837 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:19.391042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:19.444367 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:00:19.510101 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.554120 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:19.561959 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:00:19.568291 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:19.601395 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:19.613385 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:19.636475 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.641298 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.651357 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:19.663474 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:19.666712 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:19.670152 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.675038 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:19.678568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.682426 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.692840 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.703300 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:00:19.712356 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:00:19.721144 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:00:19.736706 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.740923 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.757359 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.760619 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:00:19.763002 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:00:19.765027 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:00:19.768295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:00:19.773749 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:00:19.775971 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:00:19.779976 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 19:00:19.093257 => 19:00:19.779497
[0m19:00:19.784347 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (execute): 19:00:19.123821 => 19:00:19.783825
[0m19:00:19.790372 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 19:00:19.149618 => 19:00:19.789871
[0m19:00:19.792465 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:00:19.794480 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m19:00:19.797580 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:00:19.800294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154465fe20>]}
[0m19:00:19.804211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544357b80>]}
[0m19:00:19.809484 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544519720>]}
[0m19:00:19.811348 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.79s]
[0m19:00:19.814405 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.80s]
[0m19:00:19.818835 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.75s]
[0m19:00:19.822455 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:00:19.826912 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m19:00:19.829587 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:00:19.844554 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.846425 [debug] [MainThread]: On master: BEGIN
[0m19:00:19.849079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:19.872290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.874493 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.878237 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.880677 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.882814 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.884406 [debug] [MainThread]: On master: Close
[0m19:00:19.887249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:19.890905 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m19:00:19.893254 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:00:19.895014 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:00:19.898424 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:00:19.900004 [info ] [MainThread]: 
[0m19:00:19.902255 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m19:00:19.908397 [debug] [MainThread]: Command end result
[0m19:00:19.961100 [info ] [MainThread]: 
[0m19:00:19.964402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:19.968068 [info ] [MainThread]: 
[0m19:00:19.973567 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:00:19.979195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4815907, "process_user_time": 6.438614, "process_kernel_time": 1.147517, "process_mem_max_rss": "107640", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m19:00:19.981341 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:19.981067 after 3.48 seconds
[0m19:00:19.983167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741547d77730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544357b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544789270>]}
[0m19:00:19.985013 [debug] [MainThread]: Flushing usage events
[0m19:02:19.702835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fed5f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fcfb36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fcfb3640>]}


============================== 19:02:19.716073 | 87a57c52-b576-4f85-8c2a-b2c9923754a7 ==============================
[0m19:02:19.716073 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:02:19.719201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:02:20.262540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fcff5d50>]}
[0m19:02:20.500194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fd066c80>]}
[0m19:02:20.504518 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:02:20.554242 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:02:20.824612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:20.826338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:20.845785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb33c0d0>]}
[0m19:02:20.923744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb502aa0>]}
[0m19:02:20.928281 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:02:20.932707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb502bf0>]}
[0m19:02:20.942648 [info ] [MainThread]: 
[0m19:02:20.947958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:02:20.960964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:02:20.964056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:02:21.045478 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:02:21.054556 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:02:21.056010 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:02:21.058097 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:02:21.060483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:21.062971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:21.088078 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:02:21.089461 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:02:21.093786 [debug] [ThreadPool]: On list_db: Close
[0m19:02:21.097422 [debug] [ThreadPool]: On list_db: Close
[0m19:02:21.110180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:02:21.112752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:02:21.128639 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:02:21.134847 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:02:21.136824 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:02:21.139080 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:02:21.142186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:21.145441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:21.162789 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.165196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.167185 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:02:21.169943 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:02:21.172099 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:02:21.173829 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:02:21.184702 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:02:21.187412 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:02:21.191778 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:02:21.196120 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:02:21.198488 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:02:21.199992 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:02:21.219472 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.221933 [debug] [MainThread]: On master: BEGIN
[0m19:02:21.224127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:21.242752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.247693 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.251771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:02:21.310345 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m19:02:21.313453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb501480>]}
[0m19:02:21.315583 [debug] [MainThread]: On master: ROLLBACK
[0m19:02:21.317886 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.322206 [debug] [MainThread]: On master: BEGIN
[0m19:02:21.329041 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.332022 [debug] [MainThread]: On master: COMMIT
[0m19:02:21.334174 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.337526 [debug] [MainThread]: On master: COMMIT
[0m19:02:21.340417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:02:21.342997 [debug] [MainThread]: On master: Close
[0m19:02:21.347438 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:21.356319 [info ] [MainThread]: 
[0m19:02:21.392260 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:02:21.395755 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:02:21.398641 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:02:21.404301 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:02:21.414232 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:02:21.437676 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:02:21.444991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m19:02:21.449922 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:02:21.454889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m19:02:21.462170 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:02:21.466249 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:02:21.639111 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:02:21.674584 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:02:21.698793 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:02:21.712569 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:02:21.725834 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 19:02:21.646859 => 19:02:21.724851
[0m19:02:21.729466 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 19:02:21.706076 => 19:02:21.728371
[0m19:02:21.730983 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:02:21.732284 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 19:02:21.687994 => 19:02:21.731697
[0m19:02:21.734919 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:02:21.767529 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:02:21.863137 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:02:21.848086 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:02:21.864518 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:02:21.889427 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:21.890990 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:21.894674 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:02:21.908146 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:21.910121 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:02:21.912782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:21.914563 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:02:21.916209 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:02:21.922285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:21.936966 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.940396 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:21.945842 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.948165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.949713 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:02:21.955070 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:21.957793 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:21.962818 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:02:21.966701 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:02:21.969044 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:02:21.977427 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:02:21.978440 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:02:21.997640 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.010225 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.155311 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.157631 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:02:22.160573 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:02:22.163400 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:02:22.167410 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.169006 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.172048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.181927 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.192416 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.206738 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.209406 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:02:22.211419 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:02:22.216748 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:02:22.220589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.227716 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.239926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.339211 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:02:22.353752 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:02:22.366058 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:02:22.454551 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.456974 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.459680 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.463803 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:02:22.466423 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:02:22.468647 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:02:22.474918 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:22.475821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:22.476985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:22.491959 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:02:22.498451 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:02:22.506961 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:02:22.519193 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.521845 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.524364 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.527431 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:02:22.529064 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:02:22.530499 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:02:22.537662 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:02:22.539180 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:02:22.540353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:02:22.543624 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 19:02:21.837411 => 19:02:22.542970
[0m19:02:22.547774 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 19:02:21.737750 => 19:02:22.547495
[0m19:02:22.550852 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 19:02:21.797005 => 19:02:22.550550
[0m19:02:22.553703 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:02:22.556525 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:02:22.558095 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:02:22.559987 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fa223eb0>]}
[0m19:02:22.564319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb39da20>]}
[0m19:02:22.569075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb35a0e0>]}
[0m19:02:22.571927 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 1.11s]
[0m19:02:22.575662 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 1.12s]
[0m19:02:22.584717 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 1.12s]
[0m19:02:22.587724 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:02:22.592169 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:02:22.595517 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:02:22.600494 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:02:22.604172 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:02:22.607591 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:02:22.614269 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:02:22.624742 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:02:22.634201 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:02:22.645281 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m19:02:22.651620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m19:02:22.656634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m19:02:22.660767 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:02:22.670068 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:02:22.675618 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:02:22.700897 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.714625 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.723252 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:02:22.741594 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 19:02:22.678041 => 19:02:22.740533
[0m19:02:22.747552 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (compile): 19:02:22.716219 => 19:02:22.745512
[0m19:02:22.749001 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 19:02:22.704202 => 19:02:22.748249
[0m19:02:22.750447 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:02:22.753609 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:02:22.756188 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:02:22.821382 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:02:22.824152 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.840264 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.850949 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.852267 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.854702 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:02:22.856050 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.857965 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:02:22.860423 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:22.863328 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:02:22.867022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:02:22.872644 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:02:22.887090 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:22.895435 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.899288 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:02:22.900663 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:22.903010 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:22.911148 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.914968 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:02:22.916820 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.919526 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:02:22.927214 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.930821 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:02:22.938273 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:02:22.944886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.956798 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:02:22.957898 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:02:22.959326 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.969456 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.986333 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.988777 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:02:22.991367 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:02:22.994229 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:02:22.998602 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.003197 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.007516 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.023329 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:02:23.033668 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:23.045538 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:23.048002 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:23.051243 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:02:23.054319 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:02:23.058388 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:02:23.063428 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.067419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.076279 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:02:23.077509 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.084554 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:02:23.087282 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:23.096149 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:02:23.098391 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:23.100765 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:02:23.107213 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:23.109623 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:02:23.113970 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:02:23.115470 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.119776 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.131746 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:02:23.136299 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:02:23.142268 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:02:23.145813 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (execute): 19:02:22.784299 => 19:02:23.145460
[0m19:02:23.148461 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:23.151187 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:23.153398 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:02:23.155956 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:02:23.158947 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:02:23.162163 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f811ff10>]}
[0m19:02:23.174512 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:02:23.173508 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.51s]
[0m19:02:23.177996 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:02:23.183537 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 19:02:22.760236 => 19:02:23.183174
[0m19:02:23.186796 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:02:23.192362 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 19:02:22.824713 => 19:02:23.192086
[0m19:02:23.195242 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:02:23.198700 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:02:23.204298 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fa2afaf0>]}
[0m19:02:23.210051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f81374c0>]}
[0m19:02:23.214152 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.56s]
[0m19:02:23.218039 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.56s]
[0m19:02:23.221528 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:02:23.224832 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:02:23.231445 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:23.235391 [debug] [MainThread]: On master: BEGIN
[0m19:02:23.237325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:23.262838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:02:23.267097 [debug] [MainThread]: On master: COMMIT
[0m19:02:23.270749 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:23.277755 [debug] [MainThread]: On master: COMMIT
[0m19:02:23.280881 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.282806 [debug] [MainThread]: On master: Close
[0m19:02:23.285658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:23.287895 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m19:02:23.293918 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:02:23.296535 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:02:23.299482 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:02:23.301831 [info ] [MainThread]: 
[0m19:02:23.305022 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m19:02:23.313757 [debug] [MainThread]: Command end result
[0m19:02:23.372272 [info ] [MainThread]: 
[0m19:02:23.378336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:23.383744 [info ] [MainThread]: 
[0m19:02:23.390461 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:02:23.405628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7980118, "process_user_time": 6.272021, "process_kernel_time": 0.688575, "process_mem_max_rss": "109128", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m19:02:23.415658 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:23.415166 after 3.81 seconds
[0m19:02:23.418724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fed5f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f81374c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f813e860>]}
[0m19:02:23.430707 [debug] [MainThread]: Flushing usage events
[0m19:07:58.013717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f9b78e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f7d4c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f7d4f130>]}


============================== 19:07:58.105012 | c896d151-7ffd-4f52-939b-5f8565c45b30 ==============================
[0m19:07:58.105012 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:07:58.107562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /usr/app --profiles-dir /usr/app/profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:07:58.111615 [info ] [MainThread]: dbt version: 1.7.4
[0m19:07:58.113444 [info ] [MainThread]: python version: 3.10.7
[0m19:07:58.116278 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:07:58.118444 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:07:58.352223 [info ] [MainThread]: Using profiles dir at /usr/app/profiles
[0m19:07:58.354868 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles/profiles.yml
[0m19:07:58.356686 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m19:07:58.359398 [info ] [MainThread]: adapter type: postgres
[0m19:07:58.361331 [info ] [MainThread]: adapter version: 1.7.4
[0m19:07:58.573490 [info ] [MainThread]: Configuration:
[0m19:07:58.576329 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:07:58.578907 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:07:58.581195 [info ] [MainThread]: Required dependencies:
[0m19:07:58.583420 [debug] [MainThread]: Executing "git --help"
[0m19:07:58.608000 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:07:58.611875 [debug] [MainThread]: STDERR: "b''"
[0m19:07:58.615075 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:07:58.619883 [info ] [MainThread]: Connection:
[0m19:07:58.622730 [info ] [MainThread]:   host: postgres
[0m19:07:58.626656 [info ] [MainThread]:   port: 5432
[0m19:07:58.630088 [info ] [MainThread]:   user: db_user
[0m19:07:58.632235 [info ] [MainThread]:   database: db
[0m19:07:58.634664 [info ] [MainThread]:   schema: public
[0m19:07:58.637566 [info ] [MainThread]:   connect_timeout: 10
[0m19:07:58.639831 [info ] [MainThread]:   role: None
[0m19:07:58.645176 [info ] [MainThread]:   search_path: None
[0m19:07:58.649730 [info ] [MainThread]:   keepalives_idle: 0
[0m19:07:58.655516 [info ] [MainThread]:   sslmode: None
[0m19:07:58.661416 [info ] [MainThread]:   sslcert: None
[0m19:07:58.673491 [info ] [MainThread]:   sslkey: None
[0m19:07:58.677939 [info ] [MainThread]:   sslrootcert: None
[0m19:07:58.684614 [info ] [MainThread]:   application_name: dbt
[0m19:07:58.686820 [info ] [MainThread]:   retries: 1
[0m19:07:58.690720 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:07:58.697212 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:07:58.700275 [debug] [MainThread]: Using postgres connection "debug"
[0m19:07:58.702872 [debug] [MainThread]: On debug: select 1 as id
[0m19:07:58.708693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:58.746097 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:07:58.749263 [debug] [MainThread]: On debug: Close
[0m19:07:58.755155 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:07:58.759187 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:07:58.765234 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.88369566, "process_user_time": 3.593291, "process_kernel_time": 0.717187, "process_mem_max_rss": "96188", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m19:07:58.769178 [debug] [MainThread]: Command `dbt debug` succeeded at 19:07:58.768773 after 0.89 seconds
[0m19:07:58.771464 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:07:58.775442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f9b78e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61fa38ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f6579420>]}
[0m19:07:58.778077 [debug] [MainThread]: Flushing usage events
[0m19:08:05.386724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066f10faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066d3835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066d383550>]}


============================== 19:08:05.394420 | 035a1bd5-1b4b-4772-bb14-c8a62d9ad104 ==============================
[0m19:08:05.394420 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:08:05.396621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /usr/app --profiles-dir /usr/app/profiles --fail-fast', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:08:05.701774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740671400100>]}
[0m19:08:05.823560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066ba580a0>]}
[0m19:08:05.826112 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:08:05.842491 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:08:06.121486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:08:06.123664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:08:06.135446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b72c0d0>]}
[0m19:08:06.211248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b8e2aa0>]}
[0m19:08:06.213656 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:08:06.219944 [info ] [MainThread]: 
[0m19:08:06.224177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:08:06.228523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:08:06.230776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:08:06.260983 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:08:06.257519 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:08:06.265431 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:08:06.267239 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:08:06.268870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:06.270248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:06.287359 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:08:06.290704 [debug] [ThreadPool]: On list_db: Close
[0m19:08:06.291315 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:08:06.295520 [debug] [ThreadPool]: On list_db: Close
[0m19:08:06.299349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:08:06.300580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:08:06.309271 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:08:06.314349 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:08:06.315995 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:08:06.317397 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:08:06.318731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:06.320049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:06.335953 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.337824 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:08:06.339827 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.340894 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:08:06.342779 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:08:06.346887 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:08:06.352892 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:08:06.354016 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:08:06.356406 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:08:06.358737 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:08:06.360151 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:08:06.361572 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:08:06.376247 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.377724 [debug] [MainThread]: On master: BEGIN
[0m19:08:06.379327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:06.391738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.393536 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.395763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:08:06.432439 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m19:08:06.435540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b8e12d0>]}
[0m19:08:06.437041 [debug] [MainThread]: On master: ROLLBACK
[0m19:08:06.438905 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.440266 [debug] [MainThread]: On master: BEGIN
[0m19:08:06.442079 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.444535 [debug] [MainThread]: On master: COMMIT
[0m19:08:06.446203 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.447549 [debug] [MainThread]: On master: COMMIT
[0m19:08:06.449313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.450732 [debug] [MainThread]: On master: Close
[0m19:08:06.452531 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:08:06.454356 [info ] [MainThread]: 
[0m19:08:06.470530 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:08:06.471799 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:08:06.473007 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:08:06.475539 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m19:08:06.478576 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m19:08:06.481508 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m19:08:06.486045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:08:06.490038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:08:06.494596 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:08:06.496654 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:08:06.498840 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:08:06.500355 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:08:06.513726 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:08:06.517814 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:08:06.524647 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:08:06.533562 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 19:08:06.501629 => 19:08:06.532904
[0m19:08:06.535001 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 19:08:06.515128 => 19:08:06.534310
[0m19:08:06.536958 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:08:06.538633 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 19:08:06.519614 => 19:08:06.537745
[0m19:08:06.540298 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:08:06.564784 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:08:06.598460 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:08:06.598913 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:08:06.607582 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:08:06.616869 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.618505 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.620412 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:08:06.621220 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.623001 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:08:06.624300 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:08:06.625604 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:08:06.627010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:06.629816 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:06.643881 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.646562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.647738 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.649145 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.650998 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.653391 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.656084 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:08:06.658359 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:08:06.661594 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:08:06.673138 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:06.676957 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:06.691009 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:06.697370 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.702591 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.710844 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.712372 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:08:06.714145 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:08:06.716124 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:08:06.719680 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.721486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.786488 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.789005 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.793539 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.798634 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.800030 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:08:06.801118 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:08:06.802709 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:08:06.806298 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.808761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.822085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.843427 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:08:06.846200 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:08:06.851692 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:08:06.854276 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.856203 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.858008 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.860117 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:08:06.862080 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:08:06.864868 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:08:06.873606 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.876032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.877241 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.893487 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:08:06.899417 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:08:06.903845 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:08:06.912062 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.914550 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.917414 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.918835 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:08:06.919946 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:08:06.921169 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:08:06.926912 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:06.928007 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:06.928555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:06.931833 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 19:08:06.600265 => 19:08:06.931467
[0m19:08:06.936816 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 19:08:06.593384 => 19:08:06.936165
[0m19:08:06.941930 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 19:08:06.541540 => 19:08:06.941393
[0m19:08:06.944522 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:08:06.946304 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:08:06.947901 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:08:06.951135 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b660580>]}
[0m19:08:06.954630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b7812a0>]}
[0m19:08:06.957435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b717e50>]}
[0m19:08:06.960816 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.46s]
[0m19:08:06.964194 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.47s]
[0m19:08:06.967002 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.47s]
[0m19:08:06.970360 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:08:06.973474 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:08:06.975990 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:08:06.979208 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:06.980329 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:06.982577 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.074662 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.077342 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:08:07.081551 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:08:07.087567 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m19:08:07.090424 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:08:07.094084 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m19:08:07.096839 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:08:07.123130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:08:07.126233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:08:07.128702 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:07.131087 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:07.133488 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.136883 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.166991 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.184494 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.194613 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.202566 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.212040 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (compile): 19:08:07.185597 => 19:08:07.211250
[0m19:08:07.214480 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (compile): 19:08:07.167546 => 19:08:07.213564
[0m19:08:07.215916 [debug] [Thread-4 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (compile): 19:08:07.138544 => 19:08:07.215243
[0m19:08:07.217599 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.219306 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (compile): 19:08:07.195843 => 19:08:07.218723
[0m19:08:07.221402 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:07.223684 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:07.248755 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.248261 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.255108 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.259483 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.264796 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.273548 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.275210 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.276113 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:08:07.277415 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.278513 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.279687 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:08:07.281245 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:07.282604 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:08:07.283978 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:08:07.285309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:07.288044 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:08:07.290300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.301537 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.303587 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.305499 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:08:07.307610 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.309687 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.311124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.313473 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.315383 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.316783 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.318543 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.320329 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:07.325473 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (execute): 19:08:07.250866 => 19:08:07.325039
[0m19:08:07.327126 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:08:07.328718 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:08:07.331025 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:08:07.333633 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.335428 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.336572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.338738 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:08:07.340844 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (execute): 19:08:07.225472 => 19:08:07.340553
[0m19:08:07.343478 [debug] [Thread-4 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (execute): 19:08:07.256658 => 19:08:07.343111
[0m19:08:07.346454 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (execute): 19:08:07.260597 => 19:08:07.345947
[0m19:08:07.348574 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.25s]
[0m19:08:07.350262 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:08:07.354149 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:08:07.356561 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:08:07.358997 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:07.361018 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:08:07.362667 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:08:07.364297 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:08:07.365743 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.369081 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.25s]
[0m19:08:07.373460 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.28s]
[0m19:08:07.378622 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.25s]
[0m19:08:07.386308 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:08:07.388693 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.391235 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:07.393890 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.396025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:08:07.397797 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.400140 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.402854 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.404931 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.406484 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m19:08:07.408028 [info ] [Thread-4 (]: 10 of 17 START test not_null_stg_customers_country ............................. [RUN]
[0m19:08:07.411886 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m19:08:07.422865 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.424516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:08:07.426497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:08:07.429400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:08:07.432513 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.434039 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.436499 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.447392 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.456837 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (compile): 19:08:07.414156 => 19:08:07.456158
[0m19:08:07.461265 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.471817 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.475286 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.485415 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.489400 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 19:08:07.462676 => 19:08:07.488487
[0m19:08:07.490901 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (compile): 19:08:07.450547 => 19:08:07.490233
[0m19:08:07.492268 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (compile): 19:08:07.439324 => 19:08:07.491512
[0m19:08:07.493569 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.495465 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.497750 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.504023 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.505126 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.511533 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.519041 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.522460 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:08:07.526565 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:07.532848 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.536335 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:08:07.537613 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.539441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.540596 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.542330 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:08:07.544050 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.549665 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:08:07.552280 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:08:07.554849 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.557568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:07.562493 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:08:07.570927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.575575 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.576824 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.579125 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.588079 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (execute): 19:08:07.479585 => 19:08:07.583963
[0m19:08:07.589919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.591679 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:08:07.594112 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.596843 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:08:07.599227 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.602095 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:08:07.604227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.606487 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:08:07.608326 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:07.613659 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 19:08:07.499448 => 19:08:07.613117
[0m19:08:07.614904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.618538 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.22s]
[0m19:08:07.622634 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:08:07.627657 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (execute): 19:08:07.506434 => 19:08:07.627209
[0m19:08:07.628913 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.631518 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.634275 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:08:07.635331 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:08:07.637993 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (execute): 19:08:07.513546 => 19:08:07.637608
[0m19:08:07.641329 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.645314 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.22s]
[0m19:08:07.648672 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:08:07.651579 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:08:07.653855 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_customers_customer_id ........................... [RUN]
[0m19:08:07.656570 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.660513 [info ] [Thread-4 (]: 10 of 17 PASS not_null_stg_customers_country ................................... [[32mPASS[0m in 0.23s]
[0m19:08:07.663955 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:08:07.667480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:08:07.670242 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:08:07.672568 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.675670 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.25s]
[0m19:08:07.677752 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.680442 [info ] [Thread-1 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m19:08:07.691254 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.706069 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.707791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.fct_marketing_attribution)
[0m19:08:07.710641 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:08:07.715802 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:08:07.718276 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m19:08:07.727380 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.731363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now model.api_bi_project.fct_revenue_daily)
[0m19:08:07.733378 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (compile): 19:08:07.693601 => 19:08:07.732590
[0m19:08:07.736805 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:08:07.739116 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.747626 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.752584 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.753393 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 19:08:07.720131 => 19:08:07.753064
[0m19:08:07.756382 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:08:07.800257 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.802516 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 19:08:07.741322 => 19:08:07.801653
[0m19:08:07.803547 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.805924 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:08:07.808891 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:08:07.823923 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.825751 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:07.827404 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.831477 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:08:07.833168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.841662 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.844130 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:08:07.845785 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.846795 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:08:07.848856 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.852665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.853925 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:07.856252 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.860036 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:08:07.861412 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.866210 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (execute): 19:08:07.748905 => 19:08:07.865474
[0m19:08:07.868240 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.869485 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:08:07.872519 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.876313 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:08:07.877824 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:08:07.879664 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:08:07.881984 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.22s]
[0m19:08:07.894869 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.899246 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.901687 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:08:07.904648 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:08:07.907506 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:08:07.908632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.911264 [info ] [Thread-2 (]: 15 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m19:08:07.920674 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.931248 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.934305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.dim_customer)
[0m19:08:07.937372 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:08:07.939321 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:08:07.940997 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:08:07.944599 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.947811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.956485 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:08:07.963980 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.973145 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:08:07.975928 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:08:07.978813 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.981678 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.983106 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:08:07.988688 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:08:07.993194 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (compile): 19:08:07.949369 => 19:08:07.991857
[0m19:08:07.994603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:07.995453 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.997535 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:08:08.003445 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:08:08.005122 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:08:08.015908 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:08:08.024781 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:08.028178 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:08.029124 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:08:08.034336 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:08:08.039701 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:08.040557 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:08.042100 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:08:08.043903 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.046683 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 19:08:07.757575 => 19:08:08.046386
[0m19:08:08.048934 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:08:08.050434 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:08:08.052004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:08.052770 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:08.054763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b788370>]}
[0m19:08:08.059692 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 19:08:07.810941 => 19:08:08.059354
[0m19:08:08.062100 [info ] [Thread-1 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 0[0m in 0.35s]
[0m19:08:08.064097 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:08:08.066634 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:08:08.069721 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b782890>]}
[0m19:08:08.072374 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.074498 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.076128 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 0[0m in 0.34s]
[0m19:08:08.080031 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.082003 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m19:08:08.084482 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:08:08.087478 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:08:08.090650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m19:08:08.094332 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.096937 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.100043 [info ] [Thread-1 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m19:08:08.108556 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:08:08.112839 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.114743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m19:08:08.122514 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.125117 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.127465 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:08:08.137180 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.139814 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:08.140820 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (compile): 19:08:08.102622 => 19:08:08.140441
[0m19:08:08.148220 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.149769 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.151392 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:08:08.156208 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.159522 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:08.161649 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (compile): 19:08:08.129020 => 19:08:08.161078
[0m19:08:08.168106 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:08:08.170366 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.172316 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.177196 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.180085 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:08:08.181078 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.185186 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:08:08.185965 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:08.187530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:08.193838 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:08:08.199288 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.201318 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.203101 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:08:08.204462 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:08:08.205813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:08.209948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.211338 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:08.213495 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.218405 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (execute): 19:08:08.006431 => 19:08:08.217869
[0m19:08:08.220172 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:08:08.221682 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:08:08.223284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.226537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406685c3df0>]}
[0m19:08:08.227923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:08.230089 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.232285 [info ] [Thread-2 (]: 15 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 0[0m in 0.29s]
[0m19:08:08.237065 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (execute): 19:08:08.152759 => 19:08:08.236402
[0m19:08:08.239186 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:08:08.241061 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:08:08.243008 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:08:08.247025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:08.250363 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:08:08.254304 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (execute): 19:08:08.173678 => 19:08:08.253230
[0m19:08:08.257867 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.17s]
[0m19:08:08.260110 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:08:08.264117 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.266772 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:08:08.270756 [info ] [Thread-1 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.16s]
[0m19:08:08.273596 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.280318 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:08.282832 [debug] [MainThread]: On master: BEGIN
[0m19:08:08.284245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:08.300470 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.303108 [debug] [MainThread]: On master: COMMIT
[0m19:08:08.305038 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:08.306942 [debug] [MainThread]: On master: COMMIT
[0m19:08:08.309097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:08:08.310677 [debug] [MainThread]: On master: Close
[0m19:08:08.313541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:08.314927 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:08:08.316337 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m19:08:08.317801 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m19:08:08.319229 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:08:08.320988 [info ] [MainThread]: 
[0m19:08:08.322931 [info ] [MainThread]: Finished running 3 view models, 11 tests, 3 table models in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m19:08:08.332359 [debug] [MainThread]: Command end result
[0m19:08:08.369046 [info ] [MainThread]: 
[0m19:08:08.371565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:08:08.375266 [info ] [MainThread]: 
[0m19:08:08.378787 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m19:08:08.384050 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0959857, "process_user_time": 4.164596, "process_kernel_time": 0.474078, "process_mem_max_rss": "109868", "process_out_blocks": "56", "process_in_blocks": "0"}
[0m19:08:08.387359 [debug] [MainThread]: Command `dbt build` succeeded at 19:08:08.386861 after 3.10 seconds
[0m19:08:08.389433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066f10faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406683e8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b7163e0>]}
[0m19:08:08.392666 [debug] [MainThread]: Flushing usage events
[0m19:10:42.075756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835af23bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835af4b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835c9f0550>]}


============================== 19:10:42.087931 | 3cd20de9-cf10-4b0a-b39b-92fbb65a57cc ==============================
[0m19:10:42.087931 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:10:42.090080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:10:42.383200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd20de9-cf10-4b0a-b39b-92fbb65a57cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835b415f50>]}
[0m19:10:42.412174 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:10:42.424132 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:10:42.428091 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47026244, "process_user_time": 3.631879, "process_kernel_time": 1.46658, "process_mem_max_rss": "162240", "process_in_blocks": "2032", "process_out_blocks": "2432"}
[0m19:10:42.430311 [debug] [MainThread]: Command `dbt deps` succeeded at 19:10:42.430059 after 0.47 seconds
[0m19:10:42.431765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835c0b7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835af29050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835adea7d0>]}
[0m19:10:42.433657 [debug] [MainThread]: Flushing usage events
[0m19:10:49.196809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7524b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7524b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7524b210>]}


============================== 19:10:49.206995 | 612ef697-3eba-4c45-a772-1b6f8ee166ca ==============================
[0m19:10:49.206995 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:10:49.209357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:10:49.444572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe749bfc90>]}
[0m19:10:49.549468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe74561650>]}
[0m19:10:49.561600 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:10:49.973070 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:10:50.107921 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:10:50.109639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe766ac410>]}
[0m19:10:51.603163 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:10:51.607057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe73932790>]}
[0m19:10:52.045252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe77307b10>]}
[0m19:10:52.265988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7314fc10>]}
[0m19:10:52.269602 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:10:52.272851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe739d6750>]}
[0m19:10:52.280408 [info ] [MainThread]: 
[0m19:10:52.283138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:10:52.300528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:10:52.302689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:10:52.611711 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:10:52.613857 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:10:52.616089 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:10:52.620227 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:10:52.625316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:52.627682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:52.664173 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.036 seconds
[0m19:10:52.665508 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.040 seconds
[0m19:10:52.668704 [debug] [ThreadPool]: On list_db: Close
[0m19:10:52.674227 [debug] [ThreadPool]: On list_db: Close
[0m19:10:52.685652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:10:52.688485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:10:52.706360 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:10:52.713700 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:10:52.715600 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:10:52.718916 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:10:52.721766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:52.724514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:52.743228 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:10:52.744449 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m19:10:52.748148 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:10:52.750496 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:10:52.752229 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:10:52.754289 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:10:52.765157 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m19:10:52.768412 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:10:52.769978 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m19:10:52.771238 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:10:52.774109 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:10:52.781492 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:10:52.794172 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.796658 [debug] [MainThread]: On master: BEGIN
[0m19:10:52.797886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:52.814723 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:10:52.817269 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.819850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:10:52.853450 [debug] [MainThread]: SQL status: SELECT 3 in 0.032 seconds
[0m19:10:52.858100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70e32790>]}
[0m19:10:52.860039 [debug] [MainThread]: On master: ROLLBACK
[0m19:10:52.861442 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.862502 [debug] [MainThread]: On master: BEGIN
[0m19:10:52.864876 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:10:52.866934 [debug] [MainThread]: On master: COMMIT
[0m19:10:52.868780 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.870492 [debug] [MainThread]: On master: COMMIT
[0m19:10:52.874228 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:10:52.876542 [debug] [MainThread]: On master: Close
[0m19:10:52.878227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:52.880007 [info ] [MainThread]: 
[0m19:10:52.896741 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:10:52.897458 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:10:52.898073 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:10:52.899707 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:10:52.903636 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:10:52.905239 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:10:52.906613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:10:52.908095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:10:52.910967 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:10:52.912960 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:10:52.914459 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:10:52.916506 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:10:52.925212 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:10:52.928514 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:10:52.932368 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:10:52.940213 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:10:52.941235 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:10:52.948243 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:10:53.006012 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:10:53.004341 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:10:53.012390 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:10:53.020665 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.022279 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.023692 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:10:53.024554 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.025725 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:10:53.027275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:10:53.029084 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:10:53.030476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:53.032876 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:10:53.046267 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m19:10:53.049577 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.052484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m19:10:53.055342 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:10:53.057094 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m19:10:53.058888 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.062336 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.064939 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:10:53.066725 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:10:53.070046 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:10:53.079281 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:10:53.086415 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.104226 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m19:10:53.097779 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.106062 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:10:53.112804 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.114408 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:10:53.117426 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.118274 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:10:53.121482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.126314 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.129645 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.134294 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.136459 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:10:53.142558 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.144432 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:10:53.147691 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:10:53.149163 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:10:53.151363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.153013 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.189103 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:10:53.189884 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:10:53.194244 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:10:53.196726 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.198790 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.203614 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.211887 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:10:53.214683 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:10:53.217793 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:10:53.229705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:10:53.233386 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m19:10:53.234257 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m19:10:53.252868 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:10:53.260671 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:10:53.270793 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:10:53.289002 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.291150 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.296233 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.299265 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:10:53.300922 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:10:53.303241 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:10:53.308468 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:10:53.309923 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:10:53.311201 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:10:53.316036 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:10:53.319116 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:10:53.323592 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:10:53.328258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe74197b50>]}
[0m19:10:53.332203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe74194910>]}
[0m19:10:53.335370 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70fde550>]}
[0m19:10:53.337300 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.42s]
[0m19:10:53.339846 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.42s]
[0m19:10:53.342138 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.42s]
[0m19:10:53.343786 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:10:53.345574 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:10:53.347676 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:10:53.350795 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m19:10:53.352468 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:10:53.354271 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.355337 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:10:53.357400 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:10:53.359852 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:10:53.361435 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m19:10:53.362669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m19:10:53.363959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m19:10:53.365150 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:10:53.366810 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:10:53.368629 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.373086 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:10:53.380198 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.385293 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.398234 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m19:10:53.399032 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.406376 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:10:53.445384 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:10:53.448006 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.454651 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.466153 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.467762 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.470614 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:10:53.471882 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.473376 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:10:53.475096 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:10:53.477651 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:10:53.479580 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:10:53.482458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:53.498357 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m19:10:53.501014 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m19:10:53.517333 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.521300 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.526166 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:10:53.528932 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:10:53.533098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m19:10:53.543461 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.546284 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:10:53.547858 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.016 seconds
[0m19:10:53.559754 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.562625 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:10:53.567815 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:10:53.576698 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.579074 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:10:53.582610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.595112 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:10:53.598029 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.599603 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:10:53.602066 [debug] [Thread-1 (]: SQL status: SELECT 4332 in 0.052 seconds
[0m19:10:53.609079 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.609728 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m19:10:53.611121 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:10:53.620182 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:10:53.622461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.630763 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.637762 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.639795 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:10:53.642436 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:10:53.646994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.650375 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:10:53.656184 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:10:53.662355 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m19:10:53.663537 [debug] [Thread-2 (]: SQL status: SELECT 5707 in 0.123 seconds
[0m19:10:53.665494 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.668502 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70e09410>]}
[0m19:10:53.684730 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.686544 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:10:53.689828 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.31s]
[0m19:10:53.691671 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:10:53.694531 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m19:10:53.695468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:10:53.698357 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.702770 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:10:53.709733 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.711904 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.713163 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:10:53.714772 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:10:53.717579 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.721308 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:10:53.721931 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:10:53.723242 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.726421 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:10:53.728033 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:10:53.729784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70ef31d0>]}
[0m19:10:53.734287 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:10:53.732963 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4332[0m in 0.37s]
[0m19:10:53.739960 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:10:53.741832 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:10:53.744134 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.746519 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:10:53.751395 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:10:53.755172 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:10:53.757152 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70febcd0>]}
[0m19:10:53.758682 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5707[0m in 0.39s]
[0m19:10:53.760837 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.765641 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:53.767184 [debug] [MainThread]: On master: BEGIN
[0m19:10:53.768415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:53.781866 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m19:10:53.783691 [debug] [MainThread]: On master: COMMIT
[0m19:10:53.785293 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:53.786471 [debug] [MainThread]: On master: COMMIT
[0m19:10:53.788751 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:10:53.790499 [debug] [MainThread]: On master: Close
[0m19:10:53.791960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:53.792964 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:10:53.793989 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:10:53.795076 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m19:10:53.796078 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:10:53.797976 [info ] [MainThread]: 
[0m19:10:53.800531 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m19:10:53.802802 [debug] [MainThread]: Command end result
[0m19:10:53.866519 [info ] [MainThread]: 
[0m19:10:53.868109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:10:53.869709 [info ] [MainThread]: 
[0m19:10:53.871636 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:10:53.873831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7688828, "process_user_time": 5.665403, "process_kernel_time": 0.854599, "process_mem_max_rss": "162240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:10:53.875023 [debug] [MainThread]: Command `dbt run` succeeded at 19:10:53.874901 after 4.77 seconds
[0m19:10:53.876205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe791035d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe79183550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe79038510>]}
[0m19:10:53.877299 [debug] [MainThread]: Flushing usage events
[0m19:11:04.540531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08aa27210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08ad5d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08bdd8b50>]}


============================== 19:11:04.566239 | 032f9b2a-0c9a-44d4-95ff-9e783eceb43e ==============================
[0m19:11:04.566239 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:11:04.570389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:11:05.391589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08aa67250>]}
[0m19:11:05.485081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08c77b590>]}
[0m19:11:05.487938 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:11:05.717763 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:11:06.104582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:11:06.106649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:11:06.180082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c0899e6150>]}
[0m19:11:06.399542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08993e410>]}
[0m19:11:06.402121 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:11:06.404892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c089d56590>]}
[0m19:11:06.408743 [info ] [MainThread]: 
[0m19:11:06.412226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:11:06.421979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:11:06.423333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:11:06.522973 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:11:06.523648 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:11:06.524935 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:11:06.526284 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:11:06.527838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:06.529696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:06.548264 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:11:06.551316 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:11:06.553545 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:11:06.554769 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m19:11:06.558668 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:11:06.560764 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:11:06.568089 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m19:11:06.571355 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:11:06.572105 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m19:11:06.573618 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:11:06.576517 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:11:06.581518 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:11:06.595693 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.597577 [debug] [MainThread]: On master: BEGIN
[0m19:11:06.599989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:06.617472 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:11:06.619579 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.622122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:11:06.660602 [debug] [MainThread]: SQL status: SELECT 3 in 0.036 seconds
[0m19:11:06.663171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08a1819d0>]}
[0m19:11:06.664572 [debug] [MainThread]: On master: ROLLBACK
[0m19:11:06.665968 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.667781 [debug] [MainThread]: On master: BEGIN
[0m19:11:06.669895 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:11:06.671383 [debug] [MainThread]: On master: COMMIT
[0m19:11:06.673079 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.674904 [debug] [MainThread]: On master: COMMIT
[0m19:11:06.677756 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:11:06.679693 [debug] [MainThread]: On master: Close
[0m19:11:06.681211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:06.682630 [info ] [MainThread]: 
[0m19:11:06.698926 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:06.699804 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:06.700429 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:06.701029 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:06.701954 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:11:06.703699 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:11:06.705754 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:11:06.707196 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:11:06.708785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:11:06.710044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:11:06.711639 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:11:06.714003 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:11:06.715665 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:06.717011 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:06.718251 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:06.719356 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:06.742688 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.754600 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.806864 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.810744 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.821349 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:06.822495 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:06.830725 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:06.838121 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:06.864202 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.865111 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.870225 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.876584 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.885645 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.887888 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.890081 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:11:06.891346 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.892806 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.894616 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:11:06.896406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:11:06.898091 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:11:06.899665 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:11:06.901081 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:11:06.903526 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:11:06.910410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:06.919126 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m19:11:06.922114 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.926195 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:11:06.929708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m19:11:06.934544 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m19:11:06.936657 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.939026 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.941693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m19:11:06.945392 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:11:06.948640 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:11:06.954283 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.960359 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:11:06.961777 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:11:06.963995 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:11:06.972233 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.044 seconds
[0m19:11:06.975790 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:11:06.980425 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:11:06.989767 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:11:07.000946 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m19:11:07.004266 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:11:07.006214 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:11:07.009220 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:11:07.014006 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:11:07.018132 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.30s]
[0m19:11:07.020876 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.31s]
[0m19:11:07.023197 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.31s]
[0m19:11:07.026159 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:11:07.029180 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:07.031307 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:07.036942 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:07.039136 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.33s]
[0m19:11:07.045309 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.048529 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.051954 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.055967 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:07.057688 [info ] [Thread-4 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:11:07.059328 [info ] [Thread-3 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:11:07.062355 [info ] [Thread-2 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:11:07.065145 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.068661 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:11:07.071025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:11:07.073428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:11:07.074799 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:11:07.076252 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.077460 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.079003 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.082261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:11:07.088952 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.095199 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.101272 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.102774 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.113466 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.119727 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.121966 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.128412 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.127394 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.129477 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.134385 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.141434 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.149368 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.156906 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.158394 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.159510 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.160869 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:11:07.162502 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.164601 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:11:07.166458 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:11:07.168550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:11:07.170030 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:11:07.172441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:07.174015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:11:07.176750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:11:07.191563 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m19:11:07.194587 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.197158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m19:11:07.199122 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.201123 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:11:07.202296 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.204028 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.205708 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.208931 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.210589 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:11:07.212249 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:11:07.214359 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:11:07.216516 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:11:07.220716 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:11:07.225169 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:11:07.226360 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:11:07.227731 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:11:07.228935 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:11:07.230963 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:11:07.236025 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:11:07.241167 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:11:07.243788 [info ] [Thread-4 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.17s]
[0m19:11:07.246598 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:11:07.247891 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:11:07.249672 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:11:07.252130 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.256388 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.17s]
[0m19:11:07.259723 [info ] [Thread-3 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.19s]
[0m19:11:07.262886 [info ] [Thread-2 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.19s]
[0m19:11:07.270496 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.275460 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.277992 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.281758 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.285847 [info ] [Thread-4 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:11:07.287959 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.289803 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.293927 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:11:07.295368 [info ] [Thread-1 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:11:07.296774 [info ] [Thread-3 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:11:07.298082 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.300480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:11:07.302402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:11:07.317179 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.319822 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.321855 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.337435 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.349297 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.351772 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.360929 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.364606 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.449763 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.451639 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.456461 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.459003 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.461971 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:11:07.463792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:11:07.467492 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.470843 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:11:07.471908 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.473444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:07.475630 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:11:07.478654 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:11:07.482763 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m19:11:07.492535 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.495052 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:11:07.498659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.502818 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.504100 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.506601 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:11:07.509242 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.515232 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m19:11:07.517818 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:11:07.527690 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:11:07.533230 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:11:07.538480 [info ] [Thread-4 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.24s]
[0m19:11:07.543249 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.544473 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m19:11:07.552613 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:11:07.556753 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:11:07.560535 [info ] [Thread-1 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.26s]
[0m19:11:07.563260 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.583885 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.053 seconds
[0m19:11:07.588046 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:11:07.590739 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:11:07.593166 [info ] [Thread-3 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.29s]
[0m19:11:07.596437 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.602494 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:07.604946 [debug] [MainThread]: On master: BEGIN
[0m19:11:07.606445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:07.622736 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:11:07.625344 [debug] [MainThread]: On master: COMMIT
[0m19:11:07.627272 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:07.629630 [debug] [MainThread]: On master: COMMIT
[0m19:11:07.632598 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:11:07.634616 [debug] [MainThread]: On master: Close
[0m19:11:07.636984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:07.639674 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:11:07.642223 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075' was properly closed.
[0m19:11:07.644331 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:11:07.646269 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:11:07.648902 [info ] [MainThread]: 
[0m19:11:07.651468 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m19:11:07.657310 [debug] [MainThread]: Command end result
[0m19:11:07.758375 [info ] [MainThread]: 
[0m19:11:07.760646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:11:07.762203 [info ] [MainThread]: 
[0m19:11:07.763734 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:11:07.765783 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.3846645, "process_user_time": 6.286871, "process_kernel_time": 1.066627, "process_mem_max_rss": "162240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:11:07.768033 [debug] [MainThread]: Command `dbt test` succeeded at 19:11:07.767704 after 3.39 seconds
[0m19:11:07.769409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08aafc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08e8ce990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08e814210>]}
[0m19:11:07.770877 [debug] [MainThread]: Flushing usage events
[0m19:15:10.224597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab2943a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab2943690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab2943c50>]}


============================== 19:15:10.238955 | d1654bf5-1821-4082-a08d-b1214a74a435 ==============================
[0m19:15:10.238955 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:15:10.242506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:15:10.479875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1654bf5-1821-4082-a08d-b1214a74a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab280f8d0>]}
[0m19:15:10.514606 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:15:10.528532 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:15:10.531323 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41587272, "process_user_time": 3.421852, "process_kernel_time": 0.635059, "process_mem_max_rss": "162276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:10.533523 [debug] [MainThread]: Command `dbt deps` succeeded at 19:15:10.533310 after 0.42 seconds
[0m19:15:10.535154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab29484d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab29ac290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab65db2d0>]}
[0m19:15:10.537655 [debug] [MainThread]: Flushing usage events
[0m19:15:15.463769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54c85a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54cc9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54ccb210>]}


============================== 19:15:15.476361 | 4a0eb178-a49d-4c9d-b26c-532ad52ec312 ==============================
[0m19:15:15.476361 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:15:15.479375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:15.722012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54742550>]}
[0m19:15:15.803856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a56a132d0>]}
[0m19:15:15.806872 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:15.966349 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:15:16.441988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:16.445192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:16.552244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53b45050>]}
[0m19:15:17.075524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53fc5050>]}
[0m19:15:17.079578 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:15:17.090188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54cca390>]}
[0m19:15:17.112348 [info ] [MainThread]: 
[0m19:15:17.115721 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:17.132656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:15:17.147635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:15:17.304576 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:15:17.305789 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:15:17.307219 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:17.310252 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:17.313514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:17.315024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:17.339323 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m19:15:17.340705 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m19:15:17.343445 [debug] [ThreadPool]: On list_db: Close
[0m19:15:17.347081 [debug] [ThreadPool]: On list_db: Close
[0m19:15:17.353346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:15:17.354761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:15:17.367305 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:17.372779 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:17.376688 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:15:17.378797 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:15:17.380117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:17.381646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:17.402405 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:15:17.405944 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m19:15:17.407447 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:17.413684 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:17.415886 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:15:17.417973 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:15:17.427418 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:15:17.428063 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m19:15:17.433439 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:15:17.436841 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:15:17.441165 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:15:17.442663 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:15:17.460065 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.461799 [debug] [MainThread]: On master: BEGIN
[0m19:15:17.463413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:17.482667 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:15:17.486982 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.489069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:17.542848 [debug] [MainThread]: SQL status: SELECT 3 in 0.051 seconds
[0m19:15:17.545786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54d27e90>]}
[0m19:15:17.547048 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:17.550183 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.552220 [debug] [MainThread]: On master: BEGIN
[0m19:15:17.554387 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:15:17.557079 [debug] [MainThread]: On master: COMMIT
[0m19:15:17.560474 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.562395 [debug] [MainThread]: On master: COMMIT
[0m19:15:17.564032 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:15:17.566017 [debug] [MainThread]: On master: Close
[0m19:15:17.569452 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:17.570912 [info ] [MainThread]: 
[0m19:15:17.591472 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:15:17.592383 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:15:17.593802 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:15:17.596893 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:15:17.599563 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:15:17.601462 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:15:17.604309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m19:15:17.606593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m19:15:17.608286 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:15:17.609669 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:15:17.610797 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:15:17.613187 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:15:17.626351 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:15:17.629567 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:15:17.635647 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:15:17.645879 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:15:17.647185 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:15:17.654657 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:15:17.747756 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:15:17.752869 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:15:17.756219 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:15:17.766292 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.770000 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.771718 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:15:17.774083 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.775708 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:15:17.779253 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:15:17.781030 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:15:17.782576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:17.787120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:17.801175 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m19:15:17.805157 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.808480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m19:15:17.810098 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m19:15:17.811045 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:15:17.812789 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.816825 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.821045 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:15:17.826110 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:15:17.828001 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:15:17.842710 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m19:15:17.843859 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m19:15:17.851437 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.859991 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.867381 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.871388 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:15:17.874086 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:15:17.876003 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:15:17.880552 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:15:17.883488 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.886063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.894608 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.902306 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.912515 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.914170 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:15:17.918175 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:15:17.919905 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:15:17.922331 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.923148 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.927080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.967981 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:15:17.976402 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:15:17.982827 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:15:17.984678 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.986088 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.988732 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.991755 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:15:17.993601 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:15:17.994957 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:15:18.000095 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m19:15:18.001720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m19:15:18.017067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m19:15:18.018283 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:15:18.022562 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:15:18.030301 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:15:18.044305 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:18.047125 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:18.049503 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:18.050848 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:15:18.054001 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:15:18.057590 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:15:18.066148 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m19:15:18.067379 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m19:15:18.068266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:15:18.075454 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:15:18.078254 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:15:18.082842 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:15:18.089843 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a517caf90>]}
[0m19:15:18.094362 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53fdc350>]}
[0m19:15:18.099411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53788ad0>]}
[0m19:15:18.103715 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.48s]
[0m19:15:18.107132 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.49s]
[0m19:15:18.110849 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.49s]
[0m19:15:18.113036 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:15:18.115110 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:15:18.120202 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:15:18.128673 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:15:18.131920 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:15:18.134372 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:15:18.139312 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:15:18.145572 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:15:18.149093 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:15:18.153419 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m19:15:18.163269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m19:15:18.173190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m19:15:18.175464 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:15:18.177561 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:15:18.180783 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:15:18.194935 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.205944 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.220005 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:15:18.232772 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:15:18.238599 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:15:18.246787 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:15:18.557963 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:15:18.563839 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.571216 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.588584 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.590161 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.599517 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:15:18.602104 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.606118 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:15:18.608896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:18.611820 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:15:18.616438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:18.621165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:15:18.637132 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m19:15:18.642335 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.644983 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:15:18.647270 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m19:15:18.654204 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.655714 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m19:15:18.661333 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:15:18.664541 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.671360 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:15:18.673053 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.021 seconds
[0m19:15:18.697320 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.707988 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:15:18.717966 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:18.756953 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.773677 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:15:18.788244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:15:18.789965 [debug] [Thread-3 (]: SQL status: SELECT 4332 in 0.120 seconds
[0m19:15:18.814792 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:15:18.825038 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.827871 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.830674 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:15:18.838530 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:15:18.846273 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:18.860881 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m19:15:18.875329 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.887424 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:15:18.900547 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:15:18.927996 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.931207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:18.935361 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:15:18.944367 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:15:18.948033 [debug] [Thread-4 (]: SQL status: SELECT 5707 in 0.271 seconds
[0m19:15:18.954817 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.963688 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.014 seconds
[0m19:15:18.973021 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.974839 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:15:18.982702 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:15:18.984711 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:15:18.992110 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m19:15:18.994770 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a517b8d90>]}
[0m19:15:18.999421 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:15:19.004554 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:15:19.009844 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.82s]
[0m19:15:19.018876 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:19.021037 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:19.022923 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:15:19.026371 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:15:19.028366 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:15:19.031760 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:19.045575 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m19:15:19.044500 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:15:19.049016 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:15:19.051801 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:19.056303 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a52b8f610>]}
[0m19:15:19.064025 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:15:19.071530 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4332[0m in 0.89s]
[0m19:15:19.075963 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:15:19.077050 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m19:15:19.093826 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:15:19.096198 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:19.104007 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:15:19.113810 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m19:15:19.120166 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:15:19.122608 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53bae190>]}
[0m19:15:19.126847 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5707[0m in 0.97s]
[0m19:15:19.131440 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:15:19.139493 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:19.141653 [debug] [MainThread]: On master: BEGIN
[0m19:15:19.145720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:19.166137 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:15:19.168726 [debug] [MainThread]: On master: COMMIT
[0m19:15:19.172693 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:19.175723 [debug] [MainThread]: On master: COMMIT
[0m19:15:19.184906 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:15:19.195433 [debug] [MainThread]: On master: Close
[0m19:15:19.201477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:19.204106 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m19:15:19.207130 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:15:19.211322 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:15:19.213388 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:15:19.216399 [info ] [MainThread]: 
[0m19:15:19.219676 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m19:15:19.223155 [debug] [MainThread]: Command end result
[0m19:15:19.344884 [info ] [MainThread]: 
[0m19:15:19.350562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:19.352662 [info ] [MainThread]: 
[0m19:15:19.356614 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:15:19.359239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9947906, "process_user_time": 5.016837, "process_kernel_time": 0.756362, "process_mem_max_rss": "162280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:19.360892 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:19.360714 after 4.00 seconds
[0m19:15:19.362281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54cd9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a58b3a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a58b3a650>]}
[0m19:15:19.366434 [debug] [MainThread]: Flushing usage events
[0m19:15:28.076103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b370837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b37083510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b37caa4d0>]}


============================== 19:15:28.090000 | c7a67ba8-8cd6-4395-ab5b-61963118ae1a ==============================
[0m19:15:28.090000 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:15:28.092200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:15:28.337099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b37082c10>]}
[0m19:15:28.423197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b38e16dd0>]}
[0m19:15:28.426379 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:28.700863 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:15:30.743833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:30.774633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:30.954228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b35b116d0>]}
[0m19:15:31.617395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b353e3d10>]}
[0m19:15:31.624513 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:15:31.631792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b357bca90>]}
[0m19:15:31.642705 [info ] [MainThread]: 
[0m19:15:31.650535 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:31.663497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:15:31.667786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:15:31.789199 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:31.790034 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:31.791171 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:15:31.792749 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:15:31.796109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:31.797808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:31.817713 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:15:31.818799 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:15:31.824189 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:31.826673 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:31.828674 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:15:31.834196 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:15:31.850141 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.013 seconds
[0m19:15:31.851988 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m19:15:31.855371 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:15:31.862071 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:15:31.864231 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:15:31.865472 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:15:31.888155 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:31.890615 [debug] [MainThread]: On master: BEGIN
[0m19:15:31.896933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:31.919940 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:15:31.926534 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:31.929098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:32.006145 [debug] [MainThread]: SQL status: SELECT 3 in 0.071 seconds
[0m19:15:32.014483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b36fa6e90>]}
[0m19:15:32.022209 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:32.027448 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:32.032494 [debug] [MainThread]: On master: BEGIN
[0m19:15:32.039586 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:15:32.051412 [debug] [MainThread]: On master: COMMIT
[0m19:15:32.055332 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:32.066777 [debug] [MainThread]: On master: COMMIT
[0m19:15:32.086754 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:15:32.093642 [debug] [MainThread]: On master: Close
[0m19:15:32.100627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:32.118366 [info ] [MainThread]: 
[0m19:15:32.164276 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.166307 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.167655 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.170437 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.172990 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:15:32.182624 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:15:32.186024 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:15:32.191558 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:15:32.196476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:15:32.201470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:15:32.203767 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:15:32.208841 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:15:32.211008 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.212655 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.215212 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.218576 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.274169 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.282763 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.302907 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.310192 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.319585 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.320945 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.323078 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.334228 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.359711 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.363980 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.367949 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.376784 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.386711 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.389876 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.392534 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:15:32.394257 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.394958 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.396275 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:15:32.399021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:32.401181 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:15:32.403323 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:15:32.406435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:32.411242 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:15:32.413169 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:15:32.428473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m19:15:32.431449 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.433332 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:15:32.437167 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m19:15:32.439858 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:15:32.442182 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.444903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m19:15:32.446281 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.449048 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:15:32.450271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m19:15:32.451600 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.453751 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:15:32.466838 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:15:32.468430 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:15:32.471775 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:15:32.477291 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m19:15:32.476217 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.28s]
[0m19:15:32.478703 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:15:32.485674 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:15:32.489943 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.494026 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:15:32.494758 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.039 seconds
[0m19:15:32.496409 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:15:32.498155 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.500581 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:15:32.503146 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:15:32.505770 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.30s]
[0m19:15:32.507206 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:15:32.510024 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.31s]
[0m19:15:32.512098 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:15:32.514180 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.515920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:15:32.517582 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.519341 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.32s]
[0m19:15:32.521162 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.522751 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.524154 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.525965 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.527619 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:15:32.535623 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.536885 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:15:32.538530 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.539819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:15:32.542185 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:15:32.543914 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:15:32.545826 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.547307 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.548976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:15:32.556240 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.557518 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.564224 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.565650 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.570449 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.579117 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.586138 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.587906 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.592283 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.593348 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.598747 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.599810 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.605717 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.608450 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:15:32.611327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:32.613893 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.615515 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.616651 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.618556 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:15:32.620601 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:15:32.621920 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:15:32.623219 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:32.624496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:32.625929 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:15:32.627566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:15:32.635502 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.637843 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:15:32.642734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:15:32.646042 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m19:15:32.648199 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m19:15:32.652231 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:15:32.654668 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:15:32.656651 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.658827 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.661584 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:15:32.663484 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.666325 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:15:32.669820 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:15:32.673209 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.16s]
[0m19:15:32.675055 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:15:32.679934 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:15:32.681654 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:15:32.684534 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.689759 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:15:32.690605 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:15:32.695151 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:15:32.697196 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.699361 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:15:32.703647 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:15:32.705887 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:15:32.707477 [info ] [Thread-1 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:15:32.710103 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.17s]
[0m19:15:32.712502 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:15:32.714288 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.17s]
[0m19:15:32.715914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:15:32.717963 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.722126 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.18s]
[0m19:15:32.724823 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.727205 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.730067 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.732301 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.733963 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.744347 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.746257 [info ] [Thread-3 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:15:32.750036 [info ] [Thread-2 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:15:32.752812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:15:32.754905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:15:32.757082 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.758856 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.767085 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.774311 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.782998 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.883258 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.888611 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.889863 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.895207 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.899853 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.902664 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.905729 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:15:32.907188 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.909119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:32.910727 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.912263 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:15:32.915308 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:15:32.917074 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:32.918980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:32.928591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:15:32.930750 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.932298 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:32.936465 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:15:32.938107 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m19:15:32.939013 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:15:32.940192 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.941721 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.944891 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:15:32.946798 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:32.948670 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:32.951044 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:15:32.955218 [info ] [Thread-1 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.24s]
[0m19:15:32.957394 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.963405 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m19:15:32.967162 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:15:32.969348 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:15:32.971272 [info ] [Thread-3 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.22s]
[0m19:15:32.973415 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.982297 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.029 seconds
[0m19:15:32.985130 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:15:32.987063 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:15:32.988821 [info ] [Thread-2 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.23s]
[0m19:15:32.990499 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.995399 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:32.997273 [debug] [MainThread]: On master: BEGIN
[0m19:15:32.998719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:33.011296 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m19:15:33.013444 [debug] [MainThread]: On master: COMMIT
[0m19:15:33.015168 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:33.016561 [debug] [MainThread]: On master: COMMIT
[0m19:15:33.018484 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:15:33.020419 [debug] [MainThread]: On master: Close
[0m19:15:33.022878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:33.026029 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:15:33.028605 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:15:33.030318 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:15:33.032806 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
[0m19:15:33.034622 [info ] [MainThread]: 
[0m19:15:33.035961 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m19:15:33.039813 [debug] [MainThread]: Command end result
[0m19:15:33.125089 [info ] [MainThread]: 
[0m19:15:33.129897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:33.132669 [info ] [MainThread]: 
[0m19:15:33.134955 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:15:33.138684 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.1401386, "process_user_time": 5.08476, "process_kernel_time": 0.801475, "process_mem_max_rss": "162284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:33.141425 [debug] [MainThread]: Command `dbt test` succeeded at 19:15:33.140877 after 5.14 seconds
[0m19:15:33.144963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b3af05590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b3af93450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b3ad1c510>]}
[0m19:15:33.147500 [debug] [MainThread]: Flushing usage events
[0m23:26:08.525621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1bc4a78550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1bc5cea1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1bc4aaf390>]}


============================== 23:26:08.536969 | 054f971d-5bcb-49e6-89b2-1dd5b7df2fc0 ==============================
[0m23:26:08.536969 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:26:08.539253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m23:26:08.680714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '054f971d-5bcb-49e6-89b2-1dd5b7df2fc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1bc4952510>]}
[0m23:26:08.724945 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:08.755599 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:08.760357 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37194496, "process_user_time": 2.098678, "process_kernel_time": 0.542696, "process_mem_max_rss": "93516", "process_in_blocks": "86640", "process_out_blocks": "1128"}
[0m23:26:08.763504 [debug] [MainThread]: Command `dbt deps` succeeded at 23:26:08.763115 after 0.38 seconds
[0m23:26:08.766724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1bc4a842d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1bc48c9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1bc885c750>]}
[0m23:26:08.769059 [debug] [MainThread]: Flushing usage events
[0m23:26:12.746586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2e626990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2ebd3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2e653fd0>]}


============================== 23:26:12.753112 | af6608d2-9d49-409c-a0ec-c5aa4eec2dcd ==============================
[0m23:26:12.753112 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:26:12.756564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:26:13.127670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2e49ac50>]}
[0m23:26:13.214150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e3230c8d0>]}
[0m23:26:13.218207 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:26:13.258837 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:26:13.481983 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:26:13.485333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2fb06e90>]}
[0m23:26:15.298787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:26:15.302291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2ccc6650>]}
[0m23:26:15.794106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2cb9dd10>]}
[0m23:26:16.145718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2f2e24d0>]}
[0m23:26:16.148342 [info ] [MainThread]: Found 6 models, 11 data tests, 415 macros
[0m23:26:16.152410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2c9e9210>]}
[0m23:26:16.159117 [info ] [MainThread]: 
[0m23:26:16.165040 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:16.181761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:26:16.184146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:26:16.357135 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:26:16.358299 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:26:16.359995 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:26:16.361844 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:26:16.363467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:16.365353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:16.404359 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:26:16.406386 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:26:16.409521 [debug] [ThreadPool]: On list_db: Close
[0m23:26:16.413046 [debug] [ThreadPool]: On list_db: Close
[0m23:26:16.417417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m23:26:16.418634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m23:26:16.422209 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m23:26:16.423925 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m23:26:16.432808 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m23:26:16.437879 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m23:26:16.439719 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m23:26:16.441487 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m23:26:16.443214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:16.444658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:16.460344 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.464215 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.466356 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m23:26:16.468267 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m23:26:16.470206 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m23:26:16.472397 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m23:26:16.475416 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:26:16.476160 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:26:16.479071 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m23:26:16.483327 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m23:26:16.485257 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m23:26:16.486711 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m23:26:16.488718 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m23:26:16.491809 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m23:26:16.495408 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:26:16.496649 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:26:16.498530 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m23:26:16.501030 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m23:26:16.507717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_staging)
[0m23:26:16.509540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_analytics)
[0m23:26:16.522192 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m23:26:16.526548 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m23:26:16.528206 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m23:26:16.529999 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m23:26:16.532017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:16.534423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:16.550256 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.551972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.553787 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m23:26:16.555090 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m23:26:16.556679 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m23:26:16.558408 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:26:16.568575 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:26:16.569704 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:26:16.573992 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m23:26:16.578515 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m23:26:16.582847 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m23:26:16.587273 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m23:26:16.601868 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:16.604375 [debug] [MainThread]: On master: BEGIN
[0m23:26:16.606136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:16.622957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.625024 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:16.626944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:26:16.637196 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:26:16.640783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2f2e24d0>]}
[0m23:26:16.643079 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:16.645157 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:16.647014 [debug] [MainThread]: On master: BEGIN
[0m23:26:16.649704 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.656766 [debug] [MainThread]: On master: COMMIT
[0m23:26:16.659144 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:16.660774 [debug] [MainThread]: On master: COMMIT
[0m23:26:16.663154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:26:16.665370 [debug] [MainThread]: On master: Close
[0m23:26:16.667604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:26:16.670314 [info ] [MainThread]: 
[0m23:26:16.703655 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:26:16.704676 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:26:16.705326 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:26:16.707780 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m23:26:16.711506 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m23:26:16.714044 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m23:26:16.716962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m23:26:16.719710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m23:26:16.721975 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:26:16.724208 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:26:16.726476 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:26:16.729294 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:26:16.744464 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:26:16.750668 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:26:16.755751 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:26:16.782297 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:26:16.783880 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:26:16.823185 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:26:16.869715 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:26:16.872555 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:26:16.873897 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:26:16.896364 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:26:16.897625 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:26:16.899618 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:26:16.901866 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:26:16.904310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:16.905563 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:26:16.906991 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:26:16.911417 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:26:16.918395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:16.927291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.929276 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.930351 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:26:16.932029 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:26:16.936893 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:26:16.937998 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:26:16.940035 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:26:16.943796 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:26:16.947393 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:26:16.948766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:26:16.953954 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:26:16.969439 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:26:16.974992 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:26:16.982768 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:26:16.990288 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:26:16.991579 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:26:16.993012 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:26:16.994898 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:26:16.997918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:26:16.999624 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:26:17.001700 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:26:17.028197 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:26:17.030565 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:26:17.033667 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:26:17.035635 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:26:17.037265 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:26:17.038806 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:26:17.040351 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:26:17.041890 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:26:17.043325 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:26:17.047544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:26:17.048566 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:26:17.049606 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:26:17.059037 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m23:26:17.063626 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m23:26:17.069989 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m23:26:17.081426 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:26:17.084033 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:26:17.085933 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:26:17.087533 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m23:26:17.088978 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m23:26:17.090699 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m23:26:17.093348 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:26:17.094420 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:26:17.096284 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:26:17.100413 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:26:17.103656 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:26:17.106640 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:26:17.111574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e1e4a5850>]}
[0m23:26:17.114061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e1e5adc50>]}
[0m23:26:17.119732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e1e5c01d0>]}
[0m23:26:17.121573 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.39s]
[0m23:26:17.123841 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.39s]
[0m23:26:17.126635 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.40s]
[0m23:26:17.129188 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:26:17.131797 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:26:17.133678 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:26:17.137131 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m23:26:17.139772 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:26:17.141876 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:26:17.143724 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m23:26:17.150149 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m23:26:17.154967 [info ] [Thread-3 (]: 6 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m23:26:17.159469 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m23:26:17.162159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_marketing_attribution)
[0m23:26:17.166325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m23:26:17.169709 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:26:17.172330 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:26:17.174558 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:26:17.186238 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:26:17.194154 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:26:17.203199 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:26:17.234766 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m23:26:17.235969 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:26:17.317727 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:26:17.332929 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:26:17.336873 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:26:17.343886 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:26:17.366938 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:26:17.368068 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:26:17.369175 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:26:17.371227 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:26:17.375650 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:26:17.378026 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:26:17.385369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:17.387644 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:17.390476 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:26:17.409038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:26:17.412941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:26:17.414628 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:26:17.417312 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:26:17.419077 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:26:17.420396 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:26:17.423750 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:26:17.426975 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:26:17.430876 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:26:17.448340 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:26:17.449769 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:26:17.453736 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:26:17.465018 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:26:17.475508 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:26:17.482610 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:26:17.484878 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:26:17.487938 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:26:17.491812 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:26:17.496472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:26:17.499750 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:26:17.503935 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:26:17.518131 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:26:17.523797 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:26:17.527686 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:26:17.531005 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:26:17.533288 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:26:17.535286 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:26:17.537958 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:26:17.540088 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:26:17.541903 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:26:17.548515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:26:17.549720 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:26:17.550317 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:26:17.557122 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:26:17.562500 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m23:26:17.568518 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m23:26:17.576974 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:26:17.579198 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:26:17.582879 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:26:17.585206 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:26:17.586836 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:26:17.588678 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m23:26:17.592202 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:26:17.594307 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:26:17.596919 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:26:17.600814 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:26:17.603767 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:26:17.608701 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m23:26:17.610959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2cba8f50>]}
[0m23:26:17.612858 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e2cbfbd10>]}
[0m23:26:17.615551 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6608d2-9d49-409c-a0ec-c5aa4eec2dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e1e57f010>]}
[0m23:26:17.618486 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.45s]
[0m23:26:17.620755 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.45s]
[0m23:26:17.623862 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.46s]
[0m23:26:17.628364 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:26:17.631118 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:26:17.634945 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m23:26:17.643165 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:17.645243 [debug] [MainThread]: On master: BEGIN
[0m23:26:17.647323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:17.667584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:26:17.672484 [debug] [MainThread]: On master: COMMIT
[0m23:26:17.675401 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:17.677849 [debug] [MainThread]: On master: COMMIT
[0m23:26:17.681273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:26:17.684539 [debug] [MainThread]: On master: Close
[0m23:26:17.688371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:17.690171 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m23:26:17.691978 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m23:26:17.694130 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m23:26:17.697428 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:26:17.699745 [info ] [MainThread]: 
[0m23:26:17.702045 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m23:26:17.709949 [debug] [MainThread]: Command end result
[0m23:26:17.867396 [info ] [MainThread]: 
[0m23:26:17.870969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:17.873314 [info ] [MainThread]: 
[0m23:26:17.876054 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:26:17.881454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.260377, "process_user_time": 5.670511, "process_kernel_time": 0.639039, "process_mem_max_rss": "118104", "process_in_blocks": "25240", "process_out_blocks": "144"}
[0m23:26:17.883415 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:17.883169 after 5.26 seconds
[0m23:26:17.885675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e324106d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e32594390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738e32594cd0>]}
[0m23:26:17.888389 [debug] [MainThread]: Flushing usage events
[0m19:15:33.262385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727a97e8aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727a99a6cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727a992b75d0>]}


============================== 19:15:33.277738 | 9e82c93f-bbee-4514-ad0e-3e509fca4288 ==============================
[0m19:15:33.277738 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:15:33.280526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:33.437425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e82c93f-bbee-4514-ad0e-3e509fca4288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727a97e88d50>]}
[0m19:15:33.484366 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:15:33.498928 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:15:33.503967 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5010197, "process_user_time": 1.736691, "process_kernel_time": 0.468279, "process_mem_max_rss": "93824", "process_in_blocks": "91600", "process_out_blocks": "1128"}
[0m19:15:33.506283 [debug] [MainThread]: Command `dbt deps` succeeded at 19:15:33.506030 after 0.50 seconds
[0m19:15:33.508066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727a97e90250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727a97ce5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727a9bc74690>]}
[0m19:15:33.509842 [debug] [MainThread]: Flushing usage events
[0m19:15:36.343988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6daef310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6db36610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6dcafbd0>]}


============================== 19:15:36.349327 | 37f3dd7e-8fe6-43b6-ad95-b62050ed39b8 ==============================
[0m19:15:36.349327 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:15:36.352158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:15:36.649466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6daece90>]}
[0m19:15:36.710873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa717e48d0>]}
[0m19:15:36.713891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:36.747749 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:15:37.252558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:37.254533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:37.295152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6db98c10>]}
[0m19:15:37.552716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6daeded0>]}
[0m19:15:37.554958 [info ] [MainThread]: Found 6 models, 11 data tests, 415 macros
[0m19:15:37.557066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6c2518d0>]}
[0m19:15:37.562391 [info ] [MainThread]: 
[0m19:15:37.565442 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:37.574917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:15:37.576757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:15:37.706201 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:15:37.706677 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:15:37.709112 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:37.710769 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:37.712720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:37.714451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:37.753110 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:15:37.753853 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:15:37.757183 [debug] [ThreadPool]: On list_db: Close
[0m19:15:37.760038 [debug] [ThreadPool]: On list_db: Close
[0m19:15:37.767112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m19:15:37.767796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m19:15:37.769721 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m19:15:37.771879 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m19:15:37.780455 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:15:37.783940 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:15:37.785809 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m19:15:37.787728 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m19:15:37.789420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:37.791521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:37.805995 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.807794 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.809074 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:15:37.811448 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:15:37.813424 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m19:15:37.815229 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m19:15:37.818297 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:15:37.820310 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:15:37.821821 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:15:37.824055 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:15:37.826619 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:15:37.828608 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:15:37.830358 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:15:37.831941 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:15:37.837319 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.838914 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.839932 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m19:15:37.841960 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m19:15:37.854409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_staging)
[0m19:15:37.856322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_analytics)
[0m19:15:37.872749 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:37.878849 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:37.882057 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:15:37.884016 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:15:37.885835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:37.887624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:37.902410 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.903165 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.904993 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:37.909715 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:37.911822 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:15:37.913502 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:15:37.922967 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:37.924077 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:37.926936 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:15:37.929728 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:15:37.932297 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:15:37.934105 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:15:37.947583 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:37.949532 [debug] [MainThread]: On master: BEGIN
[0m19:15:37.952489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:37.973089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.975218 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:37.977198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:37.988391 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:37.990806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6ac3b910>]}
[0m19:15:37.992989 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:37.995569 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:37.997800 [debug] [MainThread]: On master: BEGIN
[0m19:15:38.000793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.005540 [debug] [MainThread]: On master: COMMIT
[0m19:15:38.008385 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:38.010580 [debug] [MainThread]: On master: COMMIT
[0m19:15:38.012812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.015034 [debug] [MainThread]: On master: Close
[0m19:15:38.018039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:38.023785 [info ] [MainThread]: 
[0m19:15:38.052574 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:15:38.054644 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:15:38.055440 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:15:38.056797 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:15:38.060126 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:15:38.063511 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:15:38.065674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m19:15:38.067287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m19:15:38.070303 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:15:38.073335 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:15:38.075241 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:15:38.079149 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:15:38.095931 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:15:38.100199 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:15:38.106724 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:15:38.132647 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:15:38.133523 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:15:38.134307 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:15:38.190294 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:15:38.193048 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:15:38.197189 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:15:38.218437 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:38.219169 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:38.220843 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:15:38.222451 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:15:38.224049 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:15:38.225631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:38.241210 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:38.245340 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.246318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.247109 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:15:38.249293 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:38.251197 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:38.253019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:38.255088 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:15:38.256978 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:15:38.265268 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:38.266560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:38.280079 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.281175 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:38.288870 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:38.290687 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:38.292289 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:15:38.295053 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:15:38.298451 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:15:38.302624 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.305121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.313821 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:38.332830 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:15:38.334650 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:15:38.341102 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:38.342931 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:38.344570 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:38.346167 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:15:38.347792 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:15:38.349190 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:15:38.351651 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.356210 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:15:38.356794 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.357220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.358305 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:38.366084 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:15:38.369293 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:15:38.370738 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:15:38.379084 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:38.380537 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:38.383396 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:15:38.384128 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.385227 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:15:38.387923 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:38.391714 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:15:38.394116 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:38.398540 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:15:38.401386 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:38.405972 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:15:38.410450 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6d971550>]}
[0m19:15:38.412237 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:15:38.414741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6ab9bb10>]}
[0m19:15:38.419180 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.34s]
[0m19:15:38.422134 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:38.423889 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.35s]
[0m19:15:38.426133 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:15:38.429601 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:15:38.432035 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:15:38.435195 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:15:38.437919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6ab32d50>]}
[0m19:15:38.440693 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m19:15:38.442186 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:15:38.445646 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.37s]
[0m19:15:38.447995 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:15:38.450354 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m19:15:38.453056 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:15:38.455215 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.dim_customer)
[0m19:15:38.457126 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:15:38.461043 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:15:38.464728 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:15:38.470797 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:15:38.474023 [info ] [Thread-1 (]: 6 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:15:38.484292 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:15:38.487971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m19:15:38.491545 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:15:38.502749 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:15:38.514222 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:15:38.514952 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m19:15:38.546148 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:15:38.564707 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:15:38.567390 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:15:38.571642 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:15:38.590080 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:38.590907 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:38.591635 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:38.592522 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:15:38.593989 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:15:38.595521 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:15:38.597043 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:38.599025 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:15:38.600903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:38.616058 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.617032 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.618429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.619301 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:38.620870 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:38.622419 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:38.623812 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:15:38.625301 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:15:38.626964 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:15:38.639124 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:38.641620 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:38.651043 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:38.652487 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:38.661899 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:38.666125 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:15:38.673138 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:38.675167 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:15:38.677487 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.679038 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:15:38.684611 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.694720 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:15:38.697756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.703699 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:15:38.705777 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:38.709538 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:15:38.712814 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:38.716485 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:15:38.718755 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:38.719972 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:15:38.722109 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:15:38.723218 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.726909 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.728339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.732995 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:15:38.740060 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:15:38.747893 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:15:38.756984 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:38.758920 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:38.762287 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:38.764337 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:15:38.765837 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:15:38.767202 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:15:38.769489 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:38.771772 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:38.772945 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:38.775036 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m19:15:38.777032 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:15:38.780257 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:15:38.781974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6bead310>]}
[0m19:15:38.783320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6bfe4d10>]}
[0m19:15:38.784731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f3dd7e-8fe6-43b6-ad95-b62050ed39b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa6817e190>]}
[0m19:15:38.790832 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.33s]
[0m19:15:38.793108 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.33s]
[0m19:15:38.795122 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.30s]
[0m19:15:38.802211 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m19:15:38.851887 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:15:38.854144 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:15:38.861246 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:38.876493 [debug] [MainThread]: On master: BEGIN
[0m19:15:38.882847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:38.900422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.907909 [debug] [MainThread]: On master: COMMIT
[0m19:15:38.912052 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:38.913823 [debug] [MainThread]: On master: COMMIT
[0m19:15:38.915806 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.916759 [debug] [MainThread]: On master: Close
[0m19:15:38.918336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:38.921731 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:15:38.923688 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m19:15:38.924981 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:15:38.926391 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:15:38.927857 [info ] [MainThread]: 
[0m19:15:38.929607 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m19:15:38.935013 [debug] [MainThread]: Command end result
[0m19:15:39.094681 [info ] [MainThread]: 
[0m19:15:39.096924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:39.099039 [info ] [MainThread]: 
[0m19:15:39.101368 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:15:39.104556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8697402, "process_user_time": 2.689516, "process_kernel_time": 0.530584, "process_mem_max_rss": "113936", "process_in_blocks": "28008", "process_out_blocks": "144"}
[0m19:15:39.106933 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:39.106653 after 2.87 seconds
[0m19:15:39.108739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa719dc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa71a6c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa71a6d210>]}
[0m19:15:39.110736 [debug] [MainThread]: Flushing usage events
[0m19:37:35.172716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e364a0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e364a1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e364a25d0>]}


============================== 19:37:35.183747 | c51d949e-81e9-432f-8d48-ee7b9ba1748e ==============================
[0m19:37:35.183747 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:37:35.186509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:37:35.393164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c51d949e-81e9-432f-8d48-ee7b9ba1748e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e364ee2d0>]}
[0m19:37:35.448414 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zb0ggsp6'
[0m19:37:35.450501 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:37:35.687204 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:37:35.690371 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:37:35.803515 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:37:35.826760 [info ] [MainThread]: Updating lock file in file path: /usr/app/package-lock.yml
[0m19:37:35.849576 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pb_lphus'
[0m19:37:35.855593 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:37:42.260822 [info ] [MainThread]: Installed from version 1.3.1
[0m19:37:42.263056 [info ] [MainThread]: Up to date!
[0m19:37:42.265542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c51d949e-81e9-432f-8d48-ee7b9ba1748e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e36322750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e36321f10>]}
[0m19:37:42.270901 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.199055, "process_user_time": 2.073357, "process_kernel_time": 0.821871, "process_mem_max_rss": "94864", "process_in_blocks": "87544", "process_out_blocks": "1296"}
[0m19:37:42.273528 [debug] [MainThread]: Command `dbt deps` succeeded at 19:37:42.273216 after 7.20 seconds
[0m19:37:42.275498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e36312150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e364efbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e3a2746d0>]}
[0m19:37:42.277876 [debug] [MainThread]: Flushing usage events
[0m19:37:45.413159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b637c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b67cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b67f050>]}


============================== 19:37:45.418472 | f4946ba7-038f-45d6-95bf-4486887a6d97 ==============================
[0m19:37:45.418472 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:37:45.420783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:37:45.754332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b635390>]}
[0m19:37:45.834801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139f384910>]}
[0m19:37:45.837728 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:37:45.907734 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:37:46.040688 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:37:46.044328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139cadb090>]}
[0m19:37:49.183773 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:37:49.186148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721399c0ff50>]}
[0m19:37:49.577533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721399c8df10>]}
[0m19:37:49.762436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139888bf90>]}
[0m19:37:49.764818 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m19:37:49.767196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721399abd010>]}
[0m19:37:49.772714 [info ] [MainThread]: 
[0m19:37:49.775227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:49.785888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:37:49.787621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:37:49.901234 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:37:49.902131 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:37:49.903455 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:37:49.905074 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:37:49.906757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:49.908157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:49.943753 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:37:49.944389 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:37:49.947124 [debug] [ThreadPool]: On list_db: Close
[0m19:37:49.951333 [debug] [ThreadPool]: On list_db: Close
[0m19:37:49.959647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m19:37:49.960561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m19:37:49.962428 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m19:37:49.964660 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m19:37:49.977347 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:37:49.981833 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:37:49.983884 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m19:37:49.985881 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m19:37:49.987815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:49.989472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:50.007897 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.008695 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.010780 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:37:50.012920 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:37:50.014725 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m19:37:50.016551 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m19:37:50.020421 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:37:50.021229 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:37:50.023902 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:37:50.027471 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:37:50.029737 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:37:50.031994 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:37:50.033938 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:37:50.035664 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:37:50.041844 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.044141 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.045434 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m19:37:50.047325 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m19:37:50.055800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_staging)
[0m19:37:50.057744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_analytics)
[0m19:37:50.073671 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:37:50.078477 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:37:50.080469 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:37:50.082002 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:37:50.083347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:50.084827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:50.101179 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.104185 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:37:50.106440 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:37:50.107551 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.110234 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:37:50.112189 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:37:50.118021 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:37:50.119708 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:37:50.123741 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:37:50.127008 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:37:50.129519 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:37:50.133557 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:37:50.147682 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:50.153013 [debug] [MainThread]: On master: BEGIN
[0m19:37:50.155398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:50.169903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.171873 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:50.173316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:50.181929 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:37:50.185023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7213735e6110>]}
[0m19:37:50.186990 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:50.189323 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:50.191213 [debug] [MainThread]: On master: BEGIN
[0m19:37:50.193966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.196103 [debug] [MainThread]: On master: COMMIT
[0m19:37:50.197276 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:50.200844 [debug] [MainThread]: On master: COMMIT
[0m19:37:50.204789 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.207835 [debug] [MainThread]: On master: Close
[0m19:37:50.209531 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:37:50.211290 [info ] [MainThread]: 
[0m19:37:50.237428 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:37:50.238949 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:37:50.240350 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:37:50.243283 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:37:50.245857 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:37:50.248184 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:37:50.251223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:37:50.253581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:37:50.256304 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:37:50.258624 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:37:50.263336 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:37:50.265930 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:37:50.279271 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:37:50.283546 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:37:50.289997 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:37:50.299246 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:37:50.301326 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:37:50.309156 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:37:50.368537 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:37:50.370247 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:37:50.375001 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:37:50.383542 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:37:50.384744 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:37:50.386525 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:37:50.387584 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:37:50.388849 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:37:50.390509 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:37:50.392058 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:37:50.393525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:50.396692 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:37:50.410909 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.413366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.416002 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.416831 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:37:50.419002 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:37:50.420803 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:37:50.422646 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:37:50.425167 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:37:50.427885 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:37:50.439535 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:50.442711 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:50.444270 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:50.458754 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:37:50.467710 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:37:50.477447 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:37:50.480385 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:37:50.483711 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:37:50.485040 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:37:50.487428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:50.489261 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:50.491126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:50.510895 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:37:50.513192 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:37:50.516262 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:37:50.518043 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:37:50.519419 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:37:50.520860 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:37:50.522219 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:37:50.523514 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:37:50.525448 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:37:50.530705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.531778 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.533046 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.542678 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:37:50.549289 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:37:50.555580 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:37:50.572351 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:37:50.574594 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:37:50.577468 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:37:50.580731 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:37:50.582711 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:37:50.584225 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:37:50.586555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:50.587796 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:50.590658 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:50.595120 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:37:50.599488 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:37:50.603223 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:37:50.608015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721370b09ed0>]}
[0m19:37:50.610401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7213734b6fd0>]}
[0m19:37:50.612533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7213734f0590>]}
[0m19:37:50.614628 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.35s]
[0m19:37:50.617416 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.35s]
[0m19:37:50.620066 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.36s]
[0m19:37:50.622634 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:37:50.624961 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:37:50.627260 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:37:50.630792 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m19:37:50.634669 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:37:50.638312 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:37:50.639769 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:37:50.642009 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:37:50.646219 [info ] [Thread-3 (]: 6 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:37:50.652457 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m19:37:50.656116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_marketing_attribution)
[0m19:37:50.658697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m19:37:50.660389 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:37:50.662819 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:37:50.667225 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:37:50.676635 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:37:50.683272 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:37:50.688698 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:37:50.700056 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m19:37:50.702277 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:37:50.710211 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:37:50.770805 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:37:50.775954 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:37:50.777704 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:37:50.787049 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:37:50.788426 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:37:50.790679 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:37:50.791756 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:37:50.793445 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:37:50.795465 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:37:50.797815 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:37:50.800407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:50.804409 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:37:50.819591 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.822574 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:37:50.823766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.825597 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:50.826867 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:37:50.829398 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:37:50.831737 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:37:50.836853 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:37:50.839977 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:37:50.859522 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:37:50.862510 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:37:50.870527 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:37:50.878162 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:37:50.885667 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:37:50.896280 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:37:50.897602 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:37:50.899558 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:37:50.901400 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:37:50.905322 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:50.907183 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:50.908968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:50.922095 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:37:50.925335 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:37:50.929153 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:37:50.931221 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:37:50.933003 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:37:50.935134 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:37:50.937416 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:37:50.941070 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:37:50.943720 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:37:50.947740 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.949514 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.954690 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:37:50.955566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:50.962520 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:37:50.970006 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:37:50.976437 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:37:50.979216 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:37:50.980556 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:37:50.982682 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:37:50.984116 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:37:50.987961 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:50.993828 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:37:50.998544 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:51.004645 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:37:51.007593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:51.010236 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m19:37:51.012523 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72137358a810>]}
[0m19:37:51.015574 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:37:51.018246 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7213734a4d90>]}
[0m19:37:51.020711 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.35s]
[0m19:37:51.023212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4946ba7-038f-45d6-95bf-4486887a6d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b57d790>]}
[0m19:37:51.025499 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.37s]
[0m19:37:51.028149 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:37:51.030835 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.37s]
[0m19:37:51.032815 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m19:37:51.036510 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:37:51.044048 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:51.046077 [debug] [MainThread]: On master: BEGIN
[0m19:37:51.048078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:51.069142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:51.071363 [debug] [MainThread]: On master: COMMIT
[0m19:37:51.075817 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:51.078317 [debug] [MainThread]: On master: COMMIT
[0m19:37:51.080273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:51.082045 [debug] [MainThread]: On master: Close
[0m19:37:51.084876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:51.087080 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m19:37:51.088671 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:37:51.090672 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:37:51.096089 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:37:51.098500 [info ] [MainThread]: 
[0m19:37:51.100395 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m19:37:51.107361 [debug] [MainThread]: Command end result
[0m19:37:51.214400 [info ] [MainThread]: 
[0m19:37:51.216692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:51.218839 [info ] [MainThread]: 
[0m19:37:51.221170 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:37:51.224249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9095654, "process_user_time": 4.75821, "process_kernel_time": 0.597525, "process_mem_max_rss": "119132", "process_in_blocks": "25032", "process_out_blocks": "144"}
[0m19:37:51.227138 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:51.226646 after 5.91 seconds
[0m19:37:51.229830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b67fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b67dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72139b7f7610>]}
[0m19:37:51.232471 [debug] [MainThread]: Flushing usage events
[0m19:45:54.273850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e88f1f2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e88f3a4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e88f3a4250>]}


============================== 19:45:54.289104 | d36ff69c-d3fd-4c6c-a959-9f943c7bf447 ==============================
[0m19:45:54.289104 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:45:54.292454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:45:54.523767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd36ff69c-d3fd-4c6c-a959-9f943c7bf447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e88f525510>]}
[0m19:45:55.061739 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qwymjeet'
[0m19:45:55.064818 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:45:55.293930 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:45:55.297555 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:45:55.401101 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:45:55.410145 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:46:01.712314 [info ] [MainThread]: Installed from version 1.3.1
[0m19:46:01.714588 [info ] [MainThread]: Up to date!
[0m19:46:01.716493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd36ff69c-d3fd-4c6c-a959-9f943c7bf447', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e88f263b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e890958350>]}
[0m19:46:01.719793 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.552746, "process_user_time": 2.397043, "process_kernel_time": 0.839153, "process_mem_max_rss": "94828", "process_out_blocks": "1296", "process_in_blocks": "0"}
[0m19:46:01.722059 [debug] [MainThread]: Command `dbt deps` succeeded at 19:46:01.721842 after 7.56 seconds
[0m19:46:01.724355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e88ff07950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e892fdc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e893160c90>]}
[0m19:46:01.726673 [debug] [MainThread]: Flushing usage events
[0m19:46:04.932723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472ea7a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472ec4c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472ea7ac10>]}


============================== 19:46:04.941272 | b7b22af1-4766-4f04-81b4-fa7de447efca ==============================
[0m19:46:04.941272 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:46:04.943923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:46:05.240554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472eaf8350>]}
[0m19:46:05.318121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47327b0e10>]}
[0m19:46:05.321491 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:46:05.391686 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:46:07.109165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:07.110606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:07.162924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472d1990d0>]}
[0m19:46:07.350059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472d0c8ad0>]}
[0m19:46:07.353029 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m19:46:07.354878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472d1a46d0>]}
[0m19:46:07.360445 [info ] [MainThread]: 
[0m19:46:07.363107 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:07.371892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:46:07.374746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:46:07.477928 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:46:07.478498 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:46:07.480387 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:46:07.482252 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:46:07.484836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:07.486718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:07.507871 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:46:07.508712 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:46:07.512413 [debug] [ThreadPool]: On list_db: Close
[0m19:46:07.516410 [debug] [ThreadPool]: On list_db: Close
[0m19:46:07.522192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m19:46:07.522953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m19:46:07.525041 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m19:46:07.527918 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m19:46:07.537718 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:46:07.542170 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:46:07.543982 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m19:46:07.545865 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m19:46:07.547653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:07.549675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:07.567189 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.568094 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.570030 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:46:07.572052 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:46:07.574302 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m19:46:07.576394 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m19:46:07.580412 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:46:07.582461 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:46:07.584797 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:46:07.588454 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:46:07.591008 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:46:07.593725 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:46:07.596029 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:46:07.598995 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:46:07.605174 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:46:07.606908 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:46:07.607706 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m19:46:07.610447 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m19:46:07.618773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_analytics)
[0m19:46:07.620887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_staging)
[0m19:46:07.637546 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:46:07.644345 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:46:07.645492 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:46:07.647820 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:46:07.650104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:07.651459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:07.666288 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.667988 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.668837 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:46:07.670941 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:46:07.673229 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:46:07.675373 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:46:07.685453 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:07.686250 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:07.690749 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:46:07.694659 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:46:07.697352 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:46:07.701034 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:46:07.715262 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:07.717233 [debug] [MainThread]: On master: BEGIN
[0m19:46:07.718687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:07.735996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.738631 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:07.740948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:46:07.749423 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:07.751998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472e992610>]}
[0m19:46:07.753465 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:07.756619 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:07.758770 [debug] [MainThread]: On master: BEGIN
[0m19:46:07.761458 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.763508 [debug] [MainThread]: On master: COMMIT
[0m19:46:07.766791 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:07.770807 [debug] [MainThread]: On master: COMMIT
[0m19:46:07.773480 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:46:07.775888 [debug] [MainThread]: On master: Close
[0m19:46:07.778721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:46:07.780926 [info ] [MainThread]: 
[0m19:46:07.812385 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:46:07.813487 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:46:07.814380 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:46:07.815982 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:46:07.817952 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:46:07.821590 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:46:07.828731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:46:07.831931 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:46:07.833946 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:46:07.835696 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:46:07.838279 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:46:07.840568 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:46:07.857615 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:46:07.865672 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:46:07.870295 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:46:07.879865 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:46:07.881170 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:46:07.891351 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:46:07.964038 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:46:07.965944 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:46:07.968526 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:46:07.979264 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:46:07.980890 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:46:07.982781 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:46:07.983751 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:46:07.985735 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:46:07.987454 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:46:07.989533 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:46:07.992055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:07.994667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:46:08.013527 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:08.015475 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:08.016602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:08.017425 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:46:08.019086 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:46:08.021105 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:46:08.023373 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:46:08.025841 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:46:08.028934 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:46:08.040551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:46:08.041905 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:46:08.042585 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:46:08.055774 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:46:08.065026 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:46:08.073652 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:46:08.076642 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:46:08.078983 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:46:08.080535 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:46:08.084493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:08.087142 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:08.088990 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:08.119039 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:46:08.122569 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:46:08.126184 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:46:08.128635 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:46:08.130876 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:46:08.132587 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:46:08.134027 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:46:08.135393 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:46:08.136643 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:46:08.140348 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:46:08.141446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:46:08.143023 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:46:08.152530 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:46:08.160742 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:46:08.165437 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:46:08.174831 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:46:08.177129 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:46:08.179278 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:46:08.181085 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:46:08.182928 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:46:08.184864 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:46:08.187226 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:46:08.188498 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:46:08.190053 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:46:08.193874 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:46:08.197121 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:46:08.199691 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:46:08.203635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472d1fef90>]}
[0m19:46:08.206034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472c33ff90>]}
[0m19:46:08.689359 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472c33c150>]}
[0m19:46:08.693584 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.37s]
[0m19:46:08.696400 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.38s]
[0m19:46:08.698940 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.86s]
[0m19:46:08.701232 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:46:08.703896 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:46:08.706530 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:46:08.710433 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:46:08.713128 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:46:08.716617 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:46:08.720020 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:46:08.723286 [info ] [Thread-2 (]: 5 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:46:07.059079 [info ] [Thread-1 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:46:07.064667 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_revenue_daily'
[0m19:46:07.073322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m19:46:07.076071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_marketing_attribution)
[0m19:46:07.078445 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:46:07.080753 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:46:07.082614 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:46:07.097222 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:46:07.108412 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:46:07.120101 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:46:07.130218 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:46:07.131093 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:46:07.138688 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:46:07.187839 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:46:07.188960 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:46:07.193783 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:46:07.201968 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:46:07.202847 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:46:07.204841 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:46:07.205750 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:46:07.207398 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:46:07.209079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:07.210489 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:46:07.212041 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:46:07.214917 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:46:07.230010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.232003 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:46:07.233899 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:46:07.238922 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.241155 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.247316 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:46:07.250191 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:46:07.253756 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:46:07.255527 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:07.258287 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:46:07.271526 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:46:07.277951 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:46:07.280600 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:07.281732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:07.296469 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:07.297690 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:46:07.316465 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:46:07.420533 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:46:07.421959 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:46:07.423815 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:46:07.425293 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:46:07.427882 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:07.428516 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:46:07.430168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:07.432189 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:46:07.437127 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:46:07.437766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:46:07.438870 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:46:07.440560 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:46:07.444633 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:46:07.446207 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:46:07.447515 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:46:07.452524 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:46:07.456499 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:46:07.457293 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:46:07.457864 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:46:07.461791 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:46:07.464183 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:46:07.468032 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:46:07.470424 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:46:07.474269 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:46:07.476568 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:46:07.478388 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:46:07.480555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472c3bffd0>]}
[0m19:46:07.485391 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:46:07.488296 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:46:07.489839 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.40s]
[0m19:46:07.493212 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:46:07.496486 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:46:07.499422 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:46:07.503737 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:46:07.506688 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472ceb6310>]}
[0m19:46:07.512254 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b22af1-4766-4f04-81b4-fa7de447efca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b472ceaa7d0>]}
[0m19:46:07.514850 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.44s]
[0m19:46:07.520424 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.44s]
[0m19:46:07.523806 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:46:07.528110 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:46:07.536203 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:07.538492 [debug] [MainThread]: On master: BEGIN
[0m19:46:07.540538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:07.560983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:07.563680 [debug] [MainThread]: On master: COMMIT
[0m19:46:07.566096 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:07.567833 [debug] [MainThread]: On master: COMMIT
[0m19:46:07.570330 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:46:07.572636 [debug] [MainThread]: On master: Close
[0m19:46:07.578172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:07.580295 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:46:07.583114 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:46:07.584839 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m19:46:07.586127 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:46:07.587470 [info ] [MainThread]: 
[0m19:46:07.589555 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m19:46:07.595548 [debug] [MainThread]: Command end result
[0m19:46:07.701175 [info ] [MainThread]: 
[0m19:46:07.703616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:07.705891 [info ] [MainThread]: 
[0m19:46:07.708776 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:46:07.712626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0675483, "process_user_time": 3.317152, "process_kernel_time": 0.525152, "process_mem_max_rss": "114236", "process_out_blocks": "144", "process_in_blocks": "0"}
[0m19:46:07.715634 [debug] [MainThread]: Command `dbt run` succeeded at 19:46:07.715144 after 4.07 seconds
[0m19:46:07.718636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4732898650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4732a1c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4732a1cc90>]}
[0m19:46:07.721491 [debug] [MainThread]: Flushing usage events
[0m20:00:40.620593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782935416750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782935458350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7829354166d0>]}


============================== 20:00:40.660249 | cabec099-e36d-4c16-86d2-e9be240e0e37 ==============================
[0m20:00:40.660249 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:00:40.664019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m20:00:40.846513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cabec099-e36d-4c16-86d2-e9be240e0e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782935497f90>]}
[0m20:00:41.521464 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-oapoqavl'
[0m20:00:41.523748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:00:41.720230 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:00:41.723750 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:00:41.840110 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:00:41.850970 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:00:49.870500 [info ] [MainThread]: Installed from version 1.3.1
[0m20:00:49.873448 [info ] [MainThread]: Up to date!
[0m20:00:49.876875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cabec099-e36d-4c16-86d2-e9be240e0e37', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7829352aa810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782935483210>]}
[0m20:00:49.881676 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 11.94944, "process_user_time": 3.079903, "process_kernel_time": 1.255738, "process_mem_max_rss": "94820", "process_out_blocks": "1296", "process_in_blocks": "0"}
[0m20:00:49.884222 [debug] [MainThread]: Command `dbt deps` succeeded at 20:00:49.883944 after 11.95 seconds
[0m20:00:49.886010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782939240790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78293939c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78293939cd90>]}
[0m20:00:49.887985 [debug] [MainThread]: Flushing usage events
[0m20:00:54.811465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba44a6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba4a63510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba44e02d0>]}


============================== 20:00:54.818190 | 1e6243dd-0ce1-47ef-af47-d6e4287cd422 ==============================
[0m20:00:54.818190 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:00:54.821474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:00:55.325726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba44a5f90>]}
[0m20:00:55.418808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba81a8790>]}
[0m20:00:55.420690 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:00:55.481950 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:00:57.192663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:57.195410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:57.235879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba2ba0850>]}
[0m20:00:57.603925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba2c13a90>]}
[0m20:00:57.607011 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m20:00:57.615853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba45c66d0>]}
[0m20:00:57.623713 [info ] [MainThread]: 
[0m20:00:57.626272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:00:57.636774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:00:57.639188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:00:57.741914 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:00:57.742501 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:00:57.743453 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:00:57.745049 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:00:57.746468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:57.747921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:57.769690 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:00:57.770541 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:00:57.775012 [debug] [ThreadPool]: On list_db: Close
[0m20:00:57.778528 [debug] [ThreadPool]: On list_db: Close
[0m20:00:57.789988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m20:00:57.792033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m20:00:57.809119 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:00:57.817425 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:00:57.823135 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m20:00:57.825206 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m20:00:57.828148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:57.829607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:57.843854 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:00:57.845836 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:00:57.847374 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:00:57.848238 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m20:00:57.850071 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:00:57.853319 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:00:57.857564 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:00:57.861161 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m20:00:57.861984 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:00:57.863845 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m20:00:57.866028 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m20:00:57.870553 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m20:00:57.890464 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.892014 [debug] [MainThread]: On master: BEGIN
[0m20:00:57.893256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:57.912835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:00:57.914351 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.916136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:00:57.968942 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m20:00:57.974822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba43fb6d0>]}
[0m20:00:57.976775 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:57.979471 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.982375 [debug] [MainThread]: On master: BEGIN
[0m20:00:57.985894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:00:57.988783 [debug] [MainThread]: On master: COMMIT
[0m20:00:57.993434 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.995308 [debug] [MainThread]: On master: COMMIT
[0m20:00:57.997812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:00:58.001280 [debug] [MainThread]: On master: Close
[0m20:00:58.002959 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:58.004600 [info ] [MainThread]: 
[0m20:00:58.031030 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m20:00:58.031873 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m20:00:58.032733 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m20:00:58.035512 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m20:00:58.041972 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m20:00:58.045798 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m20:00:58.048727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m20:00:58.051381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m20:00:58.057828 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m20:00:58.060352 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m20:00:58.066614 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m20:00:58.069630 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m20:00:58.086243 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m20:00:58.094293 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m20:00:58.103358 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m20:00:58.118318 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m20:00:58.120389 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m20:00:58.121697 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m20:00:58.236801 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m20:00:58.261515 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m20:00:58.271051 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m20:00:58.323390 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:00:58.325711 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:00:58.331453 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:00:58.335561 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m20:00:58.348265 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m20:00:58.395524 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:00:58.376796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:58.357992 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m20:00:58.442630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:58.458000 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:00:58.465266 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:00:58.470038 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:00:58.473893 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m20:00:58.484550 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:00:58.491155 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m20:00:58.493582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:00:58.500547 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:00:58.501863 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:00:58.518251 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:00:58.526717 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m20:00:58.564270 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:00:58.581344 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:00:58.650722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:00:58.652271 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m20:00:58.710737 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m20:00:58.751206 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:00:58.780816 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:00:58.790052 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:00:58.793829 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:00:58.825267 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:00:58.872254 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:00:58.882338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:00:58.885451 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m20:00:58.889609 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m20:00:58.927364 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:00:58.939458 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:00:58.945527 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:00:58.952880 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:00:59.100692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:00:59.105577 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:00:59.112064 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:00:59.126640 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:00:59.136544 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:00:59.152012 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:00:59.155492 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:00:59.162412 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:00:59.169795 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:00:59.175943 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:00:59.187385 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:00:59.193264 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:00:59.205440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:00:59.257264 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m20:00:59.307264 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m20:00:59.339431 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:00:59.333544 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:00:59.302658 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m20:00:59.343243 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m20:00:59.347017 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m20:00:59.361711 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:00:59.389909 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:00:59.395897 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m20:00:59.398191 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:00:59.413259 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m20:00:59.439189 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m20:00:59.442974 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:00:59.455443 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba2ad5bd0>]}
[0m20:00:59.487167 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba43b7950>]}
[0m20:00:59.541416 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m20:00:59.546237 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 1.40s]
[0m20:00:59.561397 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 1.44s]
[0m20:00:59.566347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba15d6710>]}
[0m20:00:59.578338 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m20:00:59.586173 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m20:00:59.593951 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 1.52s]
[0m20:00:59.604290 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m20:00:59.609911 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m20:00:59.613367 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m20:00:59.617722 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m20:00:59.625982 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m20:00:59.634925 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m20:00:59.644058 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m20:00:59.640502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m20:00:59.637508 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m20:00:59.651960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m20:00:59.659863 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m20:00:59.665455 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m20:00:59.669217 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m20:00:59.703082 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m20:00:59.721173 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m20:00:59.743192 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m20:00:59.771370 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m20:00:59.778319 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m20:00:59.799950 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m20:01:00.054273 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m20:01:00.055653 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m20:01:00.068086 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m20:01:00.119564 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:00.120888 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:00.128801 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:00.131309 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m20:01:00.139373 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m20:01:00.151880 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m20:01:00.180180 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:01:00.173382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:01:00.156469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:00.211175 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:00.223403 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:00.218928 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:00.216792 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:00.228964 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m20:01:00.232375 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:00.234570 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:00.243063 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m20:01:00.247018 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m20:01:00.299142 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m20:01:00.345347 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:00.347285 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m20:01:00.359781 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:00.692843 [debug] [Thread-3 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m20:01:00.694323 [debug] [Thread-4 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m20:01:00.703184 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:00.721375 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:00.742280 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:00.746246 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m20:01:00.751510 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m20:01:00.757058 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m20:01:00.763388 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:00.766816 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:00.775672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:00.808653 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:01:00.849147 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:00.851346 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:00.858003 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:00.862095 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m20:01:00.864367 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m20:01:00.866412 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:01:00.873817 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:00.879106 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:00.882357 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:00.891314 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:01:00.896113 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:01:00.907826 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m20:01:00.910827 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:00.913236 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:00.928890 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:00.931210 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:01:00.938918 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:01:00.941942 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m20:01:00.950389 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:00.958654 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:00.969153 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:01:00.973987 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m20:01:00.987239 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m20:01:00.993430 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m20:01:00.997669 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:01.002693 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:01.009466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba29a8890>]}
[0m20:01:01.018397 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m20:01:01.022542 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m20:01:01.030096 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 1.36s]
[0m20:01:01.051156 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:01:01.066080 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m20:01:01.067082 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:01:01.075978 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m20:01:01.097056 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m20:01:01.106090 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba2ad5110>]}
[0m20:01:01.111642 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6243dd-0ce1-47ef-af47-d6e4287cd422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba2ad48d0>]}
[0m20:01:01.132062 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4336[0m in 1.47s]
[0m20:01:01.157154 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5698[0m in 1.47s]
[0m20:01:01.197131 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m20:01:01.216197 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m20:01:01.234545 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:01.236697 [debug] [MainThread]: On master: BEGIN
[0m20:01:01.239262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:01.268744 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:01:01.271261 [debug] [MainThread]: On master: COMMIT
[0m20:01:01.274085 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:01.276558 [debug] [MainThread]: On master: COMMIT
[0m20:01:01.279441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:01:01.282187 [debug] [MainThread]: On master: Close
[0m20:01:01.285624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:01.296966 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m20:01:01.301303 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m20:01:01.303954 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m20:01:01.305918 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m20:01:01.311583 [info ] [MainThread]: 
[0m20:01:01.317467 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m20:01:01.324437 [debug] [MainThread]: Command end result
[0m20:01:01.523250 [info ] [MainThread]: 
[0m20:01:01.526224 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:01.533112 [info ] [MainThread]: 
[0m20:01:01.539439 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:01:01.547511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8755527, "process_user_time": 5.537435, "process_kernel_time": 0.889141, "process_mem_max_rss": "114936", "process_out_blocks": "144", "process_in_blocks": "0"}
[0m20:01:01.555038 [debug] [MainThread]: Command `dbt run` succeeded at 20:01:01.554505 after 6.88 seconds
[0m20:01:01.558521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba82906d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba8414390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ba8414cd0>]}
[0m20:01:01.561246 [debug] [MainThread]: Flushing usage events
[0m20:01:08.027739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b90d4b2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b90d4b2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b90d4b2710>]}


============================== 20:01:08.035639 | 5a5e854d-7b3c-4bdc-bb11-e71eb557d886 ==============================
[0m20:01:08.035639 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:01:08.038763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:01:08.210786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a5e854d-7b3c-4bdc-bb11-e71eb557d886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b90d374290>]}
[0m20:01:08.830927 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1qk7l57c'
[0m20:01:08.832757 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:01:08.922482 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:01:08.926560 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:01:09.022842 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:01:09.032645 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:01:14.995279 [info ] [MainThread]: Installed from version 1.3.1
[0m20:01:14.997768 [info ] [MainThread]: Up to date!
[0m20:01:15.002221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a5e854d-7b3c-4bdc-bb11-e71eb557d886', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b90d356b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b90d523750>]}
[0m20:01:15.006370 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.9694934, "process_user_time": 2.435541, "process_kernel_time": 0.739767, "process_mem_max_rss": "94708", "process_in_blocks": "16", "process_out_blocks": "168"}
[0m20:01:15.009303 [debug] [MainThread]: Command `dbt deps` succeeded at 20:01:15.008869 after 7.97 seconds
[0m20:01:15.011204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b90d25acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9112b8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b91143ced0>]}
[0m20:01:15.012845 [debug] [MainThread]: Flushing usage events
[0m20:01:20.936866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a249e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a3126090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a24c7bd0>]}


============================== 20:01:20.941708 | 7ea13914-85a5-44fd-9802-7ff88c52f438 ==============================
[0m20:01:20.941708 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:01:20.944058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:01:21.257713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a24ecbd0>]}
[0m20:01:21.347580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a61e4e10>]}
[0m20:01:21.350800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:01:21.419630 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:01:23.447939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:23.452762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:23.541818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a24c4f10>]}
[0m20:01:23.824214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a06c8ed0>]}
[0m20:01:23.826577 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m20:01:23.840071 [info ] [MainThread]: 
[0m20:01:23.843277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:01:23.857531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:01:23.859337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:01:23.976741 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:01:23.977728 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:01:23.981180 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:01:23.985797 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:01:23.988091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:23.992985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:24.026101 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:01:24.028656 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:01:24.033073 [debug] [ThreadPool]: On list_db: Close
[0m20:01:24.038198 [debug] [ThreadPool]: On list_db: Close
[0m20:01:24.047061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m20:01:24.049228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m20:01:24.065458 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:01:24.071538 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:01:24.073691 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m20:01:24.075291 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m20:01:24.079354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:24.082155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:24.104850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:01:24.113503 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:01:24.116337 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:01:24.120816 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:01:24.128683 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:01:24.131301 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m20:01:24.150207 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:01:24.164865 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m20:01:24.167550 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:01:24.182270 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m20:01:24.184267 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m20:01:24.188274 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m20:01:24.249549 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:24.253093 [debug] [MainThread]: On master: BEGIN
[0m20:01:24.255150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:24.274530 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:01:24.277968 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:24.281174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:01:24.331335 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m20:01:24.336110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78609f2b9550>]}
[0m20:01:24.339829 [debug] [MainThread]: On master: ROLLBACK
[0m20:01:24.343105 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:24.344777 [debug] [MainThread]: On master: BEGIN
[0m20:01:24.346968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:01:24.351188 [debug] [MainThread]: On master: COMMIT
[0m20:01:24.353129 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:24.354857 [debug] [MainThread]: On master: COMMIT
[0m20:01:24.356619 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:01:24.359125 [debug] [MainThread]: On master: Close
[0m20:01:24.360918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:01:24.365286 [info ] [MainThread]: 
[0m20:01:24.375618 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m20:01:24.376757 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m20:01:24.377413 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m20:01:24.379044 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m20:01:24.381699 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m20:01:24.385958 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m20:01:24.388889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m20:01:24.390749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m20:01:24.393754 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m20:01:24.395850 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m20:01:24.397474 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m20:01:24.399073 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m20:01:24.414030 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m20:01:24.421567 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m20:01:24.426151 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m20:01:24.435280 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m20:01:24.437086 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m20:01:24.444313 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m20:01:24.552722 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m20:01:24.554209 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m20:01:24.561898 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m20:01:24.573023 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:01:24.575403 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:01:24.576678 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m20:01:24.577342 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:01:24.578876 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m20:01:24.580543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:24.583397 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m20:01:24.586030 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:01:24.590594 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:24.606539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:24.616638 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:24.623849 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:01:24.629289 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:01:24.634863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:24.642910 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m20:01:24.649735 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m20:01:24.658738 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:01:24.672009 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:01:24.680870 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m20:01:24.682330 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:01:24.726994 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:01:24.744743 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:01:24.761805 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:01:24.766661 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:01:24.798963 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:01:24.800335 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m20:01:24.829299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:24.832346 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m20:01:24.881146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:24.923703 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:01:24.939911 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:24.944249 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:01:24.951146 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:01:24.963941 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:01:24.972610 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m20:01:24.991284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:25.000852 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m20:01:25.006822 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:25.056670 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:25.126926 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:01:25.128810 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:01:25.153623 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:01:25.164994 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:01:25.172503 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:01:25.175358 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:01:25.182903 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:01:25.191183 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:01:25.194391 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:01:25.207915 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:25.209222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:25.217798 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:25.246012 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m20:01:25.264084 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m20:01:25.281792 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m20:01:25.298483 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:01:25.300631 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:01:25.305125 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:01:25.307977 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m20:01:25.309668 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m20:01:25.311562 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m20:01:25.323895 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:01:25.326549 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:01:25.334496 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:01:25.331040 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m20:01:25.338310 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m20:01:25.342271 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m20:01:25.349429 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a24c7b10>]}
[0m20:01:25.353384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a06c7690>]}
[0m20:01:25.356158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a24c7ad0>]}
[0m20:01:25.359143 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.95s]
[0m20:01:25.364260 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.96s]
[0m20:01:25.367119 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.97s]
[0m20:01:25.372095 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m20:01:25.374614 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m20:01:25.376486 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m20:01:25.383661 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:01:25.385366 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:01:25.390168 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:01:25.392757 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:01:25.394743 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m20:01:25.400379 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m20:01:25.402693 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m20:01:25.405778 [info ] [Thread-2 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m20:01:25.408923 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m20:01:25.411137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m20:01:25.413369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m20:01:25.416530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m20:01:25.418804 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:01:25.420763 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:01:25.422519 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:01:25.425466 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:01:25.494156 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:01:25.504810 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:01:25.869062 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:01:25.878075 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:01:25.906803 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:01:25.934571 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:01:25.937149 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:01:25.938830 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:01:25.946477 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:01:25.948379 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:01:25.952697 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:01:25.958522 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:01:25.979125 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:01:25.980310 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:01:25.982136 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m20:01:25.985157 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:01:25.986075 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m20:01:25.988103 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:01:25.990020 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:01:25.990850 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m20:01:25.993435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:25.997601 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m20:01:26.000012 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:26.007319 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:01:26.012191 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.022052 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:01:26.024844 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m20:01:26.027481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.038507 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.040164 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.044624 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.045951 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:01:26.050767 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:01:26.052727 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:01:26.062401 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m20:01:26.064270 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:01:26.067031 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m20:01:26.069105 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m20:01:26.071050 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m20:01:26.076644 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.081513 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.67s]
[0m20:01:26.088538 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m20:01:26.090282 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:01:26.093528 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m20:01:26.095277 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:01:26.097248 [info ] [Thread-2 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.68s]
[0m20:01:26.098691 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m20:01:26.100006 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.103937 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:01:26.105777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:01:26.108750 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m20:01:26.110582 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.111988 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:01:26.113859 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:01:26.115916 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m20:01:26.117887 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m20:01:26.120048 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m20:01:26.130114 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:01:26.132364 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.72s]
[0m20:01:26.134272 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m20:01:26.135830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m20:01:26.140825 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:01:26.143512 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.73s]
[0m20:01:26.146167 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:01:26.149906 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:01:26.152126 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:01:26.160836 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:01:26.162548 [info ] [Thread-4 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m20:01:26.164774 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:01:26.168424 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:01:26.170309 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m20:01:26.172435 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m20:01:26.178924 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:01:26.180920 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:01:26.182737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m20:01:26.198763 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:01:26.200921 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:01:26.205009 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:01:26.225343 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:01:26.234887 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:01:26.234158 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:01:26.238225 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m20:01:26.244493 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:01:26.247998 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:01:26.260286 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:01:26.269716 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.274265 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:01:26.280972 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:01:26.291153 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:01:26.293465 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:01:26.294860 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:01:26.299795 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m20:01:26.301729 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.302922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:26.309752 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m20:01:26.314685 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:01:26.316429 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m20:01:26.318375 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m20:01:26.321524 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.22s]
[0m20:01:26.325051 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:01:26.328524 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:01:26.329608 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.331157 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:01:26.334660 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m20:01:26.336780 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:01:26.339689 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:01:26.342342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:26.343924 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:01:26.345358 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m20:01:26.348495 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.351283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m20:01:26.353027 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:01:26.354188 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.355083 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:01:26.357093 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m20:01:26.360846 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m20:01:26.362391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.370285 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:01:26.373823 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m20:01:26.375315 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:01:26.379655 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.378959 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.24s]
[0m20:01:26.383237 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m20:01:26.388316 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m20:01:26.390748 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:01:26.393711 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m20:01:26.395787 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m20:01:26.396780 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.399279 [info ] [Thread-4 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.23s]
[0m20:01:26.404809 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m20:01:26.409762 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m20:01:26.410733 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:01:26.412190 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:01:26.414293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_marketing_attribution)
[0m20:01:26.416464 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m20:01:26.420769 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:01:26.422804 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m20:01:26.424466 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m20:01:26.426352 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.24s]
[0m20:01:26.429482 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m20:01:26.436370 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.438136 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:01:26.439491 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m20:01:26.444172 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m20:01:26.450440 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m20:01:26.453022 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m20:01:26.473313 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:01:26.499519 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.500207 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m20:01:26.500690 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m20:01:26.503324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:01:26.512829 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m20:01:26.518669 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.521096 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m20:01:26.522241 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:26.523869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:26.525199 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m20:01:26.528585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:01:26.530343 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.534117 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:01:26.537866 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:01:26.541792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.544209 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.548361 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.549468 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m20:01:26.552331 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:26.557331 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.561609 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m20:01:26.565204 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m20:01:26.568046 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m20:01:26.570579 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.22s]
[0m20:01:26.573451 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:01:26.576010 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m20:01:26.582411 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m20:01:26.581565 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m20:01:26.589073 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:26.590621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m20:01:26.592357 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m20:01:26.595708 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m20:01:26.600100 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:26.604498 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.614843 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:26.618961 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m20:01:26.621338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:26.633018 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:01:26.635218 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:26.636492 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m20:01:26.637546 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:01:26.645489 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.649915 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:26.655174 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m20:01:26.668011 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:01:26.668698 [debug] [Thread-2 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m20:01:26.670479 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m20:01:26.671574 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.678265 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.686209 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m20:01:26.691925 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m20:01:26.694879 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:01:26.698124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:26.702674 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:26.705569 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m20:01:26.717128 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.721814 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78609f28fd50>]}
[0m20:01:26.723681 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m20:01:26.726573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.728569 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.28s]
[0m20:01:26.731296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:26.733763 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.736284 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m20:01:26.740004 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:01:26.741455 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m20:01:26.744182 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.746133 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:01:26.749836 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:26.758431 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m20:01:26.762152 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:01:26.763687 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m20:01:26.769656 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:01:26.773114 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m20:01:26.775132 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a0acd6d0>]}
[0m20:01:26.779795 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.36s]
[0m20:01:26.782014 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m20:01:26.784408 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:01:26.785675 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m20:01:26.787132 [debug] [Thread-1 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m20:01:26.788191 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m20:01:26.793855 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.795196 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:01:26.796634 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m20:01:26.806669 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:01:26.809147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:26.814602 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.816182 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m20:01:26.819174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:01:26.822426 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:01:26.824003 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.825260 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:01:26.832747 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:01:26.837761 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:01:26.838354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:01:26.844363 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m20:01:26.847011 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:01:26.848754 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m20:01:26.853912 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:01:26.858013 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m20:01:26.860211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea13914-85a5-44fd-9802-7ff88c52f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78609f45ba90>]}
[0m20:01:26.863272 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.27s]
[0m20:01:26.866634 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m20:01:26.867805 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:01:26.870758 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:01:26.872372 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m20:01:26.874085 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m20:01:26.875908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:01:26.877627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m20:01:26.881529 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:01:26.891953 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:01:26.896225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.898236 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:01:26.900308 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m20:01:26.904724 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.908642 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m20:01:26.910616 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m20:01:26.912292 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.12s]
[0m20:01:26.914248 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:01:26.918988 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:01:26.923668 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:01:26.945716 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:01:26.947164 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m20:01:26.948225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:26.961003 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.963346 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:01:26.965212 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m20:01:26.969114 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:01:26.972642 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m20:01:26.974114 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m20:01:26.975492 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.10s]
[0m20:01:26.977553 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:01:26.982313 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:26.983649 [debug] [MainThread]: On master: BEGIN
[0m20:01:26.984784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:26.997640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:01:26.999899 [debug] [MainThread]: On master: COMMIT
[0m20:01:27.001513 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:27.002915 [debug] [MainThread]: On master: COMMIT
[0m20:01:27.004828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:01:27.006290 [debug] [MainThread]: On master: Close
[0m20:01:27.007790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:27.009504 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m20:01:27.010955 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m20:01:27.012560 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m20:01:27.013712 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m20:01:27.015279 [info ] [MainThread]: 
[0m20:01:27.016979 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m20:01:27.023524 [debug] [MainThread]: Command end result
[0m20:01:27.110399 [info ] [MainThread]: 
[0m20:01:27.112399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:27.114299 [info ] [MainThread]: 
[0m20:01:27.116749 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m20:01:27.120580 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.294665, "process_user_time": 4.896073, "process_kernel_time": 0.836098, "process_mem_max_rss": "117032", "process_in_blocks": "2648", "process_out_blocks": "0"}
[0m20:01:27.122959 [debug] [MainThread]: Command `dbt build` succeeded at 20:01:27.122793 after 6.30 seconds
[0m20:01:27.124577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a39faf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a2667f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860a62d4950>]}
[0m20:01:27.126445 [debug] [MainThread]: Flushing usage events
[0m20:15:02.848668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a387f8e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a387f8d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a387fd3210>]}


============================== 20:15:02.854945 | 5979a6d4-edda-4120-846a-81aafdf2d12a ==============================
[0m20:15:02.854945 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:15:02.856820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:15:02.989611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5979a6d4-edda-4120-846a-81aafdf2d12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a387eae910>]}
[0m20:15:03.514114 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ifeae9nv'
[0m20:15:03.516306 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:15:03.725375 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:15:03.729331 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:15:03.822046 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:15:03.831618 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:15:09.817398 [info ] [MainThread]: Installed from version 1.3.1
[0m20:15:09.818994 [info ] [MainThread]: Up to date!
[0m20:15:09.820714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5979a6d4-edda-4120-846a-81aafdf2d12a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a3896f4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a387e8e750>]}
[0m20:15:09.823282 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.0762744, "process_user_time": 1.77862, "process_kernel_time": 0.585123, "process_mem_max_rss": "94700", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m20:15:09.825737 [debug] [MainThread]: Command `dbt deps` succeeded at 20:15:09.825302 after 7.08 seconds
[0m20:15:09.827346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a387fb7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a387fdc090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a38bd786d0>]}
[0m20:15:09.828826 [debug] [MainThread]: Flushing usage events
[0m20:15:13.849723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff7881e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff789dfb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff789dfa90>]}


============================== 20:15:13.855824 | 42930cda-b664-4b73-8343-91b8c4435f45 ==============================
[0m20:15:13.855824 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:15:13.858181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:15:14.129120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff78757cd0>]}
[0m20:15:14.197332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff7c53cf50>]}
[0m20:15:14.199233 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:15:14.255817 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:15:15.943045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:15.944329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:15.991714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff7886c490>]}
[0m20:15:16.197665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff76a2d250>]}
[0m20:15:16.200037 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m20:15:16.207203 [info ] [MainThread]: 
[0m20:15:16.210170 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:15:16.217323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:15:16.218373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:15:16.275215 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:15:16.275778 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:15:16.277649 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:15:16.279441 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:15:16.281668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:16.283359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:16.300283 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:15:16.300789 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:15:16.303111 [debug] [ThreadPool]: On list_db: Close
[0m20:15:16.305637 [debug] [ThreadPool]: On list_db: Close
[0m20:15:16.313067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m20:15:16.314500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m20:15:16.322293 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:15:16.326283 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:15:16.328290 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m20:15:16.330381 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m20:15:16.332090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:16.333727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:16.347046 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:15:16.349131 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:15:16.350022 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:15:16.351853 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:15:16.354071 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:15:16.356100 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m20:15:16.365176 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:15:16.365957 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:15:16.369188 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m20:15:16.371965 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m20:15:16.373921 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m20:15:16.375011 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m20:15:16.386385 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.388276 [debug] [MainThread]: On master: BEGIN
[0m20:15:16.390586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:16.403510 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:15:16.405395 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.407122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:15:16.440653 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m20:15:16.443785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff787a9710>]}
[0m20:15:16.446071 [debug] [MainThread]: On master: ROLLBACK
[0m20:15:16.448346 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.450238 [debug] [MainThread]: On master: BEGIN
[0m20:15:16.452965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:15:16.455207 [debug] [MainThread]: On master: COMMIT
[0m20:15:16.457690 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:16.459410 [debug] [MainThread]: On master: COMMIT
[0m20:15:16.461621 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:15:16.463742 [debug] [MainThread]: On master: Close
[0m20:15:16.466302 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:15:16.469471 [info ] [MainThread]: 
[0m20:15:16.476993 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m20:15:16.477840 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m20:15:16.478469 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m20:15:16.480774 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m20:15:16.483659 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m20:15:16.487627 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m20:15:16.491311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m20:15:16.494122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m20:15:16.497153 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m20:15:16.500291 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m20:15:16.502466 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m20:15:16.504983 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m20:15:16.522755 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m20:15:16.533029 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m20:15:16.536561 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m20:15:16.546378 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m20:15:16.548148 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m20:15:16.555321 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m20:15:16.614147 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m20:15:16.615354 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m20:15:16.620476 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m20:15:16.635517 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:15:16.638203 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:15:16.639009 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m20:15:16.639881 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:15:16.641291 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m20:15:16.642544 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:15:16.643725 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m20:15:16.645302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:16.648819 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:16.660757 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:16.662848 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:15:16.664876 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m20:15:16.665817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:16.666670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:16.669589 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:15:16.671208 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:15:16.673051 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m20:15:16.674742 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:15:16.675734 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m20:15:16.685002 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:15:16.689118 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:15:16.695873 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:15:16.696512 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:15:16.697848 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m20:15:16.699491 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:15:16.707291 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:15:16.710154 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:16.711593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:16.712530 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m20:15:16.717337 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:15:16.722587 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:15:16.725759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:16.726289 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m20:15:16.728054 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:15:16.732742 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:15:16.734842 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:16.738063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:16.739199 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m20:15:16.760839 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:15:16.762506 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:15:16.765521 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:16.766022 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:15:16.767458 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:15:16.770575 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:15:16.772022 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:15:16.773987 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:15:16.775619 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:15:16.780118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:16.780810 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:15:16.781310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:16.791031 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m20:15:16.796691 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m20:15:16.797237 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:16.805372 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:15:16.806950 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:15:16.811096 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m20:15:16.812970 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m20:15:16.814549 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m20:15:16.816305 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:15:16.820899 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m20:15:16.821925 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:15:16.823524 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:15:16.827985 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m20:15:16.828835 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:15:16.831348 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m20:15:16.834137 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff7574d510>]}
[0m20:15:16.838041 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m20:15:16.840654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff78862690>]}
[0m20:15:16.842250 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.34s]
[0m20:15:16.845050 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff76a6d510>]}
[0m20:15:16.847202 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.35s]
[0m20:15:16.849714 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m20:15:16.852072 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.35s]
[0m20:15:16.853706 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m20:15:16.856967 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:15:16.857453 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:15:16.858589 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m20:15:16.860014 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:15:16.861864 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m20:15:16.863686 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m20:15:16.866027 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:15:16.868209 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m20:15:16.870383 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m20:15:16.872577 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m20:15:16.875152 [info ] [Thread-2 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m20:15:16.877269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m20:15:16.879786 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:15:16.881430 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:15:16.883336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m20:15:16.885025 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:15:16.903573 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:15:16.913372 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:15:16.914917 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:15:16.925440 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:15:16.998088 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:15:17.000881 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:15:17.001959 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:15:17.010469 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:15:17.023823 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:15:17.028861 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:15:17.029743 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:15:17.034427 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:15:17.042933 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:15:17.051402 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:15:17.052477 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:15:17.054075 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m20:15:17.055403 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:15:17.056549 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:15:17.057961 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m20:15:17.059815 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:17.061375 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m20:15:17.063008 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m20:15:17.065081 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:15:17.068985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:17.071549 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:17.082326 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.084315 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:15:17.085968 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m20:15:17.087996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.090918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.092085 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.093835 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:15:17.095699 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.096545 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:15:17.105475 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m20:15:17.107845 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m20:15:17.110588 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:15:17.114477 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:17.118826 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m20:15:17.122275 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m20:15:17.126290 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.25s]
[0m20:15:17.131862 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:15:17.133053 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.134398 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:17.138350 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m20:15:17.140279 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m20:15:17.142435 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m20:15:17.145359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:15:17.148305 [info ] [Thread-2 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.26s]
[0m20:15:17.150434 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:17.152912 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:15:17.153749 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.162567 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:15:17.163073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.164139 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:15:17.167193 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m20:15:17.171290 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m20:15:17.172749 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m20:15:17.174592 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m20:15:17.176532 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m20:15:17.178297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m20:15:17.181868 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:17.180961 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.31s]
[0m20:15:17.183462 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.31s]
[0m20:15:17.185188 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:15:17.189743 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:15:17.191387 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:15:17.193078 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:15:17.199000 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:15:17.201738 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:15:17.203515 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:17.206658 [info ] [Thread-4 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m20:15:17.208140 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m20:15:17.210518 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m20:15:17.213425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m20:15:17.214715 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:15:17.216612 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:15:17.218607 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:15:17.219758 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:17.221676 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m20:15:17.230018 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:15:17.235604 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:15:17.241275 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:15:17.242568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:17.251202 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:15:17.257331 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:15:17.258352 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:17.260118 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:15:17.261759 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.267227 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:15:17.269373 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m20:15:17.270970 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:15:17.272093 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:15:17.275559 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:17.277460 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m20:15:17.279820 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:15:17.283652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:17.289265 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:15:17.289978 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.291517 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m20:15:17.295144 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m20:15:17.297023 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.298139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:17.300987 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m20:15:17.302668 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:15:17.303673 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.307585 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.16s]
[0m20:15:17.311652 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:17.313958 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:15:17.316597 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:17.321219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.322541 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.324590 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m20:15:17.326988 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:15:17.329145 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:15:17.334276 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m20:15:17.337833 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m20:15:17.339938 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m20:15:17.343255 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m20:15:17.345209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m20:15:17.346797 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.350274 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.17s]
[0m20:15:17.351189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.354716 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:15:17.358664 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m20:15:17.361057 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:15:17.363666 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m20:15:17.370852 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:15:17.372717 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m20:15:17.373746 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m20:15:17.375729 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m20:15:17.378555 [info ] [Thread-4 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.17s]
[0m20:15:17.380458 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m20:15:17.384640 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.17s]
[0m20:15:17.387207 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:15:17.389182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_marketing_attribution)
[0m20:15:17.391071 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:15:17.392082 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:17.394004 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m20:15:17.395645 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m20:15:17.400446 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:15:17.403586 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m20:15:17.408894 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.411827 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m20:15:17.414857 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m20:15:17.420560 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m20:15:17.424309 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:15:17.426400 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m20:15:17.427958 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:17.428879 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m20:15:17.429932 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m20:15:17.473559 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.475134 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m20:15:17.475686 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.478743 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:15:17.480411 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:17.483824 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.486603 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m20:15:17.487365 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:15:17.488829 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:17.490211 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m20:15:17.492967 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:17.494417 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.499343 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m20:15:17.502201 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m20:15:17.504227 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.16s]
[0m20:15:17.506379 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.508545 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:15:17.510339 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.511305 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.514240 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m20:15:17.515588 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:15:17.517570 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m20:15:17.519924 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m20:15:17.522029 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m20:15:17.529862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m20:15:17.533419 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m20:15:17.542054 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.546273 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m20:15:17.553217 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:15:17.555706 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m20:15:17.557569 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m20:15:17.560410 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:17.567061 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.574241 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:15:17.577152 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m20:15:17.579719 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:17.588302 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:15:17.590307 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:15:17.591622 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.592538 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:15:17.594275 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m20:15:17.596388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:17.603802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:17.610750 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m20:15:17.612107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.620223 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:15:17.621208 [debug] [Thread-2 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m20:15:17.622001 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.623200 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m20:15:17.627770 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.629356 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m20:15:17.631427 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m20:15:17.634518 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:17.640835 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.641415 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:15:17.642875 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m20:15:17.645515 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m20:15:17.647141 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:17.648163 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff7454d990>]}
[0m20:15:17.651815 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:15:17.654090 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.24s]
[0m20:15:17.656627 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.658832 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m20:15:17.660919 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:15:17.667428 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:17.672884 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m20:15:17.673487 [debug] [Thread-1 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m20:15:17.674843 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:15:17.679539 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.681213 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m20:15:17.682333 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m20:15:17.684742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:17.690515 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.692430 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m20:15:17.693162 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:15:17.694756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:17.696265 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m20:15:17.699183 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:15:17.700866 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff756ae950>]}
[0m20:15:17.701891 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.703327 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.31s]
[0m20:15:17.704768 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:15:17.707372 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m20:15:17.710826 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:15:17.711494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:17.712548 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m20:15:17.719804 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m20:15:17.721175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m20:15:17.723788 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:15:17.725867 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:15:17.727233 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m20:15:17.733699 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:15:17.740436 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:15:17.743875 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m20:15:17.746005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42930cda-b664-4b73-8343-91b8c4435f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff75790090>]}
[0m20:15:17.747469 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:15:17.749167 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.22s]
[0m20:15:17.755517 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:15:17.758137 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m20:15:17.761744 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:15:17.763287 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m20:15:17.765354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m20:15:17.767359 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:15:17.775479 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:15:17.779650 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:15:17.781749 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m20:15:17.783048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:17.789455 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:15:17.795086 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:15:17.800277 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.802555 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:15:17.803948 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m20:15:17.808027 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.809023 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:15:17.812030 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m20:15:17.813884 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m20:15:17.815807 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m20:15:17.817046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:17.819153 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.10s]
[0m20:15:17.822520 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:15:17.834240 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.836232 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:15:17.837887 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m20:15:17.842776 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:15:17.846569 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m20:15:17.848346 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m20:15:17.850054 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.08s]
[0m20:15:17.851868 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:15:17.857102 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:17.858683 [debug] [MainThread]: On master: BEGIN
[0m20:15:17.859961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:17.873159 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:15:17.875075 [debug] [MainThread]: On master: COMMIT
[0m20:15:17.877619 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:17.879486 [debug] [MainThread]: On master: COMMIT
[0m20:15:17.881956 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:15:17.883653 [debug] [MainThread]: On master: Close
[0m20:15:17.885407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:17.886764 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m20:15:17.888296 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m20:15:17.889998 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m20:15:17.891271 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m20:15:17.894114 [info ] [MainThread]: 
[0m20:15:17.895505 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m20:15:17.900875 [debug] [MainThread]: Command end result
[0m20:15:17.992541 [info ] [MainThread]: 
[0m20:15:17.994824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:17.996515 [info ] [MainThread]: 
[0m20:15:17.998274 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m20:15:18.001336 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.2521386, "process_user_time": 3.085744, "process_kernel_time": 0.493867, "process_mem_max_rss": "116920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:15:18.003236 [debug] [MainThread]: Command `dbt build` succeeded at 20:15:18.003052 after 4.25 seconds
[0m20:15:18.004844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff7c624810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff788f0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ff7c71bc50>]}
[0m20:15:18.006324 [debug] [MainThread]: Flushing usage events
[0m20:30:06.408078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210bd00e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210bd00e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210bd052950>]}


============================== 20:30:06.413165 | a9f59cc7-db2d-456c-993a-2b9ebe4a605d ==============================
[0m20:30:06.413165 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:30:06.415472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:30:06.545912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9f59cc7-db2d-456c-993a-2b9ebe4a605d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210bcf1ed90>]}
[0m20:30:07.025817 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9mmntmt2'
[0m20:30:07.027749 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:30:07.229109 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:30:07.232272 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:30:07.330962 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:30:07.341011 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:30:12.615220 [info ] [MainThread]: Installed from version 1.3.1
[0m20:30:12.617085 [info ] [MainThread]: Up to date!
[0m20:30:12.619476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a9f59cc7-db2d-456c-993a-2b9ebe4a605d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210be511c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210bcf0d190>]}
[0m20:30:12.622743 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.097011, "process_user_time": 1.588353, "process_kernel_time": 0.599877, "process_mem_max_rss": "94656", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m20:30:12.624592 [debug] [MainThread]: Command `dbt deps` succeeded at 20:30:12.624368 after 7.10 seconds
[0m20:30:12.626311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210bd05ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210bd05c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210c0e447d0>]}
[0m20:30:12.627889 [debug] [MainThread]: Flushing usage events
[0m20:30:16.715546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f95294550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f9536c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f95853710>]}


============================== 20:30:16.721628 | 10da267c-64fe-463d-8a85-698392c7521a ==============================
[0m20:30:16.721628 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:30:16.723669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:30:16.971813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f93954750>]}
[0m20:30:17.044406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f98f98c50>]}
[0m20:30:17.046602 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:30:17.101945 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:30:18.500680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:18.502339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:18.542375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f939b8f50>]}
[0m20:30:18.731402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f934a4b50>]}
[0m20:30:18.733641 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m20:30:18.740452 [info ] [MainThread]: 
[0m20:30:18.742941 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:18.752302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:30:18.753751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:30:18.822362 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:30:18.823233 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:30:18.824673 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:30:18.826798 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:30:18.828802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:18.830912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:18.848635 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:30:18.849274 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:30:18.851982 [debug] [ThreadPool]: On list_db: Close
[0m20:30:18.854931 [debug] [ThreadPool]: On list_db: Close
[0m20:30:18.863774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m20:30:18.864968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m20:30:18.873512 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:30:18.876959 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:30:18.879202 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m20:30:18.881118 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m20:30:18.883062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:18.885552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:18.900809 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:30:18.903349 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:30:18.904728 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:30:18.906938 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:30:18.909125 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:30:18.911041 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m20:30:18.920691 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:30:18.921224 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:30:18.924021 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m20:30:18.926950 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m20:30:18.929045 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m20:30:18.930209 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m20:30:18.940888 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:18.942782 [debug] [MainThread]: On master: BEGIN
[0m20:30:18.944328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:18.957822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:18.960028 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:18.962714 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:18.994737 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m20:30:18.997706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f98f6fad0>]}
[0m20:30:18.999526 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:19.001835 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:19.003868 [debug] [MainThread]: On master: BEGIN
[0m20:30:19.006052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.008072 [debug] [MainThread]: On master: COMMIT
[0m20:30:19.010455 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:19.012676 [debug] [MainThread]: On master: COMMIT
[0m20:30:19.015019 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:30:19.016951 [debug] [MainThread]: On master: Close
[0m20:30:19.019526 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:30:19.023976 [info ] [MainThread]: 
[0m20:30:19.031981 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m20:30:19.032812 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m20:30:19.033592 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m20:30:19.035353 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m20:30:19.037651 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m20:30:19.039626 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m20:30:19.041592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m20:30:19.043506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m20:30:19.045041 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m20:30:19.047058 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m20:30:19.049021 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m20:30:19.050936 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m20:30:19.060556 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m20:30:19.065534 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m20:30:19.069828 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m20:30:19.081992 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m20:30:19.083259 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m20:30:19.091189 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m20:30:19.136595 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m20:30:19.137418 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m20:30:19.142834 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m20:30:19.155136 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:30:19.156092 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:30:19.158037 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m20:30:19.159730 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m20:30:19.160216 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:30:19.161961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:19.163408 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:30:19.165119 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m20:30:19.170167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:19.181205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.183144 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:30:19.184068 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.185945 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m20:30:19.187854 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.188801 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:30:19.192147 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:30:19.194139 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m20:30:19.196173 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m20:30:19.197358 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:30:19.213617 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:30:19.214192 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:30:19.214799 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:30:19.217584 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:30:19.224244 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:30:19.233672 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:30:19.237485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:19.240617 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m20:30:19.243946 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m20:30:19.250007 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:30:19.253270 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:19.255212 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:19.256253 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:30:19.261885 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:30:19.267293 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:30:19.271203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:19.272057 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m20:30:19.274104 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m20:30:19.293614 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:30:19.295316 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:19.297354 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:19.298717 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:30:19.302683 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:30:19.305854 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:30:19.308108 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:30:19.310172 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:30:19.312201 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:30:19.315589 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:30:19.316540 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:19.317709 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:30:19.326815 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m20:30:19.327432 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:19.337281 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:30:19.337775 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:19.341639 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m20:30:19.343763 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m20:30:19.348041 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m20:30:19.350277 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:30:19.354263 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:30:19.356764 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m20:30:19.357609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:30:19.359810 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m20:30:19.366815 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m20:30:19.367342 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:30:19.372371 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:30:19.374745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f7b7241d0>]}
[0m20:30:19.379178 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m20:30:19.382271 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m20:30:19.384701 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.33s]
[0m20:30:19.390942 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f7b751f50>]}
[0m20:30:19.392816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f921d8fd0>]}
[0m20:30:19.397485 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m20:30:19.399928 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.35s]
[0m20:30:19.402929 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.35s]
[0m20:30:19.406910 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:30:19.407845 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:30:19.409602 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m20:30:19.411815 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m20:30:19.413624 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m20:30:19.415317 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m20:30:19.417477 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:30:19.419801 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:30:19.422192 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m20:30:19.424158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:30:19.425857 [info ] [Thread-3 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m20:30:19.427759 [info ] [Thread-2 (]: 7 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m20:30:19.430075 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:30:19.431716 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:30:19.433891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m20:30:19.435732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m20:30:19.449640 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:30:19.455344 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:30:19.457512 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:30:19.459500 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:30:19.477388 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:30:19.539878 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:30:19.549597 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:30:19.555180 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:30:19.577724 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:30:19.582797 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:30:19.585953 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:30:19.595379 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:30:19.599471 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:30:19.605114 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:30:19.608035 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:30:19.609147 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:30:19.609712 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:30:19.611287 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m20:30:19.613673 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m20:30:19.615600 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m20:30:19.617570 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:30:19.619274 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:30:19.620986 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:30:19.622525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:19.628520 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m20:30:19.632737 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:19.639591 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.641957 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.642969 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:30:19.644349 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:30:19.645387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.647284 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m20:30:19.649329 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:30:19.650183 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.653125 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:30:19.658123 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:30:19.658958 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.660557 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.661188 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:30:19.663114 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m20:30:19.670081 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m20:30:19.674066 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m20:30:19.678497 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.680313 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m20:30:19.682857 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m20:30:19.686558 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m20:30:19.689580 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.27s]
[0m20:30:19.691636 [info ] [Thread-3 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.26s]
[0m20:30:19.693987 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m20:30:19.696087 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:30:19.697760 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:30:19.700189 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.28s]
[0m20:30:19.702370 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:30:19.705367 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:30:19.706331 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.708270 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:30:19.710119 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m20:30:19.712220 [info ] [Thread-3 (]: 9 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m20:30:19.716517 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m20:30:19.719079 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:30:19.721668 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m20:30:19.723746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m20:30:19.726302 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m20:30:19.727520 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m20:30:19.729492 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:30:19.731903 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:30:19.734642 [info ] [Thread-2 (]: 7 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.30s]
[0m20:30:19.736212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m20:30:19.745595 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:30:19.754370 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:30:19.756508 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:30:19.758376 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:30:19.764163 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:30:19.777750 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:30:19.780802 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:30:19.779905 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m20:30:19.781837 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:30:19.790752 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:30:19.793443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m20:30:19.800261 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:30:19.803904 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:30:19.804873 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:30:19.814180 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:30:19.819687 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:30:19.820422 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:30:19.824565 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:30:19.826168 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m20:30:19.828242 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m20:30:19.830163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:30:19.831723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:30:19.835165 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:30:19.836179 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:30:19.841582 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:30:19.844853 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m20:30:19.847847 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.848672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.850172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:19.852098 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:30:19.853817 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:30:19.857327 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:30:19.859389 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m20:30:19.860682 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:30:19.864188 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m20:30:19.865412 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.866849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:19.870139 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m20:30:19.871980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.874943 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m20:30:19.876287 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:30:19.878940 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.16s]
[0m20:30:19.880368 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m20:30:19.883350 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:30:19.886573 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:30:19.888978 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:19.889968 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m20:30:19.891949 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:30:19.894101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m20:30:19.894983 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.896390 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m20:30:19.897895 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:30:19.901168 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m20:30:19.901695 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.909742 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:19.910503 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:30:19.912596 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m20:30:19.914760 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m20:30:19.917331 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m20:30:19.920415 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.18s]
[0m20:30:19.923045 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m20:30:19.924634 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m20:30:19.926178 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:30:19.928416 [info ] [Thread-3 (]: 9 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.20s]
[0m20:30:19.930293 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.14s]
[0m20:30:19.932277 [debug] [Thread-1 (]: Began running node model.api_bi_project.dim_customer
[0m20:30:19.935139 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:30:19.935882 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:30:19.938670 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:30:19.940287 [info ] [Thread-1 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m20:30:19.942373 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m20:30:19.946499 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:30:19.949497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m20:30:19.950996 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m20:30:19.953564 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.dim_customer
[0m20:30:19.955973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now model.api_bi_project.fct_marketing_attribution)
[0m20:30:19.964529 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m20:30:19.966021 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m20:30:19.967501 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:30:19.973668 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m20:30:19.975973 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m20:30:19.979193 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:30:19.981675 [debug] [Thread-1 (]: Began executing node model.api_bi_project.dim_customer
[0m20:30:19.989897 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m20:30:20.008133 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:20.024022 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m20:30:20.026317 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m20:30:20.028235 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:30:20.032213 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:30:20.036642 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:30:20.038151 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:30:20.039460 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m20:30:20.040940 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: BEGIN
[0m20:30:20.042264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:30:20.043716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:20.045768 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:20.050216 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m20:30:20.052244 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m20:30:20.054240 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.16s]
[0m20:30:20.056497 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:30:20.058728 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:20.060096 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m20:30:20.061118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:20.061925 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:30:20.064477 [info ] [Thread-2 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m20:30:20.066315 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:30:20.068495 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m20:30:20.070830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m20:30:20.073300 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m20:30:20.076098 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m20:30:20.082868 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.090234 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m20:30:20.095583 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:30:20.097451 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m20:30:20.099433 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m20:30:20.100047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:20.105740 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.112176 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:30:20.115285 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m20:30:20.118084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:20.127466 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:30:20.129232 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:30:20.130835 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.131509 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:30:20.132968 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m20:30:20.135523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:20.139306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:20.145388 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m20:30:20.151054 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:30:20.152714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:20.154770 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m20:30:20.155700 [debug] [Thread-3 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m20:30:20.157218 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.167751 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:30:20.169244 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m20:30:20.171307 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m20:30:20.174667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:20.176018 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:20.178316 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: Close
[0m20:30:20.184011 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:30:20.185990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f92094310>]}
[0m20:30:20.187221 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m20:30:20.189955 [info ] [Thread-1 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.24s]
[0m20:30:20.193931 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:20.194943 [debug] [Thread-1 (]: Finished running node model.api_bi_project.dim_customer
[0m20:30:20.198977 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:30:20.202229 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:30:20.204079 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:30:20.210719 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:20.211297 [debug] [Thread-2 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m20:30:20.215022 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m20:30:20.220216 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.223418 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:30:20.225540 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m20:30:20.227437 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m20:30:20.230509 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:20.238562 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.239331 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:20.241043 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m20:30:20.244544 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m20:30:20.247900 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:20.248949 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f93951750>]}
[0m20:30:20.254173 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:30:20.257031 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.29s]
[0m20:30:20.258786 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.261861 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m20:30:20.265677 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:30:20.268761 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:30:20.272622 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:20.271670 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m20:30:20.280556 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m20:30:20.283001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m20:30:20.285724 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:30:20.288100 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:30:20.289957 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m20:30:20.298346 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:30:20.305424 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:20.309408 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m20:30:20.311781 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10da267c-64fe-463d-8a85-698392c7521a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f7b705c50>]}
[0m20:30:20.314256 [info ] [Thread-2 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.24s]
[0m20:30:20.317330 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m20:30:20.320162 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:30:20.320983 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:30:20.322897 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m20:30:20.328632 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:30:20.330765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m20:30:20.334367 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:30:20.343648 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:30:20.352088 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:30:20.353994 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m20:30:20.356071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:30:20.357106 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:30:20.366914 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:30:20.370783 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:20.374259 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:30:20.376486 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m20:30:20.381060 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:20.385603 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m20:30:20.386925 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:30:20.389657 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m20:30:20.390991 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m20:30:20.393306 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.11s]
[0m20:30:20.394805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:30:20.397576 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:30:20.410357 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:20.412600 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:30:20.414452 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m20:30:20.417935 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:30:20.420631 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m20:30:20.422783 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m20:30:20.424315 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.09s]
[0m20:30:20.426201 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:30:20.430842 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:20.432400 [debug] [MainThread]: On master: BEGIN
[0m20:30:20.433368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:20.444882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:20.446853 [debug] [MainThread]: On master: COMMIT
[0m20:30:20.448681 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:20.450203 [debug] [MainThread]: On master: COMMIT
[0m20:30:20.452235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:30:20.453634 [debug] [MainThread]: On master: Close
[0m20:30:20.455789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:20.459710 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m20:30:20.461135 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m20:30:20.462152 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m20:30:20.463300 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m20:30:20.464476 [info ] [MainThread]: 
[0m20:30:20.465774 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m20:30:20.470341 [debug] [MainThread]: Command end result
[0m20:30:20.556847 [info ] [MainThread]: 
[0m20:30:20.559395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:20.561610 [info ] [MainThread]: 
[0m20:30:20.563696 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m20:30:20.567435 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.9479966, "process_user_time": 2.947386, "process_kernel_time": 0.491871, "process_mem_max_rss": "116460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:20.569920 [debug] [MainThread]: Command `dbt build` succeeded at 20:30:20.569679 after 3.95 seconds
[0m20:30:20.572004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f99080990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f99204650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739f99204e50>]}
[0m20:30:20.574957 [debug] [MainThread]: Flushing usage events
[0m20:45:09.535877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f294a2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f294a2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f294a2850>]}


============================== 20:45:09.566972 | 54b61050-e5eb-4b2b-aa5e-074525712c33 ==============================
[0m20:45:09.566972 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:45:09.569484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:09.766761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b61050-e5eb-4b2b-aa5e-074525712c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f29381250>]}
[0m20:45:10.329531 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f8a_4tt0'
[0m20:45:10.333298 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:45:10.543684 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:45:10.546488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:45:10.648793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:45:10.658540 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:45:17.845646 [info ] [MainThread]: Installed from version 1.3.1
[0m20:45:17.847206 [info ] [MainThread]: Up to date!
[0m20:45:17.849082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54b61050-e5eb-4b2b-aa5e-074525712c33', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2933f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2932ed10>]}
[0m20:45:17.852031 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.405424, "process_user_time": 2.115497, "process_kernel_time": 0.778594, "process_mem_max_rss": "94812", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m20:45:17.854079 [debug] [MainThread]: Command `dbt deps` succeeded at 20:45:17.853880 after 8.41 seconds
[0m20:45:17.855205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f294e5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f294e6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2d2d47d0>]}
[0m20:45:17.856602 [debug] [MainThread]: Flushing usage events
[0m20:45:22.634778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976ba671550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976ba671650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976ba672890>]}


============================== 20:45:22.642850 | c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada ==============================
[0m20:45:22.642850 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:45:22.645822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:23.306494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976ba6b03d0>]}
[0m20:45:23.539439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976be3bc710>]}
[0m20:45:23.545289 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:45:23.688548 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:45:25.829307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:25.831404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:25.891158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b8b80550>]}
[0m20:45:26.266223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b888c410>]}
[0m20:45:26.277686 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m20:45:26.297425 [info ] [MainThread]: 
[0m20:45:26.307216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:45:26.334023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:45:26.336182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m20:45:26.539504 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:45:26.540193 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m20:45:26.544225 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:45:26.546372 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m20:45:26.548223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:26.549717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:26.578743 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:45:26.584409 [debug] [ThreadPool]: On list_db: Close
[0m20:45:26.585111 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:45:26.592905 [debug] [ThreadPool]: On list_db: Close
[0m20:45:26.600425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m20:45:26.602596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m20:45:26.624345 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:45:26.631774 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:45:26.634146 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m20:45:26.636382 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m20:45:26.638871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:26.645271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:26.672439 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:45:26.674615 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:45:26.677943 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m20:45:26.680420 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m20:45:26.682431 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:45:26.684242 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m20:45:26.694258 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:45:26.694921 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:45:26.698063 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m20:45:26.701252 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m20:45:26.703879 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m20:45:26.705630 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m20:45:26.724159 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:26.726934 [debug] [MainThread]: On master: BEGIN
[0m20:45:26.728861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:26.743893 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:45:26.745801 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:26.747434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:45:26.795983 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m20:45:26.799430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b35d20d0>]}
[0m20:45:26.801293 [debug] [MainThread]: On master: ROLLBACK
[0m20:45:26.803417 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:26.805367 [debug] [MainThread]: On master: BEGIN
[0m20:45:26.807628 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:45:26.809460 [debug] [MainThread]: On master: COMMIT
[0m20:45:26.811767 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:26.813430 [debug] [MainThread]: On master: COMMIT
[0m20:45:26.816453 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:45:26.818704 [debug] [MainThread]: On master: Close
[0m20:45:26.821646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:26.828584 [info ] [MainThread]: 
[0m20:45:26.842582 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m20:45:26.844030 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m20:45:26.845384 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m20:45:26.849164 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m20:45:26.853776 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m20:45:26.858604 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m20:45:26.883920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m20:45:26.909114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m20:45:26.915906 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m20:45:26.919045 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m20:45:26.922196 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m20:45:26.957838 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m20:45:26.926929 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m20:45:26.964159 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m20:45:26.971340 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m20:45:26.988518 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m20:45:26.989742 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m20:45:27.007497 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m20:45:27.186835 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m20:45:27.198748 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m20:45:27.200320 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m20:45:27.216691 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:45:27.218335 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:45:27.220725 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m20:45:27.224786 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m20:45:27.226454 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:45:27.228662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:27.231818 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:45:27.235293 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m20:45:27.244123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:45:27.254901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:27.255958 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:27.259253 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:45:27.261735 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:45:27.264000 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m20:45:27.267127 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:27.268431 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m20:45:27.271614 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:45:27.275216 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m20:45:27.285256 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:45:27.286336 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:45:27.287434 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:45:27.306548 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:45:27.322958 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:45:27.353001 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:45:27.354514 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:45:27.357921 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m20:45:27.364139 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m20:45:27.374687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:27.376145 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:27.380853 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:27.389554 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:45:27.400706 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:45:27.407009 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:45:27.409088 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:45:27.411250 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m20:45:27.413202 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m20:45:27.416215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:27.416947 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:27.418629 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:27.463292 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:45:27.465097 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:45:27.468393 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:45:27.471375 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:45:27.473688 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:45:27.476284 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:45:27.478492 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m20:45:27.480611 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m20:45:27.482973 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m20:45:27.489224 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:27.490902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:27.497618 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:27.505218 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m20:45:27.509536 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m20:45:27.514901 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m20:45:27.525637 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m20:45:27.527102 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m20:45:27.529621 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m20:45:27.531230 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m20:45:27.532946 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m20:45:27.534656 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m20:45:27.542893 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:45:27.543838 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:45:27.544679 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:45:27.550570 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m20:45:27.554595 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m20:45:27.559651 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m20:45:27.563353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b34f4a50>]}
[0m20:45:27.565496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b35d8790>]}
[0m20:45:27.572033 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b356d510>]}
[0m20:45:27.574089 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.68s]
[0m20:45:27.576712 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.66s]
[0m20:45:27.581340 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.66s]
[0m20:45:27.584731 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m20:45:27.587779 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m20:45:27.589835 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m20:45:27.592766 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:45:27.593370 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:45:27.594473 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:45:27.596734 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:45:27.598810 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m20:45:27.600656 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m20:45:27.603250 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m20:45:27.605632 [info ] [Thread-3 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m20:45:27.608257 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m20:45:27.610983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:45:27.613109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m20:45:27.614676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m20:45:27.616110 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:45:27.617736 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:45:27.619516 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:45:27.621595 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:45:27.647919 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:45:27.658713 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:45:27.786857 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:45:27.802544 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:45:27.810974 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:45:27.812442 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:45:27.813494 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:45:27.820298 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:45:27.835818 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:45:27.840498 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:45:27.844972 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:45:27.849420 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:45:27.857598 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:45:27.859211 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:45:27.860336 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:45:27.861298 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m20:45:27.862871 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:45:27.863690 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m20:45:27.865574 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m20:45:27.867297 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:45:27.869219 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m20:45:27.871142 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:45:27.873135 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:45:27.876258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:27.890243 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:27.892558 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:27.896340 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:27.899599 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m20:45:27.901749 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m20:45:27.904134 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m20:45:27.906552 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m20:45:27.908132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:27.911057 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:45:27.914448 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m20:45:27.920540 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:45:27.922439 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:27.926425 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:45:27.935842 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:27.936731 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m20:45:27.940962 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m20:45:27.941577 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:27.942849 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m20:45:27.944128 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m20:45:27.944842 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:27.948355 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m20:45:27.950759 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.34s]
[0m20:45:27.953496 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.34s]
[0m20:45:27.958268 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m20:45:27.960452 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m20:45:27.961617 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m20:45:27.964071 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m20:45:27.966388 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m20:45:27.967934 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.36s]
[0m20:45:27.969534 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:45:27.971510 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:45:27.973991 [info ] [Thread-3 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.36s]
[0m20:45:27.976300 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:45:27.978402 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m20:45:27.980991 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m20:45:27.983640 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m20:45:27.985249 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:45:27.986785 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m20:45:27.988168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m20:45:27.989428 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:45:27.990717 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m20:45:27.992286 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:45:27.993865 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:45:27.995451 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m20:45:27.997567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m20:45:28.006030 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:45:28.014219 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:45:28.016492 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m20:45:28.018307 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:45:28.022170 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:45:28.039351 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:45:28.055817 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:45:28.057227 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:45:28.058129 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:45:28.070316 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:45:28.077310 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:45:28.079618 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:45:28.081751 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:45:28.089182 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:45:28.108643 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:45:28.123333 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:45:28.134050 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m20:45:28.125512 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:45:28.139558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:45:28.149970 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:45:28.151902 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m20:45:28.161522 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:45:28.167907 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m20:45:28.175038 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:45:28.182413 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m20:45:28.190844 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.198921 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:45:28.217096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:28.223130 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m20:45:28.227981 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.232185 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:45:28.248254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.258291 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m20:45:28.259725 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.268759 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m20:45:28.271909 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m20:45:28.282053 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m20:45:28.288459 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m20:45:28.293028 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m20:45:28.298182 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:28.300499 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:28.312258 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:28.309710 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m20:45:28.319848 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m20:45:28.324014 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m20:45:28.327543 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m20:45:28.331196 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m20:45:28.333368 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m20:45:28.335671 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.35s]
[0m20:45:28.341072 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.35s]
[0m20:45:28.344106 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.33s]
[0m20:45:28.348998 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m20:45:28.352517 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m20:45:28.357403 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m20:45:28.359535 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:45:28.361524 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m20:45:28.364424 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m20:45:28.366614 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m20:45:28.369345 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m20:45:28.372887 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m20:45:28.376066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m20:45:28.378130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.dim_customer)
[0m20:45:28.379485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.fct_revenue_daily)
[0m20:45:28.381894 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:45:28.382829 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:28.384516 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m20:45:28.386080 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m20:45:28.395297 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:45:28.398060 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m20:45:28.404473 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m20:45:28.411350 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.414265 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m20:45:28.420141 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.42s]
[0m20:45:28.423973 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m20:45:28.426877 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m20:45:28.431424 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m20:45:28.432593 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:45:28.479843 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.488711 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m20:45:28.504357 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:45:28.515710 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.517119 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:45:28.517889 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:45:28.519274 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m20:45:28.520669 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m20:45:28.521777 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m20:45:28.523045 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:45:28.524793 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:45:28.526485 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:45:28.541913 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.543782 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.545603 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m20:45:28.547729 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.549867 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.550912 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:45:28.553799 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m20:45:28.555528 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:45:28.565695 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m20:45:28.580751 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m20:45:28.589866 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:45:28.592111 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m20:45:28.595311 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:28.597005 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:28.606058 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:45:28.609415 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m20:45:28.611390 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m20:45:28.613654 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m20:45:28.616043 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:28.618052 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.24s]
[0m20:45:28.621165 [debug] [Thread-3 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m20:45:28.632568 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:45:28.635710 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m20:45:28.642648 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.644299 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:45:28.647134 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m20:45:28.648561 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m20:45:28.649937 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m20:45:28.652684 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m20:45:28.655720 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:28.657784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m20:45:28.665306 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.665988 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:28.667578 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m20:45:28.671456 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m20:45:28.677772 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m20:45:28.686507 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.692266 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:28.703561 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m20:45:28.709980 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:45:28.712434 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m20:45:28.714010 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.717866 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m20:45:28.720932 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m20:45:28.729875 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:45:28.730543 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:28.732368 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.737001 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m20:45:28.742469 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m20:45:28.745999 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976ba5cca50>]}
[0m20:45:28.748684 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m20:45:28.751686 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.37s]
[0m20:45:28.755230 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m20:45:28.758560 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m20:45:28.762582 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.765043 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m20:45:28.766637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:28.767665 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:45:28.773164 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m20:45:28.775912 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b0b7f9d0>]}
[0m20:45:28.781163 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.40s]
[0m20:45:28.784425 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m20:45:28.787390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.793859 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:45:28.796310 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.800621 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m20:45:28.805728 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m20:45:28.810236 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m20:45:28.813384 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:45:28.823114 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:45:28.836858 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:45:28.847192 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:45:28.862664 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:45:28.865237 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m20:45:28.867720 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:45:28.887054 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:28.890143 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m20:45:28.892269 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m20:45:28.896847 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:28.901624 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m20:45:28.905095 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m20:45:28.910431 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.10s]
[0m20:45:28.916447 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m20:45:28.943820 [debug] [Thread-1 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m20:45:28.948419 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.949730 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m20:45:28.951913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:28.957323 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.958750 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m20:45:28.960790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:28.963806 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:45:28.965399 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.967017 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m20:45:28.980289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:28.987943 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m20:45:28.991799 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m20:45:28.993178 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m20:45:29.000710 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:45:29.005026 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m20:45:29.009046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c249ac0a-e8cc-4b8b-9ca5-b43e10d8aada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976b35f7750>]}
[0m20:45:29.012554 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.35s]
[0m20:45:29.014913 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m20:45:29.018050 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:45:29.021114 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m20:45:29.024552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m20:45:29.027109 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:45:29.034952 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:45:29.048153 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:45:29.052825 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:45:29.064624 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:45:29.065881 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m20:45:29.066917 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:45:29.085070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:29.088928 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m20:45:29.090326 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m20:45:29.094458 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:29.098656 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m20:45:29.100648 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m20:45:29.103055 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.08s]
[0m20:45:29.108153 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m20:45:29.114646 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:29.116500 [debug] [MainThread]: On master: BEGIN
[0m20:45:29.117790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:29.134832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:45:29.136966 [debug] [MainThread]: On master: COMMIT
[0m20:45:29.138566 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:29.140085 [debug] [MainThread]: On master: COMMIT
[0m20:45:29.142362 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:45:29.144197 [debug] [MainThread]: On master: Close
[0m20:45:29.146454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:29.148327 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m20:45:29.151329 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m20:45:29.153127 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m20:45:29.154357 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m20:45:29.156901 [info ] [MainThread]: 
[0m20:45:29.158542 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m20:45:29.165196 [debug] [MainThread]: Command end result
[0m20:45:29.294798 [info ] [MainThread]: 
[0m20:45:29.297697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:29.299827 [info ] [MainThread]: 
[0m20:45:29.302185 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m20:45:29.307205 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.8154545, "process_user_time": 6.237879, "process_kernel_time": 1.090484, "process_mem_max_rss": "116444", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:45:29.309395 [debug] [MainThread]: Command `dbt build` succeeded at 20:45:29.309181 after 6.82 seconds
[0m20:45:29.310584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976be747910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976be4b07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976be60d490>]}
[0m20:45:29.311871 [debug] [MainThread]: Flushing usage events
[0m21:00:07.623156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a0836890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a0836710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a1c95950>]}


============================== 21:00:07.635967 | ff179eca-07c0-4c44-9d12-3a00bddea432 ==============================
[0m21:00:07.635967 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:00:07.638081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:07.804906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff179eca-07c0-4c44-9d12-3a00bddea432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a08b1a50>]}
[0m21:00:08.356809 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jvsmhnp3'
[0m21:00:08.358961 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:00:08.539101 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:00:08.541571 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:00:08.645211 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:00:08.654056 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:00:14.948710 [info ] [MainThread]: Installed from version 1.3.1
[0m21:00:14.950583 [info ] [MainThread]: Up to date!
[0m21:00:14.952417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ff179eca-07c0-4c44-9d12-3a00bddea432', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a1fa3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a06da990>]}
[0m21:00:14.956083 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.4194455, "process_user_time": 1.970518, "process_kernel_time": 0.742733, "process_mem_max_rss": "94548", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m21:00:14.958071 [debug] [MainThread]: Command `dbt deps` succeeded at 21:00:14.957855 after 7.42 seconds
[0m21:00:14.959557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a09f7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a0b70c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0a0a08090>]}
[0m21:00:14.961026 [debug] [MainThread]: Flushing usage events
[0m21:00:19.578508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f02af6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f02af4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f02af6750>]}


============================== 21:00:19.584463 | 1e05f951-ba92-4790-8e5a-c4624c84f20a ==============================
[0m21:00:19.584463 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:00:19.586623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:00:19.844022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f02a37c10>]}
[0m21:00:19.920326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f02ba10d0>]}
[0m21:00:19.922978 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:00:19.983397 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m21:00:21.633873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:21.635076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:21.680438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f011fe890>]}
[0m21:00:21.897786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f00d0c390>]}
[0m21:00:21.900198 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m21:00:21.906596 [info ] [MainThread]: 
[0m21:00:21.909439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:21.918315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:00:21.919491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:00:22.017468 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:00:22.018066 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:00:22.019682 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:00:22.021461 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:00:22.023113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:22.024679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:22.048739 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:00:22.049320 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:00:22.052321 [debug] [ThreadPool]: On list_db: Close
[0m21:00:22.055918 [debug] [ThreadPool]: On list_db: Close
[0m21:00:22.061392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m21:00:22.062838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m21:00:22.072222 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:00:22.075624 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:00:22.077238 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m21:00:22.078508 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m21:00:22.079873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:22.081369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:22.096804 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.097589 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.099342 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:00:22.101729 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:00:22.103881 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m21:00:22.105645 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:00:22.115739 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:00:22.116488 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:00:22.120040 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m21:00:22.122543 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m21:00:22.124201 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m21:00:22.125347 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m21:00:22.136702 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:22.138504 [debug] [MainThread]: On master: BEGIN
[0m21:00:22.140089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:22.153495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.155787 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:22.157455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:22.194828 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m21:00:22.197769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f000c0d10>]}
[0m21:00:22.199738 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:22.202015 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:22.204131 [debug] [MainThread]: On master: BEGIN
[0m21:00:22.207132 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.209365 [debug] [MainThread]: On master: COMMIT
[0m21:00:22.211577 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:22.213703 [debug] [MainThread]: On master: COMMIT
[0m21:00:22.216169 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:00:22.217987 [debug] [MainThread]: On master: Close
[0m21:00:22.220378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:22.222429 [info ] [MainThread]: 
[0m21:00:22.231557 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m21:00:22.232468 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m21:00:22.233241 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m21:00:22.235076 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m21:00:22.238186 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m21:00:22.241184 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m21:00:22.243476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m21:00:22.245628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m21:00:22.248181 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m21:00:22.250614 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m21:00:22.252489 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m21:00:22.254938 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m21:00:22.266052 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m21:00:22.271879 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m21:00:22.276330 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m21:00:22.288936 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m21:00:22.289658 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m21:00:22.296879 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m21:00:22.349271 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m21:00:22.349988 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m21:00:22.356023 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m21:00:22.367561 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:00:22.368790 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:00:22.371250 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:00:22.372417 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m21:00:22.374988 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m21:00:22.377317 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m21:00:22.379011 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:00:22.380925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:22.383121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:22.400233 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.401194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.402939 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:00:22.403829 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.405396 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:00:22.407719 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m21:00:22.409967 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:00:22.413577 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m21:00:22.417355 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m21:00:22.429063 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:00:22.430112 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:00:22.430945 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:00:22.445235 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:00:22.452136 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:00:22.461891 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:00:22.463710 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m21:00:22.465537 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:00:22.467174 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:00:22.470302 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:22.470884 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:22.472670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:22.477848 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:00:22.484211 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:00:22.491329 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:00:22.494252 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m21:00:22.497063 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:00:22.499767 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:00:22.503372 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:22.505185 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:22.507290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:22.541389 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:00:22.542356 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:00:22.545195 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:00:22.546762 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:00:22.548232 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:00:22.550151 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:00:22.551955 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:00:22.553416 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:00:22.554727 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:00:22.559029 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:00:22.560372 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:00:22.561783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:00:22.571519 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m21:00:22.580175 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m21:00:22.584536 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m21:00:22.595281 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:00:22.597397 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:00:22.599428 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:00:22.600953 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m21:00:22.602415 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m21:00:22.603971 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m21:00:22.614338 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:00:22.615434 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:00:22.615926 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:00:22.619448 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m21:00:22.622503 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m21:00:22.625502 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m21:00:22.628909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f001916d0>]}
[0m21:00:22.631180 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f000e9d50>]}
[0m21:00:22.636135 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f00281e90>]}
[0m21:00:22.638844 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.38s]
[0m21:00:22.641317 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.39s]
[0m21:00:22.644155 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.39s]
[0m21:00:22.647119 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m21:00:22.649703 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m21:00:22.652183 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m21:00:22.655070 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:00:22.655598 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:00:22.656958 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:00:22.659315 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:00:22.661208 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m21:00:22.663636 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:00:22.665737 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m21:00:22.668006 [info ] [Thread-3 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m21:00:22.670966 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m21:00:22.673192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:00:22.674916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m21:00:22.677006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m21:00:22.679391 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:00:22.681121 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:00:22.682870 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:00:22.684773 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:00:22.701123 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:00:22.707109 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:00:22.717907 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:00:22.807018 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:00:22.817384 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:00:22.819470 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:00:22.826515 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:00:22.827140 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:00:22.842854 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:00:22.846916 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:00:22.851515 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:00:22.855528 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:00:22.867020 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:00:22.868267 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:00:22.869806 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:00:22.871428 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m21:00:22.872974 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:00:22.874152 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:00:22.875677 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:00:22.877339 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:00:22.879516 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m21:00:22.881424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:22.882872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:22.886273 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:22.900788 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.903391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.904404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.905192 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:00:22.907229 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:22.909073 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:00:22.911538 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:00:22.913498 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m21:00:22.915745 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:00:22.917767 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:00:22.919798 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:00:22.923300 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m21:00:22.926531 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:22.929816 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:22.939414 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:22.940211 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m21:00:22.944979 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:00:22.949029 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:00:22.951402 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m21:00:22.953044 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m21:00:22.953698 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:22.954962 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:00:22.956896 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.29s]
[0m21:00:22.959055 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.28s]
[0m21:00:22.966000 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m21:00:22.968693 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.30s]
[0m21:00:22.971287 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:00:22.973965 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:00:22.976718 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m21:00:22.978998 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:00:22.981028 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:00:22.982619 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:00:22.984306 [info ] [Thread-3 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.31s]
[0m21:00:22.986219 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:00:22.989163 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m21:00:22.991069 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m21:00:22.993566 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:00:22.995465 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m21:00:22.997663 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m21:00:22.999793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m21:00:23.001746 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:00:23.003281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m21:00:23.004778 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:00:23.006254 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:00:23.007945 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m21:00:23.009959 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:00:23.018974 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:00:23.025535 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:00:23.027467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m21:00:23.038051 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:00:23.041789 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:00:23.053623 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:00:23.056037 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:00:23.056783 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:00:23.057966 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:00:23.065457 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:00:23.071086 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:00:23.071863 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:00:23.075806 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:00:23.083980 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:00:23.092428 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:00:23.094509 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:00:23.095952 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m21:00:23.097191 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:00:23.098361 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:00:23.099385 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m21:00:23.101176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:23.102700 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m21:00:23.104240 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m21:00:23.105803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:23.109144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:23.111152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:23.122232 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.125862 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:00:23.128021 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m21:00:23.129193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.130087 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.133218 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:00:23.134572 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.135642 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:23.136859 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:00:23.138889 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m21:00:23.141194 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:00:23.146064 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m21:00:23.148118 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:00:23.150785 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m21:00:23.152879 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m21:00:23.156934 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.16s]
[0m21:00:23.158077 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:23.160277 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:00:23.163917 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m21:00:23.166467 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:00:23.168419 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:23.169584 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m21:00:23.170993 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m21:00:23.174884 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m21:00:23.177337 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.15s]
[0m21:00:23.178846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m21:00:23.181473 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m21:00:23.183475 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:00:23.185537 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:00:23.187634 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.19s]
[0m21:00:23.189329 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m21:00:23.196412 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:00:23.198623 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:00:23.201011 [info ] [Thread-3 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m21:00:23.205113 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m21:00:23.206637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.dim_customer)
[0m21:00:23.209165 [info ] [Thread-2 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m21:00:23.211213 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m21:00:23.213361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.fct_revenue_daily)
[0m21:00:23.214121 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:23.220153 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m21:00:23.222439 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m21:00:23.223260 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:00:23.226096 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m21:00:23.235156 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.240944 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:00:23.243273 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m21:00:23.244737 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m21:00:23.249151 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.25s]
[0m21:00:23.276376 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:00:23.276983 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m21:00:23.285191 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:00:23.288792 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m21:00:23.296758 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.298750 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m21:00:23.304321 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:23.311397 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:00:23.312529 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.314320 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m21:00:23.316442 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m21:00:23.318471 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:23.320496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:23.322625 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.327305 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:00:23.330099 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:00:23.338322 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.340162 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.342033 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:00:23.343805 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.345448 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m21:00:23.347223 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m21:00:23.365494 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:00:23.366465 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:23.374264 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:00:23.376858 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m21:00:23.378423 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m21:00:23.380217 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m21:00:23.381932 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:23.384210 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.21s]
[0m21:00:23.391448 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:00:23.393436 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:00:23.394700 [debug] [Thread-2 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m21:00:23.395233 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m21:00:23.397462 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m21:00:23.402668 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.405150 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:23.405913 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m21:00:23.407498 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m21:00:23.415910 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:00:23.417305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m21:00:23.420076 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:23.420900 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:00:23.422381 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m21:00:23.427404 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.429368 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:00:23.435043 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.437280 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m21:00:23.442900 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:23.446850 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:00:23.448903 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.450732 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:00:23.456924 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m21:00:23.463558 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.464227 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:00:23.464963 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:00:23.474600 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m21:00:23.480630 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m21:00:23.487537 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:00:23.490370 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:00:23.491057 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.492610 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m21:00:23.494376 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m21:00:23.495891 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m21:00:23.499350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:23.503714 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:00:23.504447 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:00:23.507455 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m21:00:23.510430 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m21:00:23.513081 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ef8f1bf90>]}
[0m21:00:23.515168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f02b05d50>]}
[0m21:00:23.516341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.519053 [info ] [Thread-3 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.31s]
[0m21:00:23.521723 [info ] [Thread-2 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.30s]
[0m21:00:23.523956 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.526447 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m21:00:23.528668 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m21:00:23.530865 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m21:00:23.534590 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:00:23.538540 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m21:00:23.540844 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m21:00:23.542660 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:00:23.550620 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:00:23.567250 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:00:23.574150 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:00:23.586203 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:00:23.588229 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m21:00:23.589816 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:23.605171 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.608805 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:00:23.611201 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m21:00:23.615860 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:23.619409 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m21:00:23.622259 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m21:00:23.624613 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.08s]
[0m21:00:23.627061 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:00:23.628323 [debug] [Thread-1 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m21:00:23.635777 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.637580 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m21:00:23.641695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:23.648912 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.650782 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m21:00:23.653003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:23.656816 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:00:23.659134 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.660791 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:00:23.675952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:00:23.682540 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m21:00:23.685060 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:00:23.686918 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m21:00:23.693936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:00:23.698231 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m21:00:23.700308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e05f951-ba92-4790-8e5a-c4624c84f20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f00fbeed0>]}
[0m21:00:23.702325 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.28s]
[0m21:00:23.705511 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m21:00:23.709182 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:00:23.711450 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m21:00:23.714304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m21:00:23.716456 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:00:23.726720 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:00:23.742523 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:00:23.747787 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:00:23.761322 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:00:23.763040 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m21:00:23.764493 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:23.779769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.781733 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:00:23.783105 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m21:00:23.787825 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:23.791586 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m21:00:23.793498 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m21:00:23.795570 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.08s]
[0m21:00:23.798078 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:00:23.803846 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:23.806177 [debug] [MainThread]: On master: BEGIN
[0m21:00:23.808166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:23.824321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:23.827016 [debug] [MainThread]: On master: COMMIT
[0m21:00:23.829434 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:23.831089 [debug] [MainThread]: On master: COMMIT
[0m21:00:23.833250 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:00:23.834742 [debug] [MainThread]: On master: Close
[0m21:00:23.836396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:23.837741 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m21:00:23.838943 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m21:00:23.841539 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m21:00:23.844581 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m21:00:23.846987 [info ] [MainThread]: 
[0m21:00:23.848852 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m21:00:23.855553 [debug] [MainThread]: Command end result
[0m21:00:23.940656 [info ] [MainThread]: 
[0m21:00:23.943397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:23.945508 [info ] [MainThread]: 
[0m21:00:23.947477 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m21:00:23.950677 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.477426, "process_user_time": 3.381657, "process_kernel_time": 0.631738, "process_mem_max_rss": "116300", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:00:23.952888 [debug] [MainThread]: Command `dbt build` succeeded at 21:00:23.952646 after 4.48 seconds
[0m21:00:23.954151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ef8fedf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f068fc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f069f3c50>]}
[0m21:00:23.955362 [debug] [MainThread]: Flushing usage events
[0m21:15:03.782741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753407d12750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753407d12510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753407d12990>]}


============================== 21:15:03.787805 | 6f2d5c1f-5a71-4473-90f3-01c9f601b28c ==============================
[0m21:15:03.787805 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:15:03.790450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:15:03.933744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f2d5c1f-5a71-4473-90f3-01c9f601b28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753407d512d0>]}
[0m21:15:04.515071 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv_13xxt'
[0m21:15:04.521940 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:15:04.936355 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:15:04.940931 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:15:05.345929 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:15:05.361279 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:15:11.885657 [info ] [MainThread]: Installed from version 1.3.1
[0m21:15:11.888046 [info ] [MainThread]: Up to date!
[0m21:15:11.890830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6f2d5c1f-5a71-4473-90f3-01c9f601b28c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753407d603d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753407bb2dd0>]}
[0m21:15:11.897090 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.214587, "process_user_time": 1.977164, "process_kernel_time": 0.792389, "process_mem_max_rss": "94588", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m21:15:11.899379 [debug] [MainThread]: Command `dbt deps` succeeded at 21:15:11.899181 after 8.22 seconds
[0m21:15:11.903089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75340888e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753407d629d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75340bb30890>]}
[0m21:15:11.904948 [debug] [MainThread]: Flushing usage events
[0m21:15:17.100053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc329b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc3470250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc329ae90>]}


============================== 21:15:17.106773 | d7eed61c-b2e9-4857-8ce3-47d0aa80f339 ==============================
[0m21:15:17.106773 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:15:17.109549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:15:17.406881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc1977410>]}
[0m21:15:17.492300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc3470190>]}
[0m21:15:17.494188 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:15:17.547873 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m21:15:19.230398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:19.231495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:19.274989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc19b4850>]}
[0m21:15:19.497329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc14c4d90>]}
[0m21:15:19.500029 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m21:15:19.506638 [info ] [MainThread]: 
[0m21:15:19.509340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:19.517658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:15:19.519141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:15:19.590451 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:15:19.591303 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:15:19.593235 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:15:19.595118 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:15:19.596831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:19.598640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:19.616299 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:15:19.616896 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:15:19.620092 [debug] [ThreadPool]: On list_db: Close
[0m21:15:19.623004 [debug] [ThreadPool]: On list_db: Close
[0m21:15:19.628966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m21:15:19.630282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m21:15:19.640754 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:15:19.644387 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:15:19.646665 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m21:15:19.648488 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m21:15:19.650162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:19.651784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:19.668593 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:19.672730 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:19.673921 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:15:19.676164 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:15:19.678136 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:15:19.679911 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m21:15:19.692291 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:15:19.693052 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:15:19.695789 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m21:15:19.699582 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m21:15:19.703905 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m21:15:19.707540 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m21:15:19.723801 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:19.725941 [debug] [MainThread]: On master: BEGIN
[0m21:15:19.727487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:19.743638 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:19.745695 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:19.747787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:15:19.784358 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m21:15:19.787776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc14f60d0>]}
[0m21:15:19.789774 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:19.791767 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:19.793492 [debug] [MainThread]: On master: BEGIN
[0m21:15:19.795847 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:19.797601 [debug] [MainThread]: On master: COMMIT
[0m21:15:19.799594 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:19.801421 [debug] [MainThread]: On master: COMMIT
[0m21:15:19.804085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:19.806431 [debug] [MainThread]: On master: Close
[0m21:15:19.809000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:15:19.812343 [info ] [MainThread]: 
[0m21:15:19.820200 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m21:15:19.821345 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m21:15:19.822432 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m21:15:19.824314 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m21:15:19.826378 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m21:15:19.828711 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m21:15:19.831807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m21:15:19.834074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m21:15:19.835745 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m21:15:19.837666 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m21:15:19.839700 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m21:15:19.841892 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m21:15:19.850848 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m21:15:19.855682 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m21:15:19.860197 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m21:15:19.871413 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m21:15:19.873583 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m21:15:19.885837 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m21:15:19.930377 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m21:15:19.931667 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m21:15:19.937969 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m21:15:19.954854 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:15:19.956136 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:15:19.958826 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m21:15:19.960714 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:15:19.962052 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m21:15:19.966608 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:15:19.968770 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m21:15:19.971976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:19.977803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:19.989877 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:19.996088 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:15:19.997913 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m21:15:20.000295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.002557 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:15:20.005205 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m21:15:20.006411 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:15:20.007369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.024989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:15:20.026576 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:15:20.027841 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:15:20.035293 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:15:20.036660 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m21:15:20.038013 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m21:15:20.039360 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:15:20.042201 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:20.045905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:20.054310 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:15:20.056142 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:15:20.063064 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:15:20.069379 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:15:20.071511 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m21:15:20.073543 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:15:20.075361 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:15:20.078360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:20.080099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:20.081309 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:20.113366 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:15:20.116537 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:15:20.121795 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:15:20.123677 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:15:20.125344 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:15:20.126457 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:15:20.128534 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:15:20.131615 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:15:20.134359 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:20.136218 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:20.139257 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:15:20.140050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:20.150730 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m21:15:20.152404 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:15:20.157616 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m21:15:20.171767 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:15:20.173706 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:15:20.176383 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:15:20.178391 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m21:15:20.181262 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m21:15:20.182076 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:20.189682 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m21:15:20.190399 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:15:20.190929 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:15:20.192422 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:15:20.198907 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m21:15:20.202259 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m21:15:20.204069 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m21:15:20.207854 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc19e3550>]}
[0m21:15:20.209808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc01f62d0>]}
[0m21:15:20.213307 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.37s]
[0m21:15:20.217105 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.38s]
[0m21:15:20.218128 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:15:20.220347 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m21:15:20.222363 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m21:15:20.225637 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m21:15:20.228823 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:15:20.229703 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:15:20.230835 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:15:20.233221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc01d7e50>]}
[0m21:15:20.235160 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m21:15:20.237398 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m21:15:20.239571 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m21:15:20.241772 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.40s]
[0m21:15:20.244241 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m21:15:20.246434 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m21:15:20.249562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m21:15:20.252958 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m21:15:20.255438 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:15:20.257372 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:15:20.259146 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:15:20.261307 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:15:20.301776 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:15:20.304124 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:15:20.402522 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:15:20.403996 [info ] [Thread-2 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m21:15:20.410046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m21:15:20.412316 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:15:20.419867 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:15:20.424633 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:15:20.425546 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:15:20.432785 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:15:20.447396 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:15:20.453745 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:15:20.458524 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:15:20.461767 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:15:20.467786 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:15:20.470383 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:15:20.471683 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:15:20.472890 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:15:20.475019 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m21:15:20.476986 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m21:15:20.477849 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:15:20.478964 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m21:15:20.480688 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:15:20.482859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:20.485183 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m21:15:20.486932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:20.494191 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:20.504093 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.506135 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:15:20.507727 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.511512 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m21:15:20.512982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.514788 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:15:20.515795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.524336 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:15:20.525999 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m21:15:20.527756 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:15:20.529394 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:15:20.532096 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m21:15:20.534167 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.543467 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m21:15:20.544400 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.546197 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m21:15:20.548660 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m21:15:20.552104 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.31s]
[0m21:15:20.557430 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m21:15:20.558684 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.561030 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:15:20.564438 [info ] [Thread-2 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.15s]
[0m21:15:20.569128 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m21:15:20.571625 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:15:20.574206 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:15:20.574914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.576939 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m21:15:20.578225 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:15:20.580040 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:15:20.584547 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m21:15:20.587140 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.34s]
[0m21:15:20.592177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:15:20.593843 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m21:15:20.595779 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m21:15:20.597084 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:15:20.598597 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:15:20.600356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m21:15:20.602884 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.35s]
[0m21:15:20.604615 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:15:20.613963 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:15:20.615390 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:15:20.617114 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:15:20.619835 [info ] [Thread-4 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m21:15:20.631260 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:15:20.632826 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:15:20.635041 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m21:15:20.637188 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:15:20.638616 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m21:15:20.640398 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:15:20.646897 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:15:20.648891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m21:15:20.650361 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:15:20.664404 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:15:20.666692 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:15:20.676532 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:15:20.686614 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:15:20.688927 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:15:20.692848 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:15:20.693761 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:15:20.700369 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:15:20.701369 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:15:20.703295 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:20.704306 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:15:20.709729 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:15:20.713494 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:15:20.716799 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:20.718083 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:15:20.721311 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m21:15:20.722578 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:15:20.724164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:15:20.725774 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m21:15:20.727352 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.729697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:20.732584 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:15:20.737772 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.741820 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:15:20.744086 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:15:20.747837 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.749732 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.751748 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:15:20.753881 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:15:20.758499 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:15:20.759385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.764434 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.765839 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m21:15:20.767728 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:15:20.769169 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:15:20.772474 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:15:20.775835 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.18s]
[0m21:15:20.777606 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m21:15:20.780345 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m21:15:20.781936 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:15:20.784133 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.786628 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.19s]
[0m21:15:20.788088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.789640 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:15:20.793384 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m21:15:20.795692 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:15:20.798743 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m21:15:20.802307 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m21:15:20.806324 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m21:15:20.808567 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m21:15:20.812668 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m21:15:20.813985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m21:15:20.815821 [info ] [Thread-4 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.18s]
[0m21:15:20.821392 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m21:15:20.825297 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.18s]
[0m21:15:20.826590 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:15:20.828739 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:15:20.830522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_marketing_attribution)
[0m21:15:20.832086 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:15:20.838816 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:15:20.840207 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m21:15:20.841473 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m21:15:20.844934 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m21:15:20.850310 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m21:15:20.851987 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m21:15:20.854670 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m21:15:20.860587 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m21:15:20.862402 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:15:20.863448 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m21:15:20.868419 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:15:20.900159 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m21:15:20.908059 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m21:15:20.916375 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m21:15:20.922603 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:15:20.924757 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m21:15:20.925848 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:15:20.926633 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:15:20.927798 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:20.929547 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m21:15:20.931603 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m21:15:20.935064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:20.939745 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:15:20.948870 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.951598 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:15:20.956155 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.957426 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:20.959295 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:15:20.961674 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:15:20.963314 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:15:20.966464 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m21:15:20.969118 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m21:15:20.980362 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:20.984281 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m21:15:20.986755 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:15:20.989383 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m21:15:20.998637 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:15:21.000449 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.19s]
[0m21:15:21.002022 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m21:15:21.004877 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:15:21.008577 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:21.009488 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m21:15:21.016105 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:15:21.017610 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m21:15:21.019156 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m21:15:21.021329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m21:15:21.024215 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:21.024812 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m21:15:21.033842 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:15:21.038957 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.041278 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:15:21.043791 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:15:21.051787 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:21.053332 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m21:15:21.059244 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m21:15:21.065263 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.072434 [debug] [Thread-2 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m21:15:21.071713 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:15:21.081533 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:15:21.082956 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m21:15:21.084615 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m21:15:21.088288 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.088979 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:21.090222 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m21:15:21.095579 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:15:21.097260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:21.097803 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:15:21.098902 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m21:15:21.102741 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m21:15:21.105581 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:21.107282 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736db9705590>]}
[0m21:15:21.110582 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:15:21.112977 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.26s]
[0m21:15:21.114693 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:15:21.116291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:21.117673 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m21:15:21.119220 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:15:21.120787 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.125425 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m21:15:21.126504 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:21.132913 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m21:15:21.134874 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:15:21.136228 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m21:15:21.141792 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:15:21.144507 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m21:15:21.145837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc0122c10>]}
[0m21:15:21.147224 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.32s]
[0m21:15:21.149458 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m21:15:21.152037 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:15:21.153500 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m21:15:21.155177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m21:15:21.156843 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:15:21.165751 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:15:21.167091 [debug] [Thread-1 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m21:15:21.172984 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.174521 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m21:15:21.177166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:21.185250 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:15:21.185004 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.189656 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:15:21.191210 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m21:15:21.194311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:21.197850 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:15:21.199619 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.201425 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:15:21.207494 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:15:21.209638 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m21:15:21.211606 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:21.212409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:21.218904 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m21:15:21.221005 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:15:21.222381 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m21:15:21.227708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:21.229566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:15:21.231001 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:15:21.234749 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m21:15:21.236276 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m21:15:21.238110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eed61c-b2e9-4857-8ce3-47d0aa80f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736db9787250>]}
[0m21:15:21.242085 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:21.244513 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.22s]
[0m21:15:21.248548 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m21:15:21.250566 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m21:15:21.252970 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m21:15:21.254538 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:15:21.255887 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.10s]
[0m21:15:21.260529 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m21:15:21.262655 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:15:21.264164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m21:15:21.266836 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:15:21.273591 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:15:21.284837 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:15:21.289065 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:15:21.300916 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:15:21.302121 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m21:15:21.303169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:21.316675 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:21.318726 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:15:21.320324 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m21:15:21.323810 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:15:21.326855 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m21:15:21.328292 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m21:15:21.329597 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.07s]
[0m21:15:21.334733 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:15:21.339759 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:21.341021 [debug] [MainThread]: On master: BEGIN
[0m21:15:21.342548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:21.355140 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:21.356697 [debug] [MainThread]: On master: COMMIT
[0m21:15:21.358346 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:21.361069 [debug] [MainThread]: On master: COMMIT
[0m21:15:21.363766 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:21.365811 [debug] [MainThread]: On master: Close
[0m21:15:21.368151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:21.369569 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m21:15:21.370902 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m21:15:21.372192 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m21:15:21.373279 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m21:15:21.374619 [info ] [MainThread]: 
[0m21:15:21.377125 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m21:15:21.383615 [debug] [MainThread]: Command end result
[0m21:15:21.487230 [info ] [MainThread]: 
[0m21:15:21.489599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:15:21.491716 [info ] [MainThread]: 
[0m21:15:21.493965 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m21:15:21.498221 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.51387, "process_user_time": 3.576345, "process_kernel_time": 0.517194, "process_mem_max_rss": "116972", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:15:21.500365 [debug] [MainThread]: Command `dbt build` succeeded at 21:15:21.500159 after 4.52 seconds
[0m21:15:21.501896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc31eae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc70cc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736db978dd90>]}
[0m21:15:21.503582 [debug] [MainThread]: Flushing usage events
[0m21:30:03.970636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6a533190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6a5330d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6a531410>]}


============================== 21:30:04.001781 | 6073c1ea-a35b-4e9d-a979-5fa92e3af737 ==============================
[0m21:30:04.001781 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:30:04.004258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:30:04.146851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6073c1ea-a35b-4e9d-a979-5fa92e3af737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6a55b910>]}
[0m21:30:04.710579 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-64_axaau'
[0m21:30:04.712657 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:30:04.889182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:30:04.892043 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:30:04.982699 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:30:04.991337 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:30:11.499316 [info ] [MainThread]: Installed from version 1.3.1
[0m21:30:11.501060 [info ] [MainThread]: Up to date!
[0m21:30:11.503575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6073c1ea-a35b-4e9d-a979-5fa92e3af737', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6b9d5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6a53a0d0>]}
[0m21:30:11.506330 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.6478615, "process_user_time": 1.914774, "process_kernel_time": 0.749738, "process_mem_max_rss": "94656", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m21:30:11.508048 [debug] [MainThread]: Command `dbt deps` succeeded at 21:30:11.507837 after 7.65 seconds
[0m21:30:11.509291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6a581a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6a581650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a6e390750>]}
[0m21:30:11.510686 [debug] [MainThread]: Flushing usage events
[0m21:30:16.620501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716095ba05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716095ba21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716095d23c50>]}


============================== 21:30:16.627806 | 83ceeea0-3ff3-4447-ba3d-8a05864ce76a ==============================
[0m21:30:16.627806 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:30:16.629981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:16.962568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716094227310>]}
[0m21:30:17.032595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716099874890>]}
[0m21:30:17.035340 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:30:17.092315 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m21:30:18.946385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:18.948452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:19.006206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160959d7150>]}
[0m21:30:19.201508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716093d60fd0>]}
[0m21:30:19.203906 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m21:30:19.212059 [info ] [MainThread]: 
[0m21:30:19.215047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:19.224658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:30:19.226587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:30:19.320575 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:30:19.321335 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:30:19.322862 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:30:19.324978 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:30:19.327153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:19.329305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:19.352314 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:30:19.353510 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:30:19.356947 [debug] [ThreadPool]: On list_db: Close
[0m21:30:19.360933 [debug] [ThreadPool]: On list_db: Close
[0m21:30:19.367757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m21:30:19.369341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m21:30:19.384751 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:30:19.391873 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:30:19.394162 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m21:30:19.396868 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m21:30:19.399531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:19.402018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:19.417734 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:19.418831 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:19.420419 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:30:19.422551 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:30:19.424550 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m21:30:19.426502 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:30:19.435554 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:30:19.436770 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:30:19.440674 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m21:30:19.444088 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m21:30:19.446322 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m21:30:19.448230 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m21:30:19.462278 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:19.464981 [debug] [MainThread]: On master: BEGIN
[0m21:30:19.467141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:19.485161 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:19.489177 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:19.494710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:19.615588 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m21:30:19.627343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716093d99510>]}
[0m21:30:19.635619 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:19.641986 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:19.644699 [debug] [MainThread]: On master: BEGIN
[0m21:30:19.651781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:19.655473 [debug] [MainThread]: On master: COMMIT
[0m21:30:19.659593 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:19.665725 [debug] [MainThread]: On master: COMMIT
[0m21:30:19.671605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:19.674153 [debug] [MainThread]: On master: Close
[0m21:30:19.677306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:30:19.689238 [info ] [MainThread]: 
[0m21:30:19.716698 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m21:30:19.718140 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m21:30:19.720131 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m21:30:19.726566 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m21:30:19.734227 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m21:30:19.738885 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m21:30:19.743425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m21:30:19.747504 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m21:30:19.756121 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m21:30:19.765751 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m21:30:19.790195 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m21:30:19.801716 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m21:30:19.871125 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m21:30:19.886263 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m21:30:19.897759 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m21:30:19.953482 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m21:30:19.954847 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m21:30:19.972121 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m21:30:20.265175 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m21:30:20.270845 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m21:30:20.274036 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m21:30:20.293893 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:30:20.301000 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:30:20.305562 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m21:30:20.307813 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:30:20.314120 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m21:30:20.320026 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:30:20.323946 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m21:30:20.333551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:20.342284 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:30:20.358524 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:20.371523 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:20.377921 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:30:20.392590 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:30:20.399755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:20.402680 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m21:30:20.423527 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m21:30:20.428664 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:30:20.437809 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m21:30:20.444463 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:30:20.454269 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:30:20.474704 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:30:20.527069 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:30:20.537902 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:30:20.551899 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:30:20.555563 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:30:20.560877 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m21:30:20.568547 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:30:20.572108 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:20.574820 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:20.578625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:20.628281 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:30:20.656181 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:30:20.663604 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:30:20.665997 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:30:20.678704 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m21:30:20.683136 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:30:20.690948 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:20.697609 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:20.700661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:20.800156 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:30:20.801684 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:30:20.807680 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:30:20.812630 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:30:20.815071 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:30:20.817429 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:30:20.819569 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:30:20.822577 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:30:20.826320 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:30:20.830264 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:20.833312 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:20.835962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:20.855485 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m21:30:20.863517 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m21:30:20.871981 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m21:30:20.890367 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:30:20.893250 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:30:20.898621 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:30:20.900467 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m21:30:20.902104 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m21:30:20.904101 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m21:30:20.912141 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:30:20.913826 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:30:20.914641 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:30:20.918602 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m21:30:20.925596 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m21:30:20.931914 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m21:30:20.937934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716094175610>]}
[0m21:30:20.941889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716073f195d0>]}
[0m21:30:20.945594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716092a89610>]}
[0m21:30:20.947955 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 1.19s]
[0m21:30:20.952570 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 1.19s]
[0m21:30:20.955748 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 1.20s]
[0m21:30:20.962901 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m21:30:20.965130 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m21:30:20.967585 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m21:30:20.972436 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:30:20.973025 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:30:20.973692 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:30:20.977009 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:30:20.979093 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m21:30:20.982034 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m21:30:20.985375 [info ] [Thread-3 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m21:30:20.988120 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m21:30:20.992685 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m21:30:20.996464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m21:30:20.998686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m21:30:21.000598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m21:30:21.002241 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:30:21.003968 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:30:21.006592 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:30:21.008904 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:30:21.039629 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:30:21.067601 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:30:21.277055 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:30:21.284842 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:30:21.294950 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:30:21.296511 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:30:21.306633 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:30:21.314119 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:30:21.354349 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:30:21.356299 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:30:21.365409 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:30:21.373048 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:30:21.386837 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:30:21.390669 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:30:21.392684 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m21:30:21.394737 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:30:21.396953 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:30:21.398663 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m21:30:21.404280 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:30:21.406704 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m21:30:21.410647 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m21:30:21.413090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:21.419678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:30:21.422949 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:30:21.438906 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.452440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.464074 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:30:21.465568 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.479800 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:30:21.486835 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m21:30:21.489939 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.494407 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:30:21.497937 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m21:30:21.526342 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:30:21.529835 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m21:30:21.535077 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:30:21.543436 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:21.546109 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:21.569338 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m21:30:21.570960 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:21.575981 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m21:30:21.579887 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m21:30:21.584328 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m21:30:21.589204 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m21:30:21.592914 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.60s]
[0m21:30:21.596050 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:21.598903 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m21:30:21.604702 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.61s]
[0m21:30:21.608346 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:30:21.616003 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m21:30:21.623779 [info ] [Thread-3 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.62s]
[0m21:30:21.626256 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:30:21.630167 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:30:21.632846 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m21:30:21.634661 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:30:21.637052 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:30:21.640005 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m21:30:21.643025 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.64s]
[0m21:30:21.645746 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:30:21.650191 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m21:30:21.661563 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m21:30:21.665518 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:30:21.667981 [info ] [Thread-3 (]: 10 of 17 START test not_null_stg_customers_country ............................. [RUN]
[0m21:30:21.670772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m21:30:21.673226 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:30:21.676787 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:30:21.678696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m21:30:21.680178 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:30:21.697029 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:30:21.698773 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m21:30:21.702890 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:30:21.729399 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:30:21.734147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:30:21.751102 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:30:21.774909 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:30:21.784919 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:30:21.827558 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:30:21.791564 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:30:21.837752 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:30:21.844897 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:30:21.856493 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:30:21.868767 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:30:21.876306 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:30:21.880048 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:30:21.888165 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:30:21.890431 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:30:21.894468 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m21:30:21.897134 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:30:21.899350 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m21:30:21.904572 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:30:21.913572 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m21:30:21.916577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:30:21.920169 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:30:21.927373 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:30:21.929563 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:30:21.936031 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.940502 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.943274 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.947020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:21.950805 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:30:21.952604 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:30:21.954485 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:30:21.960412 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m21:30:21.964208 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:30:21.967669 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m21:30:21.976688 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:21.981323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:21.991713 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:21.997686 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m21:30:22.000038 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:30:22.006288 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m21:30:22.012206 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m21:30:22.017119 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:30:22.020148 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m21:30:22.025018 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.36s]
[0m21:30:22.038987 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:22.037778 [info ] [Thread-3 (]: 10 of 17 PASS not_null_stg_customers_country ................................... [[32mPASS[0m in 0.36s]
[0m21:30:22.044000 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:30:22.050523 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:30:22.053120 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:30:22.055538 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:30:22.062672 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:30:22.066485 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m21:30:22.072383 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:22.070792 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:30:22.076506 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.34s]
[0m21:30:22.082389 [info ] [Thread-3 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m21:30:22.087631 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m21:30:22.095364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m21:30:22.098543 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:30:22.101397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now model.api_bi_project.fct_revenue_daily)
[0m21:30:22.105831 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m21:30:22.108234 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:30:22.112996 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m21:30:22.117894 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.45s]
[0m21:30:22.136079 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:30:22.142691 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.144680 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:30:22.149771 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m21:30:22.153364 [info ] [Thread-1 (]: 14 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m21:30:22.156122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.fct_marketing_attribution)
[0m21:30:22.160888 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m21:30:22.161973 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:30:22.169793 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m21:30:22.172713 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.180747 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:30:22.265906 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.270287 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m21:30:22.285044 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.289473 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:30:22.292112 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.294071 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:30:22.296864 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m21:30:22.300488 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:30:22.302334 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:30:22.319363 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.321502 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m21:30:22.324025 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:22.327849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:22.330142 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:22.335151 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:30:22.340544 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.344300 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:30:22.350141 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m21:30:22.355931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:22.359046 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:22.365378 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.372193 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:30:22.375843 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m21:30:22.378395 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m21:30:22.393762 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.30s]
[0m21:30:22.402712 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:30:22.405831 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m21:30:22.409534 [info ] [Thread-2 (]: 15 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m21:30:22.413119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now model.api_bi_project.dim_customer)
[0m21:30:22.415666 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m21:30:22.433038 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m21:30:22.434356 [debug] [Thread-3 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m21:30:22.455933 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.458562 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m21:30:22.463156 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:22.475802 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m21:30:22.477005 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.490770 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m21:30:22.508900 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m21:30:22.510935 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:22.531171 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:30:22.540451 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.543157 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:30:22.548231 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:30:22.549955 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m21:30:22.552303 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:30:22.553384 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:22.568529 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m21:30:22.582387 [debug] [Thread-1 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m21:30:22.585149 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:30:22.586132 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:22.603451 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.605884 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m21:30:22.609276 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:30:22.612507 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m21:30:22.624836 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m21:30:22.632152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:22.652033 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:22.650781 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.654102 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:30:22.658027 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m21:30:22.660431 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m21:30:22.671120 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:30:22.674183 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716073f190d0>]}
[0m21:30:22.677659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:22.678868 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m21:30:22.681825 [info ] [Thread-3 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.57s]
[0m21:30:22.692035 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:30:22.696116 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:22.697539 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m21:30:22.702926 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.730163 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:30:22.733062 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:30:22.734851 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:30:22.737167 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m21:30:22.740356 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m21:30:22.745878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:22.749947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m21:30:22.757452 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:30:22.759514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:22.761874 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:30:22.763855 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:30:22.780506 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m21:30:22.814187 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:30:22.816518 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:30:22.822260 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:30:22.844432 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:22.846114 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m21:30:22.862380 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m21:30:22.876511 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:30:22.878831 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m21:30:22.879964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:22.880983 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:30:22.888356 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m21:30:22.889888 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:22.898845 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:30:22.902460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716073f09ed0>]}
[0m21:30:22.911632 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m21:30:22.917048 [info ] [Thread-1 (]: 14 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.75s]
[0m21:30:22.922545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ceeea0-3ff3-4447-ba3d-8a05864ce76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160967c7bd0>]}
[0m21:30:22.928533 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m21:30:22.935015 [info ] [Thread-2 (]: 15 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.51s]
[0m21:30:22.942863 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:30:22.947448 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:30:22.949874 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m21:30:22.953300 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m21:30:22.955806 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m21:30:22.962032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m21:30:22.963957 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:30:22.965714 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:30:22.984936 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:30:22.994365 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:22.999372 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:30:23.002284 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m21:30:23.014128 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:23.019926 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m21:30:23.025657 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m21:30:23.027005 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:30:23.029897 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.28s]
[0m21:30:23.041652 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:30:23.045629 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:30:23.063047 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:30:23.065152 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m21:30:23.067337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:30:23.086390 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:23.090467 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:30:23.093430 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m21:30:23.098661 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:23.104678 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m21:30:23.107392 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m21:30:23.109602 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.15s]
[0m21:30:23.112422 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:30:23.117935 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:23.119753 [debug] [MainThread]: On master: BEGIN
[0m21:30:23.128202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:23.147707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:23.150487 [debug] [MainThread]: On master: COMMIT
[0m21:30:23.153258 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:23.163089 [debug] [MainThread]: On master: COMMIT
[0m21:30:23.166898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:23.169606 [debug] [MainThread]: On master: Close
[0m21:30:23.171851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:23.173276 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m21:30:23.174736 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m21:30:23.179365 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m21:30:23.181784 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m21:30:23.183697 [info ] [MainThread]: 
[0m21:30:23.186226 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m21:30:23.195376 [debug] [MainThread]: Command end result
[0m21:30:23.313816 [info ] [MainThread]: 
[0m21:30:23.317547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:23.319694 [info ] [MainThread]: 
[0m21:30:23.322156 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m21:30:23.325773 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.839126, "process_user_time": 4.66031, "process_kernel_time": 0.812451, "process_mem_max_rss": "116936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:23.328576 [debug] [MainThread]: Command `dbt build` succeeded at 21:30:23.328298 after 6.84 seconds
[0m21:30:23.330475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716099964950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716093d6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716099ac05d0>]}
[0m21:30:23.332510 [debug] [MainThread]: Flushing usage events
[0m21:45:11.209538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a32a36890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a32bf7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a32a75410>]}


============================== 21:45:11.229655 | 4b170e90-2650-4930-8552-37ed586b043f ==============================
[0m21:45:11.229655 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:45:11.232357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m21:45:11.539326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b170e90-2650-4930-8552-37ed586b043f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a32d0c510>]}
[0m21:45:12.371272 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jcpuim4z'
[0m21:45:12.372885 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:45:12.561987 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:45:12.567582 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:45:12.666797 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:45:12.676290 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:45:19.894755 [info ] [MainThread]: Installed from version 1.3.1
[0m21:45:19.897063 [info ] [MainThread]: Up to date!
[0m21:45:19.899801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b170e90-2650-4930-8552-37ed586b043f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a328ab190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a32a75b90>]}
[0m21:45:19.902974 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.85075, "process_user_time": 3.880058, "process_kernel_time": 1.325751, "process_mem_max_rss": "94520", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m21:45:19.904954 [debug] [MainThread]: Command `dbt deps` succeeded at 21:45:19.904631 after 8.85 seconds
[0m21:45:19.907406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a32a77a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a32c04090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a368387d0>]}
[0m21:45:19.909349 [debug] [MainThread]: Flushing usage events
[0m21:45:25.986009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0caa32b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0caa32750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0caa32850>]}


============================== 21:45:25.993621 | 922aa3e7-aa7f-4417-84f8-797d9a9cc7e7 ==============================
[0m21:45:25.993621 [info ] [MainThread]: Running with dbt=1.8.3
[0m21:45:25.996024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:45:26.431389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0caa31550>]}
[0m21:45:26.524135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0ce79c710>]}
[0m21:45:26.526489 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:45:26.598814 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m21:45:28.714323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:45:28.716320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:45:28.779848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c9199a90>]}
[0m21:45:29.135105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c8c80d50>]}
[0m21:45:29.137479 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m21:45:29.144780 [info ] [MainThread]: 
[0m21:45:29.148952 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:45:29.158290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:45:29.160450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m21:45:29.295734 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:45:29.297319 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m21:45:29.299274 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:45:29.301250 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m21:45:29.303424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:29.307683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:29.350540 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:45:29.353392 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m21:45:29.356515 [debug] [ThreadPool]: On list_db: Close
[0m21:45:29.360862 [debug] [ThreadPool]: On list_db: Close
[0m21:45:29.368976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m21:45:29.371311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m21:45:29.393081 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:45:29.403817 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:45:29.405539 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m21:45:29.409768 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m21:45:29.411572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:29.413513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:29.442537 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:45:29.450301 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:45:29.451395 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m21:45:29.455977 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m21:45:29.458305 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m21:45:29.460587 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:45:29.483832 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:45:29.484531 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:45:29.488527 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m21:45:29.495645 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m21:45:29.498946 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m21:45:29.501030 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m21:45:29.520819 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:29.522508 [debug] [MainThread]: On master: BEGIN
[0m21:45:29.523969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:29.552603 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:29.558793 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:29.560985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:45:29.632235 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m21:45:29.638046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0caa75cd0>]}
[0m21:45:29.641136 [debug] [MainThread]: On master: ROLLBACK
[0m21:45:29.643941 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:29.646037 [debug] [MainThread]: On master: BEGIN
[0m21:45:29.647952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:29.649686 [debug] [MainThread]: On master: COMMIT
[0m21:45:29.651883 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:29.654820 [debug] [MainThread]: On master: COMMIT
[0m21:45:29.657025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:45:29.658703 [debug] [MainThread]: On master: Close
[0m21:45:29.660437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:45:29.662408 [info ] [MainThread]: 
[0m21:45:29.674332 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m21:45:29.675364 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m21:45:29.676199 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m21:45:29.678037 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m21:45:29.680122 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m21:45:29.685027 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m21:45:29.697607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m21:45:29.702628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m21:45:29.704591 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m21:45:29.707165 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m21:45:29.709390 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m21:45:29.711143 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m21:45:29.723818 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m21:45:29.729371 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m21:45:29.733692 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m21:45:29.746305 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m21:45:29.747401 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m21:45:29.758247 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m21:45:29.918365 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m21:45:29.922416 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m21:45:29.924552 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m21:45:29.934322 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:45:29.935706 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:45:29.936789 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m21:45:29.937864 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:45:29.939306 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m21:45:29.940721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:29.942224 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m21:45:29.943302 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:29.945621 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:45:29.961176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:29.963278 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:29.965626 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:45:29.970947 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:45:29.977514 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m21:45:29.980632 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:29.982083 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m21:45:29.991849 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:45:29.998665 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m21:45:30.012711 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:45:30.013746 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:45:30.014337 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:45:30.025944 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:45:30.033932 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:45:30.052279 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:45:30.055037 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:45:30.057897 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:45:30.061890 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m21:45:30.065805 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:30.066811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:30.075297 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:45:30.076180 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:30.080848 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:45:30.082301 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:45:30.087195 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:45:30.089231 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:45:30.092318 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m21:45:30.093458 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:30.096896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:30.098762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:30.137730 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:45:30.141449 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:45:30.153811 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:45:30.157319 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:45:30.172676 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m21:45:30.166679 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:45:30.161128 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:45:30.192183 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m21:45:30.194998 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m21:45:30.199460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:45:30.201890 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:45:30.216992 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:45:30.226674 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m21:45:30.231270 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m21:45:30.237381 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m21:45:30.248311 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m21:45:30.250584 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m21:45:30.253270 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m21:45:30.255221 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m21:45:30.257615 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m21:45:30.260274 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m21:45:30.272614 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:45:30.273879 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:45:30.274437 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:45:30.281200 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m21:45:30.284153 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m21:45:30.290357 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m21:45:30.297363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c81a86d0>]}
[0m21:45:30.300199 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c8196d90>]}
[0m21:45:30.306975 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c81b7290>]}
[0m21:45:30.309528 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.60s]
[0m21:45:30.312029 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.60s]
[0m21:45:30.316079 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.60s]
[0m21:45:30.318905 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m21:45:30.322243 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m21:45:30.325590 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m21:45:30.328587 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:45:30.329458 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:45:30.330529 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:45:30.332928 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:45:30.334527 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m21:45:30.335887 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:45:30.337635 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m21:45:30.339404 [info ] [Thread-3 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m21:45:30.343071 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m21:45:30.345511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:45:30.347771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m21:45:30.351080 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m21:45:30.353009 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:45:30.354831 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:45:30.357224 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:45:30.360696 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:45:30.414072 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:45:30.415228 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:45:30.507592 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:45:30.524182 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:45:30.534632 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:45:30.536593 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:45:30.543359 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:45:30.544152 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:45:30.562181 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:45:30.565152 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:45:30.569270 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:45:30.574816 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:45:30.584938 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:45:30.585992 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:45:30.587631 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:45:30.588932 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:45:30.591082 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m21:45:30.591939 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:45:30.593232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:30.595052 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:45:30.596296 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:45:30.597994 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m21:45:30.601076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:30.604764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:30.616958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.621332 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.629798 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m21:45:30.631509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.633394 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m21:45:30.635781 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:30.639418 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:45:30.641462 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m21:45:30.644289 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.646264 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:45:30.649903 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m21:45:30.650812 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.651633 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.654570 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m21:45:30.655923 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.662477 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:45:30.666239 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m21:45:30.671212 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:45:30.673816 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m21:45:30.675494 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m21:45:30.677008 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:45:30.678855 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.33s]
[0m21:45:30.681647 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.34s]
[0m21:45:30.685501 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.34s]
[0m21:45:30.689787 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m21:45:30.692356 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m21:45:30.693184 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.694815 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:45:30.696857 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:45:30.699243 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:45:30.702776 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m21:45:30.704315 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:45:30.705829 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m21:45:30.707408 [info ] [Thread-4 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m21:45:30.709777 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m21:45:30.711028 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m21:45:30.713339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m21:45:30.715246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m21:45:30.717147 [info ] [Thread-3 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.37s]
[0m21:45:30.718811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m21:45:30.721030 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:45:30.722522 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:45:30.724332 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m21:45:30.726168 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:45:30.738735 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:45:30.747094 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:45:30.749284 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:45:30.764235 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:45:30.767453 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m21:45:30.770388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m21:45:30.773460 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:45:30.774509 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:45:30.775658 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:45:30.782733 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:45:30.786594 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:45:30.790491 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:45:30.794813 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:45:30.799358 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:45:30.808850 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:45:30.810116 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:45:30.811526 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m21:45:30.813314 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:45:30.814391 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:45:30.814971 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m21:45:30.816417 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:30.817968 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m21:45:30.822517 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:45:30.824193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:30.826968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:30.841237 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.843789 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m21:45:30.845076 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.847517 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:30.850015 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m21:45:30.851177 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:45:30.857478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.860420 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m21:45:30.862441 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m21:45:30.867802 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m21:45:30.870650 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:30.872489 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m21:45:30.873385 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.878854 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.883192 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m21:45:30.886533 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m21:45:30.888298 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m21:45:30.889486 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m21:45:30.890818 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.18s]
[0m21:45:30.894263 [info ] [Thread-4 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.18s]
[0m21:45:30.896286 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:30.898146 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m21:45:30.901044 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m21:45:30.903188 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m21:45:30.905169 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:45:30.906913 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m21:45:30.908666 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m21:45:30.910616 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m21:45:30.912453 [info ] [Thread-4 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m21:45:30.917107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m21:45:30.919001 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.920504 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.dim_customer)
[0m21:45:30.922073 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:45:30.925188 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m21:45:30.926835 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m21:45:30.934892 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:45:30.937256 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m21:45:30.944940 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m21:45:30.950697 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:30.952607 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.18s]
[0m21:45:30.961429 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m21:45:30.977782 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:45:30.975318 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m21:45:30.981660 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m21:45:30.991902 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:45:30.993483 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m21:45:30.998727 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m21:45:31.005103 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.29s]
[0m21:45:31.047584 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m21:45:31.063374 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:45:31.077923 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m21:45:31.099324 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m21:45:31.101851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.fct_revenue_daily)
[0m21:45:31.103941 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m21:45:31.107817 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m21:45:31.109517 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:31.123078 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.136115 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:45:31.138587 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m21:45:31.143076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:31.156228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:31.162173 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m21:45:31.164394 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:31.168260 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m21:45:31.173081 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:31.198720 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.201352 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:45:31.206718 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m21:45:31.224958 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.227242 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m21:45:31.229866 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:31.246643 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m21:45:31.258328 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:45:31.262176 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:31.264971 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:31.270439 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m21:45:31.275157 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m21:45:31.279654 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.282567 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:31.283504 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m21:45:31.284533 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m21:45:31.298678 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:45:31.300691 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.38s]
[0m21:45:31.309346 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m21:45:31.313191 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m21:45:31.321724 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:31.326535 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m21:45:31.350075 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:45:31.351974 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m21:45:31.355787 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:45:31.357972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m21:45:31.362778 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m21:45:31.365171 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m21:45:31.389146 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m21:45:31.390704 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m21:45:31.412662 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m21:45:31.437282 [debug] [Thread-3 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m21:45:31.435951 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m21:45:31.449857 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m21:45:31.461825 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.464196 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m21:45:31.474269 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m21:45:31.476051 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m21:45:31.490268 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:31.502403 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.507774 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m21:45:31.513992 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:45:31.517101 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:31.518353 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:45:31.521696 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m21:45:31.530900 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:45:31.533351 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m21:45:31.536541 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c0fb9f90>]}
[0m21:45:31.538177 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.540862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:31.546762 [info ] [Thread-4 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.62s]
[0m21:45:31.551816 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m21:45:31.562900 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m21:45:31.567192 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:45:31.576398 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m21:45:31.578980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:31.583026 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m21:45:31.586201 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:45:31.589287 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m21:45:31.591857 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m21:45:31.604420 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:45:31.615142 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m21:45:31.620435 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c8f3b6d0>]}
[0m21:45:31.622963 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.52s]
[0m21:45:31.629903 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m21:45:31.632943 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:45:31.636087 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m21:45:31.640336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m21:45:31.644387 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:45:31.667470 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:45:31.761706 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:45:31.818554 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:45:31.864949 [debug] [Thread-1 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m21:45:31.887295 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:45:31.890751 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m21:45:31.902670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:31.904066 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:45:31.925118 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:45:31.926759 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m21:45:31.931690 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m21:45:31.933744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:31.939309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:45:31.951319 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:45:31.955476 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:45:31.958286 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m21:45:31.964503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:31.971136 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m21:45:31.974097 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m21:45:31.978457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:45:31.985791 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:31.997964 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m21:45:32.007262 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m21:45:32.010575 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m21:45:32.013766 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m21:45:32.015721 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m21:45:32.023340 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.38s]
[0m21:45:32.034703 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m21:45:32.041168 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:45:32.045111 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m21:45:32.054026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922aa3e7-aa7f-4417-84f8-797d9a9cc7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0c8033250>]}
[0m21:45:32.060060 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.70s]
[0m21:45:32.068354 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m21:45:32.076267 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:45:32.078736 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m21:45:32.082181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m21:45:32.088599 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:45:32.106856 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:45:32.134061 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:45:32.149218 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:45:32.173216 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:45:32.180389 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m21:45:32.187501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:32.210864 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:45:32.253811 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m21:45:32.262456 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m21:45:32.288628 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:32.296915 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m21:45:32.302200 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m21:45:32.308607 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.23s]
[0m21:45:32.318253 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m21:45:32.331341 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:32.339986 [debug] [MainThread]: On master: BEGIN
[0m21:45:32.342471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:32.366369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:32.377172 [debug] [MainThread]: On master: COMMIT
[0m21:45:32.383045 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:32.395764 [debug] [MainThread]: On master: COMMIT
[0m21:45:32.415787 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:45:32.442457 [debug] [MainThread]: On master: Close
[0m21:45:32.459362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:32.485618 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m21:45:32.495134 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m21:45:32.521254 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m21:45:32.526994 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m21:45:32.558258 [info ] [MainThread]: 
[0m21:45:32.561520 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m21:45:32.585732 [debug] [MainThread]: Command end result
[0m21:45:32.898972 [info ] [MainThread]: 
[0m21:45:32.908894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:45:32.914589 [info ] [MainThread]: 
[0m21:45:32.925037 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m21:45:32.929692 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.0597057, "process_user_time": 5.208264, "process_kernel_time": 0.976549, "process_mem_max_rss": "116780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:45:32.943290 [debug] [MainThread]: Command `dbt build` succeeded at 21:45:32.942601 after 7.07 seconds
[0m21:45:32.951211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0ceb27910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0ce8907d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b0ce9ec5d0>]}
[0m21:45:32.954332 [debug] [MainThread]: Flushing usage events
[0m22:00:07.345315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa3142950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa33034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa3303c50>]}


============================== 22:00:07.353688 | 87ed6546-6bbd-4e76-b8ec-ec7d2175db7e ==============================
[0m22:00:07.353688 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:00:07.356347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:00:07.507928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87ed6546-6bbd-4e76-b8ec-ec7d2175db7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa2fb5f50>]}
[0m22:00:08.048134 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gvmcqhx5'
[0m22:00:08.050294 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:00:08.284517 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:00:08.286904 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:00:08.380706 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:00:08.388786 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:00:15.524567 [info ] [MainThread]: Installed from version 1.3.1
[0m22:00:15.526133 [info ] [MainThread]: Up to date!
[0m22:00:15.528263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '87ed6546-6bbd-4e76-b8ec-ec7d2175db7e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa2fe67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa2fb6f50>]}
[0m22:00:15.533064 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.325816, "process_user_time": 2.126031, "process_kernel_time": 0.799094, "process_mem_max_rss": "94728", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m22:00:15.534978 [debug] [MainThread]: Command `dbt deps` succeeded at 22:00:15.534712 after 8.33 seconds
[0m22:00:15.536452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa3192750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa31937d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769aa7010590>]}
[0m22:00:15.537731 [debug] [MainThread]: Flushing usage events
[0m22:00:19.290868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a82e303d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a82e32010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a82e30190>]}


============================== 22:00:19.298568 | 08189412-465c-415d-9301-ba12910e6c01 ==============================
[0m22:00:19.298568 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:00:19.300796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:00:19.595927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a82d17d90>]}
[0m22:00:19.667260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a86b04950>]}
[0m22:00:19.670618 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:00:19.745254 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:00:21.485108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:21.486245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:21.536438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a82e31050>]}
[0m22:00:21.788293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a8100cc90>]}
[0m22:00:21.792748 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m22:00:21.801315 [info ] [MainThread]: 
[0m22:00:21.805887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:21.815302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m22:00:21.816838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m22:00:21.906606 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m22:00:21.907989 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m22:00:21.909318 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m22:00:21.910620 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m22:00:21.913086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:21.916608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:21.936892 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:00:21.937486 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:00:21.943187 [debug] [ThreadPool]: On list_db: Close
[0m22:00:21.946846 [debug] [ThreadPool]: On list_db: Close
[0m22:00:21.954669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m22:00:21.955713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m22:00:21.967429 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m22:00:21.972837 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m22:00:21.974529 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m22:00:21.976818 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m22:00:21.979535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:21.980718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:21.998123 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:00:21.998920 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:00:22.000608 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m22:00:22.002644 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m22:00:22.005378 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:00:22.007701 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m22:00:22.017228 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:00:22.017784 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:00:22.021048 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m22:00:22.027053 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m22:00:22.029994 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m22:00:22.032429 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m22:00:22.046083 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:22.047912 [debug] [MainThread]: On master: BEGIN
[0m22:00:22.049745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:22.064497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:00:22.066962 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:22.069413 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:22.108559 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m22:00:22.111350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a81532d50>]}
[0m22:00:22.112976 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:22.114825 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:22.116064 [debug] [MainThread]: On master: BEGIN
[0m22:00:22.117841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:00:22.119079 [debug] [MainThread]: On master: COMMIT
[0m22:00:22.120741 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:22.122449 [debug] [MainThread]: On master: COMMIT
[0m22:00:22.124450 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:00:22.126011 [debug] [MainThread]: On master: Close
[0m22:00:22.127790 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:00:22.129457 [info ] [MainThread]: 
[0m22:00:22.139196 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m22:00:22.140119 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m22:00:22.141034 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m22:00:22.143250 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m22:00:22.145237 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m22:00:22.148122 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m22:00:22.150320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m22:00:22.152206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m22:00:22.154517 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m22:00:22.156833 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m22:00:22.158970 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m22:00:22.160686 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m22:00:22.172248 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m22:00:22.180001 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m22:00:22.185068 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m22:00:22.195195 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m22:00:22.196868 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m22:00:22.204237 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m22:00:22.302120 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m22:00:22.305494 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m22:00:22.308146 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m22:00:22.317359 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:00:22.318344 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:00:22.320018 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m22:00:22.321261 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:00:22.322431 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m22:00:22.323849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:22.325584 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m22:00:22.327404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:22.330836 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:00:22.344691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:22.348397 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:22.349449 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:00:22.350998 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:22.352347 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:00:22.354353 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m22:00:22.356049 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:00:22.358842 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m22:00:22.362435 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m22:00:22.368094 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:00:22.376072 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:00:22.384545 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:00:22.385481 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:00:22.393467 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:00:22.395277 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:00:22.403380 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:00:22.404715 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m22:00:22.407158 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m22:00:22.408063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:22.410853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:22.411606 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:22.416329 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:00:22.421271 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:00:22.427958 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:00:22.429245 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:00:22.430845 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m22:00:22.432468 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m22:00:22.434473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:22.436012 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:22.437923 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:22.470233 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m22:00:22.473436 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m22:00:22.477586 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m22:00:22.479308 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:00:22.481023 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:00:22.482699 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:00:22.484221 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m22:00:22.485416 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m22:00:22.486877 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m22:00:22.490113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:22.491734 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:22.493296 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:22.504899 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m22:00:22.513975 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m22:00:22.522657 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m22:00:22.541250 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:00:22.543721 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:00:22.546913 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:00:22.549443 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m22:00:22.551318 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m22:00:22.552701 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m22:00:22.560635 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:00:22.568037 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m22:00:22.568868 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:00:22.569599 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:00:22.577273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a8051f250>]}
[0m22:00:22.582618 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m22:00:22.587918 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m22:00:22.591111 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.42s]
[0m22:00:22.596513 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a8142d9d0>]}
[0m22:00:22.600501 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a8051e590>]}
[0m22:00:22.605204 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m22:00:22.608337 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.44s]
[0m22:00:22.614069 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.45s]
[0m22:00:22.618532 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:00:22.620489 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:00:22.623295 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m22:00:22.625784 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m22:00:22.629829 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m22:00:22.632394 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m22:00:22.634750 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:00:22.639234 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:00:22.642449 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m22:00:22.645042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m22:00:22.649091 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m22:00:22.651431 [info ] [Thread-3 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m22:00:22.655584 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:00:22.659274 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:00:22.660969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m22:00:22.663385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m22:00:22.699479 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:00:22.704959 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:00:22.707137 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:00:22.711276 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:00:22.896538 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:00:22.918307 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:00:22.930045 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:00:22.931111 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:00:22.982233 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:00:22.988236 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:00:23.000492 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:00:23.002478 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:00:23.012524 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:00:23.027943 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:00:23.038941 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:00:23.040724 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:00:23.044826 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m22:00:23.046721 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:00:23.048647 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:00:23.049546 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m22:00:23.052736 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:00:23.056692 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m22:00:23.058518 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m22:00:23.061658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:23.066439 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:23.068016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:23.094303 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.095575 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.097508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.099375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.101928 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:00:23.104839 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:00:23.109937 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:00:23.111867 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:00:23.114094 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m22:00:23.118989 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m22:00:23.121342 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:23.125844 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m22:00:23.134070 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.142708 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.145406 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.153700 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.157543 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m22:00:23.165158 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m22:00:23.169801 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m22:00:23.175395 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m22:00:23.179031 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m22:00:23.182499 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m22:00:23.184475 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m22:00:23.186670 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m22:00:23.190761 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.55s]
[0m22:00:23.194336 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.55s]
[0m22:00:23.199640 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.54s]
[0m22:00:23.203795 [info ] [Thread-3 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.54s]
[0m22:00:23.211177 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:00:23.215056 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:00:23.219705 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:00:23.222606 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:00:23.227336 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:00:23.229285 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:00:23.231653 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:00:23.236213 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:00:23.237892 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m22:00:23.239374 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m22:00:23.242541 [info ] [Thread-2 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m22:00:23.245924 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m22:00:23.248124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m22:00:23.250686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m22:00:23.254404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m22:00:23.256624 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m22:00:23.259859 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:00:23.264105 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:00:23.266085 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:00:23.269099 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:00:23.281616 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:00:23.292092 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:00:23.310778 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:00:23.320043 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:00:23.331766 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:00:23.336248 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:00:23.346586 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:00:23.347275 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:00:23.353536 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:00:23.360281 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:00:23.365529 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:00:23.372960 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:00:23.385810 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:00:23.388564 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:00:23.391706 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m22:00:23.392884 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:00:23.394475 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:00:23.398085 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m22:00:23.400122 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:23.401593 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m22:00:23.404529 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m22:00:23.408526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:23.413530 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:23.418138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:23.429093 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.436438 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:00:23.438525 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m22:00:23.441494 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.446764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.450084 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.453887 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:00:23.456754 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:00:23.461429 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:00:23.464203 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m22:00:23.468138 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:23.472302 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m22:00:23.480044 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.491210 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m22:00:23.492468 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.499131 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.500287 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m22:00:23.506642 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m22:00:23.512899 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m22:00:23.515173 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.518442 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.27s]
[0m22:00:23.520709 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m22:00:23.525291 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m22:00:23.530852 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m22:00:23.534987 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:00:23.537368 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.28s]
[0m22:00:23.546454 [info ] [Thread-2 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.29s]
[0m22:00:23.553877 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m22:00:23.556002 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:00:23.561786 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:00:23.564905 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:00:23.570768 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.32s]
[0m22:00:23.572952 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m22:00:23.580527 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m22:00:23.586825 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:00:23.589684 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m22:00:23.592923 [info ] [Thread-3 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m22:00:23.598427 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m22:00:23.599431 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:00:23.601446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.dim_customer)
[0m22:00:23.605369 [info ] [Thread-2 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m22:00:23.619221 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:00:23.622706 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m22:00:23.625978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_revenue_daily)
[0m22:00:23.636153 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m22:00:23.638055 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m22:00:23.643384 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:00:23.653532 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m22:00:23.662682 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:00:23.663861 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m22:00:23.716000 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:00:23.723126 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m22:00:23.734369 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m22:00:23.735506 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m22:00:23.753759 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m22:00:23.759025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:23.769388 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:00:23.770751 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:00:23.772289 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m22:00:23.775251 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m22:00:23.778628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:00:23.780580 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:23.781653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.791241 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:00:23.796537 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:23.805489 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.807527 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:23.811676 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:00:23.815251 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:00:23.817427 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m22:00:23.820439 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m22:00:23.844530 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:00:23.854798 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:00:23.860679 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m22:00:23.863946 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:23.873360 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:00:23.874798 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:23.877753 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m22:00:23.882320 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m22:00:23.887519 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:23.889429 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m22:00:23.908980 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m22:00:23.911062 [debug] [Thread-2 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m22:00:23.914064 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.32s]
[0m22:00:23.915928 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:00:23.934459 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:00:23.936617 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:00:23.940901 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m22:00:23.942973 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m22:00:23.946237 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m22:00:23.952222 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:23.953127 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m22:00:23.967892 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:00:23.969204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.fct_marketing_attribution)
[0m22:00:23.970612 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m22:00:23.972980 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m22:00:23.985371 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:23.986585 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:23.991669 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.000014 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m22:00:24.006424 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m22:00:24.022119 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:00:24.024062 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:00:24.026091 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m22:00:24.030038 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m22:00:24.031657 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m22:00:24.042695 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:24.046630 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.048713 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:00:24.059560 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m22:00:24.066516 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m22:00:24.070411 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:00:24.074448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a802d6250>]}
[0m22:00:24.084980 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m22:00:24.091131 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.088898 [info ] [Thread-3 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.47s]
[0m22:00:24.101166 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m22:00:24.104360 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m22:00:24.106431 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:00:24.107833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:24.116120 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m22:00:24.122478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a82d4db50>]}
[0m22:00:24.128466 [info ] [Thread-2 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4336[0m in 0.50s]
[0m22:00:24.131873 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m22:00:24.135544 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:00:24.137623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:24.138771 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m22:00:24.141261 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.144423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m22:00:24.149544 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m22:00:24.152460 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:00:24.169736 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:00:24.183864 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:00:24.194721 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:00:24.206843 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:00:24.209663 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m22:00:24.211416 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:00:24.226797 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:24.229054 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:00:24.231087 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m22:00:24.235728 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:24.239881 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m22:00:24.245320 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m22:00:24.247964 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.10s]
[0m22:00:24.251783 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:00:24.268793 [debug] [Thread-1 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m22:00:24.277838 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.280560 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m22:00:24.283299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:24.295427 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.297210 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m22:00:24.301096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:24.304736 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m22:00:24.306506 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.307956 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m22:00:24.330965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:24.336330 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m22:00:24.338443 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:00:24.340023 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m22:00:24.346704 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:00:24.350952 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m22:00:24.354321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08189412-465c-415d-9301-ba12910e6c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a8100ee50>]}
[0m22:00:24.357490 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5698[0m in 0.38s]
[0m22:00:24.363319 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m22:00:24.367234 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:00:24.370164 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m22:00:24.373665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m22:00:24.375577 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:00:24.385639 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:00:24.398410 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:00:24.405856 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:00:24.419582 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:00:24.421177 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m22:00:24.422760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:00:24.440773 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:24.443605 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:00:24.446960 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m22:00:24.452704 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:00:24.457628 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m22:00:24.460246 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m22:00:24.463671 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.09s]
[0m22:00:24.466910 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:00:24.473260 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:24.475294 [debug] [MainThread]: On master: BEGIN
[0m22:00:24.477879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:24.494699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:00:24.499245 [debug] [MainThread]: On master: COMMIT
[0m22:00:24.501269 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:24.503435 [debug] [MainThread]: On master: COMMIT
[0m22:00:24.509124 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:00:24.511824 [debug] [MainThread]: On master: Close
[0m22:00:24.515252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:24.517058 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m22:00:24.518790 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m22:00:24.520898 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m22:00:24.525778 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m22:00:24.527844 [info ] [MainThread]: 
[0m22:00:24.530140 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m22:00:24.536321 [debug] [MainThread]: Command end result
[0m22:00:24.673255 [info ] [MainThread]: 
[0m22:00:24.676327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:24.679458 [info ] [MainThread]: 
[0m22:00:24.682145 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m22:00:24.685821 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.4917946, "process_user_time": 4.942422, "process_kernel_time": 0.669838, "process_mem_max_rss": "116428", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:24.688778 [debug] [MainThread]: Command `dbt build` succeeded at 22:00:24.688220 after 5.49 seconds
[0m22:00:24.690478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a86bec990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a86d70650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a86d714d0>]}
[0m22:00:24.692143 [debug] [MainThread]: Flushing usage events
[0m22:15:16.710959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b6f2a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b6f2a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b6f2a4d0>]}


============================== 22:15:16.749492 | e594869b-d1d0-4b95-a683-16fa0138c349 ==============================
[0m22:15:16.749492 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:16.751594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:16.981693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e594869b-d1d0-4b95-a683-16fa0138c349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b70f81d0>]}
[0m22:15:17.628430 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2_encj94'
[0m22:15:17.631622 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:15:17.912201 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:15:17.916115 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:15:18.097674 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:15:18.108310 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:15:23.888447 [info ] [MainThread]: Installed from version 1.3.1
[0m22:15:23.890065 [info ] [MainThread]: Up to date!
[0m22:15:23.892055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e594869b-d1d0-4b95-a683-16fa0138c349', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b70f8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b6e426d0>]}
[0m22:15:23.895402 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.948403, "process_user_time": 3.455523, "process_kernel_time": 1.179475, "process_mem_max_rss": "94684", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m22:15:23.897278 [debug] [MainThread]: Command `dbt deps` succeeded at 22:15:23.896992 after 9.95 seconds
[0m22:15:23.898715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b6f4d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6b7264c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6bad48890>]}
[0m22:15:23.900225 [debug] [MainThread]: Flushing usage events
[0m22:15:29.571022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103ed36a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103ed74490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103ed74390>]}


============================== 22:15:29.583870 | d47a43a4-22fb-4e1c-886f-235811679939 ==============================
[0m22:15:29.583870 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:29.590771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:29.969665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103d45fd10>]}
[0m22:15:30.074746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1042a6cf90>]}
[0m22:15:30.077566 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:30.144353 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:15:30.563034 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:15:30.570053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1040247190>]}
[0m22:15:35.355848 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:15:35.357761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103d3aec10>]}
[0m22:15:35.650362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103d39d450>]}
[0m22:15:35.859380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f101fef51d0>]}
[0m22:15:35.861507 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m22:15:35.869039 [info ] [MainThread]: 
[0m22:15:35.872508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:35.884422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m22:15:35.886650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m22:15:36.036052 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m22:15:36.036657 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m22:15:36.038280 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m22:15:36.040807 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m22:15:36.043217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:36.045283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:36.080069 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:15:36.081044 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:15:36.086019 [debug] [ThreadPool]: On list_db: Close
[0m22:15:36.090940 [debug] [ThreadPool]: On list_db: Close
[0m22:15:36.097964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__analytics)
[0m22:15:36.099139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__staging)
[0m22:15:36.104501 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_analytics"
"
[0m22:15:36.107290 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_staging"
"
[0m22:15:36.123846 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m22:15:36.128671 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m22:15:36.131007 [debug] [ThreadPool]: On create_db__analytics: BEGIN
[0m22:15:36.133553 [debug] [ThreadPool]: On create_db__staging: BEGIN
[0m22:15:36.135372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:36.137049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:36.154810 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.157576 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.159939 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m22:15:36.162379 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m22:15:36.164260 [debug] [ThreadPool]: On create_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__analytics"} */
create schema if not exists "_analytics"
[0m22:15:36.165879 [debug] [ThreadPool]: On create_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__staging"} */
create schema if not exists "_staging"
[0m22:15:36.175369 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m22:15:36.176372 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m22:15:36.179638 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m22:15:36.181862 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m22:15:36.183623 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m22:15:36.185369 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m22:15:36.187552 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m22:15:36.188868 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m22:15:36.192582 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m22:15:36.194467 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m22:15:36.196067 [debug] [ThreadPool]: On create_db__analytics: Close
[0m22:15:36.197872 [debug] [ThreadPool]: On create_db__staging: Close
[0m22:15:36.204178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__analytics, now list_db__analytics)
[0m22:15:36.206169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__staging, now list_db__staging)
[0m22:15:36.219446 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m22:15:36.224461 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m22:15:36.226646 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m22:15:36.228213 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m22:15:36.229644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:36.231314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:36.248147 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.249266 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.251911 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m22:15:36.254161 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m22:15:36.256060 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m22:15:36.258083 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m22:15:36.273574 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:15:36.274494 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:15:36.281966 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m22:15:36.288155 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m22:15:36.291853 [debug] [ThreadPool]: On list_db__staging: Close
[0m22:15:36.294400 [debug] [ThreadPool]: On list_db__analytics: Close
[0m22:15:36.308866 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.311767 [debug] [MainThread]: On master: BEGIN
[0m22:15:36.315406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:36.334522 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.336713 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.342226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:36.421530 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m22:15:36.426241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103c05e610>]}
[0m22:15:36.428300 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:36.431569 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.433627 [debug] [MainThread]: On master: BEGIN
[0m22:15:36.441211 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.444105 [debug] [MainThread]: On master: COMMIT
[0m22:15:36.447032 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.448778 [debug] [MainThread]: On master: COMMIT
[0m22:15:36.450973 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:15:36.452663 [debug] [MainThread]: On master: Close
[0m22:15:36.455175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:36.459737 [info ] [MainThread]: 
[0m22:15:36.468492 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m22:15:36.469869 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m22:15:36.470649 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m22:15:36.472289 [info ] [Thread-1 (]: 1 of 17 START sql view model _staging.stg_customers ............................ [RUN]
[0m22:15:36.474332 [info ] [Thread-2 (]: 2 of 17 START sql view model _staging.stg_payments ............................. [RUN]
[0m22:15:36.476417 [info ] [Thread-3 (]: 3 of 17 START sql view model _staging.stg_sessions ............................. [RUN]
[0m22:15:36.479803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_customers)
[0m22:15:36.482488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_payments)
[0m22:15:36.484944 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m22:15:36.486242 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m22:15:36.488398 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m22:15:36.490183 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m22:15:36.502058 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m22:15:36.507421 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m22:15:36.512259 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m22:15:36.522927 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m22:15:36.523993 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m22:15:36.531626 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m22:15:36.612582 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m22:15:36.614128 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m22:15:36.619700 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m22:15:36.629902 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:15:36.631371 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:15:36.633290 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m22:15:36.634628 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:15:36.636404 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m22:15:36.638269 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:36.639999 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m22:15:36.642036 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:15:36.646751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:36.661192 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.663582 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:15:36.665551 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.668435 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m22:15:36.671322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:36.673487 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:15:36.678070 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:15:36.681051 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m22:15:36.684663 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m22:15:36.695094 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:36.696046 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:36.696749 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:36.711370 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:15:36.720388 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:15:36.724999 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:15:36.727696 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m22:15:36.729241 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:15:36.730525 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m22:15:36.733060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:36.733720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:36.741564 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:36.754945 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m22:15:36.756940 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m22:15:36.759887 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m22:15:36.761715 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:15:36.763356 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:15:36.764561 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:15:36.765651 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m22:15:36.767230 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m22:15:36.769206 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m22:15:36.777960 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:36.778887 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:36.779395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:36.793320 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m22:15:36.797319 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m22:15:36.802983 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m22:15:36.814492 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m22:15:36.816404 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m22:15:36.818964 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m22:15:36.820612 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m22:15:36.822269 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m22:15:36.823396 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m22:15:36.828325 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:36.828862 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:36.829523 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:36.832843 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m22:15:36.835643 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m22:15:36.838535 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m22:15:36.841790 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f101eabf210>]}
[0m22:15:36.844051 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f101ea0c2d0>]}
[0m22:15:36.846279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103d173850>]}
[0m22:15:36.850123 [info ] [Thread-3 (]: 3 of 17 OK created sql view model _staging.stg_sessions ........................ [[32mCREATE VIEW[0m in 0.36s]
[0m22:15:36.852566 [info ] [Thread-2 (]: 2 of 17 OK created sql view model _staging.stg_payments ........................ [[32mCREATE VIEW[0m in 0.36s]
[0m22:15:36.854981 [info ] [Thread-1 (]: 1 of 17 OK created sql view model _staging.stg_customers ....................... [[32mCREATE VIEW[0m in 0.37s]
[0m22:15:36.857623 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m22:15:36.859378 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m22:15:36.860931 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m22:15:36.863699 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:15:36.864398 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:15:36.865552 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:15:36.867261 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:15:36.869577 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m22:15:36.872439 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m22:15:36.874874 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m22:15:36.876553 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m22:15:36.878765 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m22:15:36.880796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m22:15:36.882992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m22:15:36.885152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m22:15:36.887231 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:15:36.888890 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:15:36.890597 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:15:36.892753 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:15:36.899877 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:15:36.919467 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:15:36.943032 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:15:36.958333 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:15:36.968904 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:15:36.970540 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:15:36.972755 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:15:36.980081 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:15:37.038963 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:15:37.042012 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:15:37.046986 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:15:37.052566 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:15:37.090159 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:15:37.096764 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:15:37.105520 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m22:15:37.111237 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:15:37.137292 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m22:15:37.119244 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:15:37.131455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:37.117901 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m22:15:37.142932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:37.146408 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m22:15:37.151991 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:37.160491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:15:37.174126 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.179630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.180869 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m22:15:37.183303 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m22:15:37.190446 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.193925 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:37.195200 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.197967 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m22:15:37.200342 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m22:15:37.204344 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m22:15:37.208849 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m22:15:37.211595 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m22:15:37.216738 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.226594 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m22:15:37.228302 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.229316 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m22:15:37.232527 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m22:15:37.234849 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.35s]
[0m22:15:37.236733 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m22:15:37.239104 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m22:15:37.241970 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.36s]
[0m22:15:37.243645 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:15:37.246224 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m22:15:37.247678 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m22:15:37.249753 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:15:37.251792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m22:15:37.253520 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m22:15:37.255372 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:15:37.257513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m22:15:37.267329 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:15:37.269208 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:15:37.270947 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.280025 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:15:37.280720 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.283158 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m22:15:37.285576 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:15:37.288180 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m22:15:37.290859 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m22:15:37.291769 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:15:37.296673 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:15:37.299569 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m22:15:37.301236 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.42s]
[0m22:15:37.310728 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:15:37.313862 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.43s]
[0m22:15:37.315545 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m22:15:37.318478 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m22:15:37.320114 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:15:37.322113 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:15:37.325973 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:15:37.324703 [info ] [Thread-4 (]: 10 of 17 START test not_null_stg_customers_country ............................. [RUN]
[0m22:15:37.327644 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:15:37.329132 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m22:15:37.331578 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m22:15:37.333755 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m22:15:37.335453 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m22:15:37.337234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m22:15:37.338929 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:37.340863 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:15:37.342924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:37.344419 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:15:37.352885 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:15:37.366270 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:15:37.368679 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.372400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.375452 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m22:15:37.378607 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m22:15:37.379709 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:15:37.380589 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:15:37.382152 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m22:15:37.384147 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:37.399534 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:15:37.410529 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:15:37.417270 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.427065 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m22:15:37.429909 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m22:15:37.434752 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.18s]
[0m22:15:37.439223 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m22:15:37.441895 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.443429 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:15:37.445813 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:15:37.446866 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:15:37.451494 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m22:15:37.453326 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m22:15:37.455314 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_customers_customer_id ........................... [RUN]
[0m22:15:37.457476 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m22:15:37.460756 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m22:15:37.461971 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:15:37.463669 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m22:15:37.465316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:37.467517 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.21s]
[0m22:15:37.471439 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:15:37.475969 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m22:15:37.490653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.492531 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:15:37.494655 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m22:15:37.496205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.498443 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m22:15:37.501420 [info ] [Thread-1 (]: 13 of 17 START sql table model _analytics.fct_marketing_attribution ............ [RUN]
[0m22:15:37.503339 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:15:37.506186 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m22:15:37.508054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.fct_marketing_attribution)
[0m22:15:37.510624 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m22:15:37.514554 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m22:15:37.515763 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:15:37.517055 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.524813 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.523831 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m22:15:37.531065 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:15:37.535674 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m22:15:37.539221 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m22:15:37.544659 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m22:15:37.547465 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m22:15:37.549893 [info ] [Thread-4 (]: 10 of 17 PASS not_null_stg_customers_country ................................... [[32mPASS[0m in 0.22s]
[0m22:15:37.553612 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.22s]
[0m22:15:37.555765 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m22:15:37.558150 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m22:15:37.559218 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:15:37.562410 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:15:37.587887 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m22:15:37.602699 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m22:15:37.604744 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m22:15:37.608672 [info ] [Thread-4 (]: 14 of 17 START sql table model _analytics.fct_revenue_daily .................... [RUN]
[0m22:15:37.614251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:37.616540 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now model.api_bi_project.fct_revenue_daily)
[0m22:15:37.620521 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m22:15:37.627596 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m22:15:37.635333 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:15:37.637311 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.638575 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m22:15:37.640888 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m22:15:37.646515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:37.649640 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:37.652648 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m22:15:37.659740 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:37.674163 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m22:15:37.676074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.680788 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m22:15:37.684571 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:15:37.687156 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m22:15:37.688982 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m22:15:37.691650 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.23s]
[0m22:15:37.697294 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m22:15:37.700320 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:15:37.702491 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m22:15:37.704851 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m22:15:37.708373 [info ] [Thread-2 (]: 15 of 17 START sql table model _analytics.dim_customer ......................... [RUN]
[0m22:15:37.714634 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:15:37.717815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.dim_customer)
[0m22:15:37.721090 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m22:15:37.808318 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m22:15:37.809282 [debug] [Thread-1 (]: SQL status: SELECT 5698 in 0.0 seconds
[0m22:15:37.810004 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.817883 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:15:37.820184 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:15:37.822215 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m22:15:37.824106 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m22:15:37.827197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:37.828861 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m22:15:37.838781 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m22:15:37.845483 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m22:15:37.847161 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:15:37.850953 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m22:15:37.876220 [debug] [Thread-4 (]: SQL status: SELECT 4336 in 0.0 seconds
[0m22:15:37.877059 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:15:37.884259 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:37.885056 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:15:37.887095 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m22:15:37.891858 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m22:15:37.893585 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m22:15:37.895009 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:37.900674 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m22:15:37.903429 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:37.905881 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m22:15:37.909864 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m22:15:37.911832 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:15:37.913052 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:15:37.916379 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m22:15:37.918418 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m22:15:37.920555 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:37.922830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103c013510>]}
[0m22:15:37.930833 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:15:37.933018 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:37.935328 [info ] [Thread-1 (]: 13 of 17 OK created sql table model _analytics.fct_marketing_attribution ....... [[32mSELECT 5698[0m in 0.41s]
[0m22:15:37.937524 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m22:15:37.946047 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m22:15:37.949450 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m22:15:37.953329 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m22:15:37.956784 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:15:37.958623 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m22:15:37.960458 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m22:15:37.963318 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:15:37.966464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m22:15:37.969062 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:15:37.972654 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m22:15:37.974757 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:15:37.980384 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:15:37.983961 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ffbfc3d90>]}
[0m22:15:37.994117 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:15:37.995657 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m22:15:37.997746 [info ] [Thread-4 (]: 14 of 17 OK created sql table model _analytics.fct_revenue_daily ............... [[32mSELECT 4336[0m in 0.37s]
[0m22:15:38.002468 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m22:15:38.003478 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:38.006006 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:15:38.009863 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m22:15:38.011963 [info ] [Thread-1 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m22:15:38.013766 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:15:38.014976 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:15:38.017836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m22:15:38.020327 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m22:15:38.025814 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:15:38.028034 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:15:38.046548 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:38.047512 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:15:38.055334 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:15:38.054368 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m22:15:38.057837 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m22:15:38.060051 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m22:15:38.061816 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:38.063952 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m22:15:38.069515 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:15:38.070495 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:15:38.075837 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:15:38.079881 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m22:15:38.083652 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:38.087415 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47a43a4-22fb-4e1c-886f-235811679939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103d2c2350>]}
[0m22:15:38.089631 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m22:15:38.093964 [info ] [Thread-2 (]: 15 of 17 OK created sql table model _analytics.dim_customer .................... [[32mSELECT 1000[0m in 0.37s]
[0m22:15:38.096194 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m22:15:38.099202 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m22:15:38.100437 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:15:38.105654 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m22:15:38.106295 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:38.107513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:38.111796 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m22:15:38.117085 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m22:15:38.122738 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.16s]
[0m22:15:38.125490 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m22:15:38.130318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:38.132485 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m22:15:38.135428 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m22:15:38.139542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:15:38.142534 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m22:15:38.144011 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m22:15:38.145633 [info ] [Thread-1 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.13s]
[0m22:15:38.147710 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m22:15:38.152953 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.154579 [debug] [MainThread]: On master: BEGIN
[0m22:15:38.155983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:38.169899 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:38.171888 [debug] [MainThread]: On master: COMMIT
[0m22:15:38.173549 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.175625 [debug] [MainThread]: On master: COMMIT
[0m22:15:38.177627 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:15:38.179056 [debug] [MainThread]: On master: Close
[0m22:15:38.180498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:38.181667 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m22:15:38.183166 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m22:15:38.185193 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m22:15:38.186455 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m22:15:38.187914 [info ] [MainThread]: 
[0m22:15:38.189356 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m22:15:38.194936 [debug] [MainThread]: Command end result
[0m22:15:38.294279 [info ] [MainThread]: 
[0m22:15:38.296485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:38.298646 [info ] [MainThread]: 
[0m22:15:38.300762 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m22:15:38.305017 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.862325, "process_user_time": 7.324789, "process_kernel_time": 0.907266, "process_mem_max_rss": "120724", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:38.307457 [debug] [MainThread]: Command `dbt build` succeeded at 22:15:38.307253 after 8.87 seconds
[0m22:15:38.309065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103ed87c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1042c4bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1042b54810>]}
[0m22:15:38.310817 [debug] [MainThread]: Flushing usage events
[0m23:00:03.151692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563067b90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563067bb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563067d75d0>]}


============================== 23:00:01.375880 | c823c92e-914d-4519-9633-6a15739ae39c ==============================
[0m23:00:01.375880 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:00:01.378441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:01.633905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c823c92e-914d-4519-9633-6a15739ae39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563066abf50>]}
[0m23:00:02.498280 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tpko2gq2'
[0m23:00:02.500146 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:00:02.759476 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:00:02.765297 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:00:02.894416 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:00:02.910887 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:00:10.487768 [info ] [MainThread]: Installed from version 1.3.1
[0m23:00:10.490110 [info ] [MainThread]: Up to date!
[0m23:00:10.493731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c823c92e-914d-4519-9633-6a15739ae39c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563066aebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75630661a290>]}
[0m23:00:10.497678 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.361826, "process_user_time": 3.062559, "process_kernel_time": 1.551947, "process_mem_max_rss": "94404", "process_in_blocks": "87544", "process_out_blocks": "1296"}
[0m23:00:10.500598 [debug] [MainThread]: Command `dbt deps` succeeded at 23:00:10.500374 after 9.36 seconds
[0m23:00:10.502386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75630695c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75630695c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75630a5b4790>]}
[0m23:00:10.504046 [debug] [MainThread]: Flushing usage events
[0m23:00:15.365055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf68322c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf6849b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf682dbf90>]}


============================== 23:00:15.370810 | 87a121f3-5cbf-495c-822e-840a16e1d8d9 ==============================
[0m23:00:15.370810 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:00:15.373199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:16.206844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf68219c90>]}
[0m23:00:16.579186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf6bfecf50>]}
[0m23:00:16.590458 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:00:16.857475 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:00:17.379661 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:00:17.384130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf697caf10>]}
[0m23:00:23.064252 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:00:23.066113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf66734ad0>]}
[0m23:00:23.614615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf667dd150>]}
[0m23:00:23.891521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf655c38d0>]}
[0m23:00:23.894755 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:00:23.898913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf655aa390>]}
[0m23:00:23.915541 [info ] [MainThread]: 
[0m23:00:23.926655 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:23.958871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:00:23.963015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:00:24.393427 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:00:24.394571 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:00:24.397204 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:00:24.399358 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:00:24.401953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:24.403399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:24.443948 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:00:24.444727 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:00:24.447731 [debug] [ThreadPool]: On list_db: Close
[0m23:00:24.450885 [debug] [ThreadPool]: On list_db: Close
[0m23:00:24.456548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__analytics)
[0m23:00:24.457937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__staging)
[0m23:00:24.464155 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_analytics"
"
[0m23:00:24.466230 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_staging"
"
[0m23:00:24.479308 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:00:24.487275 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:00:24.489006 [debug] [ThreadPool]: On create_db__analytics: BEGIN
[0m23:00:24.493076 [debug] [ThreadPool]: On create_db__staging: BEGIN
[0m23:00:24.495741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:24.497407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:24.515477 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:00:24.520156 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:00:24.521310 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:00:24.523172 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:00:24.525123 [debug] [ThreadPool]: On create_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__analytics"} */
create schema if not exists "_analytics"
[0m23:00:24.528630 [debug] [ThreadPool]: On create_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__staging"} */
create schema if not exists "_staging"
[0m23:00:24.532669 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:00:24.534156 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:00:24.537585 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:00:24.541755 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:00:24.546864 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:00:24.549893 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:00:24.552796 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:00:24.556829 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:00:24.563951 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:00:24.566214 [debug] [ThreadPool]: On create_db__analytics: Close
[0m23:00:24.567252 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:00:24.574918 [debug] [ThreadPool]: On create_db__staging: Close
[0m23:00:24.582704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__staging, now list_db__analytics)
[0m23:00:24.585387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__analytics, now list_db__staging)
[0m23:00:24.601781 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:00:24.606558 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:00:24.608155 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:00:24.611006 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:00:24.614869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:24.616891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:24.636505 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:00:24.645132 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:00:24.650309 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:00:24.651955 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:00:24.653693 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:00:24.656299 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:00:24.667507 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:00:24.668392 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:00:24.672784 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:00:24.683181 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:00:24.687058 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:00:24.689416 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:00:24.713333 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:24.715885 [debug] [MainThread]: On master: BEGIN
[0m23:00:24.717324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:24.744870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:24.752665 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:24.755406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:24.774838 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:00:24.778442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf655d63d0>]}
[0m23:00:24.781824 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:24.785897 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:24.789244 [debug] [MainThread]: On master: BEGIN
[0m23:00:24.793536 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:24.797365 [debug] [MainThread]: On master: COMMIT
[0m23:00:24.805041 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:24.806994 [debug] [MainThread]: On master: COMMIT
[0m23:00:24.809037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:24.811187 [debug] [MainThread]: On master: Close
[0m23:00:24.824225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:24.835145 [info ] [MainThread]: 
[0m23:00:24.877754 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:00:24.879672 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:00:24.881129 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:00:24.883006 [info ] [Thread-1 (]: 1 of 6 START sql view model _staging.stg_customers ............................. [RUN]
[0m23:00:24.887193 [info ] [Thread-2 (]: 2 of 6 START sql view model _staging.stg_payments .............................. [RUN]
[0m23:00:24.899277 [info ] [Thread-3 (]: 3 of 6 START sql view model _staging.stg_sessions .............................. [RUN]
[0m23:00:24.912955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_customers)
[0m23:00:24.919921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_payments)
[0m23:00:24.925236 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:00:24.927438 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:00:24.943867 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:00:24.949402 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:00:24.996377 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:00:25.000312 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:00:25.009225 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:00:25.036496 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:00:25.037814 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:00:25.065143 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:00:25.229882 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:00:25.232650 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:00:25.225731 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:00:25.244202 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:00:25.245037 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:00:25.246612 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:00:25.247869 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:00:25.248962 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:00:25.250485 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:25.253103 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:00:25.254464 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:00:25.256848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:25.273159 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:25.276892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:25.278176 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:25.279392 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:00:25.281990 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:00:25.284027 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:00:25.286516 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:00:25.288663 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:00:25.291047 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:00:25.301596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:00:25.303143 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:00:25.304387 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:00:25.328464 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:00:25.335535 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:00:25.345467 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:00:25.347274 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:00:25.349381 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:00:25.353968 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:00:25.358423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:25.360704 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:25.363919 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:25.409520 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:00:25.413477 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:00:25.417854 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:00:25.420585 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:00:25.423602 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:00:25.427834 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:00:25.430246 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:00:25.432084 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:00:25.434489 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:00:25.439401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:25.440551 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:25.442220 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:25.463992 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:00:25.468647 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:00:25.474355 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:00:25.486022 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:00:25.489396 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:00:25.492198 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:00:25.494139 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:00:25.496259 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:00:25.498372 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:00:25.501679 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:00:25.503480 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:00:25.505280 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:00:25.510380 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:00:25.518541 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:00:25.522898 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:00:25.528798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf654d5110>]}
[0m23:00:25.531004 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf655aa7d0>]}
[0m23:00:25.532900 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf640f6b90>]}
[0m23:00:25.538985 [info ] [Thread-1 (]: 1 of 6 OK created sql view model _staging.stg_customers ........................ [[32mCREATE VIEW[0m in 0.61s]
[0m23:00:25.543143 [info ] [Thread-2 (]: 2 of 6 OK created sql view model _staging.stg_payments ......................... [[32mCREATE VIEW[0m in 0.61s]
[0m23:00:25.547566 [info ] [Thread-3 (]: 3 of 6 OK created sql view model _staging.stg_sessions ......................... [[32mCREATE VIEW[0m in 0.61s]
[0m23:00:25.550564 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:00:25.553256 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:00:25.557163 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:00:25.560988 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m23:00:25.564582 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:00:25.567697 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:00:25.568971 [info ] [Thread-4 (]: 4 of 6 START sql table model _analytics.dim_customer ........................... [RUN]
[0m23:00:25.571657 [info ] [Thread-1 (]: 5 of 6 START sql table model _analytics.fct_revenue_daily ...................... [RUN]
[0m23:00:25.577414 [info ] [Thread-2 (]: 6 of 6 START sql table model _analytics.fct_marketing_attribution .............. [RUN]
[0m23:00:25.584451 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m23:00:25.587289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m23:00:25.594533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m23:00:25.600234 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:00:25.602872 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:00:25.604737 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:00:25.614060 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:00:25.625435 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:00:25.640955 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:00:25.654863 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:00:25.656382 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:00:25.668294 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m23:00:25.750872 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:00:25.755601 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:00:25.766580 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:00:25.785423 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:00:25.787231 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:00:25.788532 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:00:25.790400 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:00:25.793443 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:00:25.797147 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:00:25.799229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:25.802095 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:25.805856 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:00:25.833949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:25.836582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:25.839336 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:00:25.841648 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:25.842791 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:00:25.845675 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:00:25.852380 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:00:25.854771 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:00:25.869978 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:00:25.906275 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:00:25.933190 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:00:25.934462 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:00:25.932278 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:00:25.948829 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:00:25.956271 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:00:25.959824 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:00:25.962803 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:00:25.967014 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:00:25.972705 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:25.974324 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:25.978032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:25.993470 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:00:25.998884 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:00:26.003354 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:00:26.006247 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:00:26.007960 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:00:26.009465 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:00:26.011430 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:00:26.015741 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:00:26.018015 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:00:26.023664 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:26.026105 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:26.027783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:26.035138 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:00:26.041675 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:00:26.047712 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:00:26.055404 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:00:26.058531 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:00:26.061338 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:00:26.063899 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:00:26.066474 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:00:26.069300 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:00:26.071938 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:00:26.073695 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:00:26.075929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:00:26.078727 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:00:26.082133 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m23:00:26.085166 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:00:26.087679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf6423e790>]}
[0m23:00:26.090065 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf6413ce90>]}
[0m23:00:26.092469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a121f3-5cbf-495c-822e-840a16e1d8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf64148650>]}
[0m23:00:26.094510 [info ] [Thread-2 (]: 6 of 6 OK created sql table model _analytics.fct_marketing_attribution ......... [[32mSELECT 0[0m in 0.49s]
[0m23:00:26.097951 [info ] [Thread-4 (]: 4 of 6 OK created sql table model _analytics.dim_customer ...................... [[32mSELECT 0[0m in 0.51s]
[0m23:00:26.104617 [info ] [Thread-1 (]: 5 of 6 OK created sql table model _analytics.fct_revenue_daily ................. [[32mSELECT 0[0m in 0.51s]
[0m23:00:26.109876 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:00:26.114097 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m23:00:26.126324 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:00:26.156179 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:26.158619 [debug] [MainThread]: On master: BEGIN
[0m23:00:26.162373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:26.182979 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:26.188100 [debug] [MainThread]: On master: COMMIT
[0m23:00:26.190533 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:26.192133 [debug] [MainThread]: On master: COMMIT
[0m23:00:26.194125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:26.199298 [debug] [MainThread]: On master: Close
[0m23:00:26.202388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:26.204564 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m23:00:26.207293 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m23:00:26.208905 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m23:00:26.210332 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:00:26.211983 [info ] [MainThread]: 
[0m23:00:26.217705 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m23:00:26.228430 [debug] [MainThread]: Command end result
[0m23:00:26.509169 [info ] [MainThread]: 
[0m23:00:26.528675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:26.542513 [info ] [MainThread]: 
[0m23:00:26.550340 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:00:26.559202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.386375, "process_user_time": 8.84562, "process_kernel_time": 1.256609, "process_mem_max_rss": "118808", "process_in_blocks": "17024", "process_out_blocks": "144"}
[0m23:00:26.573608 [debug] [MainThread]: Command `dbt run` succeeded at 23:00:26.573102 after 11.40 seconds
[0m23:00:26.584770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf6832d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf6832fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf6c0d46d0>]}
[0m23:00:26.613368 [debug] [MainThread]: Flushing usage events
[0m23:04:17.369214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757216d01c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757216cbd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757216ce6fd0>]}


============================== 23:04:17.383660 | 592366bb-5ac1-4a5e-9b4c-2bec111336e7 ==============================
[0m23:04:17.383660 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:04:17.388948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:04:17.609483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '592366bb-5ac1-4a5e-9b4c-2bec111336e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757216b5ccd0>]}
[0m23:04:18.416475 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ayttil0y'
[0m23:04:18.419433 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:04:18.670958 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:04:18.673270 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:04:18.755283 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:04:18.764065 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:04:28.430358 [info ] [MainThread]: Installed from version 1.3.1
[0m23:04:28.441727 [info ] [MainThread]: Up to date!
[0m23:04:28.454629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '592366bb-5ac1-4a5e-9b4c-2bec111336e7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757216d0c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757216bbd910>]}
[0m23:04:28.467291 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 11.3246355, "process_user_time": 3.531988, "process_kernel_time": 1.42212, "process_mem_max_rss": "94392", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m23:04:28.479617 [debug] [MainThread]: Command `dbt deps` succeeded at 23:04:28.470426 after 11.33 seconds
[0m23:04:28.486355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757217008a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757216a84a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75721aaa86d0>]}
[0m23:04:28.489670 [debug] [MainThread]: Flushing usage events
[0m23:04:36.889486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b402db7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b402e88150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b402f77a90>]}


============================== 23:04:36.895798 | 37636a55-f90d-4bd2-9c04-360937c4258c ==============================
[0m23:04:36.895798 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:04:36.898333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:36.675687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b401493950>]}
[0m23:04:35.037356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b406aec790>]}
[0m23:04:35.049043 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:04:35.140103 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:04:37.916931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:37.920135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:38.008850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b4014fda10>]}
[0m23:04:38.219387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b400fe4c10>]}
[0m23:04:38.221431 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:04:38.228784 [info ] [MainThread]: 
[0m23:04:38.231617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:04:38.240764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:04:38.242695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:04:38.349560 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:04:38.350391 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:04:38.351666 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:04:38.353181 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:04:38.354626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:38.356542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:38.388162 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:04:38.388984 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:04:38.392187 [debug] [ThreadPool]: On list_db: Close
[0m23:04:38.395840 [debug] [ThreadPool]: On list_db: Close
[0m23:04:38.403205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__analytics)
[0m23:04:38.404953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__staging)
[0m23:04:38.417309 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:04:38.421276 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:04:38.422883 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:04:38.424366 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:04:38.426094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:38.427366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:38.443771 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:04:38.444531 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:04:38.446180 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:04:38.447934 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:04:38.449597 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:04:38.451423 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:04:38.459155 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:04:38.459735 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:04:38.462616 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:04:38.465863 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:04:38.468137 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:04:38.469709 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:04:38.491139 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:38.497112 [debug] [MainThread]: On master: BEGIN
[0m23:04:38.499895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:38.521020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:04:38.523798 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:38.526261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:04:38.605972 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m23:04:38.666354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b406ac3290>]}
[0m23:04:38.685418 [debug] [MainThread]: On master: ROLLBACK
[0m23:04:38.689044 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:38.692883 [debug] [MainThread]: On master: BEGIN
[0m23:04:38.699533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:04:38.703863 [debug] [MainThread]: On master: COMMIT
[0m23:04:38.707067 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:38.711075 [debug] [MainThread]: On master: COMMIT
[0m23:04:38.720540 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:04:38.725649 [debug] [MainThread]: On master: Close
[0m23:04:38.772306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:38.798283 [info ] [MainThread]: 
[0m23:04:38.818708 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:04:38.819817 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:04:38.821085 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:04:38.836915 [info ] [Thread-1 (]: 1 of 17 START sql view model _staging.stg_customers ............................ [RUN]
[0m23:04:38.872158 [info ] [Thread-2 (]: 2 of 17 START sql view model _staging.stg_payments ............................. [RUN]
[0m23:04:38.894321 [info ] [Thread-3 (]: 3 of 17 START sql view model _staging.stg_sessions ............................. [RUN]
[0m23:04:38.906208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_customers)
[0m23:04:38.920432 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_payments)
[0m23:04:38.927490 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:04:38.951015 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:04:38.999086 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:04:39.079663 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:04:39.166589 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:04:39.216337 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:04:39.244818 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:04:39.413198 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:04:39.446214 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:04:39.572060 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:04:39.756945 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:04:39.743297 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:04:39.807330 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:04:40.103327 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:04:40.106665 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:04:40.124100 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:04:40.128776 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:04:40.165241 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:04:40.202857 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:04:40.269682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:04:40.288745 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:04:40.291703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:40.336616 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:40.341278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:40.342683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:40.344646 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:04:40.350971 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:04:40.353505 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:04:40.356172 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:04:40.360809 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:04:40.363623 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:04:40.406074 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:04:40.407262 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:04:40.408156 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:04:40.453206 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:04:40.481336 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:04:40.523319 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:04:40.527345 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:04:40.536374 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m23:04:40.572127 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m23:04:40.579871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:40.586694 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:40.587897 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:40.599355 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:04:40.614449 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:04:40.632097 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:04:40.633701 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:04:40.636263 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:04:40.644304 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:04:40.650599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:40.654463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:40.659893 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:40.762813 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:04:40.770363 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:04:40.779143 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:04:40.781191 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:04:40.786252 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:04:40.788986 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:04:40.794791 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:04:40.798053 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:04:40.802445 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:04:40.807426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:04:40.808759 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:04:40.820201 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:04:40.835176 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:04:40.844460 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:04:40.854286 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:04:40.872653 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:04:40.875452 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:04:40.878517 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:04:40.880553 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:04:40.882767 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:04:40.884968 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:04:40.891728 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:04:40.901373 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:04:40.902432 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:04:40.903116 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:04:40.907349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b4003afd50>]}
[0m23:04:40.913473 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:04:40.917294 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:04:40.920521 [info ] [Thread-1 (]: 1 of 17 OK created sql view model _staging.stg_customers ....................... [[32mCREATE VIEW[0m in 2.00s]
[0m23:04:40.923204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b4004faad0>]}
[0m23:04:40.925949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b400fdec90>]}
[0m23:04:40.929609 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:04:40.932712 [info ] [Thread-3 (]: 3 of 17 OK created sql view model _staging.stg_sessions ........................ [[32mCREATE VIEW[0m in 2.00s]
[0m23:04:40.935816 [info ] [Thread-2 (]: 2 of 17 OK created sql view model _staging.stg_payments ........................ [[32mCREATE VIEW[0m in 2.01s]
[0m23:04:40.939851 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:04:40.940688 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:04:40.942544 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:04:40.946191 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:04:40.949028 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m23:04:40.951318 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m23:04:40.954436 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:04:40.957548 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:04:40.960699 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m23:04:40.963750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m23:04:40.966552 [info ] [Thread-3 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m23:04:40.969759 [info ] [Thread-2 (]: 7 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m23:04:40.972350 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:04:40.975182 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:04:40.978240 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m23:04:40.980823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m23:04:41.040525 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:04:41.041656 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:04:41.050951 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:04:41.053592 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:04:41.240254 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:04:41.242563 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:04:41.277811 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:04:41.305725 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:04:41.392284 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:04:41.393691 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:04:41.420804 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:04:41.432283 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:04:41.441515 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:04:41.456755 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:04:41.471158 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:04:41.476168 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m23:04:41.480047 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:04:41.482467 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:04:41.485037 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:04:41.487285 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m23:04:41.492040 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m23:04:41.493508 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:04:41.496175 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:04:41.499423 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:04:41.501915 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m23:04:41.509375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:41.512129 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:41.516830 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:04:41.519173 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m23:04:41.523253 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:41.525603 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:41.527799 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:04:41.530750 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:41.540726 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m23:04:41.542994 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:04:41.544231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:41.546527 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:04:41.549422 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m23:04:41.551892 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:04:41.554466 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m23:04:41.555700 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:41.558022 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.60s]
[0m23:04:41.560005 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m23:04:41.567523 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m23:04:41.570728 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:04:41.574869 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m23:04:41.575998 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:41.577108 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:04:41.580455 [info ] [Thread-3 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.60s]
[0m23:04:41.584990 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m23:04:41.587211 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m23:04:41.591657 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:04:41.593874 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m23:04:41.596301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m23:04:41.599409 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:04:41.600934 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:41.603964 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.64s]
[0m23:04:41.606264 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:04:41.609539 [info ] [Thread-3 (]: 9 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m23:04:41.616797 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m23:04:41.619674 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:04:41.630455 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:04:41.632685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m23:04:41.635407 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m23:04:41.636742 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:04:41.640004 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:04:41.642811 [info ] [Thread-2 (]: 7 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.66s]
[0m23:04:41.648988 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m23:04:41.667108 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:04:41.671171 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:04:41.673741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m23:04:41.675244 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:04:41.681413 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:04:41.684403 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:04:41.693308 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:04:41.696231 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m23:04:41.726298 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:04:41.731538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m23:04:41.733052 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:04:41.738079 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:04:41.752256 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:04:41.757765 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:04:41.764508 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:04:41.771191 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:04:41.804941 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m23:04:41.826873 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:04:41.840624 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:04:41.867438 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:41.883263 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:04:41.884925 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:04:41.886012 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:04:41.899753 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m23:04:41.902076 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:04:41.904403 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m23:04:41.907308 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m23:04:41.916459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:41.926061 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:04:41.931474 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:04:41.932926 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:41.946001 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m23:04:41.953949 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m23:04:41.957732 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.36s]
[0m23:04:41.967672 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:04:41.969740 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:41.971835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:41.974510 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:04:41.978850 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:04:41.981869 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:04:41.983393 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:04:41.985233 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m23:04:41.988865 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:04:41.991530 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m23:04:41.995949 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m23:04:41.999270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m23:04:42.004805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:04:42.008576 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:04:42.025435 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:04:42.026363 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:42.030675 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.037523 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m23:04:42.045837 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:04:42.049513 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m23:04:42.051094 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:04:42.052525 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m23:04:42.055671 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.38s]
[0m23:04:42.064978 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:04:42.068227 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:04:42.069216 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:42.070086 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:42.072946 [debug] [Thread-1 (]: Began running node model.api_bi_project.dim_customer
[0m23:04:42.077941 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m23:04:42.083933 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m23:04:42.086685 [info ] [Thread-1 (]: 13 of 17 START sql table model _analytics.dim_customer ......................... [RUN]
[0m23:04:42.091316 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:04:42.092921 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m23:04:42.096375 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m23:04:42.098572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m23:04:42.101292 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m23:04:42.104426 [info ] [Thread-3 (]: 9 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.47s]
[0m23:04:42.109237 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.38s]
[0m23:04:42.113719 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:04:42.123383 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:04:42.126401 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:04:42.132784 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:04:42.148393 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:04:42.154902 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:04:42.160167 [info ] [Thread-3 (]: 14 of 17 START sql table model _analytics.fct_marketing_attribution ............ [RUN]
[0m23:04:42.163468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now model.api_bi_project.fct_marketing_attribution)
[0m23:04:42.167672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.170526 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:04:42.173622 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:04:42.184954 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.187198 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:04:42.189263 [debug] [Thread-1 (]: Began executing node model.api_bi_project.dim_customer
[0m23:04:42.214226 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:42.246952 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m23:04:42.255041 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:04:42.269790 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:04:42.270876 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m23:04:42.288504 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.292629 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.29s]
[0m23:04:42.299655 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:04:42.302116 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:04:42.305538 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:04:42.304551 [info ] [Thread-2 (]: 15 of 17 START sql table model _analytics.fct_revenue_daily .................... [RUN]
[0m23:04:42.307775 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:04:42.308980 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.311072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m23:04:42.312978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:42.314647 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:04:42.316419 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:04:42.320001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:04:42.327827 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.333233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.336319 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:04:42.338471 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:04:42.347522 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:04:42.355990 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.357703 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.360636 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.363611 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:04:42.372925 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m23:04:42.374111 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.381762 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:04:42.383327 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:04:42.385026 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m23:04:42.386940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:04:42.389210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:42.399935 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:04:42.402104 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:04:42.404770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:42.406630 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.426144 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:04:42.427619 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.429638 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:04:42.432095 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:04:42.434361 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:04:42.439498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:04:42.450771 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:04:42.461302 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:04:42.463633 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:04:42.473883 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:04:42.482553 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: Close
[0m23:04:42.485115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b402d25810>]}
[0m23:04:42.488457 [info ] [Thread-1 (]: 13 of 17 OK created sql table model _analytics.dim_customer .................... [[32mSELECT 1000[0m in 0.39s]
[0m23:04:42.491024 [debug] [Thread-2 (]: SQL status: SELECT 4298 in 0.0 seconds
[0m23:04:42.494665 [debug] [Thread-1 (]: Finished running node model.api_bi_project.dim_customer
[0m23:04:42.508665 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.513689 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m23:04:42.510386 [debug] [Thread-3 (]: SQL status: SELECT 5666 in 0.0 seconds
[0m23:04:42.517259 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:42.528566 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.539036 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.544747 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m23:04:42.549573 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:04:42.553078 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:42.554790 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:42.570382 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.572939 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:04:42.574785 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:04:42.576621 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.579777 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:42.581093 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:04:42.585959 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:04:42.589195 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.590594 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:04:42.610057 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:04:42.619921 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:04:42.625802 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:04:42.633920 [debug] [Thread-3 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:04:42.636723 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:04:42.647003 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:04:42.642216 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:04:42.651084 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:04:42.653253 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:04:42.657451 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:04:42.658707 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:04:42.664453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b402f84150>]}
[0m23:04:42.667479 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:04:42.669820 [info ] [Thread-2 (]: 15 of 17 OK created sql table model _analytics.fct_revenue_daily ............... [[32mSELECT 4298[0m in 0.35s]
[0m23:04:42.673056 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37636a55-f90d-4bd2-9c04-360937c4258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b40031d650>]}
[0m23:04:42.677340 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:04:42.681247 [info ] [Thread-3 (]: 14 of 17 OK created sql table model _analytics.fct_marketing_attribution ....... [[32mSELECT 5666[0m in 0.51s]
[0m23:04:42.684652 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:04:42.686787 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:04:42.688974 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m23:04:42.694169 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:04:42.696503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m23:04:42.698889 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m23:04:42.700881 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:04:42.703140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m23:04:42.722906 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:04:42.714951 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:04:42.743585 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:04:42.753928 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:04:42.763381 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:04:42.763028 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:04:42.769694 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:04:42.779473 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:04:42.781592 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m23:04:42.783680 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:04:42.785163 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:04:42.786907 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m23:04:42.790359 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:04:42.808208 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.809267 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.811108 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:04:42.813631 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:04:42.815742 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m23:04:42.818108 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m23:04:42.824994 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:42.829427 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:42.833764 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m23:04:42.837057 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m23:04:42.839813 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m23:04:42.841347 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m23:04:42.843709 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.15s]
[0m23:04:42.847546 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.14s]
[0m23:04:42.852474 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:04:42.855107 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:04:42.865325 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:42.867394 [debug] [MainThread]: On master: BEGIN
[0m23:04:42.868922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:42.886516 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:04:42.888631 [debug] [MainThread]: On master: COMMIT
[0m23:04:42.890263 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:42.892020 [debug] [MainThread]: On master: COMMIT
[0m23:04:42.895050 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:04:42.897113 [debug] [MainThread]: On master: Close
[0m23:04:42.899362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:42.900909 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:04:42.902477 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m23:04:42.904075 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m23:04:42.905446 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m23:04:42.907237 [info ] [MainThread]: 
[0m23:04:42.908924 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m23:04:42.916812 [debug] [MainThread]: Command end result
[0m23:04:43.072049 [info ] [MainThread]: 
[0m23:04:43.075151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:43.079236 [info ] [MainThread]: 
[0m23:04:43.082203 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m23:04:43.086463 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.044562, "process_user_time": 7.62677, "process_kernel_time": 1.236355, "process_mem_max_rss": "117156", "process_in_blocks": "2112", "process_out_blocks": "0"}
[0m23:04:43.089388 [debug] [MainThread]: Command `dbt build` succeeded at 23:04:43.088974 after 9.05 seconds
[0m23:04:43.092016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b402e04d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b402e04c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b406ccbc50>]}
[0m23:04:43.095704 [debug] [MainThread]: Flushing usage events
[0m23:12:15.234920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab6f63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab6f5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab6f5090>]}


============================== 23:12:15.267140 | bdd9a789-096b-4f4f-af3c-9b23747f73d0 ==============================
[0m23:12:15.267140 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:12:15.271695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m23:12:15.440183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdd9a789-096b-4f4f-af3c-9b23747f73d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab5af250>]}
[0m23:12:16.053999 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lfzrrj3y'
[0m23:12:16.056769 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:12:16.255210 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:12:16.258884 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:12:16.343275 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:12:16.353134 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:12:20.940473 [info ] [MainThread]: Installed from version 1.3.1
[0m23:12:20.944857 [info ] [MainThread]: Up to date!
[0m23:12:20.948333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bdd9a789-096b-4f4f-af3c-9b23747f73d0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab9f9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab736e90>]}
[0m23:12:20.952651 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.518432, "process_user_time": 5.689921, "process_kernel_time": 2.086836, "process_mem_max_rss": "94984", "process_out_blocks": "1296", "process_in_blocks": "0"}
[0m23:12:20.959060 [debug] [MainThread]: Command `dbt deps` succeeded at 23:12:20.958649 after 8.53 seconds
[0m23:12:20.961421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab721d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab722e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7565ab8c3e10>]}
[0m23:12:20.965561 [debug] [MainThread]: Flushing usage events
[0m23:12:24.362029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca2d2e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca2d2e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca2d56790>]}


============================== 23:12:24.368398 | 0e07ee22-19d5-4f70-bd91-775391d75840 ==============================
[0m23:12:24.368398 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:12:24.370861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:12:24.705403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca2d2c850>]}
[0m23:12:24.811161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca6a48a50>]}
[0m23:12:24.813860 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:12:24.915104 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:12:27.223723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:27.226597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:27.324301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca1250d90>]}
[0m23:12:27.692353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca14abc10>]}
[0m23:12:27.695862 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:12:27.699716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca121d210>]}
[0m23:12:27.711736 [info ] [MainThread]: 
[0m23:12:27.717320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:27.731666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:12:27.734665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:12:27.992335 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:12:27.994415 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:12:28.001008 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:12:28.004977 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:12:28.019411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:28.022833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:28.081379 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:12:28.085701 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:12:28.091041 [debug] [ThreadPool]: On list_db: Close
[0m23:12:28.095205 [debug] [ThreadPool]: On list_db: Close
[0m23:12:28.102569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__analytics)
[0m23:12:28.104108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__staging)
[0m23:12:28.122186 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_analytics"
"
[0m23:12:28.125952 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_staging"
"
[0m23:12:28.153731 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:12:28.158224 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:12:28.161138 [debug] [ThreadPool]: On create_db__analytics: BEGIN
[0m23:12:28.164259 [debug] [ThreadPool]: On create_db__staging: BEGIN
[0m23:12:28.166091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:28.167559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:28.187228 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:12:28.189936 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:12:28.191606 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:12:28.193892 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:12:28.198033 [debug] [ThreadPool]: On create_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__analytics"} */
create schema if not exists "_analytics"
[0m23:12:28.200342 [debug] [ThreadPool]: On create_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__staging"} */
create schema if not exists "_staging"
[0m23:12:28.204034 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:12:28.204824 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:12:28.208722 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:12:28.212541 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:12:28.215678 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:12:28.219037 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:12:28.221920 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:12:28.229876 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:12:28.236725 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:12:28.238272 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:12:28.240599 [debug] [ThreadPool]: On create_db__analytics: Close
[0m23:12:28.243563 [debug] [ThreadPool]: On create_db__staging: Close
[0m23:12:28.273344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db__analytics'
[0m23:12:28.279760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__staging, now list_db__staging)
[0m23:12:28.301493 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:12:28.308088 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:12:28.309665 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:12:28.311131 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:12:28.312852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:28.314825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:28.334620 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:12:28.336097 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:12:28.338141 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:12:28.340123 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:12:28.342445 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:12:28.346054 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:12:28.358749 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:12:28.359853 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:12:28.364451 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:12:28.369248 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:12:28.384731 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:12:28.422626 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:12:28.507133 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:28.620672 [debug] [MainThread]: On master: BEGIN
[0m23:12:28.648718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:28.737258 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:12:28.812005 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:28.924030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:28.986376 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:12:29.018908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca143bb90>]}
[0m23:12:29.026814 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:29.078888 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:29.086744 [debug] [MainThread]: On master: BEGIN
[0m23:12:29.114838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:12:29.124303 [debug] [MainThread]: On master: COMMIT
[0m23:12:29.137867 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:29.141660 [debug] [MainThread]: On master: COMMIT
[0m23:12:29.160367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:12:29.172314 [debug] [MainThread]: On master: Close
[0m23:12:29.176673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:29.213808 [info ] [MainThread]: 
[0m23:12:29.337798 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:12:29.341777 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:12:29.344751 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:12:29.360584 [info ] [Thread-1 (]: 1 of 6 START sql view model _staging.stg_customers ............................. [RUN]
[0m23:12:29.404547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_customers)
[0m23:12:29.396643 [info ] [Thread-3 (]: 3 of 6 START sql view model _staging.stg_sessions .............................. [RUN]
[0m23:12:29.388655 [info ] [Thread-2 (]: 2 of 6 START sql view model _staging.stg_payments .............................. [RUN]
[0m23:12:29.417190 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:12:29.422065 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly create_db__analytics, now model.api_bi_project.stg_sessions)
[0m23:12:29.448482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_payments)
[0m23:12:29.511030 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:12:29.570517 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:12:29.579283 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:12:29.634917 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:12:29.664080 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:12:29.692420 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:12:29.704856 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:12:29.960811 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:12:30.245248 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:12:30.250324 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:12:30.242888 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:12:30.278668 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:12:30.282246 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:12:30.285016 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:12:30.288313 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:12:30.294311 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:12:30.307614 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:12:30.311883 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:12:30.319010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:12:30.333538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:30.368568 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:12:30.390170 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:12:30.398569 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:12:30.416352 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:12:30.422972 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:12:30.431028 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:12:30.435142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:12:30.462530 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:12:30.496942 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:12:30.499349 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:12:30.508042 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:12:30.516571 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:12:30.521879 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:12:30.554137 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:12:30.575794 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:12:30.586878 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:12:30.665705 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:12:30.690360 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:12:30.725746 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:12:30.738558 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:12:30.741919 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:12:30.758117 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:12:30.780992 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:12:30.790368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:12:30.804485 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:12:30.811321 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:12:30.837677 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:12:30.844090 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:12:30.862100 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:12:30.875868 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:12:30.903359 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:12:30.942054 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:12:30.945241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:12:30.952112 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:12:31.014201 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:12:31.048393 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:12:31.109534 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:12:31.113053 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:12:31.137155 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:12:31.145551 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:12:31.151409 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:12:31.161196 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:12:31.169354 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:12:31.174971 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:12:31.183413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:12:31.218853 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:12:31.224645 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:12:31.243015 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:12:31.265577 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec9b3f4110>]}
[0m23:12:31.307457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec9bdf9990>]}
[0m23:12:31.325044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca14d4dd0>]}
[0m23:12:31.375040 [info ] [Thread-3 (]: 3 of 6 OK created sql view model _staging.stg_sessions ......................... [[32mCREATE VIEW[0m in 1.84s]
[0m23:12:31.379635 [info ] [Thread-2 (]: 2 of 6 OK created sql view model _staging.stg_payments ......................... [[32mCREATE VIEW[0m in 1.86s]
[0m23:12:31.391240 [info ] [Thread-1 (]: 1 of 6 OK created sql view model _staging.stg_customers ........................ [[32mCREATE VIEW[0m in 1.92s]
[0m23:12:31.400503 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:12:31.413155 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:12:31.418114 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:12:31.429665 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:12:31.442723 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:12:31.453293 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m23:12:31.457700 [info ] [Thread-4 (]: 4 of 6 START sql table model _analytics.fct_marketing_attribution .............. [RUN]
[0m23:12:31.468369 [info ] [Thread-3 (]: 5 of 6 START sql table model _analytics.fct_revenue_daily ...................... [RUN]
[0m23:12:31.478735 [info ] [Thread-2 (]: 6 of 6 START sql table model _analytics.dim_customer ........................... [RUN]
[0m23:12:31.487385 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m23:12:31.497157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m23:12:31.507189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m23:12:31.518007 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:12:31.523175 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:12:31.532237 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:12:31.564509 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:12:31.602482 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:12:31.632378 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:12:31.714959 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:12:31.720347 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m23:12:31.796577 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:12:32.013742 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:12:32.020904 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:12:32.052269 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:12:32.073536 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:12:32.075208 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:12:32.078576 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:12:32.080805 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:12:32.084937 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:12:32.090657 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:12:32.094710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:12:32.098535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:12:32.101628 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:12:32.137212 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:12:32.139628 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:12:32.142963 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:12:32.145516 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:12:32.146879 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:12:32.152777 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:12:32.158686 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:12:32.161589 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:12:32.167995 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:12:32.191671 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:12:32.193207 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:12:32.204905 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:12:32.223886 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:12:32.502097 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:12:32.519440 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:12:32.525921 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:12:32.532016 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:12:32.536678 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:12:32.542177 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:12:32.544602 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:12:32.547380 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:12:32.572429 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:12:32.577818 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:12:32.584538 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:12:32.588100 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:12:32.591088 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:12:32.593457 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:12:32.597131 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:12:32.607217 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:12:32.610745 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:12:32.618425 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:12:32.619986 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:12:32.628745 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:12:32.629705 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:12:32.643120 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:12:32.658820 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:12:32.673733 [debug] [Thread-3 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:12:32.677901 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:12:32.695074 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:12:32.712018 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:12:32.730098 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:12:32.738076 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:12:32.745445 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:12:32.749159 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:12:32.753310 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:12:32.756739 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:12:32.760055 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m23:12:32.763044 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec9b4791d0>]}
[0m23:12:32.772305 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:12:32.775935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec9befa710>]}
[0m23:12:32.778910 [info ] [Thread-4 (]: 4 of 6 OK created sql table model _analytics.fct_marketing_attribution ......... [[32mSELECT 0[0m in 1.28s]
[0m23:12:32.782917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e07ee22-19d5-4f70-bd91-775391d75840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec9be92150>]}
[0m23:12:32.786289 [info ] [Thread-2 (]: 6 of 6 OK created sql table model _analytics.dim_customer ...................... [[32mSELECT 0[0m in 1.27s]
[0m23:12:32.790565 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:12:32.793795 [info ] [Thread-3 (]: 5 of 6 OK created sql table model _analytics.fct_revenue_daily ................. [[32mSELECT 0[0m in 1.29s]
[0m23:12:32.797013 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m23:12:32.801476 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:12:32.813152 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.815490 [debug] [MainThread]: On master: BEGIN
[0m23:12:32.818642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:32.841684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:12:32.845328 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.848198 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.850686 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.856992 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:12:32.859489 [debug] [MainThread]: On master: Close
[0m23:12:32.863783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:32.866185 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:12:32.868369 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m23:12:32.873384 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m23:12:32.878370 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m23:12:32.882247 [info ] [MainThread]: 
[0m23:12:32.885259 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m23:12:32.898239 [debug] [MainThread]: Command end result
[0m23:12:33.067363 [info ] [MainThread]: 
[0m23:12:33.069700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:33.073622 [info ] [MainThread]: 
[0m23:12:33.078892 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:12:33.083899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.842041, "process_user_time": 5.912764, "process_kernel_time": 0.833448, "process_mem_max_rss": "115732", "process_out_blocks": "144", "process_in_blocks": "0"}
[0m23:12:33.086705 [debug] [MainThread]: Command `dbt run` succeeded at 23:12:33.086315 after 8.85 seconds
[0m23:12:33.089317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca6b4c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca2d23550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeca116d0d0>]}
[0m23:12:33.092546 [debug] [MainThread]: Flushing usage events
[0m23:17:54.361746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c663da7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c664ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c67850150>]}


============================== 23:17:54.378658 | f809c21d-dc96-4924-af25-cbfa12422d81 ==============================
[0m23:17:54.378658 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:17:54.383867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:17:54.599875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f809c21d-dc96-4924-af25-cbfa12422d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c66428150>]}
[0m23:17:55.458965 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-767b6219'
[0m23:17:55.461302 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:17:55.638485 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:17:55.641187 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:17:55.744981 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:17:55.754966 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:18:03.891960 [info ] [MainThread]: Installed from version 1.3.1
[0m23:18:03.899805 [info ] [MainThread]: Up to date!
[0m23:18:03.903417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f809c21d-dc96-4924-af25-cbfa12422d81', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c6627e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c678e9b90>]}
[0m23:18:03.909395 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.785914, "process_user_time": 2.9764, "process_kernel_time": 1.007222, "process_mem_max_rss": "94624", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m23:18:03.911755 [debug] [MainThread]: Command `dbt deps` succeeded at 23:18:03.911460 after 9.79 seconds
[0m23:18:03.913517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c663fdd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c66714c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5c6a1f8890>]}
[0m23:18:03.916381 [debug] [MainThread]: Flushing usage events
[0m23:36:01.703556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f1e347550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f1e3e3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f1e4f4090>]}


============================== 23:36:01.718572 | 733ff2d5-797f-419e-96a3-82eb4c5b6b95 ==============================
[0m23:36:01.718572 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:36:01.724413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:36:01.888743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733ff2d5-797f-419e-96a3-82eb4c5b6b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f1e189690>]}
[0m23:36:02.477535 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qsy1twb6'
[0m23:36:02.479186 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:36:02.674228 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:36:02.677935 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:36:02.788311 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:36:02.801301 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:36:09.610526 [info ] [MainThread]: Installed from version 1.3.1
[0m23:36:09.613088 [info ] [MainThread]: Up to date!
[0m23:36:09.615352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '733ff2d5-797f-419e-96a3-82eb4c5b6b95', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f1f811f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f1e239fd0>]}
[0m23:36:09.620627 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.060605, "process_user_time": 2.622785, "process_kernel_time": 1.253399, "process_mem_max_rss": "94988", "process_out_blocks": "1296", "process_in_blocks": "0"}
[0m23:36:09.624429 [debug] [MainThread]: Command `dbt deps` succeeded at 23:36:09.623834 after 8.06 seconds
[0m23:36:09.627770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f1e347a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f22134710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f22290310>]}
[0m23:36:09.629753 [debug] [MainThread]: Flushing usage events
[0m23:36:13.470867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a6a27290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a6a27150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a6a26dd0>]}


============================== 23:36:13.479060 | e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a ==============================
[0m23:36:13.479060 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:36:13.482938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:36:14.061603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a6963cd0>]}
[0m23:36:14.237891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98aa75cf10>]}
[0m23:36:14.243633 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:36:14.346413 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:36:16.207613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:16.208997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:16.280437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a4f00290>]}
[0m23:36:16.728272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a698f950>]}
[0m23:36:16.737190 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:36:16.743116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a5132f90>]}
[0m23:36:16.751634 [info ] [MainThread]: 
[0m23:36:16.767031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:16.787532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:36:16.790527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:36:16.989449 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:36:16.990298 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:36:16.992418 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:36:16.996228 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:36:16.998662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:17.001894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:17.048072 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:36:17.049016 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:36:17.053471 [debug] [ThreadPool]: On list_db: Close
[0m23:36:17.059193 [debug] [ThreadPool]: On list_db: Close
[0m23:36:17.065955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__analytics)
[0m23:36:17.068054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__staging)
[0m23:36:17.070660 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_analytics"
"
[0m23:36:17.074576 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_staging"
"
[0m23:36:17.093131 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:36:17.099875 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:36:17.101566 [debug] [ThreadPool]: On create_db__analytics: BEGIN
[0m23:36:17.103487 [debug] [ThreadPool]: On create_db__staging: BEGIN
[0m23:36:17.105627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:17.107374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:17.133597 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.136040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.138895 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:36:17.141421 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:36:17.143614 [debug] [ThreadPool]: On create_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__staging"} */
create schema if not exists "_staging"
[0m23:36:17.146485 [debug] [ThreadPool]: On create_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__analytics"} */
create schema if not exists "_analytics"
[0m23:36:17.150785 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:36:17.151586 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:36:17.154966 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:36:17.159327 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:36:17.161707 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:36:17.163894 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:36:17.166552 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:36:17.170297 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:36:17.177300 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:36:17.179636 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:36:17.182179 [debug] [ThreadPool]: On create_db__staging: Close
[0m23:36:17.185470 [debug] [ThreadPool]: On create_db__analytics: Close
[0m23:36:17.194267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__analytics, now list_db__analytics)
[0m23:36:17.196689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__staging, now list_db__staging)
[0m23:36:17.217309 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:36:17.221616 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:36:17.223544 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:36:17.225339 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:36:17.227161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:17.228779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:17.246325 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.248470 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.250245 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:36:17.252786 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:36:17.254684 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:36:17.256836 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:36:17.272137 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:36:17.273242 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:36:17.277599 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:36:17.282261 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:36:17.288854 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:36:17.291782 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:36:17.308336 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:17.310081 [debug] [MainThread]: On master: BEGIN
[0m23:36:17.311593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:17.340698 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.343843 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:17.346708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:36:17.360417 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:36:17.363183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a4230590>]}
[0m23:36:17.371455 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:17.374721 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:17.377310 [debug] [MainThread]: On master: BEGIN
[0m23:36:17.383917 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.386861 [debug] [MainThread]: On master: COMMIT
[0m23:36:17.391221 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:17.393567 [debug] [MainThread]: On master: COMMIT
[0m23:36:17.396362 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:17.399796 [debug] [MainThread]: On master: Close
[0m23:36:17.408204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:17.416551 [info ] [MainThread]: 
[0m23:36:17.468677 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:36:17.470562 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:36:17.472126 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:36:17.475624 [info ] [Thread-1 (]: 1 of 6 START sql view model _staging.stg_customers ............................. [RUN]
[0m23:36:17.479009 [info ] [Thread-2 (]: 2 of 6 START sql view model _staging.stg_payments .............................. [RUN]
[0m23:36:17.482517 [info ] [Thread-3 (]: 3 of 6 START sql view model _staging.stg_sessions .............................. [RUN]
[0m23:36:17.492928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_customers)
[0m23:36:17.499760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_payments)
[0m23:36:17.502716 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:36:17.505787 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:36:17.508709 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:36:17.511414 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:36:17.537942 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:36:17.540786 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:36:17.547849 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:36:17.566820 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:36:17.568988 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:36:17.582324 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:36:17.899193 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:36:17.911220 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:36:17.912586 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:36:17.927572 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:36:17.929058 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:36:17.937461 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:36:17.938795 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:36:17.944122 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:36:17.947529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:17.950431 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:36:17.953183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:17.960616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:17.983996 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.988480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.990839 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:17.992871 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:36:17.996396 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:36:18.000081 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:36:18.004555 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:36:18.007849 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:36:18.012630 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:36:18.032476 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:18.033941 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:18.035200 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:18.068239 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:36:18.102829 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:36:18.108655 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:36:18.111433 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:36:18.115108 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:36:18.118064 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:36:18.125014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:18.125987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:18.130696 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:18.215542 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:36:18.217972 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:36:18.223225 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:36:18.226337 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:36:18.228921 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:36:18.231203 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:36:18.233606 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:36:18.236288 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:36:18.238341 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:36:18.245449 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:18.247236 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:18.248314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:18.270449 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:36:18.286207 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:36:18.292933 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:36:18.319003 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:36:18.321338 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:36:18.324369 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:36:18.326316 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:36:18.328609 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:36:18.331305 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:36:18.334780 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:18.335693 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:18.338228 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:18.342816 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:36:18.346557 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:36:18.351323 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:36:18.356799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a4ec3950>]}
[0m23:36:18.359788 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a5055510>]}
[0m23:36:18.363013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a5065310>]}
[0m23:36:18.366141 [info ] [Thread-2 (]: 2 of 6 OK created sql view model _staging.stg_payments ......................... [[32mCREATE VIEW[0m in 0.86s]
[0m23:36:18.369010 [info ] [Thread-3 (]: 3 of 6 OK created sql view model _staging.stg_sessions ......................... [[32mCREATE VIEW[0m in 0.86s]
[0m23:36:18.371664 [info ] [Thread-1 (]: 1 of 6 OK created sql view model _staging.stg_customers ........................ [[32mCREATE VIEW[0m in 0.87s]
[0m23:36:18.374646 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:36:18.377378 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:36:18.380971 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:36:18.384530 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:36:18.393646 [info ] [Thread-4 (]: 4 of 6 START sql table model _analytics.fct_revenue_daily ...................... [RUN]
[0m23:36:18.396826 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_revenue_daily'
[0m23:36:18.402724 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:36:18.416860 [info ] [Thread-2 (]: 5 of 6 START sql table model _analytics.fct_marketing_attribution .............. [RUN]
[0m23:36:18.411305 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:36:18.406590 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m23:36:18.426772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m23:36:18.439128 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:36:18.444488 [info ] [Thread-3 (]: 6 of 6 START sql table model _analytics.dim_customer ........................... [RUN]
[0m23:36:18.446499 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:36:18.454118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.dim_customer)
[0m23:36:18.469042 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:36:18.470691 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:36:18.473010 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:36:18.486321 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:36:18.502706 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:36:18.552799 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:36:18.560740 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m23:36:18.565379 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:36:18.579122 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:36:18.582289 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:36:18.587419 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:36:18.589350 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:36:18.590172 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:36:18.592127 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:36:18.600586 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:36:18.602977 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:36:18.605531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:18.607596 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:18.609259 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:18.613785 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:36:18.616597 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:36:18.626326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:18.629359 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:36:18.631443 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:18.633256 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:36:18.634559 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:36:18.636998 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:36:18.646967 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:36:18.651282 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:36:18.654907 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:36:18.656237 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:36:18.679260 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:36:18.682383 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:36:18.685282 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:18.949608 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:36:18.952798 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:36:18.983475 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:36:18.985974 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:36:18.993537 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:18.998786 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:36:19.003066 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:19.009363 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:36:19.022906 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:36:19.030553 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:36:19.036381 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:36:19.041202 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:36:19.042408 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:19.044857 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:36:19.047629 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:36:19.064376 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:36:19.071235 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:19.078343 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:19.083323 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:36:19.093886 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:36:19.103104 [debug] [Thread-3 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:36:19.105359 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:36:19.108670 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:36:19.111788 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:36:19.115016 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:36:19.117181 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:36:19.120124 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:36:19.126814 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:36:19.131516 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:36:19.133926 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:36:19.135955 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a6b3e010>]}
[0m23:36:19.143903 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:36:19.148255 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m23:36:19.150583 [info ] [Thread-4 (]: 4 of 6 OK created sql table model _analytics.fct_revenue_daily ................. [[32mSELECT 0[0m in 0.74s]
[0m23:36:19.153692 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a4186b90>]}
[0m23:36:19.158527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7fd17b4-9e39-46e3-ac48-60d9b9f5b60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98a418b650>]}
[0m23:36:19.160931 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:36:19.163675 [info ] [Thread-2 (]: 5 of 6 OK created sql table model _analytics.fct_marketing_attribution ......... [[32mSELECT 0[0m in 0.73s]
[0m23:36:19.167548 [info ] [Thread-3 (]: 6 of 6 OK created sql table model _analytics.dim_customer ...................... [[32mSELECT 0[0m in 0.70s]
[0m23:36:19.172367 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:36:19.176065 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m23:36:19.183493 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:19.185812 [debug] [MainThread]: On master: BEGIN
[0m23:36:19.187343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:19.213426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:19.223616 [debug] [MainThread]: On master: COMMIT
[0m23:36:19.226007 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:19.228605 [debug] [MainThread]: On master: COMMIT
[0m23:36:19.231857 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:19.233356 [debug] [MainThread]: On master: Close
[0m23:36:19.235258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:19.237520 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m23:36:19.240762 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m23:36:19.246276 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:36:19.251620 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m23:36:19.254007 [info ] [MainThread]: 
[0m23:36:19.263273 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m23:36:19.273065 [debug] [MainThread]: Command end result
[0m23:36:19.464087 [info ] [MainThread]: 
[0m23:36:19.467519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:19.469739 [info ] [MainThread]: 
[0m23:36:19.472096 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:36:19.475807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1659203, "process_user_time": 5.123654, "process_kernel_time": 0.828442, "process_mem_max_rss": "114724", "process_out_blocks": "144", "process_in_blocks": "0"}
[0m23:36:19.478668 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:19.478254 after 6.17 seconds
[0m23:36:19.480797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98aa844650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98aa9c8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98aa9c8c90>]}
[0m23:36:19.483304 [debug] [MainThread]: Flushing usage events
[0m23:40:11.529840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7053151619d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705315163a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705315163d90>]}


============================== 23:40:11.568528 | 4ce7e889-c056-4d90-9f49-4bfa89d5c6a2 ==============================
[0m23:40:11.568528 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:40:11.573081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:40:11.943773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ce7e889-c056-4d90-9f49-4bfa89d5c6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70531513cc90>]}
[0m23:40:12.619389 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k20x_kuu'
[0m23:40:12.621074 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:40:12.839235 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:40:12.842746 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:40:12.948687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:40:12.959551 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:40:21.442819 [info ] [MainThread]: Installed from version 1.3.1
[0m23:40:21.444822 [info ] [MainThread]: Up to date!
[0m23:40:21.447918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ce7e889-c056-4d90-9f49-4bfa89d5c6a2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705314fde7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705316626b50>]}
[0m23:40:21.452272 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 10.156459, "process_user_time": 2.559589, "process_kernel_time": 1.041693, "process_mem_max_rss": "94704", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m23:40:21.454962 [debug] [MainThread]: Command `dbt deps` succeeded at 23:40:21.454409 after 10.16 seconds
[0m23:40:21.456911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705315163c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705318f7c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7053190d8d50>]}
[0m23:40:21.459045 [debug] [MainThread]: Flushing usage events
[0m23:40:28.662527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef06d6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef210c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef0703ed0>]}


============================== 23:40:28.670319 | 7c578b44-bf09-419a-a33a-e4e6bcb42cb9 ==============================
[0m23:40:28.670319 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:40:28.673461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:29.024002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef0746dd0>]}
[0m23:40:29.091921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef07f1210>]}
[0m23:40:29.094319 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:40:29.145329 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:40:31.258050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:40:31.261611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:40:31.373978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eeed91d10>]}
[0m23:40:31.676603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eee904150>]}
[0m23:40:31.679739 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:40:31.687528 [info ] [MainThread]: 
[0m23:40:31.690505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:31.697982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:40:31.699435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:40:31.814816 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:40:31.816808 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:40:31.820908 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:40:31.828031 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:40:31.833086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:31.838311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:31.876292 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:40:31.876814 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:40:31.879857 [debug] [ThreadPool]: On list_db: Close
[0m23:40:31.882864 [debug] [ThreadPool]: On list_db: Close
[0m23:40:31.889378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__analytics)
[0m23:40:31.890598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__staging)
[0m23:40:31.900938 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:40:31.907399 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:40:31.910105 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:40:31.911871 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:40:31.913101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:31.914279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:31.928895 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:40:31.929701 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:40:31.931291 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:40:31.932929 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:40:31.934953 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:40:31.936813 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:40:31.944522 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:40:31.948919 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:40:31.951269 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:40:31.952266 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:40:31.961382 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:40:31.964564 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:40:31.977038 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:31.978985 [debug] [MainThread]: On master: BEGIN
[0m23:40:31.981491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:31.997977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:40:32.000555 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:32.002401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:40:32.046245 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m23:40:32.048996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eeebb5310>]}
[0m23:40:32.052073 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:32.056176 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:32.057755 [debug] [MainThread]: On master: BEGIN
[0m23:40:32.059690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:40:32.061975 [debug] [MainThread]: On master: COMMIT
[0m23:40:32.063696 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:32.065213 [debug] [MainThread]: On master: COMMIT
[0m23:40:32.067264 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:40:32.069114 [debug] [MainThread]: On master: Close
[0m23:40:32.071630 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:32.074077 [info ] [MainThread]: 
[0m23:40:32.083213 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:40:32.083952 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:40:32.084652 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:40:32.086004 [info ] [Thread-1 (]: 1 of 17 START sql view model _staging.stg_customers ............................ [RUN]
[0m23:40:32.087672 [info ] [Thread-2 (]: 2 of 17 START sql view model _staging.stg_payments ............................. [RUN]
[0m23:40:32.092472 [info ] [Thread-3 (]: 3 of 17 START sql view model _staging.stg_sessions ............................. [RUN]
[0m23:40:32.096154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_customers)
[0m23:40:32.098502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_payments)
[0m23:40:32.101973 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:40:32.103869 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:40:32.105954 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:40:32.108619 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:40:32.119927 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:40:32.128277 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:40:32.132509 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:40:32.140965 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:40:32.141938 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:40:32.149152 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:40:32.215644 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:40:32.217787 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:40:32.223182 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:40:32.231920 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:40:32.233018 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:40:32.234860 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:40:32.235985 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:40:32.237469 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:40:32.238789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:32.240345 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:40:32.241542 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:40:32.244503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:32.257322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:32.260143 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:32.261201 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:40:32.263172 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:32.264085 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:40:32.266041 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:40:32.267970 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:40:32.269761 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:40:32.272751 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:40:32.281132 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:40:32.282064 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:40:32.282805 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:40:32.334104 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:40:32.339661 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:40:32.365036 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:40:32.368236 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:40:32.375328 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m23:40:32.379241 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m23:40:32.385185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:32.388470 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:32.392044 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:32.403528 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:40:32.423821 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:40:32.435607 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:40:32.438027 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:40:32.440149 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:40:32.441759 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:40:32.444512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:32.448113 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:32.452779 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:32.519350 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:40:32.514650 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:40:32.529861 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:40:32.531598 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:40:32.533649 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:40:32.535290 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:40:32.536629 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:40:32.541303 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:40:32.544951 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:40:32.583315 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:40:32.584762 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:40:32.585847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:40:32.607950 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:40:32.619216 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:40:32.626071 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:40:32.646495 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:40:32.651370 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:40:32.656355 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:40:32.659299 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:40:32.663555 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:40:32.668007 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:40:32.712283 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:40:32.715817 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:40:32.717919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:40:32.725814 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:40:32.730098 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:40:32.737896 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:40:32.744135 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eec3b8590>]}
[0m23:40:32.746158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef071a350>]}
[0m23:40:32.748550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eed61ed10>]}
[0m23:40:32.752073 [info ] [Thread-3 (]: 3 of 17 OK created sql view model _staging.stg_sessions ........................ [[32mCREATE VIEW[0m in 0.64s]
[0m23:40:32.755048 [info ] [Thread-2 (]: 2 of 17 OK created sql view model _staging.stg_payments ........................ [[32mCREATE VIEW[0m in 0.65s]
[0m23:40:32.757549 [info ] [Thread-1 (]: 1 of 17 OK created sql view model _staging.stg_customers ....................... [[32mCREATE VIEW[0m in 0.65s]
[0m23:40:32.761708 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:40:32.764194 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:40:32.767659 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:40:32.771267 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:40:32.772184 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:40:32.773427 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:40:32.775716 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:40:32.779271 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m23:40:32.782577 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m23:40:32.784470 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m23:40:32.788837 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m23:40:32.791276 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m23:40:32.793168 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m23:40:32.795057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m23:40:32.798764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m23:40:32.800800 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:40:32.802497 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:40:32.804136 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:40:32.806001 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:40:32.837830 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:40:32.857349 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:40:32.957377 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:40:32.965715 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:40:32.978200 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:40:32.979447 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:40:32.986302 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:40:32.987029 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:40:33.007331 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:40:33.012050 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:40:33.017762 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:40:33.024896 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:40:33.036805 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:40:33.037848 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:40:33.038847 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:40:33.040097 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m23:40:33.041976 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:40:33.043091 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m23:40:33.044917 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m23:40:33.046617 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:33.047782 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m23:40:33.049014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:33.050152 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:40:33.052811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:33.068707 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.072386 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.074706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.075673 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.076825 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:40:33.080569 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:40:33.083251 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:40:33.085180 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:40:33.087575 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:33.090182 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m23:40:33.093520 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m23:40:33.095528 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m23:40:33.109464 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.127433 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m23:40:33.130051 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.141038 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m23:40:33.142054 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m23:40:33.147973 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.35s]
[0m23:40:33.150854 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m23:40:33.161008 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.154040 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:40:33.168063 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.37s]
[0m23:40:33.178140 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m23:40:33.184483 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:40:33.190008 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:40:33.195144 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.202668 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m23:40:33.213263 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m23:40:33.222861 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:40:33.232410 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m23:40:33.238745 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.45s]
[0m23:40:33.245857 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m23:40:33.251626 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m23:40:33.263211 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m23:40:33.267579 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:40:33.271416 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:40:33.276752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m23:40:33.279114 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.48s]
[0m23:40:33.289829 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:40:33.297723 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:40:33.300873 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:40:33.304222 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:40:33.305808 [info ] [Thread-4 (]: 10 of 17 START test not_null_stg_customers_country ............................. [RUN]
[0m23:40:33.316867 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:40:33.318701 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:40:33.320417 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m23:40:33.323186 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m23:40:33.324116 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:40:33.325825 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:40:33.328417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m23:40:33.329770 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:40:33.334226 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:40:33.340485 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:40:33.341954 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:40:33.350201 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:40:33.359543 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:40:33.366381 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:40:33.367083 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:40:33.368931 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m23:40:33.369900 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:40:33.370632 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:40:33.374567 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:40:33.375971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:33.377165 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m23:40:33.381683 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:40:33.386278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:33.395323 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:40:33.397060 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:40:33.398406 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m23:40:33.399943 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.400980 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m23:40:33.402794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.403824 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:33.405697 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:40:33.407385 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:33.408981 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:40:33.411781 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m23:40:33.415624 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:33.421202 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.430079 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m23:40:33.431983 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.433247 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.434399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.435683 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m23:40:33.437358 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:40:33.441740 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m23:40:33.443653 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:40:33.446625 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.20s]
[0m23:40:33.449940 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m23:40:33.452584 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m23:40:33.453698 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m23:40:33.456145 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:40:33.460593 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.462560 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.19s]
[0m23:40:33.468798 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:40:33.469927 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.473288 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m23:40:33.476112 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:40:33.477950 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_customers_customer_id ........................... [RUN]
[0m23:40:33.482757 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m23:40:33.486558 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m23:40:33.488282 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:40:33.490064 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m23:40:33.492804 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m23:40:33.495495 [info ] [Thread-4 (]: 10 of 17 PASS not_null_stg_customers_country ................................... [[32mPASS[0m in 0.17s]
[0m23:40:33.501331 [info ] [Thread-1 (]: 13 of 17 START sql table model _analytics.fct_marketing_attribution ............ [RUN]
[0m23:40:33.504108 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:40:33.506805 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.18s]
[0m23:40:33.508700 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:40:33.511315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.fct_marketing_attribution)
[0m23:40:33.521976 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:40:33.524332 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:40:33.526367 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:40:33.530008 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:40:33.534504 [info ] [Thread-4 (]: 14 of 17 START sql table model _analytics.fct_revenue_daily .................... [RUN]
[0m23:40:33.547347 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.549737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now model.api_bi_project.fct_revenue_daily)
[0m23:40:33.550959 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:40:33.553762 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:40:33.568557 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:40:33.581062 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.585375 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:40:33.618574 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.620984 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:40:33.621837 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:40:33.623222 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m23:40:33.632243 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.633869 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:33.635204 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.638340 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:40:33.640580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:33.648047 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.652211 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.653543 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:40:33.655410 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:40:33.657405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.658348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:33.660312 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:33.662072 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.668549 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:40:33.670222 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:33.678823 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.682035 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m23:40:33.686002 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.688968 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m23:40:33.690378 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:40:33.692625 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.20s]
[0m23:40:33.697541 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:40:33.699978 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m23:40:33.702643 [info ] [Thread-2 (]: 15 of 17 START sql table model _analytics.dim_customer ......................... [RUN]
[0m23:40:33.705969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.dim_customer)
[0m23:40:33.707851 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:40:33.716607 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:40:33.748147 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m23:40:33.757361 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:40:33.758790 [debug] [Thread-4 (]: SQL status: SELECT 4289 in 0.0 seconds
[0m23:40:33.769923 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.771631 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m23:40:33.773523 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:33.781749 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.783644 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:40:33.784426 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:40:33.786634 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:40:33.789039 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:33.789730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:33.797158 [debug] [Thread-1 (]: SQL status: SELECT 5667 in 0.0 seconds
[0m23:40:33.800044 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:40:33.817074 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.820012 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.820861 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:33.825398 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m23:40:33.829764 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:40:33.831872 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:40:33.835204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:33.837210 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:40:33.848381 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.857382 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:40:33.865983 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:40:33.867498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:33.880666 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:40:33.881374 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m23:40:33.891395 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:40:33.901433 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:40:33.913388 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:40:33.917130 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.919093 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:40:33.922364 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m23:40:33.927259 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:40:33.933218 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:33.944031 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:40:33.946055 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:40:33.946962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:40:33.949070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:40:33.961337 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:40:33.963322 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:40:33.966079 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:40:33.968908 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:40:33.972558 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:40:33.973977 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:40:33.975557 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef1c03b50>]}
[0m23:40:33.976852 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:40:33.978251 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:40:33.980286 [info ] [Thread-4 (]: 14 of 17 OK created sql table model _analytics.fct_revenue_daily ............... [[32mSELECT 4289[0m in 0.43s]
[0m23:40:33.984445 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:40:33.987307 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:40:33.989044 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m23:40:33.990939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m23:40:33.992319 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:40:33.999546 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:40:34.010321 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:40:34.011105 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:40:34.012879 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:40:34.018836 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:40:34.030070 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:40:34.037185 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:40:34.042458 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:40:34.048585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eed4d2d10>]}
[0m23:40:34.054889 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:40:34.058236 [info ] [Thread-1 (]: 13 of 17 OK created sql table model _analytics.fct_marketing_attribution ....... [[32mSELECT 5667[0m in 0.54s]
[0m23:40:34.068834 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:40:34.070971 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:40:34.074533 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:40:34.076443 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m23:40:34.083707 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:40:34.089200 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m23:40:34.092402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:34.094496 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m23:40:34.099406 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c578b44-bf09-419a-a33a-e4e6bcb42cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eec385a10>]}
[0m23:40:34.103116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m23:40:34.105876 [info ] [Thread-2 (]: 15 of 17 OK created sql table model _analytics.dim_customer .................... [[32mSELECT 1000[0m in 0.39s]
[0m23:40:34.109859 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:40:34.112173 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m23:40:34.125551 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:34.126657 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:40:34.129485 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:40:34.132419 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m23:40:34.139736 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:34.149173 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m23:40:34.152346 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m23:40:34.156352 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:40:34.167229 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.18s]
[0m23:40:34.195500 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:40:34.199066 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:40:34.219634 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:40:34.222019 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m23:40:34.224495 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:34.249622 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:40:34.252616 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:40:34.256241 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m23:40:34.263887 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:40:34.270157 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m23:40:34.277511 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m23:40:34.289704 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.19s]
[0m23:40:34.311356 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:40:34.321248 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:34.324398 [debug] [MainThread]: On master: BEGIN
[0m23:40:34.332935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:34.350827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:40:34.353739 [debug] [MainThread]: On master: COMMIT
[0m23:40:34.355437 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:34.357022 [debug] [MainThread]: On master: COMMIT
[0m23:40:34.359029 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:40:34.361549 [debug] [MainThread]: On master: Close
[0m23:40:34.364490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:34.366585 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m23:40:34.368322 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:40:34.369770 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m23:40:34.371434 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m23:40:34.373375 [info ] [MainThread]: 
[0m23:40:34.375181 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m23:40:34.385506 [debug] [MainThread]: Command end result
[0m23:40:34.531954 [info ] [MainThread]: 
[0m23:40:34.534170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:34.540761 [info ] [MainThread]: 
[0m23:40:34.543052 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m23:40:34.550968 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.009386, "process_user_time": 5.305306, "process_kernel_time": 0.861832, "process_mem_max_rss": "116828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:40:34.555199 [debug] [MainThread]: Command `dbt build` succeeded at 23:40:34.554681 after 6.01 seconds
[0m23:40:34.558826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef44f4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3eec28ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3ef45ebc50>]}
[0m23:40:34.561432 [debug] [MainThread]: Flushing usage events
[0m23:45:08.326333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccdaf2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccdaf2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccdaf2750>]}


============================== 23:45:08.335181 | 1d4338ce-f3e4-4587-95fc-fb223498acf8 ==============================
[0m23:45:08.335181 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:45:08.339203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:45:08.554739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d4338ce-f3e4-4587-95fc-fb223498acf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccdaf0bd0>]}
[0m23:45:09.265541 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wstepk4_'
[0m23:45:09.270483 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:45:11.786345 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7b8ccd885e50>: Failed to resolve 'hub.getdbt.com' ([Errno -5] No address associated with hostname)"))
[0m23:45:11.787925 [debug] [MainThread]: Retrying external call. Attempt: 0 Max attempts: 5
[0m23:45:12.791605 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:45:23.020003 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:45:23.022668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:45:38.774013 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:45:38.788999 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:45:42.821368 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='codeload.github.com', port=443): Max retries exceeded with url: /dbt-labs/dbt-utils/tar.gz/1.3.1 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7b8ccd8b6850>: Failed to resolve 'codeload.github.com' ([Errno -5] No address associated with hostname)"))
[0m23:45:42.824066 [debug] [MainThread]: Retrying external call. Attempt: 0 Max attempts: 5
[0m23:45:57.694352 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='codeload.github.com', port=443): Read timed out. (read timeout=10.0)
[0m23:45:57.697594 [debug] [MainThread]: Retrying external call. Attempt: 1 Max attempts: 5
[0m23:46:07.620278 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='codeload.github.com', port=443): Max retries exceeded with url: /dbt-labs/dbt-utils/tar.gz/1.3.1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7b8ccd8ea610>, 'Connection to codeload.github.com timed out. (connect timeout=10.0)'))
[0m23:46:07.621873 [debug] [MainThread]: Retrying external call. Attempt: 2 Max attempts: 5
[0m23:46:18.644716 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='codeload.github.com', port=443): Max retries exceeded with url: /dbt-labs/dbt-utils/tar.gz/1.3.1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7b8ccd8f8410>, 'Connection to codeload.github.com timed out. (connect timeout=10.0)'))
[0m23:46:18.646884 [debug] [MainThread]: Retrying external call. Attempt: 3 Max attempts: 5
[0m23:46:46.379660 [info ] [MainThread]: Installed from version 1.3.1
[0m23:46:46.383745 [info ] [MainThread]: Up to date!
[0m23:46:46.386637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1d4338ce-f3e4-4587-95fc-fb223498acf8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccde3cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccd9f11d0>]}
[0m23:46:46.393313 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 103.38546, "process_user_time": 2.73488, "process_kernel_time": 1.050101, "process_mem_max_rss": "94756", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m23:46:46.397213 [debug] [MainThread]: Command `dbt deps` succeeded at 23:46:46.396770 after 103.39 seconds
[0m23:46:46.400569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccdaf8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ccdb17010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8cd18dc750>]}
[0m23:46:46.403472 [debug] [MainThread]: Flushing usage events
[0m23:46:56.148555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79369282f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7936927eac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793692828550>]}


============================== 23:46:56.154688 | 9d83d5bb-20e7-4e8e-b585-fd17417f3c83 ==============================
[0m23:46:56.154688 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:46:56.157248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:46:56.458875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79369273dd90>]}
[0m23:46:56.557083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793690f70a50>]}
[0m23:46:56.559681 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:46:56.621116 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:46:58.686493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:58.688175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:58.744198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793690d119d0>]}
[0m23:46:59.080076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793690a18e90>]}
[0m23:46:59.082527 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:46:59.093939 [info ] [MainThread]: 
[0m23:46:59.099219 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:59.109281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:46:59.112484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:46:59.203271 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:46:59.204551 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:46:59.210026 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:46:59.214172 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:46:59.219575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:59.222986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:59.249427 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:46:59.250791 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:46:59.254342 [debug] [ThreadPool]: On list_db: Close
[0m23:46:59.259473 [debug] [ThreadPool]: On list_db: Close
[0m23:46:59.270318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__analytics)
[0m23:46:59.271637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__staging)
[0m23:46:59.274545 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_analytics"
"
[0m23:46:59.278016 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_staging"
"
[0m23:46:59.293119 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:46:59.299855 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:46:59.302335 [debug] [ThreadPool]: On create_db__analytics: BEGIN
[0m23:46:59.305037 [debug] [ThreadPool]: On create_db__staging: BEGIN
[0m23:46:59.308922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:59.314870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:59.361825 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:46:59.365210 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:46:59.375380 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:46:59.377569 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:46:59.382506 [debug] [ThreadPool]: On create_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__analytics"} */
create schema if not exists "_analytics"
[0m23:46:59.391276 [debug] [ThreadPool]: On create_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__staging"} */
create schema if not exists "_staging"
[0m23:46:59.407284 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:46:59.408258 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:46:59.411999 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:46:59.445245 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:46:59.477116 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:46:59.513178 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:46:59.570396 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:46:59.620761 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:46:59.629719 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:46:59.636108 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:46:59.638232 [debug] [ThreadPool]: On create_db__analytics: Close
[0m23:46:59.642317 [debug] [ThreadPool]: On create_db__staging: Close
[0m23:46:59.650340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__staging, now list_db__analytics)
[0m23:46:59.651924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__analytics, now list_db__staging)
[0m23:46:59.675684 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:46:59.700650 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:46:59.717515 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:46:59.720439 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:46:59.723830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:59.725665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:59.742595 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:46:59.743617 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:46:59.745922 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:46:59.747588 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:46:59.749067 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:46:59.750562 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:46:59.758014 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:46:59.758814 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:46:59.762304 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:46:59.765795 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:46:59.769175 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:46:59.773152 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:46:59.789449 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:59.791100 [debug] [MainThread]: On master: BEGIN
[0m23:46:59.792941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:59.810774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:59.813950 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:59.821770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:59.904476 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m23:46:59.908281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79368b65a610>]}
[0m23:46:59.910540 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:59.916785 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:59.919007 [debug] [MainThread]: On master: BEGIN
[0m23:46:59.922076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:59.924138 [debug] [MainThread]: On master: COMMIT
[0m23:46:59.925673 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:59.927842 [debug] [MainThread]: On master: COMMIT
[0m23:46:59.933848 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:59.937175 [debug] [MainThread]: On master: Close
[0m23:46:59.941329 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:59.950570 [info ] [MainThread]: 
[0m23:46:59.961966 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:46:59.963480 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:46:59.966035 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:46:59.973114 [info ] [Thread-1 (]: 1 of 17 START sql view model _staging.stg_customers ............................ [RUN]
[0m23:46:59.975666 [info ] [Thread-2 (]: 2 of 17 START sql view model _staging.stg_payments ............................. [RUN]
[0m23:46:59.978304 [info ] [Thread-3 (]: 3 of 17 START sql view model _staging.stg_sessions ............................. [RUN]
[0m23:47:00.002296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_customers)
[0m23:47:00.008334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_payments)
[0m23:47:00.012379 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:47:00.029592 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:47:00.035296 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:47:00.037747 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:47:00.061696 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:47:00.072425 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:47:00.082211 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:47:00.105337 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:47:00.108591 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:47:00.122166 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:47:00.349633 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:47:00.354634 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:47:00.360313 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:47:00.376131 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:47:00.377873 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:47:00.385501 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:47:00.387434 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:47:00.389792 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:47:00.392482 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:47:00.395730 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:47:00.402472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:00.407006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:00.424925 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:00.439753 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:47:00.437208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:00.443007 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:47:00.446233 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:00.452269 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:47:00.459488 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:47:00.474733 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:47:00.478919 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:47:00.480619 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:47:00.524660 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:47:00.572917 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:47:00.584886 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:47:00.596164 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:47:00.617768 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:47:00.660706 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:47:00.668211 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:47:00.673423 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:00.675149 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:47:00.681565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:00.723863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:00.737764 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:47:00.741965 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:47:00.747405 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:47:00.750903 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:47:00.754170 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:47:00.757273 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:47:00.760181 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:47:00.765827 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:47:00.769038 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:47:00.776859 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:00.778507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:00.781148 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:00.803967 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:47:00.814633 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:47:00.823388 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:47:00.851125 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:47:00.852830 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:47:00.855059 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:47:00.858204 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:47:00.864479 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:47:00.867877 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:47:00.874668 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:47:00.879885 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:47:00.883134 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:47:00.889687 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:47:00.895166 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:47:00.900374 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:47:00.908869 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793688c496d0>]}
[0m23:47:00.914460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79368b5f1b90>]}
[0m23:47:00.918059 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79368b68d4d0>]}
[0m23:47:00.927848 [info ] [Thread-3 (]: 3 of 17 OK created sql view model _staging.stg_sessions ........................ [[32mCREATE VIEW[0m in 0.89s]
[0m23:47:00.933025 [info ] [Thread-1 (]: 1 of 17 OK created sql view model _staging.stg_customers ....................... [[32mCREATE VIEW[0m in 0.91s]
[0m23:47:00.938392 [info ] [Thread-2 (]: 2 of 17 OK created sql view model _staging.stg_payments ........................ [[32mCREATE VIEW[0m in 0.91s]
[0m23:47:00.942372 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:47:00.945583 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:47:00.952362 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:47:00.958023 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:47:00.959743 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:47:00.965213 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:47:00.969892 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:47:00.978826 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m23:47:00.981326 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m23:47:00.983863 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m23:47:00.986410 [info ] [Thread-2 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m23:47:00.995645 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m23:47:01.000803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m23:47:01.006568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m23:47:01.009835 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m23:47:01.013046 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:47:01.018453 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:47:01.021352 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:47:01.024524 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:47:01.306687 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:47:01.325651 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:47:01.327204 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:47:01.333794 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:47:01.350834 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:47:01.355436 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:47:01.365254 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:47:01.375815 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:47:01.399165 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:47:01.407192 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:47:01.418017 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:47:01.428656 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:47:01.440652 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:47:01.443171 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:47:01.444739 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m23:47:01.446601 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:47:01.447967 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:47:01.450888 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m23:47:01.454228 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:47:01.457565 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m23:47:01.459484 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m23:47:01.461964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:01.466346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:01.475683 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:47:01.484086 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:01.495875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:01.499939 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:47:01.507205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:01.515896 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:47:01.522122 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m23:47:01.525878 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:47:01.533961 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:47:01.542857 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:01.543999 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:01.564411 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m23:47:01.580709 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:47:01.607746 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m23:47:01.621176 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m23:47:01.625586 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:01.628417 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m23:47:01.649036 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m23:47:01.661337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:01.669336 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:01.677949 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.67s]
[0m23:47:01.791370 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m23:47:01.840275 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m23:47:01.871922 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m23:47:01.921425 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:47:01.933365 [info ] [Thread-2 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.92s]
[0m23:47:01.942633 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m23:47:01.950411 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m23:47:01.952856 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:47:01.968215 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:47:01.978667 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.97s]
[0m23:47:01.989327 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.99s]
[0m23:47:01.992724 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m23:47:01.995956 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:47:01.999808 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:47:02.004468 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:47:02.008618 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m23:47:02.011226 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m23:47:02.014544 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:47:02.018048 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:47:02.020808 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:47:02.025326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m23:47:02.030258 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m23:47:02.037054 [info ] [Thread-4 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m23:47:02.057252 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:47:02.076288 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:47:02.079091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m23:47:02.090868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m23:47:02.143395 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:47:02.149488 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:47:02.151693 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:47:02.196702 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:47:02.262200 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:47:02.275658 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:47:02.303579 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:47:02.308749 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:47:02.317058 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:47:02.319382 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:47:02.320729 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:47:02.334446 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:47:02.348845 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:47:02.356554 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:47:02.365496 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m23:47:02.366722 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:47:02.368056 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:47:02.371343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:47:02.373979 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:47:02.375082 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m23:47:02.377494 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m23:47:02.382564 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m23:47:02.385185 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:02.388335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:47:02.390612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:02.397497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:02.413149 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:47:02.416251 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:02.421042 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m23:47:02.423182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:02.429253 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:02.431184 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:47:02.437276 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:47:02.438546 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:02.440911 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:47:02.444331 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:47:02.448825 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m23:47:02.461061 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m23:47:02.471294 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m23:47:02.484982 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:02.490508 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m23:47:02.500332 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m23:47:02.501741 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:02.505330 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:02.508998 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.50s]
[0m23:47:02.516086 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m23:47:02.521862 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m23:47:02.526175 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m23:47:02.529910 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:47:02.533196 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.51s]
[0m23:47:02.535864 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m23:47:02.539884 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m23:47:02.542474 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:47:02.548642 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:47:02.551609 [info ] [Thread-4 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.46s]
[0m23:47:02.554945 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.48s]
[0m23:47:02.558082 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m23:47:02.560411 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:47:02.567167 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:47:02.570468 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:47:02.574212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m23:47:02.577062 [info ] [Thread-2 (]: 13 of 17 START sql table model _analytics.fct_marketing_attribution ............ [RUN]
[0m23:47:02.580817 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m23:47:02.586559 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:47:02.589307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_marketing_attribution)
[0m23:47:02.592184 [info ] [Thread-4 (]: 14 of 17 START sql table model _analytics.dim_customer ......................... [RUN]
[0m23:47:02.602707 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:47:02.604633 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:47:02.607086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.dim_customer)
[0m23:47:02.617390 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:47:02.619244 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:47:02.623043 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:47:02.631973 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:47:02.641933 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:47:02.646101 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:47:02.692692 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:47:02.694153 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:47:02.696779 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m23:47:02.697859 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m23:47:02.705068 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:47:02.706911 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:47:02.711369 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:47:02.714418 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:47:02.716750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:02.717891 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:47:02.721002 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:47:02.723311 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:47:02.729839 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:02.734774 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:02.737856 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:47:02.740181 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:47:02.747542 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:47:02.751305 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:02.753169 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:47:02.764657 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:47:02.769265 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:47:02.785317 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:02.802706 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m23:47:02.808409 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m23:47:02.812680 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m23:47:02.831000 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:47:02.833825 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.26s]
[0m23:47:02.835652 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:47:02.838107 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:47:02.840964 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:02.843014 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:47:02.850869 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:47:02.852278 [info ] [Thread-1 (]: 15 of 17 START sql table model _analytics.fct_revenue_daily .................... [RUN]
[0m23:47:02.853833 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:47:02.857045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.fct_revenue_daily)
[0m23:47:02.859802 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:47:02.862018 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:47:02.869881 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:47:02.873246 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:02.878783 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:47:02.886715 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:47:02.889272 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:47:02.890643 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:47:02.892965 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:47:02.893882 [debug] [Thread-2 (]: SQL status: SELECT 5667 in 0.0 seconds
[0m23:47:02.902294 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:47:02.906023 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m23:47:02.919433 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:47:02.940112 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:47:02.938524 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793688c35990>]}
[0m23:47:02.951920 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:02.958380 [info ] [Thread-4 (]: 14 of 17 OK created sql table model _analytics.dim_customer .................... [[32mSELECT 1000[0m in 0.33s]
[0m23:47:02.974924 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:47:02.978090 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:47:02.984989 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m23:47:02.994120 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:47:02.999209 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:47:03.009905 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:47:03.014138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:03.033640 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:03.064883 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:47:03.070954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:03.081571 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:47:03.087220 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:47:03.097431 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:47:03.106595 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:47:03.121635 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:47:03.149719 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:47:03.165651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79368b6b7890>]}
[0m23:47:03.170803 [info ] [Thread-2 (]: 13 of 17 OK created sql table model _analytics.fct_marketing_attribution ....... [[32mSELECT 5667[0m in 0.58s]
[0m23:47:03.182106 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:47:03.187250 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:47:03.208516 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m23:47:03.219885 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m23:47:03.240481 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:47:03.283206 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:47:03.284304 [debug] [Thread-1 (]: SQL status: SELECT 4289 in 0.0 seconds
[0m23:47:03.332395 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:47:03.340653 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:47:03.348137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:03.365474 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:47:03.370062 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:47:03.377786 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:47:03.381732 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:47:03.398620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:03.425548 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:47:03.457834 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:47:03.492320 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:47:03.507701 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:47:03.521508 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:47:03.529069 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:47:03.530681 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:47:03.580303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d83d5bb-20e7-4e8e-b585-fd17417f3c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793688c34e90>]}
[0m23:47:03.591753 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m23:47:03.606545 [info ] [Thread-1 (]: 15 of 17 OK created sql table model _analytics.fct_revenue_daily ............... [[32mSELECT 4289[0m in 0.72s]
[0m23:47:03.652620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:47:03.716380 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:47:03.754667 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:47:03.769443 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:03.776139 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m23:47:03.797698 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:47:03.810138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m23:47:03.823414 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m23:47:03.827780 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:47:03.898358 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:03.987675 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:47:04.118777 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m23:47:04.186820 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m23:47:04.250678 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 1.03s]
[0m23:47:04.268198 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:47:04.545969 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:47:04.592833 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:47:04.645525 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:47:04.665468 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m23:47:04.669539 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:04.694871 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:04.698267 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:47:04.701279 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m23:47:04.708897 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:04.721496 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m23:47:04.724423 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m23:47:04.729546 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.92s]
[0m23:47:04.736901 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:47:04.742864 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:04.745225 [debug] [MainThread]: On master: BEGIN
[0m23:47:04.748840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:04.784252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:04.787026 [debug] [MainThread]: On master: COMMIT
[0m23:47:04.795559 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:04.797995 [debug] [MainThread]: On master: COMMIT
[0m23:47:04.800649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:04.803787 [debug] [MainThread]: On master: Close
[0m23:47:04.806514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:04.813652 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m23:47:04.816265 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m23:47:04.820283 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m23:47:04.822863 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:47:04.825523 [info ] [MainThread]: 
[0m23:47:04.831599 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m23:47:04.843415 [debug] [MainThread]: Command end result
[0m23:47:02.630906 [info ] [MainThread]: 
[0m23:47:02.633072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:47:02.635531 [info ] [MainThread]: 
[0m23:47:02.638977 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m23:47:02.644023 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.047434, "process_user_time": 5.768031, "process_kernel_time": 1.015581, "process_mem_max_rss": "116736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:47:02.647695 [debug] [MainThread]: Command `dbt build` succeeded at 23:47:02.647134 after 9.05 seconds
[0m23:47:02.654248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7936948d5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793696608810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7936966ffc50>]}
[0m23:47:02.658535 [debug] [MainThread]: Flushing usage events
[0m23:55:32.484035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737428f19950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73742a3345d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737428efea10>]}


============================== 23:55:32.495715 | 5a022293-7212-48d6-8248-b4f9e30098ad ==============================
[0m23:55:32.495715 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:55:32.498389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m23:55:32.647973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a022293-7212-48d6-8248-b4f9e30098ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737429080450>]}
[0m23:55:33.258295 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s1oelpf9'
[0m23:55:33.260087 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:55:33.698506 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:55:33.702274 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:55:33.939630 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:55:33.949240 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:55:42.014131 [info ] [MainThread]: Installed from version 1.3.1
[0m23:55:42.015766 [info ] [MainThread]: Up to date!
[0m23:55:42.018064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a022293-7212-48d6-8248-b4f9e30098ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73742a648050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73742a427990>]}
[0m23:55:42.021393 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.633873, "process_user_time": 3.260686, "process_kernel_time": 1.351716, "process_mem_max_rss": "94876", "process_out_blocks": "1296", "process_in_blocks": "0"}
[0m23:55:42.023471 [debug] [MainThread]: Command `dbt deps` succeeded at 23:55:42.023100 after 9.64 seconds
[0m23:55:42.025034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737428f25490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737428f25290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73742ccd0650>]}
[0m23:55:42.026330 [debug] [MainThread]: Flushing usage events
[0m23:55:45.512478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51ccd1ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51cebd8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51ccd1a690>]}


============================== 23:55:45.520711 | 4533f3b9-3c0f-41ab-a2e2-19ea3f64e214 ==============================
[0m23:55:45.520711 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:55:45.523001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:55:45.856077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51cb418d90>]}
[0m23:55:45.987122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51d0a84fd0>]}
[0m23:55:45.991741 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:55:46.128749 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:55:46.150653 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:55:46.155341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51cb474650>]}
[0m23:55:47.184694 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:55:47.187358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51cb14d5d0>]}
[0m23:55:47.673469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51ccd618d0>]}
[0m23:55:47.873856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51cb1f8a50>]}
[0m23:55:47.876423 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:55:47.878517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51ce7e1b90>]}
[0m23:55:47.884632 [info ] [MainThread]: 
[0m23:55:47.888340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:55:47.900491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:55:47.902389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:55:48.052238 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:55:48.053197 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:55:48.055192 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:48.057452 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:48.058933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:48.060402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:48.081448 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:55:48.084144 [debug] [ThreadPool]: On list_db: Close
[0m23:55:48.089163 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:55:48.092689 [debug] [ThreadPool]: On list_db: Close
[0m23:55:48.095171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__staging)
[0m23:55:48.095921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db__analytics)
[0m23:55:48.097391 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_staging"
"
[0m23:55:48.099281 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "_analytics"
"
[0m23:55:48.107859 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:55:48.111578 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:55:48.112738 [debug] [ThreadPool]: On create_db__staging: BEGIN
[0m23:55:48.113773 [debug] [ThreadPool]: On create_db__analytics: BEGIN
[0m23:55:48.115058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:48.116431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:48.133785 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.135718 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.137536 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:55:48.139178 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:55:48.140637 [debug] [ThreadPool]: On create_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__staging"} */
create schema if not exists "_staging"
[0m23:55:48.142340 [debug] [ThreadPool]: On create_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db__analytics"} */
create schema if not exists "_analytics"
[0m23:55:48.145393 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:55:48.146089 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:55:48.148682 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:55:48.150942 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:55:48.153477 [debug] [ThreadPool]: Using postgres connection "create_db__staging"
[0m23:55:48.155537 [debug] [ThreadPool]: Using postgres connection "create_db__analytics"
[0m23:55:48.157214 [debug] [ThreadPool]: On create_db__staging: COMMIT
[0m23:55:48.158610 [debug] [ThreadPool]: On create_db__analytics: COMMIT
[0m23:55:48.162940 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:55:48.164764 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:55:48.166636 [debug] [ThreadPool]: On create_db__staging: Close
[0m23:55:48.168339 [debug] [ThreadPool]: On create_db__analytics: Close
[0m23:55:48.176331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__staging, now list_db__staging)
[0m23:55:48.177939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db__analytics, now list_db__analytics)
[0m23:55:48.192933 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:55:48.196487 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:55:48.198395 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:55:48.199950 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:55:48.201774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:48.203256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:48.219930 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.220637 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.222326 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:55:48.223864 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:55:48.225535 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:55:48.227442 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:55:48.234959 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:55:48.236774 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:55:48.238787 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:55:48.241593 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:55:48.244883 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:55:48.247637 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:55:48.260105 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:48.262163 [debug] [MainThread]: On master: BEGIN
[0m23:55:48.264086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:55:48.286856 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.289644 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:48.293254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:55:48.308758 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:55:48.312854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51ca0bcf50>]}
[0m23:55:48.315511 [debug] [MainThread]: On master: ROLLBACK
[0m23:55:48.319222 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:48.321126 [debug] [MainThread]: On master: BEGIN
[0m23:55:48.323554 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.325814 [debug] [MainThread]: On master: COMMIT
[0m23:55:48.327892 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:48.329470 [debug] [MainThread]: On master: COMMIT
[0m23:55:48.331808 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:55:48.334950 [debug] [MainThread]: On master: Close
[0m23:55:48.338170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:55:48.341125 [info ] [MainThread]: 
[0m23:55:48.370356 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:55:48.371510 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:55:48.372274 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:55:48.374524 [info ] [Thread-1 (]: 1 of 6 START sql view model _staging.stg_customers ............................. [RUN]
[0m23:55:48.377029 [info ] [Thread-2 (]: 2 of 6 START sql view model _staging.stg_payments .............................. [RUN]
[0m23:55:48.380678 [info ] [Thread-3 (]: 3 of 6 START sql view model _staging.stg_sessions .............................. [RUN]
[0m23:55:48.384855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_customers)
[0m23:55:48.388339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_payments)
[0m23:55:48.391254 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:55:48.393754 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:55:48.397867 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:55:48.401408 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:55:48.419070 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:55:48.424929 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:55:48.431065 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:55:48.475303 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:55:48.484594 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:55:48.496957 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:55:48.577100 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:55:48.580655 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:55:48.583214 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:55:48.604758 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:55:48.606875 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:55:48.607814 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:55:48.609290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:48.610333 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:55:48.611364 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:55:48.614332 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:55:48.617128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:48.618912 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:55:48.628347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.630345 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:55:48.634792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.636049 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:55:48.637889 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:55:48.639869 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:55:48.642751 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:55:48.645242 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:55:48.647332 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:55:48.648438 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:55:48.655848 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:55:48.666408 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:55:48.673468 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:55:48.680705 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:55:48.688711 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:55:48.689928 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:55:48.691868 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:55:48.695044 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:55:48.698819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:55:48.700069 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:55:48.702744 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:55:48.729706 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:55:48.732044 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:55:48.734971 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:55:48.736366 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:55:48.737805 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:55:48.739403 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:55:48.740675 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:55:48.742005 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:55:48.743400 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:55:48.747209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:55:48.748299 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:55:48.749347 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:55:48.759890 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:55:48.763915 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:55:48.771052 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:55:48.779980 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:55:48.782347 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:55:48.784560 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:55:48.786213 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:55:48.787695 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:55:48.789115 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:55:48.791690 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:55:48.792574 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:55:48.794726 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:55:48.798105 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:55:48.801590 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:55:48.804963 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:55:48.808406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51ccd61150>]}
[0m23:55:48.810778 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51c8b86610>]}
[0m23:55:48.815183 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51c8c5d290>]}
[0m23:55:48.817840 [info ] [Thread-1 (]: 1 of 6 OK created sql view model _staging.stg_customers ........................ [[32mCREATE VIEW[0m in 0.42s]
[0m23:55:48.821490 [info ] [Thread-2 (]: 2 of 6 OK created sql view model _staging.stg_payments ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m23:55:48.824326 [info ] [Thread-3 (]: 3 of 6 OK created sql view model _staging.stg_sessions ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m23:55:48.827145 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:55:48.829535 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:55:48.832753 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:55:48.836387 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m23:55:48.839575 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:55:48.842448 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:55:48.844363 [info ] [Thread-4 (]: 4 of 6 START sql table model _analytics.dim_customer ........................... [RUN]
[0m23:55:48.847577 [info ] [Thread-1 (]: 5 of 6 START sql table model _analytics.fct_revenue_daily ...................... [RUN]
[0m23:55:48.854129 [info ] [Thread-2 (]: 6 of 6 START sql table model _analytics.fct_marketing_attribution .............. [RUN]
[0m23:55:48.860346 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m23:55:48.862495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m23:55:48.868076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m23:55:48.873706 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:55:48.878801 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:55:48.881707 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:55:48.899650 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:55:48.916339 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:55:48.926199 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:55:48.942647 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m23:55:48.956101 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:55:48.963480 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:55:49.005237 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:55:49.001876 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:55:49.011382 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:55:49.024765 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:55:49.026945 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:55:49.028071 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:55:49.029840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:55:49.031312 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:55:49.032392 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:55:49.035850 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:55:49.038239 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:55:49.041163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:49.050630 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:55:49.055026 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:55:49.056445 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:55:49.063742 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:55:49.066083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:55:49.067295 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:55:49.068387 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:55:49.070348 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:55:49.078193 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:55:49.080023 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:55:49.082995 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:55:49.086192 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:55:49.096493 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:55:49.098970 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:55:49.099970 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:55:49.116372 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:55:49.124068 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:55:49.133696 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:55:49.136387 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:55:49.142972 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:55:49.145506 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:55:49.147727 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:55:49.150301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:55:49.151608 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:55:49.155961 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:55:49.157251 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:55:49.161066 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:55:49.163215 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:55:49.168171 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:55:49.170136 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:55:49.172270 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:55:49.180459 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:55:49.183074 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:55:49.186231 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:55:49.187826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:55:49.190817 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:55:49.197118 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:55:49.198794 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:55:49.204087 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:55:49.208969 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:55:49.216609 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:55:49.220516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51c8b69150>]}
[0m23:55:49.222401 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:55:49.225822 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:55:49.228676 [info ] [Thread-2 (]: 6 of 6 OK created sql table model _analytics.fct_marketing_attribution ......... [[32mSELECT 0[0m in 0.35s]
[0m23:55:49.232329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:55:49.234116 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:55:49.237754 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:55:49.241297 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:55:49.244349 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:55:49.249039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51cf259f10>]}
[0m23:55:49.253150 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m23:55:49.256458 [info ] [Thread-1 (]: 5 of 6 OK created sql table model _analytics.fct_revenue_daily ................. [[32mSELECT 0[0m in 0.39s]
[0m23:55:49.259232 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4533f3b9-3c0f-41ab-a2e2-19ea3f64e214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51c8cec190>]}
[0m23:55:49.262623 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:55:49.265598 [info ] [Thread-4 (]: 4 of 6 OK created sql table model _analytics.dim_customer ...................... [[32mSELECT 0[0m in 0.40s]
[0m23:55:49.272348 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m23:55:49.278552 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:49.281291 [debug] [MainThread]: On master: BEGIN
[0m23:55:49.289268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:55:49.316472 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:55:49.321782 [debug] [MainThread]: On master: COMMIT
[0m23:55:49.323501 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:49.325707 [debug] [MainThread]: On master: COMMIT
[0m23:55:49.329395 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:55:49.333091 [debug] [MainThread]: On master: Close
[0m23:55:49.335464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:49.339300 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m23:55:49.341065 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m23:55:49.346127 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m23:55:49.347742 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:55:49.349821 [info ] [MainThread]: 
[0m23:55:49.353488 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m23:55:49.358965 [debug] [MainThread]: Command end result
[0m23:55:49.502500 [info ] [MainThread]: 
[0m23:55:49.505353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:55:49.507973 [info ] [MainThread]: 
[0m23:55:49.510833 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:55:49.515510 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.58714, "process_user_time": 5.460319, "process_kernel_time": 0.601749, "process_mem_max_rss": "118380", "process_out_blocks": "144", "process_in_blocks": "0"}
[0m23:55:49.518151 [debug] [MainThread]: Command `dbt run` succeeded at 23:55:49.517807 after 6.59 seconds
[0m23:55:49.519834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51ccedbc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51d0c44550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51d0b78790>]}
[0m23:55:49.521347 [debug] [MainThread]: Flushing usage events
[0m23:59:24.540924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d97392910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d973d0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d98d368d0>]}


============================== 23:59:24.558148 | 77210e46-99a8-49aa-b619-f92e8639d6f8 ==============================
[0m23:59:24.558148 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:24.560305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:24.723814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77210e46-99a8-49aa-b619-f92e8639d6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d972aa1d0>]}
[0m23:59:25.400233 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-80bku03c'
[0m23:59:25.403226 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:59:25.793493 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:59:25.795837 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:59:26.054029 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:59:26.071302 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:59:30.529618 [info ] [MainThread]: Installed from version 1.3.1
[0m23:59:30.531630 [info ] [MainThread]: Up to date!
[0m23:59:30.533642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '77210e46-99a8-49aa-b619-f92e8639d6f8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d97402f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d98889c50>]}
[0m23:59:30.537738 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.645504, "process_user_time": 2.45793, "process_kernel_time": 0.815652, "process_mem_max_rss": "94552", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m23:59:30.539865 [debug] [MainThread]: Command `dbt deps` succeeded at 23:59:30.539653 after 8.65 seconds
[0m23:59:30.541374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d97818110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d9b198810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702d9b31cdd0>]}
[0m23:59:30.542747 [debug] [MainThread]: Flushing usage events
[0m23:59:36.940407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae035ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae1d74550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae051ff10>]}


============================== 23:59:36.947759 | d3494a5c-762e-4c97-baa5-9de34cdd90dd ==============================
[0m23:59:36.947759 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:36.950486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:59:37.360753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae03a3f10>]}
[0m23:59:37.530353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae4070c50>]}
[0m23:59:37.535089 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:37.630093 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:59:40.329512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:40.330882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:40.403331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711adeacc710>]}
[0m23:59:40.867885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ade575210>]}
[0m23:59:40.870102 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m23:59:40.884400 [info ] [MainThread]: 
[0m23:59:40.887862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:40.903230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:59:40.904744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m23:59:41.120223 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:59:41.121415 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m23:59:41.123343 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:59:41.127790 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m23:59:41.139073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:41.141463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:41.181809 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:59:41.183221 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:59:41.196336 [debug] [ThreadPool]: On list_db: Close
[0m23:59:41.212879 [debug] [ThreadPool]: On list_db: Close
[0m23:59:41.236448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__analytics)
[0m23:59:41.238656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__staging)
[0m23:59:41.294338 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:59:41.308650 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:59:41.360142 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m23:59:41.405399 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m23:59:41.418879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:41.427891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:41.474485 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:59:41.475454 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:59:41.500143 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m23:59:41.509557 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m23:59:41.524838 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m23:59:41.531428 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m23:59:41.549030 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:59:41.557941 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:59:41.565816 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m23:59:41.594978 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m23:59:41.617080 [debug] [ThreadPool]: On list_db__staging: Close
[0m23:59:41.654338 [debug] [ThreadPool]: On list_db__analytics: Close
[0m23:59:41.712832 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:41.725299 [debug] [MainThread]: On master: BEGIN
[0m23:59:41.727927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:41.763955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:59:41.778514 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:41.781821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:41.872533 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m23:59:41.877221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711adea7e290>]}
[0m23:59:41.880080 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:41.882663 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:41.887251 [debug] [MainThread]: On master: BEGIN
[0m23:59:41.891966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:59:41.896345 [debug] [MainThread]: On master: COMMIT
[0m23:59:41.898565 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:41.900585 [debug] [MainThread]: On master: COMMIT
[0m23:59:41.907018 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:59:41.910504 [debug] [MainThread]: On master: Close
[0m23:59:41.913462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:41.950641 [info ] [MainThread]: 
[0m23:59:41.996133 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m23:59:41.998801 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m23:59:42.000275 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m23:59:42.006129 [info ] [Thread-1 (]: 1 of 17 START sql view model _staging.stg_customers ............................ [RUN]
[0m23:59:42.017849 [info ] [Thread-2 (]: 2 of 17 START sql view model _staging.stg_payments ............................. [RUN]
[0m23:59:42.038866 [info ] [Thread-3 (]: 3 of 17 START sql view model _staging.stg_sessions ............................. [RUN]
[0m23:59:42.085576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_customers)
[0m23:59:42.093323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_payments)
[0m23:59:42.099664 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m23:59:42.110216 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m23:59:42.115519 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m23:59:42.122906 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m23:59:42.169368 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m23:59:42.227894 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m23:59:42.249239 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m23:59:42.323782 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m23:59:42.337378 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m23:59:42.351032 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m23:59:42.716455 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m23:59:42.718573 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m23:59:42.725025 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m23:59:43.088847 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:59:43.094813 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:59:43.096193 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m23:59:43.102243 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:59:43.103818 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m23:59:43.116146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:43.140921 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m23:59:43.186403 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:43.246976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:43.277226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:43.333858 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:59:43.342058 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:43.347880 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m23:59:43.355218 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:59:43.366599 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:43.506362 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m23:59:43.598633 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:59:43.739787 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:59:43.795878 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:59:43.865773 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:59:44.166006 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m23:59:44.193124 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:59:44.265510 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:59:44.293175 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:59:44.312300 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m23:59:44.323221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:44.366159 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:59:44.385259 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:44.398079 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:59:44.697083 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m23:59:44.967042 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:59:45.012561 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:59:45.022155 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:45.036311 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m23:59:45.054452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:45.094441 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:59:45.118627 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:45.242423 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:59:45.254811 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:59:45.268567 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:59:45.326370 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:59:45.344502 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:45.351741 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:59:45.354840 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m23:59:45.367262 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:59:45.422120 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m23:59:45.444956 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:59:45.448103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:59:45.473359 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:59:45.482850 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m23:59:45.525743 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m23:59:45.555977 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m23:59:45.600353 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:59:45.632314 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m23:59:45.668779 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m23:59:45.694364 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m23:59:45.759728 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m23:59:45.777788 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m23:59:45.792372 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m23:59:45.861922 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:59:45.864282 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:59:45.890318 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m23:59:45.982275 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m23:59:46.019048 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m23:59:46.128695 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:59:46.162755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ade5cdc50>]}
[0m23:59:46.173963 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711add14a350>]}
[0m23:59:46.322862 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m23:59:46.374649 [info ] [Thread-1 (]: 1 of 17 OK created sql view model _staging.stg_customers ....................... [[32mCREATE VIEW[0m in 4.07s]
[0m23:59:46.413210 [info ] [Thread-3 (]: 3 of 17 OK created sql view model _staging.stg_sessions ........................ [[32mCREATE VIEW[0m in 4.07s]
[0m23:59:46.474503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711add118e10>]}
[0m23:59:46.487205 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m23:59:46.540458 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m23:59:46.548352 [info ] [Thread-2 (]: 2 of 17 OK created sql view model _staging.stg_payments ........................ [[32mCREATE VIEW[0m in 4.38s]
[0m23:59:46.559868 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:59:46.562002 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:46.564058 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:59:46.570444 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m23:59:46.583388 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m23:59:46.587067 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m23:59:46.663734 [info ] [Thread-3 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m23:59:46.669006 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:59:46.686246 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m23:59:46.779289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m23:59:46.797681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m23:59:46.921614 [info ] [Thread-2 (]: 7 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m23:59:46.934291 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:59:46.951809 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:46.976101 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:59:46.987755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m23:59:47.100301 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:59:47.105240 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:47.391584 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:59:47.392369 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:59:47.428793 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:59:47.430582 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:47.431319 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:59:47.437202 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:59:47.505928 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:59:47.526304 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:47.542817 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:59:47.545346 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:59:47.729154 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:59:47.820911 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:59:47.822963 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m23:59:47.825474 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:47.854556 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:47.858175 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:47.860508 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m23:59:47.863650 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m23:59:47.866812 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m23:59:47.871933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:47.894562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:47.916890 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:47.927325 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:47.931603 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m23:59:47.970814 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m23:59:47.989414 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m23:59:47.990750 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:48.008235 [info ] [Thread-2 (]: 7 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 1.02s]
[0m23:59:48.042210 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m23:59:48.043659 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:59:48.047484 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m23:59:48.051833 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:59:48.055572 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:59:48.060022 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m23:59:48.064436 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m23:59:48.067509 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m23:59:48.073496 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m23:59:48.077415 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:48.081679 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 1.30s]
[0m23:59:48.089846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m23:59:48.095627 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:48.100248 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:48.103894 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:59:48.116884 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:59:48.134612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:48.136064 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:48.149564 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:59:48.152462 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m23:59:48.159973 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m23:59:48.167836 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m23:59:48.175168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m23:59:48.186604 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:59:48.196653 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m23:59:48.249864 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:59:48.257023 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:48.259103 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:48.285189 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:59:48.291903 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:59:48.307596 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m23:59:48.312626 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m23:59:48.325845 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:59:48.330608 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m23:59:48.337173 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m23:59:48.345480 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 1.66s]
[0m23:59:48.356224 [info ] [Thread-3 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 1.56s]
[0m23:59:48.374006 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m23:59:48.390877 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m23:59:48.394848 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:59:48.398833 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:59:48.407632 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:59:48.416513 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:59:48.432187 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:59:48.435758 [info ] [Thread-4 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m23:59:48.440009 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m23:59:48.443908 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m23:59:48.452827 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m23:59:48.455461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m23:59:48.457761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:48.460569 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:59:48.463234 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:59:48.465614 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:59:48.498270 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:48.550593 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:59:48.582580 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:59:48.588357 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m23:59:48.591776 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m23:59:48.607463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:48.610992 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m23:59:48.637785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:48.640099 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:48.650800 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:59:48.658622 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m23:59:48.668767 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:59:48.667203 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m23:59:48.692127 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:59:48.694044 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:59:48.711712 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:59:48.714185 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m23:59:48.724048 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.64s]
[0m23:59:48.735835 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m23:59:48.739620 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:59:48.740933 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:59:48.743456 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m23:59:48.746254 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:59:48.751422 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m23:59:48.753885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m23:59:48.756723 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m23:59:48.759496 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:48.762892 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:59:48.766543 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:48.791713 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:48.797659 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:59:48.799908 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m23:59:48.803438 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m23:59:48.804311 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:48.811484 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:48.821246 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m23:59:48.822768 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:48.826720 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m23:59:48.829479 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m23:59:48.833404 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m23:59:48.835506 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m23:59:48.836801 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:59:48.848906 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.67s]
[0m23:59:48.863802 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m23:59:48.868900 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:48.877896 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:59:48.883772 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m23:59:48.889764 [info ] [Thread-4 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.44s]
[0m23:59:48.896037 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m23:59:48.900057 [debug] [Thread-1 (]: Began running node model.api_bi_project.dim_customer
[0m23:59:48.902983 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m23:59:48.905344 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m23:59:48.908442 [info ] [Thread-1 (]: 13 of 17 START sql table model _analytics.dim_customer ......................... [RUN]
[0m23:59:48.912129 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m23:59:48.917667 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:59:48.916372 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.46s]
[0m23:59:48.919995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now model.api_bi_project.dim_customer)
[0m23:59:48.922471 [info ] [Thread-4 (]: 14 of 17 START sql table model _analytics.fct_marketing_attribution ............ [RUN]
[0m23:59:48.925328 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m23:59:48.927930 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m23:59:48.929849 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.dim_customer
[0m23:59:48.931907 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.fct_marketing_attribution)
[0m23:59:48.934226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:48.945079 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m23:59:48.946791 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m23:59:48.958083 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m23:59:48.966045 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:48.968071 [debug] [Thread-1 (]: Began executing node model.api_bi_project.dim_customer
[0m23:59:48.969894 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m23:59:48.970896 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m23:59:48.996585 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:59:49.026373 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m23:59:49.046417 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m23:59:49.056245 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:59:49.057337 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:59:49.059083 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: BEGIN
[0m23:59:49.061486 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m23:59:49.062838 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:49.063975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:49.065685 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:49.069087 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m23:59:49.074852 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m23:59:49.079395 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.33s]
[0m23:59:49.083424 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m23:59:49.086158 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m23:59:49.088839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:49.091118 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:49.092856 [info ] [Thread-3 (]: 15 of 17 START sql table model _analytics.fct_revenue_daily .................... [RUN]
[0m23:59:49.095078 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:59:49.097662 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:59:49.100107 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m23:59:49.102044 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m23:59:49.104083 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m23:59:49.106085 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m23:59:49.126797 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.128582 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m23:59:49.139219 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:59:49.141570 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m23:59:49.144899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:49.151156 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:59:49.152070 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m23:59:49.153732 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m23:59:49.160485 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.163055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:49.172379 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:59:49.174076 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:59:49.175677 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m23:59:49.180943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:59:49.182050 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.189701 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m23:59:49.191637 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m23:59:49.204729 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m23:59:49.207081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:49.213798 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m23:59:49.233352 [debug] [Thread-4 (]: SQL status: SELECT 5661 in 0.0 seconds
[0m23:59:49.238557 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:59:49.254959 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:49.261337 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:59:49.281024 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: Close
[0m23:59:49.303035 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.309305 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m23:59:49.320495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711add2fdad0>]}
[0m23:59:49.327405 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m23:59:49.345622 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:49.357363 [info ] [Thread-1 (]: 13 of 17 OK created sql table model _analytics.dim_customer .................... [[32mSELECT 1000[0m in 0.40s]
[0m23:59:49.419060 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:59:49.439953 [debug] [Thread-1 (]: Finished running node model.api_bi_project.dim_customer
[0m23:59:49.463530 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m23:59:49.475047 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:49.496336 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:59:49.589356 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:59:49.606695 [debug] [Thread-3 (]: SQL status: SELECT 4291 in 0.0 seconds
[0m23:59:49.611568 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m23:59:49.648648 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.657391 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m23:59:49.658876 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:59:49.664342 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:49.677548 [debug] [Thread-4 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m23:59:49.706587 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.709114 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m23:59:49.711225 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m23:59:49.713168 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m23:59:49.718200 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:59:49.725876 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:59:49.727921 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:59:49.733844 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.741046 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m23:59:49.743965 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m23:59:49.750549 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711add2d1010>]}
[0m23:59:49.757084 [info ] [Thread-4 (]: 14 of 17 OK created sql table model _analytics.fct_marketing_attribution ....... [[32mSELECT 5661[0m in 0.82s]
[0m23:59:49.758568 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:59:49.764962 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m23:59:49.777456 [debug] [Thread-3 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m23:59:49.785799 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:59:49.792340 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m23:59:49.795745 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m23:59:49.801260 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m23:59:49.809341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m23:59:49.816364 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:59:49.819774 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:59:49.841496 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:59:49.848552 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m23:59:49.854787 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3494a5c-762e-4c97-baa5-9de34cdd90dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711add206f10>]}
[0m23:59:49.861177 [info ] [Thread-3 (]: 15 of 17 OK created sql table model _analytics.fct_revenue_daily ............... [[32mSELECT 4291[0m in 0.75s]
[0m23:59:49.870150 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m23:59:49.873151 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:59:49.876616 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:59:49.889425 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:59:49.895518 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m23:59:49.905688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m23:59:49.908754 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:59:49.929008 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:59:49.938079 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:59:49.940597 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m23:59:49.943340 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:49.976087 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:59:49.992205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:49.989719 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:59:49.995226 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m23:59:50.002480 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m23:59:50.018715 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:50.032050 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m23:59:50.035796 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m23:59:50.037652 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:59:50.041891 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.23s]
[0m23:59:50.050430 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m23:59:50.053113 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m23:59:50.056177 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:50.085268 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:59:50.087963 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m23:59:50.090959 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m23:59:50.101823 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:59:50.108344 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m23:59:50.114314 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m23:59:50.134804 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.23s]
[0m23:59:50.179754 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m23:59:50.187499 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:50.192535 [debug] [MainThread]: On master: BEGIN
[0m23:59:50.196181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:50.233372 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:59:50.238813 [debug] [MainThread]: On master: COMMIT
[0m23:59:50.260237 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:50.265841 [debug] [MainThread]: On master: COMMIT
[0m23:59:50.278028 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:59:50.323945 [debug] [MainThread]: On master: Close
[0m23:59:50.350157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:50.367993 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m23:59:50.390988 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m23:59:50.399419 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m23:59:50.417583 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m23:59:50.435063 [info ] [MainThread]: 
[0m23:59:50.442540 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 9.55 seconds (9.55s).
[0m23:59:50.462815 [debug] [MainThread]: Command end result
[0m23:59:50.724817 [info ] [MainThread]: 
[0m23:59:50.730448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:50.746305 [info ] [MainThread]: 
[0m23:59:50.756657 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m23:59:50.770631 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.998457, "process_user_time": 7.515913, "process_kernel_time": 1.4574, "process_mem_max_rss": "116420", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:50.894350 [debug] [MainThread]: Command `dbt build` succeeded at 23:59:50.893849 after 14.12 seconds
[0m23:59:50.931956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae4158990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae42dc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ae188a110>]}
[0m23:59:50.995527 [debug] [MainThread]: Flushing usage events
[0m00:00:07.881608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746858703050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468587d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468587d4090>]}


============================== 00:00:07.887411 | 91ed2207-1e50-45aa-b327-eae2120a8c10 ==============================
[0m00:00:07.887411 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:00:07.889357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:00:08.037718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91ed2207-1e50-45aa-b327-eae2120a8c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746858744b50>]}
[0m00:00:08.629331 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ikjo_4hz'
[0m00:00:08.631125 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:00:08.855773 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:00:08.858344 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:00:09.079715 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:00:09.088803 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:00:16.325651 [info ] [MainThread]: Installed from version 1.3.1
[0m00:00:16.327333 [info ] [MainThread]: Up to date!
[0m00:00:16.329535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91ed2207-1e50-45aa-b327-eae2120a8c10', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746859e87fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746858620fd0>]}
[0m00:00:16.332802 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.5672245, "process_user_time": 2.031349, "process_kernel_time": 0.792631, "process_mem_max_rss": "94540", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m00:00:16.334969 [debug] [MainThread]: Command `dbt deps` succeeded at 00:00:16.334815 after 8.57 seconds
[0m00:00:16.336513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746858727710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746858727350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74685c520810>]}
[0m00:00:16.338116 [debug] [MainThread]: Flushing usage events
[0m00:00:24.215365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641e0a51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641e093f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641e0922d0>]}


============================== 00:00:24.226404 | 139b6b12-437b-4280-8c1f-36480490b20f ==============================
[0m00:00:24.226404 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:00:24.231619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:00:22.379487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641dfa64d0>]}
[0m00:00:22.490798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766421d78990>]}
[0m00:00:22.494698 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:00:22.550139 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:00:25.537589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:25.539280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:25.624237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641c53c710>]}
[0m00:00:25.929549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641c278e10>]}
[0m00:00:25.932483 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m00:00:25.944254 [info ] [MainThread]: 
[0m00:00:25.949124 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:25.958047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m00:00:25.959986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m00:00:26.070959 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m00:00:26.072114 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m00:00:26.073692 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:26.078038 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:26.084584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:26.093365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:26.122638 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m00:00:26.127055 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m00:00:26.138594 [debug] [ThreadPool]: On list_db: Close
[0m00:00:26.144784 [debug] [ThreadPool]: On list_db: Close
[0m00:00:26.159297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__staging)
[0m00:00:26.161161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db__analytics)
[0m00:00:26.187426 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m00:00:26.198551 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m00:00:26.201202 [debug] [ThreadPool]: On list_db__staging: BEGIN
[0m00:00:26.223908 [debug] [ThreadPool]: On list_db__analytics: BEGIN
[0m00:00:26.232592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:26.239067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:26.261694 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:00:26.271480 [debug] [ThreadPool]: Using postgres connection "list_db__staging"
[0m00:00:26.272823 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:00:26.277470 [debug] [ThreadPool]: On list_db__staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m00:00:26.280555 [debug] [ThreadPool]: Using postgres connection "list_db__analytics"
[0m00:00:26.289912 [debug] [ThreadPool]: On list_db__analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db__analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m00:00:26.298247 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:00:26.304478 [debug] [ThreadPool]: On list_db__staging: ROLLBACK
[0m00:00:26.305566 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:00:26.308886 [debug] [ThreadPool]: On list_db__staging: Close
[0m00:00:26.311397 [debug] [ThreadPool]: On list_db__analytics: ROLLBACK
[0m00:00:26.324889 [debug] [ThreadPool]: On list_db__analytics: Close
[0m00:00:26.351650 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:26.355251 [debug] [MainThread]: On master: BEGIN
[0m00:00:26.357880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:26.387770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:26.392662 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:26.396329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:26.457909 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:00:26.461941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641c7a47d0>]}
[0m00:00:26.465448 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:26.468673 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:26.471065 [debug] [MainThread]: On master: BEGIN
[0m00:00:26.473598 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:26.476533 [debug] [MainThread]: On master: COMMIT
[0m00:00:26.479221 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:26.481061 [debug] [MainThread]: On master: COMMIT
[0m00:00:26.483406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:00:26.485167 [debug] [MainThread]: On master: Close
[0m00:00:26.487565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:26.490589 [info ] [MainThread]: 
[0m00:00:26.502857 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m00:00:26.504225 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m00:00:26.505355 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m00:00:26.508157 [info ] [Thread-1 (]: 1 of 17 START sql view model _staging.stg_customers ............................ [RUN]
[0m00:00:26.510734 [info ] [Thread-2 (]: 2 of 17 START sql view model _staging.stg_payments ............................. [RUN]
[0m00:00:26.514211 [info ] [Thread-3 (]: 3 of 17 START sql view model _staging.stg_sessions ............................. [RUN]
[0m00:00:26.517536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db__analytics, now model.api_bi_project.stg_customers)
[0m00:00:26.520538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db__staging, now model.api_bi_project.stg_payments)
[0m00:00:26.523098 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m00:00:26.525554 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m00:00:26.527632 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m00:00:26.530066 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m00:00:26.555542 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m00:00:26.565079 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m00:00:26.573666 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m00:00:26.603999 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m00:00:26.609413 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m00:00:26.616746 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m00:00:26.773140 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m00:00:26.781952 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m00:00:26.783512 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m00:00:26.792941 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:00:26.795401 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:00:26.798519 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m00:00:26.800208 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:00:26.802311 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m00:00:26.804635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:26.807346 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m00:00:26.810016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:26.816785 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:00:26.830237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:26.834771 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:00:26.837292 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m00:00:26.839051 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:26.842924 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:00:26.844338 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:26.845302 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:00:26.847380 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m00:00:26.849597 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:00:26.866141 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:00:26.869642 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m00:00:26.871969 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:00:26.874119 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:00:26.883029 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:00:26.884745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:26.895034 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:00:26.910786 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:00:26.920169 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:00:26.921644 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m00:00:26.923691 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m00:00:26.925586 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:00:26.928457 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:26.929181 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:26.937729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:26.939309 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:00:26.945502 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:00:26.978697 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:00:26.990985 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m00:00:26.992816 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m00:00:26.996959 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:26.998293 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:00:27.005158 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m00:00:27.006915 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:27.009092 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m00:00:27.011571 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:00:27.021009 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m00:00:27.025714 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m00:00:27.027118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:27.030203 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:00:27.040622 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:27.057378 [debug] [Thread-1 (]: Applying DROP to: "db"."_staging"."stg_customers__dbt_backup"
[0m00:00:27.059158 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m00:00:27.070350 [debug] [Thread-2 (]: Applying DROP to: "db"."_staging"."stg_payments__dbt_backup"
[0m00:00:27.089263 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:00:27.094582 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:00:27.096175 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:27.099243 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."_staging"."stg_customers__dbt_backup" cascade
[0m00:00:27.101790 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."_staging"."stg_payments__dbt_backup" cascade
[0m00:00:27.109558 [debug] [Thread-3 (]: Applying DROP to: "db"."_staging"."stg_sessions__dbt_backup"
[0m00:00:27.116952 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:00:27.121413 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:00:27.128059 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:00:27.136394 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m00:00:27.141085 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m00:00:27.144617 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."_staging"."stg_sessions__dbt_backup" cascade
[0m00:00:27.152612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664185afbd0>]}
[0m00:00:27.156295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641c2a20d0>]}
[0m00:00:27.162413 [info ] [Thread-1 (]: 1 of 17 OK created sql view model _staging.stg_customers ....................... [[32mCREATE VIEW[0m in 0.63s]
[0m00:00:27.164173 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:00:27.167608 [info ] [Thread-2 (]: 2 of 17 OK created sql view model _staging.stg_payments ........................ [[32mCREATE VIEW[0m in 0.64s]
[0m00:00:27.171533 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m00:00:27.176285 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m00:00:27.179236 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m00:00:27.182843 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:00:27.184100 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:27.186765 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641af05a50>]}
[0m00:00:27.190107 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:00:27.193506 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m00:00:27.196216 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m00:00:27.200273 [info ] [Thread-3 (]: 3 of 17 OK created sql view model _staging.stg_sessions ........................ [[32mCREATE VIEW[0m in 0.66s]
[0m00:00:27.202372 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m00:00:27.205790 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m00:00:27.208821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m00:00:27.211191 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m00:00:27.214534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m00:00:27.217693 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:00:27.220647 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:27.223948 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:00:27.226229 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:00:27.271772 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:00:27.277895 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:27.280584 [info ] [Thread-3 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m00:00:27.411535 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:00:27.416091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m00:00:27.419809 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:00:27.441755 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:00:27.443078 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:27.443698 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:00:27.445594 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:00:27.471099 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:27.475312 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:00:27.480825 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:00:27.481885 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:00:27.492016 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:00:27.495118 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:00:27.496283 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:27.496997 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:00:27.498995 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m00:00:27.501011 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:00:27.501774 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:00:27.503670 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:00:27.505354 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:00:27.506719 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m00:00:27.508275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:27.509940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:27.513197 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:27.544057 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:27.546459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:27.547971 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:27.561428 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:00:27.562993 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:27.568195 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:27.571779 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:00:27.575257 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m00:00:27.578328 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:00:27.583738 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:00:27.589523 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m00:00:27.596381 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:27.598043 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:00:27.613789 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:27.651278 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:27.654181 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m00:00:27.661667 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:27.670966 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:00:27.690576 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m00:00:27.699726 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m00:00:27.709044 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:00:27.714803 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:00:27.718890 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m00:00:27.724113 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.52s]
[0m00:00:27.733116 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m00:00:27.736957 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.53s]
[0m00:00:27.743719 [info ] [Thread-3 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.33s]
[0m00:00:27.752253 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:00:27.764909 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.55s]
[0m00:00:27.769862 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:27.774315 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:00:27.778802 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:00:27.782203 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:00:27.785606 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:00:27.788542 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:00:27.791054 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m00:00:27.795558 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:00:27.798412 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m00:00:27.801174 [info ] [Thread-3 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m00:00:27.807457 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m00:00:27.809987 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m00:00:27.813566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m00:00:27.817302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m00:00:27.819526 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:00:27.823232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m00:00:27.825555 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:00:27.827363 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:00:27.847247 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:00:27.848818 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:00:27.874536 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:00:27.903224 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:00:27.928371 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:00:27.932924 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:00:27.938092 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:00:27.961785 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:00:27.971589 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:00:27.973676 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:00:27.976295 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:00:27.987628 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:00:27.996906 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:00:28.000267 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:00:28.002053 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:00:28.006212 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m00:00:28.009372 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m00:00:28.012394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:28.014975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:28.016355 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:00:28.017182 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:00:28.021258 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m00:00:28.024663 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m00:00:28.026782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:28.028760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:28.035724 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.038057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.041491 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:00:28.043528 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:00:28.045516 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m00:00:28.048030 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:00:28.049775 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.051056 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.055248 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:00:28.056969 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:28.059668 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:00:28.061987 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m00:00:28.066326 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m00:00:28.071361 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m00:00:28.077817 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:28.079389 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m00:00:28.080433 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:28.084698 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m00:00:28.089397 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.28s]
[0m00:00:28.097995 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m00:00:28.101322 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m00:00:28.104081 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:00:28.107435 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m00:00:28.111849 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.30s]
[0m00:00:28.122036 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:00:28.137140 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.31s]
[0m00:00:28.142654 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:28.146220 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:00:28.148913 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m00:00:28.152208 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:00:28.158144 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m00:00:28.160960 [debug] [Thread-1 (]: Began running node model.api_bi_project.dim_customer
[0m00:00:28.163665 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m00:00:28.166995 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m00:00:28.170402 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m00:00:28.172279 [info ] [Thread-1 (]: 13 of 17 START sql table model _analytics.dim_customer ......................... [RUN]
[0m00:00:28.176468 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:00:28.178763 [info ] [Thread-2 (]: 14 of 17 START sql table model _analytics.fct_revenue_daily .................... [RUN]
[0m00:00:28.181955 [info ] [Thread-3 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.36s]
[0m00:00:28.189868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.dim_customer)
[0m00:00:28.202939 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:00:28.204957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.fct_revenue_daily)
[0m00:00:28.208534 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:00:28.211338 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.dim_customer
[0m00:00:28.219921 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m00:00:28.237054 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m00:00:28.249155 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.252142 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:00:28.261214 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:00:28.264613 [debug] [Thread-1 (]: Began executing node model.api_bi_project.dim_customer
[0m00:00:28.274687 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m00:00:28.306615 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:00:28.335616 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m00:00:28.336533 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.337637 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m00:00:28.341683 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:28.346934 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.348485 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:00:28.350670 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m00:00:28.352998 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: BEGIN
[0m00:00:28.354991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:28.356990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:28.359438 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.362484 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:00:28.364833 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:00:28.375819 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.376899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.378631 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.380941 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:00:28.384968 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m00:00:28.387943 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m00:00:28.417054 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m00:00:28.429747 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:00:28.431937 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m00:00:28.434302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:28.436746 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:28.446920 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:00:28.451910 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m00:00:28.454406 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m00:00:28.457453 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m00:00:28.462138 [debug] [Thread-2 (]: SQL status: SELECT 4291 in 0.0 seconds
[0m00:00:28.463795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:28.467071 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.30s]
[0m00:00:28.479347 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.492196 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m00:00:28.494075 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:00:28.495755 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m00:00:28.497230 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:00:28.500059 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m00:00:28.502525 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:28.503561 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m00:00:28.506758 [info ] [Thread-3 (]: 15 of 17 START sql table model _analytics.fct_marketing_attribution ............ [RUN]
[0m00:00:28.518134 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.523236 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m00:00:28.524228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:28.526072 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m00:00:28.528167 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m00:00:28.533558 [debug] [Thread-1 (]: Applying DROP to: "db"."_analytics"."dim_customer__dbt_backup"
[0m00:00:28.536383 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:28.541804 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.549774 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:00:28.553683 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m00:00:28.557269 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."_analytics"."dim_customer__dbt_backup" cascade
[0m00:00:28.559197 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.562344 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m00:00:28.565435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:00:28.566790 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:28.569668 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: Close
[0m00:00:28.579515 [debug] [Thread-2 (]: Applying DROP to: "db"."_analytics"."fct_revenue_daily__dbt_backup"
[0m00:00:28.580550 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m00:00:28.583189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641afedc10>]}
[0m00:00:28.586138 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:00:28.597650 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.600426 [info ] [Thread-1 (]: 13 of 17 OK created sql table model _analytics.dim_customer .................... [[32mSELECT 1000[0m in 0.39s]
[0m00:00:28.602469 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m00:00:28.607106 [debug] [Thread-1 (]: Finished running node model.api_bi_project.dim_customer
[0m00:00:28.613213 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:00:28.617874 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m00:00:28.618858 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.620860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641ed08a10>]}
[0m00:00:28.622780 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m00:00:28.624971 [info ] [Thread-2 (]: 14 of 17 OK created sql table model _analytics.fct_revenue_daily ............... [[32mSELECT 4291[0m in 0.42s]
[0m00:00:28.626892 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:00:28.629761 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m00:00:28.633860 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:00:28.635997 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m00:00:28.639355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m00:00:28.641555 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:00:28.649922 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:00:28.651597 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.654331 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.656584 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m00:00:28.665408 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:00:28.681211 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:00:28.696415 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:00:28.697974 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m00:00:28.700140 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:28.716879 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.719464 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:00:28.721158 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m00:00:28.725815 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:28.729541 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m00:00:28.731663 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m00:00:28.733487 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.09s]
[0m00:00:28.736094 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:00:28.768429 [debug] [Thread-3 (]: SQL status: SELECT 5661 in 0.0 seconds
[0m00:00:28.781650 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.783729 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m00:00:28.785623 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:28.791276 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.793005 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m00:00:28.795041 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:28.798043 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m00:00:28.800011 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.801532 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m00:00:28.807735 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:28.812750 [debug] [Thread-3 (]: Applying DROP to: "db"."_analytics"."fct_marketing_attribution__dbt_backup"
[0m00:00:28.814892 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:00:28.816448 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m00:00:28.821018 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:00:28.824641 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m00:00:28.827052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139b6b12-437b-4280-8c1f-36480490b20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766418552110>]}
[0m00:00:28.829291 [info ] [Thread-3 (]: 15 of 17 OK created sql table model _analytics.fct_marketing_attribution ....... [[32mSELECT 5661[0m in 0.30s]
[0m00:00:28.832242 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m00:00:28.836295 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:00:28.838325 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m00:00:28.841281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m00:00:28.843510 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:00:28.852902 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:00:28.868404 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:00:28.874381 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:00:28.886890 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:00:28.889167 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m00:00:28.892141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:28.910643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.912853 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:00:28.914515 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m00:00:28.919183 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:28.923557 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m00:00:28.926395 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m00:00:28.929441 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.09s]
[0m00:00:28.936162 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:00:28.942997 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:28.945377 [debug] [MainThread]: On master: BEGIN
[0m00:00:28.947054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:28.964391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:28.966598 [debug] [MainThread]: On master: COMMIT
[0m00:00:28.968100 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:28.969601 [debug] [MainThread]: On master: COMMIT
[0m00:00:28.971568 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:00:28.975504 [debug] [MainThread]: On master: Close
[0m00:00:28.977623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:28.979069 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m00:00:28.980848 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m00:00:28.982552 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m00:00:28.984095 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m00:00:28.985946 [info ] [MainThread]: 
[0m00:00:28.987589 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m00:00:28.995175 [debug] [MainThread]: Command end result
[0m00:00:29.099391 [info ] [MainThread]: 
[0m00:00:29.101417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:29.103143 [info ] [MainThread]: 
[0m00:00:29.105227 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m00:00:29.108766 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.7362323, "process_user_time": 6.097485, "process_kernel_time": 1.044115, "process_mem_max_rss": "115904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:00:29.110823 [debug] [MainThread]: Command `dbt build` succeeded at 00:00:29.110672 after 7.74 seconds
[0m00:00:29.112120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76641e3a0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766421f54710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766421e60a10>]}
[0m00:00:29.113408 [debug] [MainThread]: Flushing usage events
[0m00:55:02.066271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483b023150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483b2e8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483b1f4250>]}


============================== 00:55:02.078399 | 96d9c203-1534-4e67-9b0b-13529aab3497 ==============================
[0m00:55:02.078399 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:55:02.081003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:55:02.227612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d9c203-1534-4e67-9b0b-13529aab3497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483bc70e90>]}
[0m00:55:02.694826 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5vd_2m9d'
[0m00:55:02.696526 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:55:03.234472 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:55:03.236988 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:55:03.429446 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:55:03.438487 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:55:09.712515 [info ] [MainThread]: Installed from version 1.3.1
[0m00:55:09.713980 [info ] [MainThread]: Up to date!
[0m00:55:09.716213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '96d9c203-1534-4e67-9b0b-13529aab3497', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483b052c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483c780110>]}
[0m00:55:09.719783 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.7556086, "process_user_time": 2.202137, "process_kernel_time": 0.86839, "process_mem_max_rss": "94988", "process_out_blocks": "1296", "process_in_blocks": "0"}
[0m00:55:09.721952 [debug] [MainThread]: Command `dbt deps` succeeded at 00:55:09.721730 after 7.76 seconds
[0m00:55:09.723524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483b21bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483b355010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483ee4c790>]}
[0m00:55:09.725223 [debug] [MainThread]: Flushing usage events
[0m00:55:12.974270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5fc658d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5fcad250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5fcacfd0>]}


============================== 00:55:12.980704 | 2980ddf9-9176-46ee-b8cc-66c5f9a24dce ==============================
[0m00:55:12.980704 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:55:12.983118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:13.237768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5fce5e90>]}
[0m00:55:13.310174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f639d1010>]}
[0m00:55:13.312769 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:55:13.378709 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:55:13.547677 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:55:13.550537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f6110b010>]}
[0m00:55:16.786610 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:55:16.788817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5e2ce2d0>]}
[0m00:55:17.163674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5e22d3d0>]}
[0m00:55:17.376029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5cf90e10>]}
[0m00:55:17.378117 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m00:55:17.379988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5cf9e710>]}
[0m00:55:17.385205 [info ] [MainThread]: 
[0m00:55:17.389736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:55:17.399937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m00:55:17.402148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m00:55:17.502010 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m00:55:17.502531 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m00:55:17.503561 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m00:55:17.504717 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m00:55:17.506089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:17.507458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:17.528575 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:55:17.529016 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:55:17.531807 [debug] [ThreadPool]: On list_db: Close
[0m00:55:17.535206 [debug] [ThreadPool]: On list_db: Close
[0m00:55:17.544406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m00:55:17.545628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m00:55:17.554820 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m00:55:17.558891 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m00:55:17.560580 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m00:55:17.562160 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m00:55:17.563746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:17.565269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:17.580580 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:55:17.582224 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:55:17.583945 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m00:55:17.585983 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m00:55:17.587637 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m00:55:17.589380 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:55:17.597562 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:55:17.598187 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:55:17.601681 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m00:55:17.604331 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m00:55:17.607431 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m00:55:17.609996 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m00:55:17.622395 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:17.625469 [debug] [MainThread]: On master: BEGIN
[0m00:55:17.627277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:17.642746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:55:17.644547 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:17.647176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:55:17.656296 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:55:17.658995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5ce90f50>]}
[0m00:55:17.660728 [debug] [MainThread]: On master: ROLLBACK
[0m00:55:17.662928 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:17.664895 [debug] [MainThread]: On master: BEGIN
[0m00:55:17.667146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:55:17.669079 [debug] [MainThread]: On master: COMMIT
[0m00:55:17.670490 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:17.674242 [debug] [MainThread]: On master: COMMIT
[0m00:55:17.677058 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:55:17.678826 [debug] [MainThread]: On master: Close
[0m00:55:17.680841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:55:17.684979 [info ] [MainThread]: 
[0m00:55:17.724484 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m00:55:17.726361 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m00:55:17.727386 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m00:55:17.729095 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m00:55:17.734421 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m00:55:17.736860 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m00:55:17.741744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m00:55:17.744340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m00:55:17.746900 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m00:55:17.748799 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m00:55:17.750710 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m00:55:17.755151 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m00:55:17.774768 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m00:55:17.778529 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m00:55:17.788702 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m00:55:17.800723 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m00:55:17.801950 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m00:55:17.809194 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m00:55:17.911665 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m00:55:17.917009 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m00:55:17.917850 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m00:55:17.940666 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:55:17.941656 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:55:17.942333 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:55:17.943612 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m00:55:17.945396 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m00:55:17.948611 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m00:55:17.951034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:17.952691 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:55:17.954538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:17.971953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:55:17.973946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:55:17.975396 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:55:17.976490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:55:17.978384 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:55:17.980146 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m00:55:17.982185 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:55:17.983918 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m00:55:17.986752 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m00:55:17.991143 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:55:17.993675 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:55:18.001143 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:55:18.014167 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:55:18.022363 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:55:18.032120 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:55:18.034148 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:55:18.035703 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:55:18.037292 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m00:55:18.041962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:18.043936 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:18.045202 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:18.063867 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m00:55:18.066163 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m00:55:18.069207 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m00:55:18.070617 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:55:18.071856 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:55:18.073074 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:55:18.074316 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m00:55:18.075472 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m00:55:18.076691 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m00:55:18.091947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:55:18.099719 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:55:18.102496 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m00:55:18.103059 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:55:18.107111 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m00:55:18.119413 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:55:18.123913 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m00:55:18.126164 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:55:18.127850 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m00:55:18.130239 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:55:18.132105 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m00:55:18.134696 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:55:18.135287 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m00:55:18.137207 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:55:18.140718 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m00:55:18.142589 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:55:18.144479 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m00:55:18.147681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5c345f90>]}
[0m00:55:18.150588 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m00:55:18.152136 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5e0f7790>]}
[0m00:55:18.153539 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.41s]
[0m00:55:18.156735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5c4d56d0>]}
[0m00:55:18.158642 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.41s]
[0m00:55:18.161660 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m00:55:18.163892 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.41s]
[0m00:55:18.166308 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m00:55:18.169255 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m00:55:18.170866 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m00:55:18.173677 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m00:55:18.175958 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m00:55:18.179022 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m00:55:18.180700 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m00:55:18.187389 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m00:55:18.191861 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m00:55:18.194322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m00:55:18.196183 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m00:55:18.198347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m00:55:18.200517 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m00:55:18.259857 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m00:55:18.300931 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m00:55:18.309384 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m00:55:18.316225 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m00:55:18.349006 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m00:55:18.392015 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m00:55:18.393018 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m00:55:18.393706 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m00:55:18.399823 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m00:55:18.408765 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m00:55:18.423549 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:55:18.424370 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:55:18.425106 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:55:18.426677 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m00:55:18.428063 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m00:55:18.429633 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m00:55:18.431099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:18.432256 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:55:18.433334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:55:18.447418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:55:18.449705 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:55:18.451688 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:55:18.452702 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:55:18.453542 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m00:55:18.455800 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:55:18.458038 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:55:18.460902 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m00:55:18.463026 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m00:55:18.499901 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m00:55:18.507482 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m00:55:18.508594 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m00:55:18.511557 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:55:18.519432 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:55:18.528242 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:55:18.530626 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m00:55:18.532352 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m00:55:18.534718 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m00:55:18.538142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:18.540429 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:18.541979 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:18.550932 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m00:55:18.554682 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m00:55:18.559493 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m00:55:18.561597 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:55:18.563490 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:55:18.565429 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:55:18.567388 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m00:55:18.569068 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m00:55:18.571134 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m00:55:18.574536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:55:18.575668 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:55:18.576863 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:55:18.582418 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m00:55:18.587706 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m00:55:18.592435 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m00:55:18.601266 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:55:18.602782 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:55:18.604650 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:55:18.606210 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m00:55:18.607398 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m00:55:18.608518 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m00:55:18.610918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:55:18.611795 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:55:18.613419 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:55:18.616046 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m00:55:18.618503 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m00:55:18.620863 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m00:55:18.622749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5c17cf10>]}
[0m00:55:18.624274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5c17d290>]}
[0m00:55:18.626993 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2980ddf9-9176-46ee-b8cc-66c5f9a24dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5c123cd0>]}
[0m00:55:18.629116 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.43s]
[0m00:55:18.631684 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.44s]
[0m00:55:18.634530 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.43s]
[0m00:55:18.636988 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m00:55:18.639759 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m00:55:18.641760 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m00:55:18.649544 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:18.651370 [debug] [MainThread]: On master: BEGIN
[0m00:55:18.652425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:18.670903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:55:18.675696 [debug] [MainThread]: On master: COMMIT
[0m00:55:18.677557 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:18.679006 [debug] [MainThread]: On master: COMMIT
[0m00:55:18.681689 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:55:18.685544 [debug] [MainThread]: On master: Close
[0m00:55:18.687346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:18.689208 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m00:55:18.690697 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m00:55:18.691954 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m00:55:18.693110 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m00:55:18.694524 [info ] [MainThread]: 
[0m00:55:18.696094 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m00:55:18.700779 [debug] [MainThread]: Command end result
[0m00:55:18.810169 [info ] [MainThread]: 
[0m00:55:18.812519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:18.814881 [info ] [MainThread]: 
[0m00:55:18.816913 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:55:18.819803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9494605, "process_user_time": 5.371674, "process_kernel_time": 0.557627, "process_mem_max_rss": "119264", "process_out_blocks": "144", "process_in_blocks": "0"}
[0m00:55:18.821856 [debug] [MainThread]: Command `dbt run` succeeded at 00:55:18.821539 after 5.95 seconds
[0m00:55:18.823165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5fc8e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f5fc8fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766f63ac4790>]}
[0m00:55:18.825251 [debug] [MainThread]: Flushing usage events
[0m00:58:21.036508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734470a52dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734470a52c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734470a52750>]}


============================== 00:58:21.064384 | 71e6415d-ff0e-40c1-9830-f446baf3d5a1 ==============================
[0m00:58:21.064384 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:58:21.067560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:58:21.500677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e6415d-ff0e-40c1-9830-f446baf3d5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734470963510>]}
[0m00:58:22.213131 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cok2okog'
[0m00:58:22.215637 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:58:22.549840 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:58:22.552495 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:58:22.743490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:58:22.752768 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:58:30.695038 [info ] [MainThread]: Installed from version 1.3.1
[0m00:58:30.696460 [info ] [MainThread]: Up to date!
[0m00:58:30.698064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '71e6415d-ff0e-40c1-9830-f446baf3d5a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734470a91210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7344721d7d90>]}
[0m00:58:30.700645 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.843905, "process_user_time": 3.67336, "process_kernel_time": 1.077463, "process_mem_max_rss": "94528", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m00:58:30.702346 [debug] [MainThread]: Command `dbt deps` succeeded at 00:58:30.702172 after 9.85 seconds
[0m00:58:30.703641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734470d8cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734470aa3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734474870890>]}
[0m00:58:30.704698 [debug] [MainThread]: Flushing usage events
[0m00:58:35.792439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b104d5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b10653690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b104d69d0>]}


============================== 00:58:35.797618 | d1e0975d-ef41-43ea-bc92-0481965a62c8 ==============================
[0m00:58:35.797618 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:58:35.799595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:36.024195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b103c5010>]}
[0m00:58:36.106616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b141a4d50>]}
[0m00:58:36.109472 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:58:36.160201 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:58:37.723508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:58:37.724981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:58:37.770293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b104b9190>]}
[0m00:58:37.953627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0e6894d0>]}
[0m00:58:37.955594 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m00:58:37.961724 [info ] [MainThread]: 
[0m00:58:37.964529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:58:37.973727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m00:58:37.974990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m00:58:38.042741 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m00:58:38.044012 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m00:58:38.045282 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m00:58:38.047246 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m00:58:38.048965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:38.050488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:38.066327 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:58:38.066953 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:58:38.069248 [debug] [ThreadPool]: On list_db: Close
[0m00:58:38.071608 [debug] [ThreadPool]: On list_db: Close
[0m00:58:38.077135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m00:58:38.078414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m00:58:38.086165 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m00:58:38.089696 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m00:58:38.091676 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m00:58:38.093341 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m00:58:38.095051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:38.096344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:38.109921 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.111326 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.112455 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m00:58:38.114458 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m00:58:38.116316 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:58:38.118035 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m00:58:38.124656 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:58:38.125396 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m00:58:38.128335 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m00:58:38.130799 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m00:58:38.132658 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m00:58:38.133973 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m00:58:38.146093 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:38.147694 [debug] [MainThread]: On master: BEGIN
[0m00:58:38.149080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:58:38.165186 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.167547 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:38.169579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:58:38.204514 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:58:38.210036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0d279550>]}
[0m00:58:38.212565 [debug] [MainThread]: On master: ROLLBACK
[0m00:58:38.214640 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:38.216296 [debug] [MainThread]: On master: BEGIN
[0m00:58:38.220403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.222111 [debug] [MainThread]: On master: COMMIT
[0m00:58:38.223852 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:38.225559 [debug] [MainThread]: On master: COMMIT
[0m00:58:38.229135 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:58:38.231232 [debug] [MainThread]: On master: Close
[0m00:58:38.233864 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:58:38.235994 [info ] [MainThread]: 
[0m00:58:38.243943 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m00:58:38.244767 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m00:58:38.245552 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m00:58:38.247240 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m00:58:38.249515 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m00:58:38.252241 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m00:58:38.254517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m00:58:38.256179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m00:58:38.258261 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m00:58:38.260737 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m00:58:38.262489 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m00:58:38.264222 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m00:58:38.273886 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m00:58:38.279136 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m00:58:38.283254 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m00:58:38.292409 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m00:58:38.293453 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m00:58:38.300272 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m00:58:38.348627 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m00:58:38.350037 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m00:58:38.357851 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m00:58:38.366598 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:58:38.368822 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:58:38.370370 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m00:58:38.371806 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:58:38.372900 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m00:58:38.374424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:38.376032 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m00:58:38.377465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:38.380486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:58:38.391350 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.393501 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:58:38.396281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.397857 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.399754 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m00:58:38.402272 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:58:38.404289 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:58:38.407600 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m00:58:38.409770 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m00:58:38.411112 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:58:38.416298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:58:38.417843 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:58:38.430142 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:58:38.436284 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:58:38.442819 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:58:38.444735 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m00:58:38.446449 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:58:38.448012 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m00:58:38.450485 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:38.452289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:38.454169 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:38.459176 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:58:38.464501 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:58:38.469099 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:58:38.470806 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m00:58:38.472139 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:58:38.473372 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m00:58:38.475841 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:38.478106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:38.480949 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:38.512875 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m00:58:38.513434 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m00:58:38.515936 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m00:58:38.517612 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:58:38.519731 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:58:38.521342 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:58:38.523238 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m00:58:38.524962 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m00:58:38.526293 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m00:58:38.532544 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:58:38.533656 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:58:38.534090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:58:38.541007 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m00:58:38.544556 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m00:58:38.548270 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m00:58:38.558470 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m00:58:38.560617 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m00:58:38.562420 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m00:58:38.563765 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m00:58:38.564997 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m00:58:38.566386 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m00:58:38.571228 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:58:38.572322 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:58:38.572731 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:58:38.575659 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m00:58:38.578405 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m00:58:38.580594 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m00:58:38.583510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0d39f0d0>]}
[0m00:58:38.585888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0e6b2e50>]}
[0m00:58:38.590277 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0d24ae10>]}
[0m00:58:38.591875 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.33s]
[0m00:58:38.594074 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.33s]
[0m00:58:38.596520 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.33s]
[0m00:58:38.598508 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m00:58:38.600905 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m00:58:38.603239 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m00:58:38.606213 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:58:38.606972 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:58:38.608189 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:58:38.610541 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:58:38.612550 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m00:58:38.614990 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m00:58:38.617250 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m00:58:38.619829 [info ] [Thread-3 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m00:58:38.622490 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m00:58:38.624261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m00:58:38.626478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m00:58:38.628535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m00:58:38.630685 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:58:38.632955 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:58:38.635053 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:58:38.637091 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:58:38.656317 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:58:38.670200 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:58:38.745381 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:58:38.749941 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:58:38.771252 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:58:38.772245 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:58:38.773105 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:58:38.791430 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:58:38.794316 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:58:38.797571 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:58:38.801868 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:58:38.805618 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:58:38.826992 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:58:38.828131 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:58:38.828748 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:58:38.830265 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m00:58:38.832103 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m00:58:38.833473 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:58:38.834615 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m00:58:38.836661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:38.838513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:58:38.840001 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m00:58:38.841827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:38.846826 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:58:38.856579 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.858031 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.859466 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m00:58:38.863278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.864098 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m00:58:38.865865 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:38.867230 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m00:58:38.869465 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m00:58:38.871526 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m00:58:38.873397 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m00:58:38.876735 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:58:38.879173 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:38.880955 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m00:58:38.881948 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:38.890302 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m00:58:38.895800 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m00:58:38.898380 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m00:58:38.899344 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:38.900366 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m00:58:38.901148 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:38.902821 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.28s]
[0m00:58:38.906670 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m00:58:38.909528 [info ] [Thread-3 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.28s]
[0m00:58:38.913475 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m00:58:38.915800 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m00:58:38.918086 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m00:58:38.919931 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m00:58:38.922973 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m00:58:38.924461 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:58:38.926997 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.30s]
[0m00:58:38.928945 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:58:38.931621 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.31s]
[0m00:58:38.933697 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m00:58:38.936446 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m00:58:38.938401 [info ] [Thread-3 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m00:58:38.940871 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m00:58:38.942922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m00:58:38.944734 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:58:38.946519 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m00:58:38.948357 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:58:38.949948 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:58:38.951632 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m00:58:38.953388 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:58:38.955300 [info ] [Thread-4 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m00:58:38.963320 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:58:38.964739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m00:58:38.972217 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:58:38.973980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m00:58:38.977605 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:58:38.980753 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:58:38.995736 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:58:39.002503 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:58:39.003568 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:58:39.004893 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:58:39.014682 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:58:39.020709 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:58:39.030998 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:58:39.036663 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:58:39.040253 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:58:39.045882 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:58:39.046610 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:58:39.047273 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:58:39.049145 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:58:39.050784 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:58:39.052584 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:39.054814 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:58:39.056131 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:58:39.059729 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m00:58:39.063071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:58:39.072140 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:58:39.073184 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.075082 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m00:58:39.076135 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.077779 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:58:39.079375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:39.081064 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m00:58:39.083081 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:58:39.084164 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.087356 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:58:39.090940 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m00:58:39.093269 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:39.095355 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m00:58:39.099189 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:58:39.100249 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:39.103215 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:58:39.104349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.105139 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:39.108596 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:58:39.111144 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.17s]
[0m00:58:39.112955 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m00:58:39.116353 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m00:58:39.118516 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m00:58:39.119984 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:58:39.121636 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m00:58:39.124259 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m00:58:39.125642 [info ] [Thread-3 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.18s]
[0m00:58:39.127384 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:58:39.130705 [info ] [Thread-4 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.16s]
[0m00:58:39.132940 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m00:58:39.135191 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m00:58:39.137936 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m00:58:39.139801 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m00:58:39.141388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m00:58:39.142742 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m00:58:39.144352 [info ] [Thread-3 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m00:58:39.145959 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:58:39.147822 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m00:58:39.149615 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_revenue_daily)
[0m00:58:39.158678 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:58:39.159497 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:39.161227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.dim_customer)
[0m00:58:39.162718 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m00:58:39.167122 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m00:58:39.168712 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m00:58:39.173885 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.176346 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m00:58:39.181884 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m00:58:39.184557 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:58:39.186158 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.22s]
[0m00:58:39.193556 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:58:39.196027 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m00:58:39.196980 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m00:58:39.197662 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m00:58:39.243055 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m00:58:39.241289 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.245514 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:58:39.247855 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m00:58:39.249158 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:39.253269 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:58:39.255152 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m00:58:39.255874 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.257004 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:58:39.258240 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m00:58:39.260373 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:58:39.264388 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.267157 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m00:58:39.269277 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:58:39.273160 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.274764 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:58:39.277302 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m00:58:39.279757 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.281569 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.283062 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m00:58:39.290376 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m00:58:39.296253 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:58:39.297686 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m00:58:39.299458 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:39.304310 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:58:39.304761 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:39.305751 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m00:58:39.308423 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m00:58:39.310785 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:39.311835 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m00:58:39.318620 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m00:58:39.319323 [debug] [Thread-3 (]: SQL status: SELECT 4306 in 0.0 seconds
[0m00:58:39.320956 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.18s]
[0m00:58:39.322354 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:58:39.328178 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.329821 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m00:58:39.331065 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m00:58:39.332383 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m00:58:39.334469 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m00:58:39.337180 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:39.338114 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m00:58:39.339034 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:58:39.344025 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.345723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m00:58:39.349372 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m00:58:39.350526 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m00:58:39.351783 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m00:58:39.357137 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m00:58:39.359064 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:39.362634 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.364181 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m00:58:39.366887 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m00:58:39.370780 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.372636 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m00:58:39.373489 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:58:39.376965 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m00:58:39.377529 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:58:39.379295 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b104d0050>]}
[0m00:58:39.380420 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m00:58:39.384919 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m00:58:39.387901 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.22s]
[0m00:58:39.395317 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.397081 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m00:58:39.400163 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m00:58:39.405191 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m00:58:39.412859 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:58:39.416568 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m00:58:39.419267 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0c1d2e50>]}
[0m00:58:39.421544 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.427061 [info ] [Thread-3 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4306[0m in 0.27s]
[0m00:58:39.429599 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m00:58:39.431580 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m00:58:39.433043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:39.434919 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:58:39.440320 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m00:58:39.442598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m00:58:39.450687 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:58:39.460828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.470934 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:58:39.472097 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.475116 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m00:58:39.516985 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:58:39.538175 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:58:39.578400 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:58:39.584293 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m00:58:39.586426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:58:39.602566 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.607025 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m00:58:39.610445 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m00:58:39.616244 [debug] [Thread-1 (]: SQL status: SELECT 5686 in 0.0 seconds
[0m00:58:39.618885 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:39.624870 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.627579 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m00:58:39.631751 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m00:58:39.634186 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m00:58:39.636149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:39.639604 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.20s]
[0m00:58:39.651235 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.653009 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m00:58:39.656082 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m00:58:39.658774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:58:39.662702 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m00:58:39.666059 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.667098 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m00:58:39.669897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:58:39.674258 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m00:58:39.676103 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m00:58:39.677207 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m00:58:39.681541 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:58:39.684338 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m00:58:39.685841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e0975d-ef41-43ea-bc92-0481965a62c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0d408350>]}
[0m00:58:39.688996 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5686[0m in 0.34s]
[0m00:58:39.693617 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m00:58:39.698525 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:58:39.700252 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m00:58:39.701800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m00:58:39.703219 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:58:39.715795 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:58:39.737909 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:58:39.742430 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:58:39.764566 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:58:39.765985 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m00:58:39.767339 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:58:39.781253 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.783182 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m00:58:39.784742 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m00:58:39.789149 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:58:39.792684 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m00:58:39.794500 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m00:58:39.796752 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.09s]
[0m00:58:39.799683 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m00:58:39.804386 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:39.805656 [debug] [MainThread]: On master: BEGIN
[0m00:58:39.806697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:58:39.820378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:58:39.822216 [debug] [MainThread]: On master: COMMIT
[0m00:58:39.823595 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:39.825143 [debug] [MainThread]: On master: COMMIT
[0m00:58:39.826576 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:58:39.828091 [debug] [MainThread]: On master: Close
[0m00:58:39.830604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:39.832027 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m00:58:39.833279 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m00:58:39.834541 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m00:58:39.835789 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m00:58:39.837096 [info ] [MainThread]: 
[0m00:58:39.838690 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m00:58:39.844962 [debug] [MainThread]: Command end result
[0m00:58:39.933572 [info ] [MainThread]: 
[0m00:58:39.935558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:58:39.937492 [info ] [MainThread]: 
[0m00:58:39.939369 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m00:58:39.941918 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.2410407, "process_user_time": 3.701301, "process_kernel_time": 0.642308, "process_mem_max_rss": "116516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:58:39.943719 [debug] [MainThread]: Command `dbt build` succeeded at 00:58:39.943534 after 4.24 seconds
[0m00:58:39.945469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b142948d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b0c179bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8b143f0d90>]}
[0m00:58:39.947307 [debug] [MainThread]: Flushing usage events
[0m01:00:08.782556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7c82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7cc7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7cc4c10>]}


============================== 01:00:08.789791 | b95e2d03-50e8-4804-b5c3-7952212a9908 ==============================
[0m01:00:08.789791 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:00:08.791731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:00:08.934957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b95e2d03-50e8-4804-b5c3-7952212a9908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7b91550>]}
[0m01:00:09.571984 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kmh0izie'
[0m01:00:09.574445 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:00:09.900902 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:00:09.904294 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:00:10.112083 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:00:10.123460 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:00:16.911393 [info ] [MainThread]: Installed from version 1.3.1
[0m01:00:16.912836 [info ] [MainThread]: Up to date!
[0m01:00:16.915792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b95e2d03-50e8-4804-b5c3-7952212a9908', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7b02250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7af72d0>]}
[0m01:00:16.918884 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.284725, "process_user_time": 2.568901, "process_kernel_time": 0.865921, "process_mem_max_rss": "94776", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m01:00:16.920606 [debug] [MainThread]: Command `dbt deps` succeeded at 01:00:16.920440 after 8.29 seconds
[0m01:00:16.921837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceba7c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebb70650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebc00e50>]}
[0m01:00:16.923348 [debug] [MainThread]: Flushing usage events
[0m01:00:22.027238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051d502d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051d502dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051d547850>]}


============================== 01:00:22.035571 | 9bc23d08-c1af-4512-8326-d7e70fec1dff ==============================
[0m01:00:22.035571 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:00:22.037842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:22.352343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051bc0d250>]}
[0m01:00:22.428390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760521214e10>]}
[0m01:00:22.431805 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:00:22.490494 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:00:24.303311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:24.305310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:24.354252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051bc3e9d0>]}
[0m01:00:24.640406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051b7003d0>]}
[0m01:00:24.643966 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m01:00:24.653305 [info ] [MainThread]: 
[0m01:00:24.661223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:24.682434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m01:00:24.686447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m01:00:24.789787 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m01:00:24.790303 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m01:00:24.791316 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m01:00:24.792719 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m01:00:24.794020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:24.795759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:24.818252 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:00:24.818810 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:00:24.821166 [debug] [ThreadPool]: On list_db: Close
[0m01:00:24.824586 [debug] [ThreadPool]: On list_db: Close
[0m01:00:24.830832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m01:00:24.832799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m01:00:24.843341 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m01:00:24.849819 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m01:00:24.851509 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m01:00:24.853365 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m01:00:24.855354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:24.856864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:24.876939 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:24.877821 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:24.879923 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m01:00:24.881903 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m01:00:24.883986 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m01:00:24.885790 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:00:24.898980 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:00:24.900047 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:00:24.904429 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m01:00:24.909238 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m01:00:24.911735 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m01:00:24.913670 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m01:00:24.930154 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:24.931382 [debug] [MainThread]: On master: BEGIN
[0m01:00:24.932386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:24.948195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:24.952253 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:24.955983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:25.021430 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m01:00:25.024935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051d5222d0>]}
[0m01:00:25.027338 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:25.029613 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:25.031446 [debug] [MainThread]: On master: BEGIN
[0m01:00:25.033593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.035451 [debug] [MainThread]: On master: COMMIT
[0m01:00:25.037004 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:25.039670 [debug] [MainThread]: On master: COMMIT
[0m01:00:25.043413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:25.045304 [debug] [MainThread]: On master: Close
[0m01:00:25.048225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:25.052297 [info ] [MainThread]: 
[0m01:00:25.061043 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m01:00:25.061941 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m01:00:25.062912 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m01:00:25.065036 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m01:00:25.067620 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m01:00:25.070355 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m01:00:25.076170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m01:00:25.078061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m01:00:25.080044 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m01:00:25.081453 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m01:00:25.082775 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m01:00:25.084228 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m01:00:25.095438 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m01:00:25.101729 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m01:00:25.108882 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m01:00:25.117313 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m01:00:25.118871 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m01:00:25.130602 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m01:00:25.199080 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m01:00:25.200104 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m01:00:25.208241 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m01:00:25.222621 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:00:25.223773 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:00:25.225596 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m01:00:25.226519 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:00:25.227820 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m01:00:25.229465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:25.231208 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m01:00:25.232373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:25.234613 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:00:25.248219 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.250148 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:00:25.251585 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m01:00:25.253360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.260170 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:00:25.261571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.264516 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m01:00:25.266677 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:25.268263 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:00:25.276153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:25.281130 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:00:25.283357 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m01:00:25.291309 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:00:25.292487 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m01:00:25.294661 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:00:25.297372 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:25.298077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:25.298814 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:25.308672 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:00:25.313209 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:00:25.320748 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:00:25.322952 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m01:00:25.325094 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:00:25.326999 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m01:00:25.329969 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:25.330628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:25.332165 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:25.353330 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m01:00:25.356042 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m01:00:25.361553 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:00:25.363291 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:00:25.365258 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:00:25.366819 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m01:00:25.368564 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m01:00:25.371961 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m01:00:25.374694 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:25.379924 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m01:00:25.380886 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:25.381758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:25.383443 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:00:25.392882 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m01:00:25.397980 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m01:00:25.399565 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m01:00:25.409245 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:00:25.412325 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:00:25.416720 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m01:00:25.417982 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:25.419503 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m01:00:25.427526 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:25.428580 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m01:00:25.435448 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m01:00:25.436084 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:25.438053 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:00:25.441697 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051a3895d0>]}
[0m01:00:25.444619 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m01:00:25.446329 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m01:00:25.448695 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.36s]
[0m01:00:25.451120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051bbfea10>]}
[0m01:00:25.454332 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m01:00:25.456673 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:25.458682 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.38s]
[0m01:00:25.462038 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:00:25.462907 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:00:25.466514 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m01:00:25.468404 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m01:00:25.470594 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m01:00:25.473633 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m01:00:25.476771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051b7536d0>]}
[0m01:00:25.478873 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:00:25.482364 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m01:00:25.484223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m01:00:25.486773 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.40s]
[0m01:00:25.488987 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m01:00:25.491364 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:00:25.493347 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:00:25.495572 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m01:00:25.497841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m01:00:25.542593 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:00:25.551808 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:00:25.552925 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:00:25.555370 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:00:25.562273 [info ] [Thread-3 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m01:00:25.580191 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:00:25.582261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m01:00:25.583600 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:00:25.584465 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:00:25.586715 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:00:25.758778 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:00:25.780567 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:00:25.802308 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:00:25.804897 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:00:25.816793 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:00:25.831599 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:00:25.832761 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:00:25.835064 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m01:00:25.836508 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:00:25.839067 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m01:00:25.843124 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:00:25.844739 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:00:25.847888 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m01:00:25.850169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:25.862346 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:00:25.864573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:25.872120 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.878039 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:00:25.880106 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m01:00:25.889240 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:25.891621 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.892559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.894015 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:00:25.901523 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m01:00:25.903353 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:00:25.905022 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:00:25.906666 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m01:00:25.908661 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m01:00:25.910067 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m01:00:25.911477 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:00:25.913139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:25.916710 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.43s]
[0m01:00:25.922458 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:25.924571 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:00:25.928803 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m01:00:25.931823 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:00:25.933863 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:25.935449 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m01:00:25.937825 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:25.936928 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m01:00:25.942299 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m01:00:25.944685 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.46s]
[0m01:00:25.948725 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:00:25.950926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:00:25.953451 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m01:00:25.954870 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:00:25.957043 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m01:00:25.958784 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:00:25.961758 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.46s]
[0m01:00:25.964736 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:00:25.975102 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:00:25.976064 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:25.978602 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:00:25.981187 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m01:00:25.986957 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m01:00:25.989353 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:00:25.991529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m01:00:25.995102 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m01:00:25.996273 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:00:25.998005 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m01:00:26.000169 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:00:26.003292 [info ] [Thread-3 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.42s]
[0m01:00:26.011864 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:00:26.013903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m01:00:26.025710 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:00:26.028392 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:00:26.032247 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:00:26.035875 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:00:26.053575 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m01:00:26.062366 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:00:26.076777 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:00:26.077934 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:00:26.078749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m01:00:26.080524 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m01:00:26.087698 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:00:26.090792 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:00:26.092511 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:26.107415 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:00:26.118929 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:00:26.119977 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:00:26.124453 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:00:26.126391 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.127926 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m01:00:26.131152 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:00:26.133504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:26.134953 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:00:26.136778 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m01:00:26.146135 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:00:26.147119 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:00:26.149639 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m01:00:26.150909 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:26.153125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:26.157551 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m01:00:26.159589 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.162694 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m01:00:26.166041 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:00:26.169497 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.22s]
[0m01:00:26.174077 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:00:26.175501 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:00:26.177492 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:00:26.180547 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m01:00:26.183518 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:00:26.184913 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:26.185631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.200014 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:00:26.189404 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m01:00:26.195658 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m01:00:26.187030 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:26.202218 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m01:00:26.204640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m01:00:26.207756 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m01:00:26.212611 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:00:26.216119 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.22s]
[0m01:00:26.230042 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:00:26.232679 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.234200 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:00:26.237987 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:00:26.239398 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:26.241269 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m01:00:26.243287 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m01:00:26.246432 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m01:00:26.248943 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m01:00:26.250172 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:00:26.254939 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m01:00:26.256231 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:26.257829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_revenue_daily)
[0m01:00:26.263492 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:00:26.265633 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.25s]
[0m01:00:26.269958 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m01:00:26.272243 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m01:00:26.276057 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:00:26.278278 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m01:00:26.285307 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.287081 [debug] [Thread-1 (]: Began running node model.api_bi_project.dim_customer
[0m01:00:26.289700 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:00:26.291416 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.21s]
[0m01:00:26.295615 [info ] [Thread-1 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m01:00:26.300335 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m01:00:26.305190 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:00:26.308870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.dim_customer)
[0m01:00:26.311916 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:26.316656 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m01:00:26.318235 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.dim_customer
[0m01:00:26.365149 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m01:00:26.386128 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.404844 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:00:26.412099 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.413559 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:00:26.415624 [debug] [Thread-1 (]: Began executing node model.api_bi_project.dim_customer
[0m01:00:26.434227 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m01:00:26.436889 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.438646 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m01:00:26.440652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:26.441491 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:00:26.444767 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: BEGIN
[0m01:00:26.446887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:26.457499 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.459655 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.461784 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m01:00:26.466046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.468337 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:00:26.470192 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m01:00:26.472272 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:26.477590 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m01:00:26.480048 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m01:00:26.481987 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.28s]
[0m01:00:26.484385 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:00:26.485372 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m01:00:26.487588 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m01:00:26.493112 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:00:26.494697 [info ] [Thread-3 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m01:00:26.495836 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m01:00:26.497717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.fct_marketing_attribution)
[0m01:00:26.499981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:26.500515 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m01:00:26.507086 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:00:26.512892 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.513660 [debug] [Thread-2 (]: SQL status: SELECT 4306 in 0.0 seconds
[0m01:00:26.514931 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m01:00:26.521976 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.524492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:26.525438 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m01:00:26.532762 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m01:00:26.535211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:26.536114 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m01:00:26.536746 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:00:26.542333 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.547390 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.548786 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m01:00:26.550337 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m01:00:26.554680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:26.559312 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m01:00:26.560019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:26.561225 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.565699 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m01:00:26.566704 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.568220 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m01:00:26.574198 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:00:26.575840 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m01:00:26.577909 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m01:00:26.578636 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:26.579601 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:00:26.585990 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m01:00:26.586718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:00:26.589632 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:00:26.593170 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: Close
[0m01:00:26.594926 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m01:00:26.597162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051a388110>]}
[0m01:00:26.600596 [info ] [Thread-1 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.29s]
[0m01:00:26.602558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.603857 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:00:26.604915 [debug] [Thread-1 (]: Finished running node model.api_bi_project.dim_customer
[0m01:00:26.607158 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.610362 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m01:00:26.613016 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m01:00:26.615079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051d7dab10>]}
[0m01:00:26.622557 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4306[0m in 0.36s]
[0m01:00:26.625035 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m01:00:26.626996 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:00:26.628955 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m01:00:26.630999 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m01:00:26.632793 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:00:26.638892 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:00:26.651386 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:00:26.661337 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:00:26.672369 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:00:26.674481 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m01:00:26.676152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:26.688861 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.690987 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:00:26.693185 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m01:00:26.697466 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:26.699477 [debug] [Thread-3 (]: SQL status: SELECT 5686 in 0.0 seconds
[0m01:00:26.701387 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m01:00:26.715086 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.718141 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m01:00:26.722176 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m01:00:26.726233 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.10s]
[0m01:00:26.728938 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:26.730303 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:00:26.740656 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.744751 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m01:00:26.747660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:26.752858 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m01:00:26.754477 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.756041 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m01:00:26.761464 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:26.768815 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m01:00:26.771451 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:00:26.773231 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m01:00:26.778250 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:00:26.781960 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m01:00:26.784258 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc23d08-c1af-4512-8326-d7e70fec1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76051821d290>]}
[0m01:00:26.786678 [info ] [Thread-3 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5686[0m in 0.29s]
[0m01:00:26.789717 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m01:00:26.792503 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:00:26.794419 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m01:00:26.796164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m01:00:26.797863 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:00:26.807282 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:00:26.820353 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:00:26.827730 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:00:26.838538 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:00:26.841136 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m01:00:26.843577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:26.859543 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.861701 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:00:26.863698 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m01:00:26.868167 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:00:26.873011 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m01:00:26.875981 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m01:00:26.878660 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.08s]
[0m01:00:26.881822 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:00:26.888318 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:26.890083 [debug] [MainThread]: On master: BEGIN
[0m01:00:26.891424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:26.905436 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:26.907834 [debug] [MainThread]: On master: COMMIT
[0m01:00:26.910122 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:26.911816 [debug] [MainThread]: On master: COMMIT
[0m01:00:26.913675 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:26.915447 [debug] [MainThread]: On master: Close
[0m01:00:26.918532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:26.922265 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m01:00:26.924763 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m01:00:26.927313 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m01:00:26.928788 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m01:00:26.930443 [info ] [MainThread]: 
[0m01:00:26.932133 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m01:00:26.937057 [debug] [MainThread]: Command end result
[0m01:00:27.017898 [info ] [MainThread]: 
[0m01:00:27.019894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:27.021877 [info ] [MainThread]: 
[0m01:00:27.023540 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m01:00:27.026774 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.1002874, "process_user_time": 4.38561, "process_kernel_time": 0.732276, "process_mem_max_rss": "116924", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:00:27.028716 [debug] [MainThread]: Command `dbt build` succeeded at 01:00:27.028490 after 5.10 seconds
[0m01:00:27.030085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7605213c2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760521304950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7605213048d0>]}
[0m01:00:27.031553 [debug] [MainThread]: Flushing usage events
[0m01:15:14.820824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab330bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab330b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab330b390>]}


============================== 01:15:14.834641 | ffa26c4a-fadc-4d67-957c-228e8324e6d8 ==============================
[0m01:15:14.834641 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:15:14.843613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:15:15.043604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffa26c4a-fadc-4d67-957c-228e8324e6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab31fa450>]}
[0m01:15:15.960247 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w5fj37lc'
[0m01:15:15.962550 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:15:16.304020 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:15:16.308687 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:15:16.535854 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:15:16.556864 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:15:23.519257 [info ] [MainThread]: Installed from version 1.3.1
[0m01:15:23.521086 [info ] [MainThread]: Up to date!
[0m01:15:23.523313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ffa26c4a-fadc-4d67-957c-228e8324e6d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab3361210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab31ea010>]}
[0m01:15:23.527756 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.997121, "process_user_time": 3.836054, "process_kernel_time": 1.343867, "process_mem_max_rss": "94816", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m01:15:23.529633 [debug] [MainThread]: Command `dbt deps` succeeded at 01:15:23.529457 after 9.00 seconds
[0m01:15:23.530867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab330b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab7104810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ab7288dd0>]}
[0m01:15:23.532270 [debug] [MainThread]: Flushing usage events
[0m01:15:30.634244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d3452c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d4154b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d347b5d0>]}


============================== 01:15:30.640106 | 323445b5-b513-4ceb-b2a9-520aad931f91 ==============================
[0m01:15:30.640106 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:15:30.641999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:15:30.909134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d3392810>]}
[0m01:15:31.003869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d7188f50>]}
[0m01:15:31.006307 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:15:31.062720 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:15:32.786478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:15:32.787993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:15:32.874010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d1b7bbd0>]}
[0m01:15:33.103616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d1a8af10>]}
[0m01:15:33.105910 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m01:15:33.113633 [info ] [MainThread]: 
[0m01:15:33.117265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:15:33.138317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m01:15:33.141502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m01:15:33.348263 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m01:15:33.348775 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m01:15:33.350111 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m01:15:33.352055 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m01:15:33.353760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:33.355740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:33.384300 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:15:33.384903 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:15:33.387537 [debug] [ThreadPool]: On list_db: Close
[0m01:15:33.390546 [debug] [ThreadPool]: On list_db: Close
[0m01:15:33.395319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m01:15:33.397415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m01:15:33.409039 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m01:15:33.414393 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m01:15:33.416254 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m01:15:33.417603 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m01:15:33.419125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:33.420903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:33.438234 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:15:33.439093 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:15:33.440448 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m01:15:33.442544 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m01:15:33.444266 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:15:33.446366 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m01:15:33.458671 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:15:33.459563 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:15:33.462846 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m01:15:33.465981 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m01:15:33.468173 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m01:15:33.469718 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m01:15:33.486328 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:33.488486 [debug] [MainThread]: On master: BEGIN
[0m01:15:33.490031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:33.505362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:15:33.508064 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:33.511073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:15:33.562478 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m01:15:33.566031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d715e750>]}
[0m01:15:33.568141 [debug] [MainThread]: On master: ROLLBACK
[0m01:15:33.570124 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:33.571845 [debug] [MainThread]: On master: BEGIN
[0m01:15:33.573856 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:15:33.575795 [debug] [MainThread]: On master: COMMIT
[0m01:15:33.577365 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:33.578892 [debug] [MainThread]: On master: COMMIT
[0m01:15:33.581919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:15:33.583700 [debug] [MainThread]: On master: Close
[0m01:15:33.585787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:15:33.588415 [info ] [MainThread]: 
[0m01:15:33.599268 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m01:15:33.600212 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m01:15:33.601110 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m01:15:33.603027 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m01:15:33.605528 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m01:15:33.608049 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m01:15:33.610110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m01:15:33.612901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m01:15:33.615373 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m01:15:33.617008 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m01:15:33.618427 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m01:15:33.619737 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m01:15:33.635957 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m01:15:33.641157 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m01:15:33.646752 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m01:15:33.655482 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m01:15:33.657572 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m01:15:33.664675 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m01:15:33.763313 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m01:15:33.772706 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m01:15:33.769348 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m01:15:33.782661 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:15:33.784203 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:15:33.786267 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m01:15:33.787510 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:15:33.789631 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m01:15:33.791446 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:33.792841 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m01:15:33.794772 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:15:33.798767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:33.817788 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:33.821430 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:15:33.826596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:33.827988 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m01:15:33.830858 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:15:33.834124 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m01:15:33.839724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:33.842543 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:15:33.844803 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m01:15:33.850595 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:15:33.851572 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:15:33.853189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:15:33.865057 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:15:33.871297 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:15:33.882909 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:15:33.884557 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m01:15:33.886447 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m01:15:33.889136 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:15:33.893914 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:33.896917 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:33.898851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:33.904330 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:15:33.910498 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:15:33.916330 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:15:33.917862 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m01:15:33.920194 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m01:15:33.922034 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:15:33.924828 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:33.925412 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:33.932744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:33.947780 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m01:15:33.950979 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m01:15:33.954650 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m01:15:33.956241 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:15:33.957734 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:15:33.959133 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:15:33.960247 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m01:15:33.961464 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m01:15:33.962751 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m01:15:33.966745 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:15:33.967580 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m01:15:33.968514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:15:33.978327 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m01:15:33.983544 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m01:15:33.989564 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m01:15:34.001868 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m01:15:34.004914 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m01:15:34.007406 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m01:15:34.008921 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m01:15:34.010669 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m01:15:34.012959 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m01:15:34.020616 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:15:34.021383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:15:34.022001 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:15:34.027066 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m01:15:34.031550 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m01:15:34.034745 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m01:15:34.038183 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d03a0a50>]}
[0m01:15:34.040346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d16c7bd0>]}
[0m01:15:34.042290 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d03f5050>]}
[0m01:15:34.045299 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.42s]
[0m01:15:34.048236 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.43s]
[0m01:15:34.050708 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.43s]
[0m01:15:34.052774 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m01:15:34.054891 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m01:15:34.056776 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m01:15:34.060201 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:15:34.060938 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:15:34.061901 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:15:34.063899 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:15:34.065514 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m01:15:34.066778 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m01:15:34.068546 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m01:15:34.070501 [info ] [Thread-3 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m01:15:34.072627 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m01:15:34.074742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m01:15:34.076332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m01:15:34.077672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m01:15:34.079547 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:15:34.081113 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:15:34.082459 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:15:34.083881 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:15:34.104530 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:15:34.116514 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:15:34.206011 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:15:34.219190 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:15:34.230645 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:15:34.252805 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:15:34.255099 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:15:34.256087 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:15:34.256763 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:15:34.261408 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:15:34.266434 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:15:34.270305 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:15:34.272626 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:15:34.275677 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:15:34.277069 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m01:15:34.279669 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:15:34.280779 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m01:15:34.281679 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:15:34.282970 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:15:34.284448 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m01:15:34.286136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:34.287717 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m01:15:34.290638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:34.294735 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:15:34.303449 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.306719 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m01:15:34.308669 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m01:15:34.310541 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.313130 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.316070 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.317300 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m01:15:34.319419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.322324 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m01:15:34.333849 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m01:15:34.336424 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m01:15:34.338728 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m01:15:34.341029 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m01:15:34.343833 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m01:15:34.349766 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.351735 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:15:34.356848 [info ] [Thread-3 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.28s]
[0m01:15:34.362387 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m01:15:34.368186 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m01:15:34.375212 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m01:15:34.377277 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:15:34.380036 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.31s]
[0m01:15:34.384813 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m01:15:34.388007 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m01:15:34.388999 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.390961 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:15:34.392846 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.394124 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:15:34.400100 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m01:15:34.401830 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:15:34.405557 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m01:15:34.407914 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m01:15:34.410509 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m01:15:34.424430 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:15:34.427277 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m01:15:34.429135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m01:15:34.432701 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.36s]
[0m01:15:34.437723 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.36s]
[0m01:15:34.440066 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:15:34.444220 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m01:15:34.446989 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m01:15:34.454792 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:15:34.461930 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:15:34.464051 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:15:34.466570 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:15:34.471526 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:15:34.479588 [info ] [Thread-4 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m01:15:34.482573 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m01:15:34.486927 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m01:15:34.489367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m01:15:34.491461 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:15:34.493757 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:15:34.501459 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:15:34.509321 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:15:34.516910 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:15:34.523140 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:15:34.526692 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:15:34.527921 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m01:15:34.531957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:15:34.537788 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:15:34.542492 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:15:34.543100 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:15:34.544825 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:15:34.549999 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:15:34.550824 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.552270 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m01:15:34.554377 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:15:34.555648 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:15:34.557014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:34.558654 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m01:15:34.559962 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m01:15:34.563265 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:15:34.564276 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:15:34.569861 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.573643 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m01:15:34.578226 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m01:15:34.582283 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.583170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:34.584846 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m01:15:34.585884 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m01:15:34.588851 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.591864 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.20s]
[0m01:15:34.593596 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:15:34.595842 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m01:15:34.597575 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:15:34.599975 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m01:15:34.601724 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:15:34.603050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.603997 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.608295 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m01:15:34.610191 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m01:15:34.614470 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m01:15:34.616436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m01:15:34.617920 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m01:15:34.619698 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m01:15:34.620639 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:15:34.623671 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.19s]
[0m01:15:34.625260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.634323 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:15:34.635878 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m01:15:34.639637 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m01:15:34.643235 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m01:15:34.645944 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m01:15:34.647279 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m01:15:34.649666 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.16s]
[0m01:15:34.651830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_revenue_daily)
[0m01:15:34.653448 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:15:34.655271 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m01:15:34.657337 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m01:15:34.662470 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:15:34.664338 [debug] [Thread-1 (]: Began running node model.api_bi_project.dim_customer
[0m01:15:34.669845 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m01:15:34.674435 [info ] [Thread-1 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m01:15:34.680795 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.685067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.dim_customer)
[0m01:15:34.688971 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m01:15:34.691109 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.dim_customer
[0m01:15:34.693330 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m01:15:34.694357 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:15:34.697994 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m01:15:34.701098 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m01:15:34.700381 [info ] [Thread-4 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.21s]
[0m01:15:34.704045 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m01:15:34.735425 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m01:15:34.740866 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m01:15:34.741414 [debug] [Thread-1 (]: Began executing node model.api_bi_project.dim_customer
[0m01:15:34.742903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:15:34.754551 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m01:15:34.768591 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.770362 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m01:15:34.771890 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:15:34.774389 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:15:34.775334 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:15:34.776823 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: BEGIN
[0m01:15:34.778549 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m01:15:34.780583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:34.782817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:34.796611 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.797423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.799245 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:15:34.800623 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:15:34.801948 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m01:15:34.802531 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:34.803628 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m01:15:34.808968 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m01:15:34.814701 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m01:15:34.816981 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.20s]
[0m01:15:34.821642 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m01:15:34.824537 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m01:15:34.826698 [info ] [Thread-4 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m01:15:34.828812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m01:15:34.830766 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m01:15:34.835370 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m01:15:34.846480 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m01:15:34.852761 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m01:15:34.853362 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m01:15:34.855601 [debug] [Thread-2 (]: SQL status: SELECT 4306 in 0.0 seconds
[0m01:15:34.861237 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:15:34.867238 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:15:34.868894 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m01:15:34.869955 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:15:34.871460 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m01:15:34.873985 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m01:15:34.874689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:34.876603 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:34.877110 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:15:34.882488 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:15:34.889489 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:15:34.892485 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m01:15:34.894397 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m01:15:34.900099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:34.903109 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:34.905894 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:34.917875 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m01:15:34.922298 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m01:15:34.924783 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:15:34.926866 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:15:34.928851 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:15:34.930896 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m01:15:34.933007 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m01:15:34.934966 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m01:15:34.997645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:15:35.000205 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:15:35.004643 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m01:15:35.012006 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m01:15:35.022877 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m01:15:35.025641 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m01:15:35.027833 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m01:15:35.029418 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m01:15:35.039541 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:15:35.040668 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:15:35.044499 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: Close
[0m01:15:35.048680 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m01:15:35.051426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d00fcd90>]}
[0m01:15:35.053582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d34e53d0>]}
[0m01:15:35.059036 [info ] [Thread-1 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1000[0m in 0.37s]
[0m01:15:35.063466 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4306[0m in 0.40s]
[0m01:15:35.068426 [debug] [Thread-1 (]: Finished running node model.api_bi_project.dim_customer
[0m01:15:35.071204 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m01:15:35.077340 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:15:35.079027 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m01:15:35.080809 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m01:15:35.082710 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:15:35.092463 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:15:35.105267 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:15:35.113106 [debug] [Thread-4 (]: SQL status: SELECT 5686 in 0.0 seconds
[0m01:15:35.115610 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:15:35.121097 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:15:35.124099 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m01:15:35.126848 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:35.132529 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:15:35.135063 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m01:15:35.136382 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:15:35.138596 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:15:35.139520 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m01:15:35.142633 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m01:15:35.144056 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:15:35.145403 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:15:35.148024 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m01:15:35.159673 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:35.161551 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m01:15:35.163129 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m01:15:35.166888 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:35.169631 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m01:15:35.171158 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m01:15:35.172647 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.09s]
[0m01:15:35.174544 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m01:15:35.175457 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m01:15:35.182612 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m01:15:35.184853 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m01:15:35.186455 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m01:15:35.192589 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:15:35.195966 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m01:15:35.197840 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323445b5-b513-4ceb-b2a9-520aad931f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d02c3950>]}
[0m01:15:35.199853 [info ] [Thread-4 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5686[0m in 0.37s]
[0m01:15:35.202104 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m01:15:35.204927 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:15:35.206569 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m01:15:35.208634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m01:15:35.210806 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:15:35.217719 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:15:35.231547 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:15:35.237230 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:15:35.248938 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:15:35.250460 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m01:15:35.251834 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:15:35.264842 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:15:35.267439 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m01:15:35.269128 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m01:15:35.274604 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:15:35.278511 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m01:15:35.280451 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m01:15:35.282865 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.07s]
[0m01:15:35.285205 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m01:15:35.291109 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:35.292945 [debug] [MainThread]: On master: BEGIN
[0m01:15:35.294580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:35.310997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:15:35.313136 [debug] [MainThread]: On master: COMMIT
[0m01:15:35.315089 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:35.316857 [debug] [MainThread]: On master: COMMIT
[0m01:15:35.319363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:15:35.320827 [debug] [MainThread]: On master: Close
[0m01:15:35.322629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:35.326255 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m01:15:35.327738 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m01:15:35.329099 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m01:15:35.330282 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m01:15:35.331783 [info ] [MainThread]: 
[0m01:15:35.334512 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m01:15:35.342581 [debug] [MainThread]: Command end result
[0m01:15:35.475232 [info ] [MainThread]: 
[0m01:15:35.480786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:15:35.486142 [info ] [MainThread]: 
[0m01:15:35.492911 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m01:15:35.503236 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.968379, "process_user_time": 4.505094, "process_kernel_time": 0.858305, "process_mem_max_rss": "116708", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:15:35.511450 [debug] [MainThread]: Command `dbt build` succeeded at 01:15:35.511122 after 4.98 seconds
[0m01:15:35.514167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d40ca6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d378cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34d7270810>]}
[0m01:15:35.521244 [debug] [MainThread]: Flushing usage events
[0m16:59:36.706533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af1730d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af173094f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af1730bf950>]}


============================== 16:59:36.715245 | 368938fb-a2f8-44cf-8068-6d7ed9e795c0 ==============================
[0m16:59:36.715245 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:59:36.737617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:59:36.949539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '368938fb-a2f8-44cf-8068-6d7ed9e795c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af172f15990>]}
[0m16:59:37.808638 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0z03c7ko'
[0m16:59:37.810397 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:59:38.094542 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:59:38.097629 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:59:38.194124 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:59:38.204234 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:59:44.332479 [info ] [MainThread]: Installed from version 1.3.1
[0m16:59:44.334575 [info ] [MainThread]: Up to date!
[0m16:59:44.337213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '368938fb-a2f8-44cf-8068-6d7ed9e795c0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af1730e53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af173106e90>]}
[0m16:59:44.341531 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.250734, "process_user_time": 5.654711, "process_kernel_time": 5.391559, "process_mem_max_rss": "94012", "process_in_blocks": "88080", "process_out_blocks": "168"}
[0m16:59:44.344328 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:44.343975 after 9.25 seconds
[0m16:59:44.345983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af1730e5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af172fab2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af176e806d0>]}
[0m16:59:44.348730 [debug] [MainThread]: Flushing usage events
[0m16:59:48.172162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7365e6b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b736603c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7365eb1410>]}


============================== 16:59:48.177491 | 50e123dc-db55-404d-8ecf-047b7d50ca19 ==============================
[0m16:59:48.177491 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:59:48.180880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:59:48.779418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7364578f90>]}
[0m16:59:48.944103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7369b7c750>]}
[0m16:59:48.953544 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:59:49.140759 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:59:50.998802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:51.000793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:51.079277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7364579cd0>]}
[0m16:59:51.429520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b736452c810>]}
[0m16:59:51.432123 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m16:59:51.434555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7364422d10>]}
[0m16:59:51.440387 [info ] [MainThread]: 
[0m16:59:51.443132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:51.458132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:59:51.460202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:59:51.625863 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:59:51.626862 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:59:51.628679 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:59:51.630755 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:59:51.632903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:51.634342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:51.673089 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:59:51.673915 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:59:51.677894 [debug] [ThreadPool]: On list_db: Close
[0m16:59:51.683951 [debug] [ThreadPool]: On list_db: Close
[0m16:59:51.693938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m16:59:51.696341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m16:59:51.713924 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:59:51.722076 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:59:51.724116 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m16:59:51.725815 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m16:59:51.727672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:51.728921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:51.748279 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:59:51.750945 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:59:51.751763 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:59:51.753721 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:59:51.757595 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m16:59:51.760147 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:59:51.780517 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:59:51.781381 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:59:51.784521 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m16:59:51.795146 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m16:59:51.803659 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m16:59:51.806902 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m16:59:51.829202 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:51.833189 [debug] [MainThread]: On master: BEGIN
[0m16:59:51.835499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:51.854053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:51.857266 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:51.860010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:51.910165 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m16:59:51.913247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73645af710>]}
[0m16:59:51.915235 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:51.917213 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:51.919321 [debug] [MainThread]: On master: BEGIN
[0m16:59:51.921583 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:51.923303 [debug] [MainThread]: On master: COMMIT
[0m16:59:51.924961 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:51.926949 [debug] [MainThread]: On master: COMMIT
[0m16:59:51.929191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:51.931360 [debug] [MainThread]: On master: Close
[0m16:59:51.933506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:59:51.937985 [info ] [MainThread]: 
[0m16:59:51.948746 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m16:59:51.950511 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m16:59:51.951621 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m16:59:51.954518 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m16:59:51.957322 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m16:59:51.959979 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m16:59:51.965445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m16:59:51.969886 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m16:59:51.973195 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m16:59:51.975097 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m16:59:51.977280 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m16:59:51.980573 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m16:59:51.998734 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m16:59:52.005292 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m16:59:52.014134 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m16:59:52.044163 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m16:59:52.045183 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m16:59:52.047157 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m16:59:52.143575 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m16:59:52.145047 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m16:59:52.148312 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m16:59:52.169060 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:59:52.170668 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:59:52.171699 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:59:52.173695 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m16:59:52.176142 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m16:59:52.178549 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m16:59:52.181173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:59:52.183333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:52.185457 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:59:52.203931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:52.206247 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:59:52.207875 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:52.209872 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m16:59:52.211833 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:59:52.213106 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:52.216298 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m16:59:52.219339 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:59:52.224890 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m16:59:52.237158 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:52.238624 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:52.241209 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:52.261279 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:59:52.270008 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:59:52.279293 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:59:52.287380 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m16:59:52.289830 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m16:59:52.292891 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m16:59:52.297038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:52.298627 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:52.301083 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:52.306813 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:59:52.315976 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:59:52.322961 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:59:52.324316 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:59:52.325839 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m16:59:52.327802 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m16:59:52.331072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:52.331933 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:52.334343 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:52.357307 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:59:52.359745 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:59:52.363627 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:59:52.365372 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:59:52.366851 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:59:52.368451 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:59:52.370173 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:59:52.372001 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:59:52.373541 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:59:52.378420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:52.379683 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:52.389476 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:52.397659 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m16:59:52.403224 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m16:59:52.408982 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m16:59:52.420111 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:59:52.422401 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:59:52.424992 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:59:52.445718 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m16:59:52.438186 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m16:59:52.427188 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m16:59:52.477914 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:52.487875 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:52.486760 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:52.502558 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m16:59:52.508322 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m16:59:52.511684 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m16:59:52.516859 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7365d71090>]}
[0m16:59:52.519798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7362e74050>]}
[0m16:59:52.522611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b736053b2d0>]}
[0m16:59:52.528100 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.54s]
[0m16:59:52.531199 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.55s]
[0m16:59:52.533893 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.55s]
[0m16:59:52.538136 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m16:59:52.540609 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m16:59:52.543215 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m16:59:52.546889 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m16:59:52.550248 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m16:59:52.553480 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m16:59:52.620255 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m16:59:52.623251 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m16:59:52.625763 [info ] [Thread-1 (]: 6 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m16:59:52.628470 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m16:59:52.631074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.dim_customer)
[0m16:59:52.633424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m16:59:52.635396 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m16:59:52.637292 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m16:59:52.639625 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m16:59:52.648869 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m16:59:52.662137 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m16:59:52.669979 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m16:59:52.696946 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m16:59:52.698030 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m16:59:52.699046 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m16:59:52.756013 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m16:59:52.767003 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m16:59:52.768864 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m16:59:52.792069 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:59:52.793239 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:59:52.794237 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:59:52.796227 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m16:59:52.798602 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m16:59:52.800877 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m16:59:52.803149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:52.805512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:59:52.807843 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:59:52.827795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:52.829024 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:52.830133 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:52.832059 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:59:52.834811 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:59:52.836954 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:59:52.838629 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m16:59:52.840776 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m16:59:52.843541 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m16:59:52.879713 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m16:59:52.899329 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:59:52.903610 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m16:59:52.906836 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:53.032275 [debug] [Thread-4 (]: SQL status: SELECT 5686 in 0.0 seconds
[0m16:59:53.033197 [debug] [Thread-1 (]: SQL status: SELECT 4306 in 0.0 seconds
[0m16:59:53.036539 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:59:53.043120 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:59:53.049023 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:59:53.051086 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m16:59:53.052817 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m16:59:53.054865 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m16:59:53.057979 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:53.060208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:53.061779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:53.071329 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:59:53.078213 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:59:53.085286 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:59:53.086644 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:59:53.088189 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m16:59:53.090039 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m16:59:53.091710 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:59:53.094425 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:53.095907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:53.101814 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:59:53.102585 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:53.105853 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:59:53.108047 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:59:53.114521 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m16:59:53.116833 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:59:53.118969 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:59:53.127509 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:59:53.129545 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:59:53.133339 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m16:59:53.134310 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:53.138083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:53.143861 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m16:59:53.144792 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:59:53.154032 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m16:59:53.157280 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:59:53.162928 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m16:59:53.170148 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:59:53.173831 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m16:59:53.177853 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73605141d0>]}
[0m16:59:53.182574 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m16:59:53.186525 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.55s]
[0m16:59:53.192100 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:59:53.197255 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m16:59:53.199474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:59:53.203597 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m16:59:53.210241 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m16:59:53.214350 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7362e385d0>]}
[0m16:59:53.217910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e123dc-db55-404d-8ecf-047b7d50ca19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b736839b950>]}
[0m16:59:53.221042 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5686[0m in 0.59s]
[0m16:59:53.224966 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4306[0m in 0.58s]
[0m16:59:53.232022 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m16:59:53.235478 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m16:59:53.243164 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:53.245356 [debug] [MainThread]: On master: BEGIN
[0m16:59:53.247344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:53.267982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:53.278318 [debug] [MainThread]: On master: COMMIT
[0m16:59:53.280380 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:53.283566 [debug] [MainThread]: On master: COMMIT
[0m16:59:53.289817 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:53.293911 [debug] [MainThread]: On master: Close
[0m16:59:53.297330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:53.301897 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m16:59:53.303860 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m16:59:53.306974 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m16:59:53.313334 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m16:59:53.316365 [info ] [MainThread]: 
[0m16:59:53.325299 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m16:59:53.338353 [debug] [MainThread]: Command end result
[0m16:59:53.529398 [info ] [MainThread]: 
[0m16:59:53.533842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:53.539070 [info ] [MainThread]: 
[0m16:59:53.542867 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:59:53.552049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5306106, "process_user_time": 4.551723, "process_kernel_time": 0.713918, "process_mem_max_rss": "113036", "process_in_blocks": "16584", "process_out_blocks": "0"}
[0m16:59:53.555105 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:53.554602 after 5.53 seconds
[0m16:59:53.560152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7365e69390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7365ee5dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7367b5c0d0>]}
[0m16:59:53.563901 [debug] [MainThread]: Flushing usage events
[0m17:00:31.533358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849965d7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849965fb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849965fb550>]}


============================== 17:00:31.542710 | 2a638027-3e75-4ebc-b907-ee2bb6303213 ==============================
[0m17:00:31.542710 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:00:31.546586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:32.005474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a638027-3e75-4ebc-b907-ee2bb6303213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849965d5d50>]}
[0m17:00:32.524294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72323a922f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72323a967b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72323aae3810>]}


============================== 17:00:32.539967 | 4f6d786d-ff36-41ed-b2aa-cafae55c3af1 ==============================
[0m17:00:32.539967 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:00:32.547073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:33.365694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f6d786d-ff36-41ed-b2aa-cafae55c3af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72323a838250>]}
[0m17:00:33.814784 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'test_get_column_values_where.sql'
[0m17:00:33.841043 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/deps.py", line 233, in run
    system.rmtree(self.project.packages_install_path)
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/system.py", line 689, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/shutil.py", line 732, in rmtree
    _rmtree_safe_fd(fd, path, onerror)
  File "/usr/local/lib/python3.11/shutil.py", line 660, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onerror)
  File "/usr/local/lib/python3.11/shutil.py", line 660, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onerror)
  File "/usr/local/lib/python3.11/shutil.py", line 660, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onerror)
  [Previous line repeated 1 more time]
  File "/usr/local/lib/python3.11/shutil.py", line 683, in _rmtree_safe_fd
    onerror(os.unlink, fullname, sys.exc_info())
  File "/usr/local/lib/python3.11/shutil.py", line 681, in _rmtree_safe_fd
    os.unlink(entry.name, dir_fd=topfd)
FileNotFoundError: [Errno 2] No such file or directory: 'test_get_column_values_where.sql'

[0m17:00:33.875168 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.623011, "process_user_time": 6.303449, "process_kernel_time": 1.424248, "process_mem_max_rss": "94064", "process_in_blocks": "248", "command_success": false, "process_out_blocks": "0"}
[0m17:00:33.890946 [debug] [MainThread]: Command `dbt deps` failed at 17:00:33.890096 after 1.64 seconds
[0m17:00:33.899470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72323a990d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72323a928390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72323e8c4d90>]}
[0m17:00:33.903147 [debug] [MainThread]: Flushing usage events
[0m17:00:34.357902 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yjiito94'
[0m17:00:34.361674 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:00:34.471286 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:00:34.476602 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:00:34.581314 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:00:34.591436 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:00:42.142037 [info ] [MainThread]: Installed from version 1.3.1
[0m17:00:42.144093 [info ] [MainThread]: Up to date!
[0m17:00:42.146385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a638027-3e75-4ebc-b907-ee2bb6303213', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849964ef110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78499647a690>]}
[0m17:00:42.149383 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 11.340505, "process_user_time": 5.892943, "process_kernel_time": 1.602323, "process_mem_max_rss": "94724", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m17:00:42.151737 [debug] [MainThread]: Command `dbt deps` succeeded at 17:00:42.151373 after 11.34 seconds
[0m17:00:42.153288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784996610850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784996797a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78499a4347d0>]}
[0m17:00:42.154550 [debug] [MainThread]: Flushing usage events
[0m17:00:50.103902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b47d3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b4810390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b4817110>]}


============================== 17:00:50.111641 | 95d162ba-3b70-478c-8874-95de145e80bf ==============================
[0m17:00:50.111641 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:00:50.117786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:00:50.431303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b2ef7c50>]}
[0m17:00:50.544468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b8514e10>]}
[0m17:00:50.548184 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:00:50.627630 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:00:52.798813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:52.800803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:52.878253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b2e8a090>]}
[0m17:00:53.123810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b29fce50>]}
[0m17:00:53.125799 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m17:00:53.133262 [info ] [MainThread]: 
[0m17:00:53.135894 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:53.144051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:00:53.145869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:00:53.227956 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:00:53.228611 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:00:53.229849 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:00:53.231157 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:00:53.232595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:53.234730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:53.258496 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:00:53.259691 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:00:53.262383 [debug] [ThreadPool]: On list_db: Close
[0m17:00:53.272298 [debug] [ThreadPool]: On list_db: Close
[0m17:00:53.278351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m17:00:53.279660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m17:00:53.290558 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:00:53.295847 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:00:53.297722 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:00:53.301287 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:00:53.305340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:53.307355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:53.326731 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:00:53.333880 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:00:53.337803 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:00:53.342037 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:00:53.344407 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:00:53.348089 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:00:53.361391 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:00:53.365253 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:00:53.384139 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:00:53.409556 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:00:53.416786 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:00:53.423682 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:00:53.462356 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:53.466688 [debug] [MainThread]: On master: BEGIN
[0m17:00:53.470111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:53.491004 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:00:53.493412 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:53.498871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:53.587943 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:00:53.598629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b2f78490>]}
[0m17:00:53.611248 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:53.615116 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:53.619074 [debug] [MainThread]: On master: BEGIN
[0m17:00:53.625508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:00:53.628635 [debug] [MainThread]: On master: COMMIT
[0m17:00:53.631051 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:53.632943 [debug] [MainThread]: On master: COMMIT
[0m17:00:53.637246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:00:53.646153 [debug] [MainThread]: On master: Close
[0m17:00:53.648831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:53.659373 [info ] [MainThread]: 
[0m17:00:53.677341 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m17:00:53.678469 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m17:00:53.679484 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m17:00:53.681865 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m17:00:53.685256 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m17:00:53.692405 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m17:00:53.704191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m17:00:53.710496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m17:00:53.714536 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m17:00:53.718308 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m17:00:53.726484 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m17:00:53.729928 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m17:00:53.777676 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m17:00:53.788548 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m17:00:53.798105 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m17:00:53.829929 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m17:00:53.853394 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m17:00:53.861848 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m17:00:54.282329 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m17:00:54.286541 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m17:00:54.287965 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m17:00:54.356593 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:00:54.383079 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m17:00:54.370678 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:00:54.389333 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m17:00:54.385673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:00:54.392999 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:00:54.394537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:54.412824 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m17:00:54.445637 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:54.459205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:54.473894 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:00:54.492894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:54.535013 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m17:00:54.536677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:54.556083 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:00:54.561663 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:00:54.564786 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:00:54.566202 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m17:00:54.569019 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m17:00:54.600218 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:00:54.604468 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m17:00:54.605971 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:00:54.607113 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:00:54.609393 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:54.634199 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:00:54.646337 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:00:54.663837 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:00:54.660476 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:00:54.658826 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:00:54.670112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:54.672842 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:54.675951 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m17:00:54.690293 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:00:54.708632 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:00:54.711335 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:54.712284 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:00:54.715423 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:00:54.754486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:54.775182 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:00:54.778112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:54.781668 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:00:54.784136 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:00:54.791533 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:00:54.801509 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:00:54.812494 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:00:54.814883 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:00:54.817444 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:00:54.823916 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:00:54.824947 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:54.828776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:54.829768 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:54.846400 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m17:00:54.851207 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m17:00:54.859449 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m17:00:54.872775 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:00:54.874623 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:00:54.876619 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:00:54.878204 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m17:00:54.880341 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:00:54.882422 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m17:00:54.887132 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:00:54.888139 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:00:54.889985 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:00:54.896086 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m17:00:54.901725 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m17:00:54.905386 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m17:00:54.910460 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b0507250>]}
[0m17:00:54.912839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b2f797d0>]}
[0m17:00:54.915117 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b1779410>]}
[0m17:00:54.917573 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 1.19s]
[0m17:00:54.920156 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 1.21s]
[0m17:00:54.922593 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 1.20s]
[0m17:00:54.925347 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m17:00:54.927564 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m17:00:54.929498 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m17:00:54.932542 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:00:54.939963 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m17:00:54.934909 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:00:54.937226 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:00:54.933592 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:00:54.943258 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m17:00:54.945448 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m17:00:54.947713 [info ] [Thread-2 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m17:00:54.950357 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m17:00:54.953278 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:00:54.955332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m17:00:54.957356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m17:00:54.959987 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m17:00:54.987851 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:00:54.988821 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:00:54.991113 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:00:54.993220 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:00:55.018568 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:00:55.135688 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:00:55.142770 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:00:55.144561 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:00:55.177107 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:00:55.179394 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:00:55.180236 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:00:55.187138 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:00:55.194213 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:00:55.197454 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:00:55.204632 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:00:55.217287 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:00:55.224557 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m17:00:55.227284 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:00:55.228540 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:00:55.229979 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:00:55.232590 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m17:00:55.239461 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m17:00:55.242955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:55.244312 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:00:55.248672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:55.252567 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.256141 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m17:00:55.266537 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:00:55.268715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:55.270570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.271647 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m17:00:55.276728 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:00:55.280500 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.284708 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:00:55.287128 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:00:55.297321 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m17:00:55.301757 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.308931 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:55.310641 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:00:55.320989 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m17:00:55.322764 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m17:00:55.325886 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:55.329229 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m17:00:55.337306 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:55.342424 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m17:00:55.345395 [info ] [Thread-2 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.39s]
[0m17:00:55.354570 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m17:00:55.355874 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:55.358215 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m17:00:55.360439 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:00:55.362812 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m17:00:55.365238 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m17:00:55.367912 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.42s]
[0m17:00:55.374228 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:00:55.384309 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.42s]
[0m17:00:55.390274 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m17:00:55.392717 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:00:55.396471 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m17:00:55.399259 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:00:55.401989 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.45s]
[0m17:00:55.405097 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:00:55.407842 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:00:55.410533 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:00:55.413796 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:00:55.415941 [info ] [Thread-4 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m17:00:55.418550 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:00:55.421430 [info ] [Thread-3 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m17:00:55.423631 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:00:55.426115 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m17:00:55.442158 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:00:55.443414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m17:00:55.445110 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m17:00:55.447528 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:00:55.453100 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:00:55.455590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m17:00:55.468095 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:00:55.495310 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:00:55.497122 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:00:55.501728 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:00:55.543640 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:00:55.551933 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:00:55.553314 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:00:55.555271 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:00:55.566424 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:00:55.575281 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:00:55.596502 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:00:55.597924 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:00:55.609895 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:00:55.617453 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:00:55.627179 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:00:55.653615 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:00:55.669926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:55.707745 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:00:55.726695 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m17:00:55.758397 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:55.784548 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.787227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:55.838440 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:00:55.841012 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:00:55.868216 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:00:55.869839 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.874386 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m17:00:55.882151 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:55.884469 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:00:55.886853 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.890506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:55.899103 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:00:55.906063 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:00:55.910547 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:00:55.917880 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:00:55.946984 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:55.948703 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m17:00:55.959169 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.55s]
[0m17:00:55.963301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:55.968142 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:00:55.974645 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:00:55.981098 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:00:55.984127 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:55.984985 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m17:00:55.989054 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:00:55.992497 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m17:00:56.001336 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m17:00:56.005847 [info ] [Thread-4 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.58s]
[0m17:00:56.011877 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m17:00:56.046211 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m17:00:56.047860 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:56.050429 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:00:56.059275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m17:00:56.062606 [info ] [Thread-3 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.62s]
[0m17:00:56.072532 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:00:56.077966 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m17:00:56.081766 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:00:56.085832 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:00:56.089226 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:00:56.092276 [info ] [Thread-4 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m17:00:56.111248 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:00:56.113124 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m17:00:56.117271 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.66s]
[0m17:00:56.122299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_marketing_attribution)
[0m17:00:56.127743 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m17:00:56.131015 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:00:56.133786 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m17:00:56.136089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m17:00:56.148275 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.150456 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m17:00:56.186274 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m17:00:56.193124 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:00:56.198374 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m17:00:56.215278 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:00:56.309413 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m17:00:56.317351 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.328689 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:00:56.333558 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m17:00:56.337297 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m17:00:56.340779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:56.360294 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:56.365496 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:00:56.367830 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.370826 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:00:56.371749 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:00:56.373535 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m17:00:56.376707 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m17:00:56.381964 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:56.384714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:00:56.392993 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:56.400536 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:00:56.405759 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:56.407527 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m17:00:56.410981 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:56.412943 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.417580 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.36s]
[0m17:00:56.419187 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:00:56.421636 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m17:00:56.424110 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:00:56.426216 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m17:00:56.434933 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m17:00:56.438049 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m17:00:56.442590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m17:00:56.444717 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m17:00:56.454232 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.455569 [debug] [Thread-3 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m17:00:56.469164 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:00:56.471312 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m17:00:56.474631 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:56.484800 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m17:00:56.486757 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:00:56.496193 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.497954 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:00:56.502149 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:56.519862 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:00:56.521930 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:00:56.524586 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:00:56.525655 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.533559 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:56.539116 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m17:00:56.553618 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m17:00:56.557462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:56.568427 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:00:56.570722 [debug] [Thread-4 (]: SQL status: SELECT 5717 in 0.0 seconds
[0m17:00:56.576068 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m17:00:56.586110 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.592970 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m17:00:56.595744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:56.600458 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:56.604168 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.606710 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:00:56.615710 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.619480 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m17:00:56.625809 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m17:00:56.628251 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m17:00:56.631971 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b177f010>]}
[0m17:00:56.636876 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:56.642616 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1006[0m in 0.50s]
[0m17:00:56.653682 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:00:56.655996 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m17:00:56.658728 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.662646 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:00:56.666000 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:56.677177 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m17:00:56.679831 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:00:56.681248 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m17:00:56.686391 [debug] [Thread-1 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m17:00:56.697148 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.697919 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:00:56.699122 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m17:00:56.704182 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m17:00:56.706932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:56.707879 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b47e7510>]}
[0m17:00:56.725995 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.729913 [info ] [Thread-4 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5717[0m in 0.59s]
[0m17:00:56.733090 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m17:00:56.736106 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m17:00:56.741193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:00:56.743231 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:00:56.748399 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:00:56.750889 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m17:00:56.752675 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.756676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m17:00:56.759240 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:00:56.760692 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:00:56.771956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:00:56.774265 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:00:56.778439 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m17:00:56.784568 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:00:56.786051 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m17:00:56.792907 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:00:56.795664 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m17:00:56.799675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d162ba-3b70-478c-8874-95de145e80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b04908d0>]}
[0m17:00:56.802584 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4326[0m in 0.36s]
[0m17:00:56.804775 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m17:00:56.809265 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:00:56.811823 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m17:00:56.814141 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:00:56.816464 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m17:00:56.826466 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:00:56.828262 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:00:56.843735 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:00:56.867313 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:00:56.870952 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m17:00:56.873467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:00:56.876123 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:00:56.885371 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:00:56.896495 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:56.898632 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:00:56.900989 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m17:00:56.907286 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:56.912578 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m17:00:56.915739 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m17:00:56.918413 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.16s]
[0m17:00:56.921714 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:00:56.925243 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:00:56.930051 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m17:00:56.934869 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:00:56.958533 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:00:56.960458 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:00:56.962683 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m17:00:56.969342 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:00:56.976054 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m17:00:56.978539 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m17:00:56.984289 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.17s]
[0m17:00:56.991698 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:00:56.998222 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:57.001254 [debug] [MainThread]: On master: BEGIN
[0m17:00:57.002644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:57.021540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:00:57.025464 [debug] [MainThread]: On master: COMMIT
[0m17:00:57.028807 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:57.030933 [debug] [MainThread]: On master: COMMIT
[0m17:00:57.034878 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:00:57.038194 [debug] [MainThread]: On master: Close
[0m17:00:57.039568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:57.041765 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m17:00:57.045441 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m17:00:57.047146 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m17:00:57.048360 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m17:00:57.051216 [info ] [MainThread]: 
[0m17:00:57.055328 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m17:00:57.066671 [debug] [MainThread]: Command end result
[0m17:00:57.220721 [info ] [MainThread]: 
[0m17:00:57.223277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:57.226692 [info ] [MainThread]: 
[0m17:00:57.228657 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m17:00:57.232003 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.232741, "process_user_time": 6.933345, "process_kernel_time": 1.086718, "process_mem_max_rss": "116860", "process_in_blocks": "2112", "process_out_blocks": "0"}
[0m17:00:57.234201 [debug] [MainThread]: Command `dbt build` succeeded at 17:00:57.233936 after 7.24 seconds
[0m17:00:57.235592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b86048d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b8760490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121b8761490>]}
[0m17:00:57.237115 [debug] [MainThread]: Flushing usage events
[0m17:02:39.329848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c990d1fe710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c990e65c510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c990d1fe790>]}


============================== 17:02:39.342262 | 8bc015e6-bdfd-49f6-951e-1057e52214a3 ==============================
[0m17:02:39.342262 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:02:39.347022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:02:39.761012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bc015e6-bdfd-49f6-951e-1057e52214a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c990d26d1d0>]}
[0m17:02:40.509185 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-08ry4490'
[0m17:02:40.510910 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:02:40.806507 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:02:40.809957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:02:40.909805 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:02:40.919312 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:02:48.603168 [info ] [MainThread]: Installed from version 1.3.1
[0m17:02:48.604969 [info ] [MainThread]: Up to date!
[0m17:02:48.606881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8bc015e6-bdfd-49f6-951e-1057e52214a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c990e65ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c990d0a2990>]}
[0m17:02:48.609776 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.631721, "process_user_time": 3.4564, "process_kernel_time": 1.234709, "process_mem_max_rss": "94480", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m17:02:48.611701 [debug] [MainThread]: Command `dbt deps` succeeded at 17:02:48.611464 after 9.63 seconds
[0m17:02:48.613051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c990d538c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9911004810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9911188ed0>]}
[0m17:02:48.614114 [debug] [MainThread]: Flushing usage events
[0m17:02:54.475502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c886bcaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c887898c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c886bcac50>]}


============================== 17:02:54.480770 | 4b72a0bc-bf50-4d59-aa91-da1407278745 ==============================
[0m17:02:54.480770 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:02:54.482664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:02:54.757783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8852d7c50>]}
[0m17:02:54.831885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c88a8dce10>]}
[0m17:02:54.835225 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:02:54.901718 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:02:56.978747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:02:56.981957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:02:57.035192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8852f4cd0>]}
[0m17:02:57.259754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c884dc9150>]}
[0m17:02:57.262277 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m17:02:57.271517 [info ] [MainThread]: 
[0m17:02:57.275340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:02:57.285317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:02:57.286718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:02:57.380139 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:02:57.381221 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:02:57.382778 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:02:57.384177 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:02:57.385842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:57.388681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:57.410849 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:02:57.411832 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:02:57.415037 [debug] [ThreadPool]: On list_db: Close
[0m17:02:57.419691 [debug] [ThreadPool]: On list_db: Close
[0m17:02:57.426618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m17:02:57.428540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m17:02:57.442914 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:02:57.454163 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:02:57.458711 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:02:57.462173 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:02:57.466918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:57.473222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:57.504716 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:02:57.505521 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:02:57.509132 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:02:57.513528 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:02:57.515797 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:02:57.523046 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:02:57.540701 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:02:57.541687 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:02:57.551709 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:02:57.559000 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:02:57.565861 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:02:57.575568 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:02:57.598846 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:57.600756 [debug] [MainThread]: On master: BEGIN
[0m17:02:57.602241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:57.624117 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:02:57.626352 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:57.630466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:02:57.666112 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:02:57.668858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c884dc7450>]}
[0m17:02:57.670166 [debug] [MainThread]: On master: ROLLBACK
[0m17:02:57.671642 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:57.672694 [debug] [MainThread]: On master: BEGIN
[0m17:02:57.674536 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:02:57.676022 [debug] [MainThread]: On master: COMMIT
[0m17:02:57.677481 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:57.678861 [debug] [MainThread]: On master: COMMIT
[0m17:02:57.680889 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:02:57.682981 [debug] [MainThread]: On master: Close
[0m17:02:57.684984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:02:57.689320 [info ] [MainThread]: 
[0m17:02:57.704727 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m17:02:57.705839 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m17:02:57.706637 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m17:02:57.709627 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m17:02:57.713770 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m17:02:57.716567 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m17:02:57.719324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m17:02:57.721308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m17:02:57.723316 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m17:02:57.725533 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m17:02:57.729428 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m17:02:57.731937 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m17:02:57.753336 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m17:02:57.766382 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m17:02:57.774562 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m17:02:57.786348 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m17:02:57.789892 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m17:02:57.791755 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m17:02:57.966098 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m17:02:57.971359 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m17:02:57.973411 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m17:02:57.982448 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:02:57.983521 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:02:57.984991 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m17:02:57.985774 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:02:57.987400 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m17:02:57.989717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:57.991360 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m17:02:57.992681 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:02:57.995807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:02:58.011455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:58.015289 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:02:58.018940 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m17:02:58.025179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:58.032186 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:02:58.034510 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:58.037355 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m17:02:58.041099 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:02:58.044893 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:02:58.058324 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:02:58.073639 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:02:58.076055 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m17:02:58.088911 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:02:58.090304 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:02:58.094645 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m17:02:58.102078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:58.103633 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:02:58.105214 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:58.119160 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:02:58.124646 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:02:58.141141 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:02:58.142991 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:02:58.146302 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:02:58.149918 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m17:02:58.154495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:58.155848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:58.157028 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:58.190690 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:02:58.191244 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:02:58.193941 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:02:58.195421 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:02:58.197329 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:02:58.198735 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:02:58.201079 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:02:58.201739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:58.202908 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:02:58.207288 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:02:58.207958 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:02:58.210416 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:02:58.211020 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:02:58.220185 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m17:02:58.221451 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:02:58.225435 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m17:02:58.234750 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:02:58.237503 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:02:58.238928 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:02:58.240296 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m17:02:58.251953 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:02:58.252969 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:02:58.253433 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:02:58.257518 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m17:02:58.262116 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m17:02:58.265860 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m17:02:58.267814 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:02:58.271455 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8840c3bd0>]}
[0m17:02:58.273761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8842f7610>]}
[0m17:02:58.275337 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m17:02:58.277591 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.55s]
[0m17:02:58.279800 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.55s]
[0m17:02:58.283807 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m17:02:58.285776 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:02:58.286598 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m17:02:58.289547 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:02:58.290473 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:02:58.293265 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m17:02:58.294913 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:02:58.296456 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m17:02:58.298178 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m17:02:58.300678 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c884344a50>]}
[0m17:02:58.302314 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m17:02:58.304345 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m17:02:58.306066 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m17:02:58.307912 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.58s]
[0m17:02:58.310490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m17:02:58.313330 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:02:58.315321 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:02:58.317100 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m17:02:58.318821 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:02:58.339004 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:02:58.351187 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:02:58.352564 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:02:58.555657 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:02:58.559240 [info ] [Thread-2 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m17:02:58.563882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m17:02:58.569285 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:02:58.576842 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:02:58.581072 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:02:58.582186 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:02:58.582881 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:02:58.621449 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:02:58.632361 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:02:58.638222 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:02:58.647649 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:02:58.660670 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:02:58.671580 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:02:58.672845 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:02:58.674645 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:02:58.686114 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m17:02:58.689713 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m17:02:58.694852 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m17:02:58.698720 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:02:58.700687 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:02:58.702564 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:02:58.705984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:58.711260 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m17:02:58.729878 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:02:58.733099 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:58.743803 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:02:58.747029 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:58.748736 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m17:02:58.750531 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:02:58.758929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:58.760180 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:58.763929 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m17:02:58.767891 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:02:58.774321 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:02:58.780544 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:02:58.784005 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:58.785672 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m17:02:58.803520 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:58.807026 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m17:02:58.816303 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:58.823992 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m17:02:58.838021 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m17:02:58.833913 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m17:02:58.828733 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m17:02:58.855928 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.55s]
[0m17:02:58.859552 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m17:02:58.863400 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.56s]
[0m17:02:58.866143 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:02:58.867637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:58.872610 [info ] [Thread-2 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.31s]
[0m17:02:58.875720 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:02:58.879239 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:02:58.885630 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m17:02:58.889726 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:02:58.892525 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:02:58.895924 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m17:02:58.898673 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m17:02:58.900938 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:02:58.903892 [info ] [Thread-3 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m17:02:58.906022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:02:58.908541 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.60s]
[0m17:02:58.911713 [info ] [Thread-2 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m17:02:58.914583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m17:02:58.917083 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:02:58.920186 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:02:58.922982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m17:02:58.926411 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:02:58.951125 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:02:58.954360 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:02:58.968909 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:02:59.000618 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:02:59.003456 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m17:02:59.025706 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:02:59.030824 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:02:59.037100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m17:02:59.040230 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:02:59.047995 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:02:59.052834 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:02:59.070939 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:02:59.081992 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:02:59.093305 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:02:59.104921 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:02:59.105972 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:02:59.117583 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:02:59.114951 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:02:59.120204 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:02:59.123462 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:02:59.130629 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:02:59.137165 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:02:59.132213 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:02:59.151950 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:02:59.154500 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.155609 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.156746 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m17:02:59.161646 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:02:59.163864 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:02:59.165892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:02:59.171879 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:02:59.175559 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:02:59.182419 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:02:59.190964 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m17:02:59.195944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:59.192655 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:59.187744 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:59.201128 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.221603 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:02:59.218562 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:02:59.212056 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:02:59.225962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.232864 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m17:02:59.239447 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:02:59.244537 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m17:02:59.245735 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:02:59.256793 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m17:02:59.254633 [info ] [Thread-3 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.34s]
[0m17:02:59.264810 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:02:59.259716 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:59.249617 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.34s]
[0m17:02:59.265706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:59.268233 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:02:59.272557 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m17:02:59.275740 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:02:59.280493 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:02:59.284634 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m17:02:59.287475 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m17:02:59.289089 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m17:02:59.291107 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:02:59.292333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m17:02:59.294368 [info ] [Thread-2 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.37s]
[0m17:02:59.296424 [info ] [Thread-4 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m17:02:59.299095 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.26s]
[0m17:02:59.300540 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:02:59.303086 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:02:59.305238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.fct_marketing_attribution)
[0m17:02:59.307634 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:02:59.315136 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:02:59.316470 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m17:02:59.317932 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m17:02:59.322508 [info ] [Thread-2 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m17:02:59.331371 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.332877 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m17:02:59.335457 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m17:02:59.336542 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:02:59.344724 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m17:02:59.350737 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:02:59.352081 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m17:02:59.396773 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.397754 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m17:02:59.399896 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:02:59.409725 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m17:02:59.411151 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m17:02:59.413157 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.414748 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:02:59.416812 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m17:02:59.420408 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:02:59.424199 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:02:59.426569 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m17:02:59.428286 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:02:59.435983 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.438676 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:02:59.440217 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.442486 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:02:59.444324 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.446774 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m17:02:59.452547 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.455429 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:02:59.457955 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m17:02:59.468819 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:02:59.474004 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:02:59.477422 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m17:02:59.479969 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.19s]
[0m17:02:59.490177 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:02:59.493878 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m17:02:59.497924 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m17:02:59.500954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m17:02:59.504437 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m17:02:59.520656 [debug] [Thread-2 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m17:02:59.540594 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m17:02:59.555113 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:02:59.566876 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m17:02:59.572292 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:59.594738 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:02:59.599655 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:02:59.601464 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m17:02:59.606147 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:59.620400 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m17:02:59.633557 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:02:59.636657 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:02:59.638124 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:02:59.650084 [debug] [Thread-4 (]: SQL status: SELECT 5717 in 0.0 seconds
[0m17:02:59.654064 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:02:59.665931 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:02:59.678479 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.697453 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m17:02:59.691113 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m17:02:59.681046 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m17:02:59.701747 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:59.718193 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:02:59.725545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:59.742181 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.743999 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m17:02:59.756642 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m17:02:59.778247 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:02:59.780536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:02:59.789343 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:02:59.805839 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m17:02:59.808991 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:02:59.814703 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:02:59.820809 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8840d5510>]}
[0m17:02:59.827989 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m17:02:59.830876 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.846429 [info ] [Thread-2 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1006[0m in 0.49s]
[0m17:02:59.864590 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:02:59.870708 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m17:02:59.876645 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:02:59.886942 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m17:02:59.909330 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:02:59.918020 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m17:02:59.942509 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:02:59.949098 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m17:02:59.952893 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c887812450>]}
[0m17:02:59.961653 [debug] [Thread-1 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m17:02:59.965232 [info ] [Thread-4 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5717[0m in 0.65s]
[0m17:02:59.991523 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:02:59.994305 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m17:03:00.001439 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m17:03:00.008632 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:03:00.012807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:00.015027 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m17:03:00.046559 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:03:00.048261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m17:03:00.052886 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m17:03:00.056259 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:03:00.060484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:00.074958 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:03:00.080735 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:03:00.085910 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:03:00.088873 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:03:00.095248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:00.103205 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m17:03:00.104382 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:03:00.107043 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:03:00.114590 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:03:00.116233 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m17:03:00.125289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:00.129197 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m17:03:00.132723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b72a0bc-bf50-4d59-aa91-da1407278745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c884045290>]}
[0m17:03:00.134000 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:03:00.136981 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4326[0m in 0.63s]
[0m17:03:00.139964 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m17:03:00.143033 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m17:03:00.145400 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:03:00.149102 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:03:00.152730 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m17:03:00.158385 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m17:03:00.160857 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:03:00.181019 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:03:00.182433 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:00.194047 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:03:00.196908 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m17:03:00.207817 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:03:00.214216 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m17:03:00.228843 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m17:03:00.234080 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.19s]
[0m17:03:00.242206 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:03:00.243417 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:03:00.253209 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:03:00.266197 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:03:00.269254 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m17:03:00.272492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:03:00.290144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:00.292757 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:03:00.295711 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m17:03:00.301261 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:03:00.309663 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m17:03:00.314208 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m17:03:00.321878 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.16s]
[0m17:03:00.327073 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:03:00.333646 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:00.336020 [debug] [MainThread]: On master: BEGIN
[0m17:03:00.341428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:00.361190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:00.367569 [debug] [MainThread]: On master: COMMIT
[0m17:03:00.373581 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:00.378420 [debug] [MainThread]: On master: COMMIT
[0m17:03:00.384416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:00.389425 [debug] [MainThread]: On master: Close
[0m17:03:00.393909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:00.400357 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m17:03:00.402542 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m17:03:00.404440 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m17:03:00.406303 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m17:03:00.408570 [info ] [MainThread]: 
[0m17:03:00.410792 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m17:03:00.422270 [debug] [MainThread]: Command end result
[0m17:03:00.542972 [info ] [MainThread]: 
[0m17:03:00.547184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:00.549775 [info ] [MainThread]: 
[0m17:03:00.552172 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m17:03:00.555918 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.2156463, "process_user_time": 5.105457, "process_kernel_time": 0.884011, "process_mem_max_rss": "116928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:00.558963 [debug] [MainThread]: Command `dbt build` succeeded at 17:03:00.558497 after 6.22 seconds
[0m17:03:00.560934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8890c5a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c88a9cc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c886c1a7d0>]}
[0m17:03:00.563639 [debug] [MainThread]: Flushing usage events
[0m17:15:06.341881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32e2f6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32e644bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32e2f69d0>]}


============================== 17:15:06.368159 | 69cf65d4-2293-4b23-b9a9-42cf88ee6f76 ==============================
[0m17:15:06.368159 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:15:06.370377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:06.519784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69cf65d4-2293-4b23-b9a9-42cf88ee6f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32e20b350>]}
[0m17:15:07.092898 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qmyhx2yp'
[0m17:15:07.094466 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:15:07.266570 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:15:07.269162 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:15:07.352593 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:15:07.361372 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:15:13.861550 [info ] [MainThread]: Installed from version 1.3.1
[0m17:15:13.863718 [info ] [MainThread]: Up to date!
[0m17:15:13.866186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69cf65d4-2293-4b23-b9a9-42cf88ee6f76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32e196790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32f7d5b50>]}
[0m17:15:13.870170 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.650574, "process_user_time": 1.784788, "process_kernel_time": 0.796174, "process_mem_max_rss": "94460", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m17:15:13.872604 [debug] [MainThread]: Command `dbt deps` succeeded at 17:15:13.872406 after 7.65 seconds
[0m17:15:13.874156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32e346f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32e4bfd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3320e06d0>]}
[0m17:15:13.875591 [debug] [MainThread]: Flushing usage events
[0m17:15:18.501125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd03044f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd030493090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0304ffe50>]}


============================== 17:15:18.505759 | 3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4 ==============================
[0m17:15:18.505759 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:15:18.508012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:18.744881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd030493a10>]}
[0m17:15:18.808463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd034190e10>]}
[0m17:15:18.811630 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:15:18.868236 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:15:20.447145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:20.448112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:20.493261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd02eb73ad0>]}
[0m17:15:20.709203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd02e678c50>]}
[0m17:15:20.711288 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m17:15:20.717281 [info ] [MainThread]: 
[0m17:15:20.719781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:20.727739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:15:20.729136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:15:20.831105 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:15:20.831756 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:15:20.833677 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:15:20.835791 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:15:20.837575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:20.839526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:20.863416 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:15:20.864062 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:15:20.866381 [debug] [ThreadPool]: On list_db: Close
[0m17:15:20.869730 [debug] [ThreadPool]: On list_db: Close
[0m17:15:20.875660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m17:15:20.876852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m17:15:20.884970 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:15:20.888814 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:15:20.890732 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:15:20.892362 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:15:20.894048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:20.895951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:20.910728 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:15:20.911635 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:15:20.913375 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:15:20.915394 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:15:20.917244 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:15:20.918763 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:15:20.927972 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:15:20.928845 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:15:20.931556 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:15:20.934687 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:15:20.937369 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:15:20.938964 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:15:20.948902 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:20.950795 [debug] [MainThread]: On master: BEGIN
[0m17:15:20.952875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:20.966253 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:20.968672 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:20.970632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:21.008332 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:15:21.012552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0303a6590>]}
[0m17:15:21.016246 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:21.018833 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:21.020919 [debug] [MainThread]: On master: BEGIN
[0m17:15:21.023735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.025874 [debug] [MainThread]: On master: COMMIT
[0m17:15:21.027712 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:21.029446 [debug] [MainThread]: On master: COMMIT
[0m17:15:21.031958 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:21.034354 [debug] [MainThread]: On master: Close
[0m17:15:21.036681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:21.038518 [info ] [MainThread]: 
[0m17:15:21.047466 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m17:15:21.048303 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m17:15:21.049084 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m17:15:21.050900 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m17:15:21.053077 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m17:15:21.055222 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m17:15:21.057338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m17:15:21.059448 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m17:15:21.061414 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m17:15:21.063358 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m17:15:21.065369 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m17:15:21.067310 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m17:15:21.075155 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m17:15:21.080231 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m17:15:21.084027 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m17:15:21.092925 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m17:15:21.093651 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m17:15:21.106281 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m17:15:21.145400 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m17:15:21.148282 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m17:15:21.153607 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m17:15:21.162893 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:15:21.164888 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:15:21.165764 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m17:15:21.167818 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m17:15:21.168874 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:15:21.169750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:21.171096 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:15:21.172940 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m17:15:21.177796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:21.192366 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.193369 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.195429 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:15:21.197600 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:15:21.199025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.201041 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m17:15:21.203081 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m17:15:21.205010 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:15:21.209580 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m17:15:21.221533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:15:21.222394 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:15:21.222993 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:15:21.235495 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:15:21.242578 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:15:21.250717 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:15:21.252930 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:15:21.255131 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:15:21.257278 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m17:15:21.261194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:21.261894 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:21.263810 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:21.269621 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:15:21.276969 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:15:21.283334 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:15:21.285361 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:15:21.287637 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:15:21.289744 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m17:15:21.293352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:21.295164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:21.296860 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:21.327884 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:15:21.326263 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:15:21.331409 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:15:21.333005 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:15:21.334883 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:15:21.336539 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:15:21.338135 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:15:21.340333 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:15:21.341871 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:15:21.361651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:21.363074 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:21.363797 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:21.372327 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m17:15:21.376438 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m17:15:21.380681 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m17:15:21.390571 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:15:21.392789 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:15:21.394903 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:15:21.396845 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:15:21.399388 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m17:15:21.402656 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m17:15:21.411135 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:15:21.412491 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:15:21.413123 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:15:21.417532 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m17:15:21.421163 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m17:15:21.424503 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m17:15:21.428733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd02d38b150>]}
[0m17:15:21.430946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd02d390490>]}
[0m17:15:21.433172 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd02c15b890>]}
[0m17:15:21.435675 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.37s]
[0m17:15:21.438369 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.37s]
[0m17:15:21.440831 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.37s]
[0m17:15:21.443645 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m17:15:21.445388 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m17:15:21.447007 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m17:15:21.449954 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:15:21.450706 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:15:21.452163 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:15:21.454987 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:15:21.456984 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m17:15:21.458381 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m17:15:21.460256 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m17:15:21.462180 [info ] [Thread-3 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m17:15:21.464524 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m17:15:21.467246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:15:21.469460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m17:15:21.471495 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m17:15:21.473257 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:15:21.474644 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:15:21.475961 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:15:21.477469 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:15:21.492567 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:15:21.498803 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:15:21.508997 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:15:21.584125 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:15:21.592765 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:15:21.594267 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:15:21.605776 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:15:21.613186 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:15:21.618376 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:15:21.618947 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:15:21.623033 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:15:21.631046 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:15:21.640037 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:15:21.641055 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:15:21.643193 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:15:21.644221 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m17:15:21.646596 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:15:21.647193 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:15:21.649427 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:15:21.651281 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:15:21.653340 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m17:15:21.655106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:21.657303 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:21.661007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:15:21.672809 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.675431 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:15:21.677253 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.678122 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m17:15:21.678952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.681412 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:15:21.683227 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.685646 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:15:21.687750 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:21.688791 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.690601 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:15:21.692565 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:15:21.700296 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m17:15:21.701019 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.702707 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m17:15:21.706587 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m17:15:21.707547 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.709598 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:15:21.713617 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.25s]
[0m17:15:21.717960 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:15:21.720571 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m17:15:21.722735 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:15:21.724915 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:15:21.726066 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.727147 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.26s]
[0m17:15:21.729104 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:15:21.731777 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.26s]
[0m17:15:21.735633 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m17:15:21.738291 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:15:21.740612 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m17:15:21.743129 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:15:21.745542 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m17:15:21.747126 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:15:21.749413 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m17:15:21.751457 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:15:21.754023 [info ] [Thread-3 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.28s]
[0m17:15:21.755580 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m17:15:21.757800 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:15:21.760214 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m17:15:21.762553 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:15:21.764541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m17:15:21.771475 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:15:21.772853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m17:15:21.774737 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:15:21.776166 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:15:21.778697 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:15:21.780239 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m17:15:21.790678 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:15:21.805666 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:15:21.807201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m17:15:21.809168 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:15:21.812630 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:15:21.818329 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:15:21.826227 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:15:21.830107 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:15:21.830771 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:15:21.836549 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:15:21.843540 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:15:21.845756 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:15:21.848164 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m17:15:21.849758 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:15:21.851518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:15:21.853458 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m17:15:21.854490 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:15:21.855144 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:15:21.858320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:21.863905 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:15:21.865680 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m17:15:21.870362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:21.872472 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.875612 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:15:21.877197 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m17:15:21.882300 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.885380 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.888736 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:15:21.889563 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:15:21.891644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.892483 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:15:21.895443 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:15:21.897183 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m17:15:21.899507 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:15:21.901242 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:21.903795 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.15s]
[0m17:15:21.905503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:15:21.907730 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m17:15:21.916838 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:15:21.919583 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.921918 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:15:21.925740 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:15:21.927714 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m17:15:21.930403 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m17:15:21.932248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m17:15:21.934918 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.17s]
[0m17:15:21.936608 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:15:21.939488 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:15:21.940959 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:21.952797 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:15:21.954472 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m17:15:21.956872 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:15:21.960128 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m17:15:21.962639 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m17:15:21.965078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.dim_customer)
[0m17:15:21.968307 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m17:15:21.973701 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m17:15:21.974700 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.975431 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:15:21.976771 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:21.980948 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m17:15:21.986019 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:15:21.989853 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m17:15:21.991810 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m17:15:21.994706 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m17:15:21.995400 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m17:15:21.997097 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.19s]
[0m17:15:21.999266 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.23s]
[0m17:15:22.024000 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:15:22.024759 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:15:22.032243 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m17:15:22.033920 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:15:22.035512 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m17:15:22.037137 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m17:15:22.040792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:15:22.042699 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m17:15:22.046089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.fct_revenue_daily)
[0m17:15:22.047950 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m17:15:22.053093 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.054036 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:15:22.056366 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m17:15:22.057293 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:22.058975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:15:22.060809 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:15:22.063865 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:22.068367 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m17:15:22.076102 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.078042 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:22.080479 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:15:22.081890 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m17:15:22.091433 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.093101 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m17:15:22.094714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:15:22.109271 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:22.110368 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:22.111669 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.115054 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m17:15:22.115881 [debug] [Thread-2 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m17:15:22.117333 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m17:15:22.119115 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m17:15:22.126014 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:15:22.128447 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.20s]
[0m17:15:22.129783 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m17:15:22.132215 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:15:22.135055 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:22.136776 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m17:15:22.142373 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:15:22.144117 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m17:15:22.145529 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:15:22.147403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m17:15:22.149740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:22.150679 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m17:15:22.159429 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:15:22.164609 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.166370 [debug] [Thread-3 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m17:15:22.166909 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:15:22.172791 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.174133 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:15:22.176087 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m17:15:22.179631 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m17:15:22.180472 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:22.185889 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.190504 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.193706 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m17:15:22.195829 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:22.196403 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:22.201799 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m17:15:22.205576 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:15:22.206207 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.211825 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:15:22.213065 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.214235 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m17:15:22.215622 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m17:15:22.217019 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:15:22.218427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:22.222868 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:22.228326 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m17:15:22.228893 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:15:22.230761 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:15:22.233883 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m17:15:22.235663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:22.236757 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m17:15:22.239348 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd03032bc50>]}
[0m17:15:22.241073 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.244499 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1006[0m in 0.27s]
[0m17:15:22.246891 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m17:15:22.248003 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:15:22.249663 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m17:15:22.254135 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m17:15:22.257397 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd02c0f2590>]}
[0m17:15:22.260086 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4326[0m in 0.21s]
[0m17:15:22.262442 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m17:15:22.264972 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:15:22.267363 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m17:15:22.269407 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m17:15:22.271298 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:15:22.277918 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:15:22.290539 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:15:22.294504 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:15:22.305175 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:15:22.307013 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m17:15:22.308515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:15:22.320996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:22.323033 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:15:22.325186 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m17:15:22.329546 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:22.330728 [debug] [Thread-1 (]: SQL status: SELECT 5717 in 0.0 seconds
[0m17:15:22.334016 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m17:15:22.341394 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.342959 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m17:15:22.343883 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m17:15:22.345431 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.08s]
[0m17:15:22.348577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:22.350444 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:15:22.356152 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.358736 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m17:15:22.360792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:15:22.364333 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:15:22.365716 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.367091 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:15:22.385650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:15:22.390275 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m17:15:22.392474 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:15:22.394150 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m17:15:22.418981 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:15:22.422361 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m17:15:22.424438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4545ba-c3e0-4bbf-9145-518a8f7ad2b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd02d401c50>]}
[0m17:15:22.426548 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5717[0m in 0.28s]
[0m17:15:22.428793 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m17:15:22.431941 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:15:22.433953 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m17:15:22.436142 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m17:15:22.438031 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:15:22.445611 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:15:22.458201 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:15:22.462511 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:15:22.473436 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:15:22.474851 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m17:15:22.475909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:15:22.488565 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:15:22.490925 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:15:22.493470 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m17:15:22.497515 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:22.500657 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m17:15:22.502465 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m17:15:22.504094 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.07s]
[0m17:15:22.507001 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:15:22.513257 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:22.515481 [debug] [MainThread]: On master: BEGIN
[0m17:15:22.517251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:22.533811 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:22.535568 [debug] [MainThread]: On master: COMMIT
[0m17:15:22.537296 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:22.539136 [debug] [MainThread]: On master: COMMIT
[0m17:15:22.541580 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:22.543496 [debug] [MainThread]: On master: Close
[0m17:15:22.545566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:22.547097 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m17:15:22.548600 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m17:15:22.550296 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m17:15:22.551897 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m17:15:22.553553 [info ] [MainThread]: 
[0m17:15:22.556026 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m17:15:22.561868 [debug] [MainThread]: Command end result
[0m17:15:22.644005 [info ] [MainThread]: 
[0m17:15:22.646114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:22.648195 [info ] [MainThread]: 
[0m17:15:22.650422 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m17:15:22.653221 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.268058, "process_user_time": 3.224164, "process_kernel_time": 0.623666, "process_mem_max_rss": "116144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:15:22.655605 [debug] [MainThread]: Command `dbt build` succeeded at 17:15:22.655452 after 4.27 seconds
[0m17:15:22.657123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0343dcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0343dc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0343dd410>]}
[0m17:15:22.658751 [debug] [MainThread]: Flushing usage events
[0m17:30:07.209741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ded5ba590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ded77ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ded77b810>]}


============================== 17:30:07.217053 | 816ebb4e-f9ef-4be1-b6e2-09a0e1a8110d ==============================
[0m17:30:07.217053 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:30:07.219605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:30:07.363023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '816ebb4e-f9ef-4be1-b6e2-09a0e1a8110d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ded473f50>]}
[0m17:30:07.885283 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g9ms_8c3'
[0m17:30:07.886929 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:30:08.068697 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:30:08.070775 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:30:08.160704 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:30:08.168030 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:30:14.979956 [info ] [MainThread]: Installed from version 1.3.1
[0m17:30:14.984727 [info ] [MainThread]: Up to date!
[0m17:30:14.989547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '816ebb4e-f9ef-4be1-b6e2-09a0e1a8110d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730deea261d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ded48ef90>]}
[0m17:30:14.995713 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.9129014, "process_user_time": 1.890223, "process_kernel_time": 0.814009, "process_mem_max_rss": "94632", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m17:30:14.999340 [debug] [MainThread]: Command `dbt deps` succeeded at 17:30:14.997826 after 7.92 seconds
[0m17:30:15.002380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ded608150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730ded5df350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730df13d8810>]}
[0m17:30:15.003833 [debug] [MainThread]: Flushing usage events
[0m17:30:20.224600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c115aeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c12fa4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c115f3410>]}


============================== 17:30:20.229500 | db4d240b-170c-44fe-85f9-3aa9012e155f ==============================
[0m17:30:20.229500 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:30:20.231952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:20.522416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c115f3a10>]}
[0m17:30:20.645675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c152c0e10>]}
[0m17:30:20.648480 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:30:20.715015 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:30:21.138229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:21.139356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:21.197491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0fa49c90>]}
[0m17:30:21.434906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0f7ace90>]}
[0m17:30:21.437388 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m17:30:21.444792 [info ] [MainThread]: 
[0m17:30:21.447792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:21.459590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:30:21.461043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:30:21.566653 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:30:21.567162 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:30:21.568258 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:30:21.569494 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:30:21.570766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:21.572084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:21.590510 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:30:21.591275 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:30:21.593412 [debug] [ThreadPool]: On list_db: Close
[0m17:30:21.596042 [debug] [ThreadPool]: On list_db: Close
[0m17:30:21.602290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m17:30:21.603568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m17:30:21.616321 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:30:21.620201 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:30:21.622108 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:30:21.623839 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:30:21.625645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:21.627530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:21.644189 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:30:21.648112 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:30:21.648949 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:30:21.651174 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:30:21.652870 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:30:21.654587 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:30:21.664092 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:30:21.668649 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:30:21.669346 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:30:21.671069 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:30:21.673682 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:30:21.681542 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:30:21.694290 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:21.696085 [debug] [MainThread]: On master: BEGIN
[0m17:30:21.697370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:21.712007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:21.714067 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:21.716007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:30:21.758654 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:30:21.761842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0f7ce1d0>]}
[0m17:30:21.764575 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:21.766753 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:21.768420 [debug] [MainThread]: On master: BEGIN
[0m17:30:21.770351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:21.773351 [debug] [MainThread]: On master: COMMIT
[0m17:30:21.775279 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:21.777166 [debug] [MainThread]: On master: COMMIT
[0m17:30:21.779567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:30:21.781761 [debug] [MainThread]: On master: Close
[0m17:30:21.784988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:21.791291 [info ] [MainThread]: 
[0m17:30:21.802820 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m17:30:21.804529 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m17:30:21.807002 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m17:30:21.812055 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m17:30:21.814535 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m17:30:21.822701 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m17:30:21.829611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m17:30:21.832413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m17:30:21.838512 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m17:30:21.841032 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m17:30:21.843207 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m17:30:21.847343 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m17:30:21.866374 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m17:30:21.874516 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m17:30:21.881127 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m17:30:21.891592 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m17:30:21.893560 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m17:30:21.906006 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m17:30:22.017616 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m17:30:22.029768 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m17:30:22.027650 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m17:30:22.039864 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:30:22.041789 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:30:22.043980 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m17:30:22.046306 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:30:22.047920 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m17:30:22.049673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:30:22.051654 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m17:30:22.053272 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:22.055764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:22.069419 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.071199 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.072196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.073244 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:30:22.074727 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:30:22.076277 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:30:22.078181 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m17:30:22.079896 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m17:30:22.081380 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m17:30:22.090336 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:30:22.091459 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:30:22.092241 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:30:22.101518 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:30:22.108457 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:30:22.118691 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:30:22.120526 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m17:30:22.122679 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:30:22.126425 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:30:22.129878 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:22.131797 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:22.133412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:22.139313 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:30:22.145023 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:30:22.151077 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:30:22.153019 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m17:30:22.154364 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:30:22.157035 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:30:22.159507 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:22.160081 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:22.162231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:22.185015 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:30:22.187226 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:30:22.191204 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:30:22.193058 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:30:22.194333 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:30:22.195459 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:30:22.196813 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:30:22.197839 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:30:22.199404 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:30:22.203495 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:22.204701 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:22.206468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:22.217669 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m17:30:22.222120 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m17:30:22.226332 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m17:30:22.236669 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:30:22.238319 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:30:22.240281 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:30:22.241571 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m17:30:22.242976 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m17:30:22.244638 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:30:22.250598 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:30:22.252057 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:30:22.252841 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:30:22.257114 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m17:30:22.259798 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m17:30:22.262999 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m17:30:22.266316 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0c29bb10>]}
[0m17:30:22.268368 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0f7de510>]}
[0m17:30:22.270582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c114f01d0>]}
[0m17:30:22.272662 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.43s]
[0m17:30:22.274489 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.44s]
[0m17:30:22.276787 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.44s]
[0m17:30:22.279218 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m17:30:22.281100 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m17:30:22.282539 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m17:30:22.284900 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:30:22.285722 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:30:22.287205 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:30:22.289229 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:30:22.290713 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m17:30:22.292464 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m17:30:22.294391 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m17:30:22.296306 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m17:30:22.298550 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m17:30:22.300549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m17:30:22.302585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m17:30:22.304671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m17:30:22.306386 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:30:22.307808 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:30:22.309231 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:30:22.310933 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:30:22.335049 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:30:22.349678 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:30:22.428519 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:30:22.436569 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:30:22.446724 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:30:22.448315 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:30:22.458035 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:30:22.469383 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:30:22.500817 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:30:22.502952 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:30:22.512553 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:30:22.523265 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:30:22.542885 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:30:22.547046 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:30:22.551684 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:30:22.553035 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m17:30:22.561512 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m17:30:22.562675 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:30:22.565041 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m17:30:22.569068 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:30:22.576565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:22.580123 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m17:30:22.585474 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:22.600190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:22.610618 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.612902 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.634867 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:30:22.642228 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:30:22.647374 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.657786 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m17:30:22.661217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.665469 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:22.669463 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:30:22.681154 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:30:22.694703 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m17:30:22.700505 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m17:30:22.708408 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:22.729305 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m17:30:22.730987 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:22.734897 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:22.749156 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m17:30:22.759916 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m17:30:22.764791 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m17:30:22.769306 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.47s]
[0m17:30:22.774056 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m17:30:22.776628 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m17:30:22.778796 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:30:22.781994 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:22.781257 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.48s]
[0m17:30:22.787437 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.49s]
[0m17:30:22.791149 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:30:22.795622 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m17:30:22.797706 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:30:22.799449 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:30:22.801607 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m17:30:22.803529 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m17:30:22.805390 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:30:22.807171 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:30:22.809147 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m17:30:22.811297 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.51s]
[0m17:30:22.813724 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m17:30:22.816020 [info ] [Thread-4 (]: 10 of 17 START test not_null_stg_customers_country ............................. [RUN]
[0m17:30:22.817860 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:30:22.820515 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:30:22.822873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m17:30:22.824753 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m17:30:22.837080 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:30:22.838477 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:30:22.840470 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:30:22.841786 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:30:22.844307 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m17:30:22.855331 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:30:22.863130 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:30:22.865578 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:30:22.867539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:30:22.874603 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:30:22.877660 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:30:22.893248 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:30:22.893929 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:30:22.896519 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:30:22.902925 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:30:22.902312 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:30:22.910565 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:30:22.911486 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:30:22.912958 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m17:30:22.920534 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:30:22.923333 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:22.928759 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:30:22.930070 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:30:22.932342 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m17:30:22.933709 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:30:22.935336 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m17:30:22.936995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:22.938393 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:30:22.939968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:22.941885 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.946508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:22.951048 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:30:22.956142 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m17:30:22.959536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.966543 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.969387 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:30:22.971030 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:22.972520 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:22.974097 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:30:22.976897 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:22.981749 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:30:22.983908 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:30:22.986029 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m17:30:22.997375 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:30:22.998381 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:30:23.000428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:23.002462 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.19s]
[0m17:30:23.003736 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:23.008762 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:30:23.009580 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:23.011379 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:30:23.014650 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m17:30:23.016826 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m17:30:23.020341 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:30:23.022564 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:30:23.024992 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m17:30:23.026518 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.20s]
[0m17:30:23.031074 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:30:23.032428 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_customers_customer_id ........................... [RUN]
[0m17:30:23.034456 [info ] [Thread-4 (]: 10 of 17 PASS not_null_stg_customers_country ................................... [[32mPASS[0m in 0.21s]
[0m17:30:23.036479 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:30:23.038858 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.17s]
[0m17:30:23.041194 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m17:30:23.043389 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:30:23.045259 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m17:30:23.047466 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:30:23.049029 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:30:23.050501 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m17:30:23.052165 [info ] [Thread-1 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m17:30:23.061788 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:30:23.063597 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m17:30:23.065534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.fct_marketing_attribution)
[0m17:30:23.068415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now model.api_bi_project.fct_revenue_daily)
[0m17:30:23.070244 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m17:30:23.072110 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m17:30:23.079531 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.085314 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.086191 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:30:23.094393 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:30:23.101636 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m17:30:23.103007 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m17:30:23.139931 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:30:23.152544 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.156754 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.157954 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:30:23.161907 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:23.166473 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.168306 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.170116 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m17:30:23.171914 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m17:30:23.173323 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:23.174562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:23.178532 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:23.181613 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:30:23.182927 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:30:23.188131 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:23.190996 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:30:23.192411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:23.193255 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:23.194627 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m17:30:23.196322 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.197951 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.200016 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.16s]
[0m17:30:23.204649 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m17:30:23.206363 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m17:30:23.208152 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:30:23.212896 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m17:30:23.214859 [info ] [Thread-2 (]: 15 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m17:30:23.217237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.dim_customer)
[0m17:30:23.219661 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m17:30:23.225342 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m17:30:23.238019 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m17:30:23.244274 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m17:30:23.258264 [debug] [Thread-4 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m17:30:23.265174 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:30:23.264731 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.267341 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m17:30:23.273701 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m17:30:23.275998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:23.278054 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:23.286304 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.287846 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m17:30:23.289829 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:23.301972 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:30:23.302776 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:23.304013 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.305331 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:30:23.307009 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:30:23.308819 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m17:30:23.316830 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:23.318486 [debug] [Thread-1 (]: SQL status: SELECT 5717 in 0.0 seconds
[0m17:30:23.323214 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m17:30:23.324162 [debug] [Thread-2 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m17:30:23.330470 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.337198 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:30:23.343592 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:30:23.345180 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m17:30:23.346815 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m17:30:23.348121 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m17:30:23.350667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:23.352865 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:23.357852 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.358701 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:30:23.364879 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:30:23.366299 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m17:30:23.369472 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m17:30:23.371238 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:30:23.373489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:23.374416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0e4b3e50>]}
[0m17:30:23.376804 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:23.380737 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:30:23.383011 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4326[0m in 0.31s]
[0m17:30:23.386804 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:30:23.388578 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.390211 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m17:30:23.391500 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:30:23.393000 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:30:23.396285 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:30:23.398022 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:30:23.401521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:23.400896 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m17:30:23.410086 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:23.412248 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m17:30:23.413774 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m17:30:23.418368 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m17:30:23.420671 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:30:23.422373 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:30:23.424359 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:30:23.425748 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m17:30:23.432978 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:30:23.434214 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m17:30:23.440014 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:30:23.443124 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m17:30:23.443978 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:30:23.445844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0fd0d0d0>]}
[0m17:30:23.448796 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m17:30:23.452500 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:30:23.451405 [info ] [Thread-1 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5717[0m in 0.38s]
[0m17:30:23.454633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4d240b-170c-44fe-85f9-3aa9012e155f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0c129950>]}
[0m17:30:23.461071 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:30:23.463094 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m17:30:23.465023 [info ] [Thread-2 (]: 15 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1006[0m in 0.24s]
[0m17:30:23.468278 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:30:23.469846 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m17:30:23.471364 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m17:30:23.475150 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m17:30:23.477117 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:30:23.478218 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:30:23.485484 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:30:23.486852 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m17:30:23.490125 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:23.499865 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:30:23.506256 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:30:23.508395 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:23.511433 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:30:23.513070 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m17:30:23.516998 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:23.519879 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m17:30:23.522097 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m17:30:23.524339 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:30:23.525976 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.11s]
[0m17:30:23.527340 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m17:30:23.530033 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:30:23.531814 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:23.548435 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:23.550675 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:30:23.552730 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m17:30:23.556782 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:30:23.560311 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m17:30:23.562160 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m17:30:23.564119 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.09s]
[0m17:30:23.566081 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:30:23.570912 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:23.572597 [debug] [MainThread]: On master: BEGIN
[0m17:30:23.573908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:23.589426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:23.591115 [debug] [MainThread]: On master: COMMIT
[0m17:30:23.592918 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:23.594596 [debug] [MainThread]: On master: COMMIT
[0m17:30:23.596734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:30:23.598326 [debug] [MainThread]: On master: Close
[0m17:30:23.600537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:23.602752 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m17:30:23.604680 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m17:30:23.606126 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m17:30:23.607444 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m17:30:23.608906 [info ] [MainThread]: 
[0m17:30:23.610486 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m17:30:23.617138 [debug] [MainThread]: Command end result
[0m17:30:23.825950 [info ] [MainThread]: 
[0m17:30:23.838252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:23.850511 [info ] [MainThread]: 
[0m17:30:23.855641 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m17:30:23.861105 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0340676, "process_user_time": 4.143069, "process_kernel_time": 0.673732, "process_mem_max_rss": "116520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:23.870378 [debug] [MainThread]: Command `dbt build` succeeded at 17:30:23.869794 after 5.04 seconds
[0m17:30:23.876306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c115fc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c0c281910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c153b0950>]}
[0m17:30:23.880252 [debug] [MainThread]: Flushing usage events
[0m17:45:08.816065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7c4fad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7c4fafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7c4fa710>]}


============================== 17:45:08.843894 | 3b3e88b1-9eb2-4330-993a-f238d59756f1 ==============================
[0m17:45:08.843894 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:45:08.846470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:09.016974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b3e88b1-9eb2-4330-993a-f238d59756f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7c4f9810>]}
[0m17:45:09.656804 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mranaf3o'
[0m17:45:09.658909 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:45:08.525911 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:45:08.528461 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:45:08.624499 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:45:08.632359 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:45:15.383483 [info ] [MainThread]: Installed from version 1.3.1
[0m17:45:15.385279 [info ] [MainThread]: Up to date!
[0m17:45:15.387681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b3e88b1-9eb2-4330-993a-f238d59756f1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7c39a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7dc6ff10>]}
[0m17:45:15.392084 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.039344, "process_user_time": 2.266285, "process_kernel_time": 0.866171, "process_mem_max_rss": "94444", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m17:45:15.393797 [debug] [MainThread]: Command `dbt deps` succeeded at 17:45:15.393621 after 8.04 seconds
[0m17:45:15.395155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7c54b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be7c548310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79be8032c7d0>]}
[0m17:45:15.396620 [debug] [MainThread]: Flushing usage events
[0m17:45:19.723767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af5107d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af5100290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af51013d0>]}


============================== 17:45:19.728646 | 1b86bede-5339-4958-82fb-11b527023b00 ==============================
[0m17:45:19.728646 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:45:19.730661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:19.968331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af5110490>]}
[0m17:45:20.038307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af8dd4cd0>]}
[0m17:45:20.041058 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:45:20.100945 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:45:21.884066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:21.885915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:21.944891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af5107850>]}
[0m17:45:22.157185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af32dc2d0>]}
[0m17:45:22.159377 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m17:45:22.165693 [info ] [MainThread]: 
[0m17:45:22.168585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:22.176677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:45:22.177994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:45:22.290500 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:45:22.291012 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:45:22.292743 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:45:22.294637 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:45:22.296911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:22.298503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:22.324468 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:45:22.325138 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:45:22.327511 [debug] [ThreadPool]: On list_db: Close
[0m17:45:22.330131 [debug] [ThreadPool]: On list_db: Close
[0m17:45:22.335743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m17:45:22.336961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m17:45:22.344486 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:45:22.348324 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:45:22.350199 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:45:22.352332 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:45:22.354605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:22.356689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:22.372974 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:45:22.374119 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:45:22.375576 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:45:22.377354 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:45:22.379341 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:45:22.381554 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:45:22.392433 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:45:22.393062 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:45:22.395711 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:45:22.398952 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:45:22.401837 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:45:22.403506 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:45:22.414637 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:22.416761 [debug] [MainThread]: On master: BEGIN
[0m17:45:22.418558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:22.431367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:22.433810 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:22.435700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:22.470643 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:45:22.473956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af379ab10>]}
[0m17:45:22.475994 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:22.478738 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:22.481275 [debug] [MainThread]: On master: BEGIN
[0m17:45:22.483648 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:22.485537 [debug] [MainThread]: On master: COMMIT
[0m17:45:22.487364 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:22.489299 [debug] [MainThread]: On master: COMMIT
[0m17:45:22.491612 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:22.493690 [debug] [MainThread]: On master: Close
[0m17:45:22.496288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:22.498077 [info ] [MainThread]: 
[0m17:45:22.507606 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m17:45:22.508330 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m17:45:22.508951 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m17:45:22.511130 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m17:45:22.514300 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m17:45:22.517051 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m17:45:22.519481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m17:45:22.522177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m17:45:22.525030 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m17:45:22.527548 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m17:45:22.530106 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m17:45:22.532442 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m17:45:22.543593 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m17:45:22.549896 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m17:45:22.553805 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m17:45:22.565189 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m17:45:22.566234 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m17:45:22.579653 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m17:45:22.638030 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m17:45:22.640854 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m17:45:22.646477 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m17:45:22.657520 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:45:22.658526 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:45:22.660470 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m17:45:22.661311 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:45:22.662942 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m17:45:22.664810 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:45:22.666880 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m17:45:22.668709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:22.672746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:22.684978 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:22.687487 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:45:22.688574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:22.690235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:22.691294 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m17:45:22.693632 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:45:22.695809 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:45:22.699516 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m17:45:22.701222 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m17:45:22.717444 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:22.718128 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:22.718761 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:22.741271 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:45:22.745895 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:45:22.753493 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:45:22.755715 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:45:22.758065 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:45:22.760025 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m17:45:22.763785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:22.765031 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:22.771452 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:45:22.772057 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:22.777964 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:45:22.779942 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:45:22.788042 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:45:22.789401 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:45:22.792747 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m17:45:22.793387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:22.795626 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:22.797207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:22.822217 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:45:22.822881 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:45:22.825595 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:45:22.827425 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:45:22.829318 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:45:22.831481 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:45:22.833968 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:45:22.835421 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:45:22.837015 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:45:22.842631 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:22.843573 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:22.844226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:22.854681 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m17:45:22.858696 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m17:45:22.862959 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m17:45:22.871714 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:45:22.873411 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:45:22.874978 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:45:22.876248 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m17:45:22.877461 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m17:45:22.878757 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:45:22.887268 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:22.888672 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:22.890212 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:22.895848 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m17:45:22.900093 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m17:45:22.903754 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m17:45:22.909322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af0617e50>]}
[0m17:45:22.911823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af1ffd7d0>]}
[0m17:45:22.914293 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af205a610>]}
[0m17:45:22.917057 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.39s]
[0m17:45:22.919873 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.39s]
[0m17:45:22.922727 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.39s]
[0m17:45:22.926050 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m17:45:22.928675 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m17:45:22.931386 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m17:45:22.935024 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:45:22.935537 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:45:22.936421 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:45:22.938222 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:45:22.940311 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m17:45:22.942571 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m17:45:22.944562 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m17:45:22.946408 [info ] [Thread-3 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m17:45:22.948737 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m17:45:22.950734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:45:22.952166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m17:45:22.953678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m17:45:22.955296 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:45:22.957153 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:45:22.959097 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:45:22.960492 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:45:22.979405 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:45:22.985224 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:45:22.997553 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:45:23.075791 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:45:23.084806 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:45:23.086133 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:45:23.087947 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:45:23.094448 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:45:23.109430 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:45:23.113506 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:45:23.118474 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:45:23.122185 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:45:23.132696 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:45:23.134179 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:45:23.135525 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:45:23.136380 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:45:23.137315 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:45:23.138734 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m17:45:23.140712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:23.142767 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:45:23.144514 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m17:45:23.146258 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:23.149666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:23.151723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:23.162974 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.165208 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:45:23.166953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.168735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.169671 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:23.172032 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:45:23.173753 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.175139 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:45:23.179063 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m17:45:23.181207 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:45:23.183105 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:45:23.183989 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.187597 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m17:45:23.189066 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.196505 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:45:23.197231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.201433 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m17:45:23.204375 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m17:45:23.206854 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:45:23.209117 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m17:45:23.210974 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.26s]
[0m17:45:23.213016 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:45:23.215226 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.27s]
[0m17:45:23.217915 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:45:23.219117 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.221555 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.27s]
[0m17:45:23.226361 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:45:23.228372 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:45:23.231594 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m17:45:23.233608 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:45:23.235455 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:45:23.237357 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m17:45:23.240060 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m17:45:23.241409 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:45:23.243322 [info ] [Thread-4 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m17:45:23.244983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m17:45:23.247646 [info ] [Thread-3 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.29s]
[0m17:45:23.249717 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m17:45:23.251704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m17:45:23.254180 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:45:23.256948 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:45:23.258899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m17:45:23.260516 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:45:23.273815 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:45:23.275976 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:45:23.279100 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:45:23.289831 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:45:23.293730 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m17:45:23.309808 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:45:23.311910 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:45:23.313705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m17:45:23.323325 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:45:23.325884 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:45:23.326983 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:45:23.328609 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:45:23.340252 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:45:23.344871 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:45:23.349709 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:45:23.350837 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:45:23.356692 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m17:45:23.358687 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:23.361915 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:45:23.364228 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m17:45:23.365722 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:45:23.366673 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:45:23.367899 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:23.369516 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m17:45:23.373751 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:45:23.375497 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.378635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:23.381837 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:45:23.385222 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m17:45:23.391662 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.393385 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.395051 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:45:23.396628 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:45:23.399983 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:45:23.401752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.403445 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:23.405451 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m17:45:23.407278 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:45:23.408546 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:45:23.411962 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:23.416370 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.17s]
[0m17:45:23.418014 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m17:45:23.423132 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:45:23.426677 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.427753 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:45:23.432486 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:45:23.434649 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m17:45:23.436926 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m17:45:23.438946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m17:45:23.439994 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.442589 [info ] [Thread-4 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.19s]
[0m17:45:23.444880 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:45:23.447624 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:45:23.449726 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:45:23.457113 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:45:23.458727 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m17:45:23.460562 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m17:45:23.465757 [info ] [Thread-4 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m17:45:23.467544 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.468968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.dim_customer)
[0m17:45:23.472188 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m17:45:23.474287 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m17:45:23.475712 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:45:23.477735 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m17:45:23.483632 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m17:45:23.484729 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.490271 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:45:23.493175 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.18s]
[0m17:45:23.498735 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m17:45:23.502568 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:45:23.504885 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m17:45:23.506342 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m17:45:23.507903 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m17:45:23.511487 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.25s]
[0m17:45:23.514492 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m17:45:23.523437 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:45:23.553853 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:45:23.553092 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m17:45:23.555771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.fct_revenue_daily)
[0m17:45:23.558283 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m17:45:23.563033 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m17:45:23.565184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:23.571227 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.575033 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:45:23.576627 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m17:45:23.578508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:23.586175 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m17:45:23.587918 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.595777 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.597589 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.599327 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:45:23.603842 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:45:23.606192 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:45:23.608203 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m17:45:23.615726 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.617325 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m17:45:23.619133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:23.632664 [debug] [Thread-4 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m17:45:23.646081 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.650656 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:45:23.652208 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.654170 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m17:45:23.657127 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m17:45:23.660726 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:23.661681 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.671230 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:45:23.675131 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m17:45:23.677228 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:45:23.679892 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m17:45:23.682283 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:23.684560 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.25s]
[0m17:45:23.695019 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:45:23.696792 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:45:23.698219 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:45:23.701027 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m17:45:23.701949 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:45:23.703578 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m17:45:23.706252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m17:45:23.708427 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m17:45:23.709333 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:23.718069 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.718979 [debug] [Thread-3 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m17:45:23.723033 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m17:45:23.731512 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.737756 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:45:23.739338 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m17:45:23.740894 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m17:45:23.741467 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m17:45:23.749599 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:23.748505 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.758429 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.759270 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:45:23.761659 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m17:45:23.765000 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m17:45:23.768420 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:23.770592 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af1ebbe90>]}
[0m17:45:23.780939 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:45:23.785115 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.784035 [info ] [Thread-4 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1006[0m in 0.30s]
[0m17:45:23.787423 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.789811 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m17:45:23.792762 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m17:45:23.795327 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:45:23.797392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:23.802465 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:23.808207 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m17:45:23.810032 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:45:23.811297 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m17:45:23.814729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.816658 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.818063 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m17:45:23.818780 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:45:23.823883 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m17:45:23.825772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af513dad0>]}
[0m17:45:23.828048 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4326[0m in 0.27s]
[0m17:45:23.832037 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m17:45:23.834982 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:45:23.836692 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m17:45:23.838751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m17:45:23.840617 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:45:23.849738 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:45:23.861245 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:45:23.866660 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:45:23.878839 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:45:23.880600 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m17:45:23.882143 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:23.898394 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:23.900738 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:45:23.902728 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m17:45:23.906647 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:23.910498 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m17:45:23.912862 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m17:45:23.915884 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.08s]
[0m17:45:23.919899 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:45:23.930146 [debug] [Thread-1 (]: SQL status: SELECT 5717 in 0.0 seconds
[0m17:45:23.939902 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.941481 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m17:45:23.945242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:23.951017 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.952894 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m17:45:23.955269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:23.958640 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:45:23.960102 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.961431 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:45:23.965852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:23.970535 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m17:45:23.972750 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:45:23.973875 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m17:45:23.981139 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:45:23.983983 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m17:45:23.986083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b86bede-5339-4958-82fb-11b527023b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af05f7690>]}
[0m17:45:23.988389 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5717[0m in 0.28s]
[0m17:45:23.990472 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m17:45:23.993931 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:45:23.995749 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m17:45:23.997662 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m17:45:23.999182 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:45:24.004826 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:45:24.017275 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:45:24.021117 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:45:24.034608 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:45:24.036124 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m17:45:24.037399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:24.052107 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:24.054156 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:45:24.056033 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m17:45:24.060705 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:24.063961 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m17:45:24.066166 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m17:45:24.068501 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.07s]
[0m17:45:24.070941 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:45:24.077178 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:24.078840 [debug] [MainThread]: On master: BEGIN
[0m17:45:24.080090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:24.095422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:24.097428 [debug] [MainThread]: On master: COMMIT
[0m17:45:24.098937 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:24.100342 [debug] [MainThread]: On master: COMMIT
[0m17:45:24.102428 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:24.104341 [debug] [MainThread]: On master: Close
[0m17:45:24.106131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:24.107630 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m17:45:24.108897 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m17:45:24.110758 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m17:45:24.112486 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m17:45:24.114205 [info ] [MainThread]: 
[0m17:45:24.115817 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m17:45:24.123329 [debug] [MainThread]: Command end result
[0m17:45:24.223849 [info ] [MainThread]: 
[0m17:45:24.226122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:24.228254 [info ] [MainThread]: 
[0m17:45:24.229973 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m17:45:24.232951 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.6121583, "process_user_time": 3.582604, "process_kernel_time": 0.623566, "process_mem_max_rss": "116772", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:45:24.234926 [debug] [MainThread]: Command `dbt build` succeeded at 17:45:24.234745 after 4.61 seconds
[0m17:45:24.236170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af53fcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af8ebc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af65ee1d0>]}
[0m17:45:24.237366 [debug] [MainThread]: Flushing usage events
[0m18:00:06.925098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72679c3028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72679c345c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72679c345b50>]}


============================== 18:00:06.931999 | cf0dd213-85fc-4987-9424-b7b6ce8c0838 ==============================
[0m18:00:06.931999 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:00:06.937489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:00:07.105127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf0dd213-85fc-4987-9424-b7b6ce8c0838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72679c20fbd0>]}
[0m18:00:07.670725 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ma3hqyak'
[0m18:00:07.672449 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:00:07.878428 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:00:07.881150 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:00:07.997372 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:00:08.007226 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:00:14.575956 [info ] [MainThread]: Installed from version 1.3.1
[0m18:00:14.578184 [info ] [MainThread]: Up to date!
[0m18:00:14.580200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cf0dd213-85fc-4987-9424-b7b6ce8c0838', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72679c3503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72679c216710>]}
[0m18:00:14.583948 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.7704453, "process_user_time": 2.157552, "process_kernel_time": 0.745054, "process_mem_max_rss": "94496", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m18:00:14.586546 [debug] [MainThread]: Command `dbt deps` succeeded at 18:00:14.586200 after 7.77 seconds
[0m18:00:14.588270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7267a01347d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7267a0290410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7267a0290d50>]}
[0m18:00:14.589792 [debug] [MainThread]: Flushing usage events
[0m18:00:20.678133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a326a2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a326a1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a326a2910>]}


============================== 18:00:20.689029 | cb662707-b597-4ebf-8026-7865ae54a475 ==============================
[0m18:00:20.689029 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:00:20.691310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:00:20.956685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a30db4150>]}
[0m18:00:21.058960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a363b4e10>]}
[0m18:00:21.061812 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:00:21.123247 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:00:23.019754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:23.021521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:23.080338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a30d66450>]}
[0m18:00:23.298661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a308a09d0>]}
[0m18:00:23.300389 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m18:00:23.307359 [info ] [MainThread]: 
[0m18:00:23.309961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:00:23.317139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:00:23.318287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:00:23.391448 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:00:23.392038 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:00:23.393680 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:00:23.396135 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:00:23.398091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:23.399538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:23.418744 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:00:23.420893 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:00:23.424826 [debug] [ThreadPool]: On list_db: Close
[0m18:00:23.427381 [debug] [ThreadPool]: On list_db: Close
[0m18:00:23.432817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m18:00:23.434520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m18:00:23.444939 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:00:23.449156 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:00:23.450982 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:00:23.452149 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:00:23.453112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:23.454495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:23.468599 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:00:23.469315 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:00:23.470791 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:00:23.472859 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:00:23.474640 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:00:23.476240 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:00:23.483903 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:00:23.484839 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:00:23.488094 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:00:23.491191 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:00:23.493253 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:00:23.494522 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:00:23.505675 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:23.507651 [debug] [MainThread]: On master: BEGIN
[0m18:00:23.509113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:23.522256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:23.523934 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:23.525604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:00:23.558421 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:00:23.563106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a30db5810>]}
[0m18:00:23.565380 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:23.568080 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:23.570295 [debug] [MainThread]: On master: BEGIN
[0m18:00:23.573329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:23.576732 [debug] [MainThread]: On master: COMMIT
[0m18:00:23.578927 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:23.581001 [debug] [MainThread]: On master: COMMIT
[0m18:00:23.583018 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:23.584951 [debug] [MainThread]: On master: Close
[0m18:00:23.587297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:23.589237 [info ] [MainThread]: 
[0m18:00:23.602044 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:00:23.602981 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:00:23.604032 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:00:23.605937 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m18:00:23.608725 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m18:00:23.612961 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m18:00:23.615315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m18:00:23.618420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m18:00:23.621713 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:00:23.623508 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:00:23.626327 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:00:23.628391 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:00:23.638998 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:00:23.645567 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:00:23.649714 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:00:23.658317 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:00:23.659342 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:00:23.666062 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:00:23.734257 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:00:23.736435 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:00:23.742137 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:00:23.752951 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:00:23.754229 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:00:23.755535 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:00:23.756894 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:00:23.758148 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:00:23.759918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:23.761479 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:00:23.762880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:23.765352 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:23.777673 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:23.779911 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:00:23.780799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:23.782221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:23.783044 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:00:23.785016 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:00:23.786820 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:00:23.797126 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:00:23.798346 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:00:23.799756 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:00:23.809754 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:00:23.813899 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m18:00:23.816174 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:00:23.817762 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:23.818515 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:00:23.823648 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:00:23.830500 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:00:23.837144 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:00:23.838781 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:00:23.840705 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:00:23.841973 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m18:00:23.844516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:23.845184 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:23.847092 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:23.851628 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:00:23.872702 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:00:23.876966 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:00:23.878720 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:00:23.880264 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:00:23.881640 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:00:23.884814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:23.885521 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:00:23.888617 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:23.890742 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:00:23.896492 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:00:23.897258 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:23.898820 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:00:23.901499 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:00:23.912979 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m18:00:23.914792 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:00:23.916893 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:00:23.929939 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:00:23.933542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:23.934943 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:23.935698 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m18:00:23.941226 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:00:23.947166 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m18:00:23.953334 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:00:23.954259 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:00:23.956339 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:00:23.957942 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:00:23.961635 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:00:23.963566 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m18:00:23.968174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a28aff210>]}
[0m18:00:23.968824 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:00:23.973679 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.35s]
[0m18:00:23.975252 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:00:23.978003 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:00:23.980513 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:00:23.982971 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:00:23.984919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a2b5e60d0>]}
[0m18:00:23.987337 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:00:23.988242 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:00:23.989735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a2b42f490>]}
[0m18:00:23.991806 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.37s]
[0m18:00:23.994150 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m18:00:23.996326 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m18:00:23.999017 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.37s]
[0m18:00:24.001505 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:00:24.003403 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m18:00:24.005212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m18:00:24.006933 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:00:24.008605 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:00:24.010099 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:00:24.011719 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:00:24.013491 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:00:24.015548 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m18:00:24.035910 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:00:24.047696 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:00:24.049637 [info ] [Thread-3 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m18:00:24.052115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m18:00:24.057575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m18:00:24.059987 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:00:24.062071 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:00:24.159218 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:00:24.160582 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:00:24.169287 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:00:24.189908 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:00:24.217854 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:00:24.221630 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:00:24.231204 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:00:24.242286 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:00:24.243822 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:00:24.245175 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:00:24.247014 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:00:24.254993 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:00:24.256830 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m18:00:24.259010 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m18:00:24.264160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:24.265956 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:00:24.270530 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:00:24.274921 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:00:24.276094 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m18:00:24.278890 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m18:00:24.280559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:24.282213 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:24.289228 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.292402 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.297782 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:00:24.299853 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:00:24.302177 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m18:00:24.304272 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m18:00:24.307405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.313840 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:00:24.315846 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.317043 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:24.318697 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.326178 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m18:00:24.326862 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.333967 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:00:24.336958 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m18:00:24.340300 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m18:00:24.341410 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.342451 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m18:00:24.344665 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.34s]
[0m18:00:24.346738 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m18:00:24.351387 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m18:00:24.354436 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:00:24.355549 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.357264 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.35s]
[0m18:00:24.361504 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m18:00:24.362801 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:00:24.366749 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m18:00:24.369280 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:00:24.372130 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.32s]
[0m18:00:24.374100 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m18:00:24.377114 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m18:00:24.378550 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:00:24.380390 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:00:24.383104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:00:24.385508 [info ] [Thread-3 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.33s]
[0m18:00:24.387009 [info ] [Thread-4 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m18:00:24.389271 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:00:24.391818 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:00:24.395173 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:00:24.397026 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m18:00:24.399697 [info ] [Thread-1 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m18:00:24.410577 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:00:24.412724 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:00:24.416976 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:00:24.419674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m18:00:24.424197 [info ] [Thread-3 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m18:00:24.436258 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:00:24.438502 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:00:24.440308 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:00:24.441701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m18:00:24.461065 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:00:24.470873 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:00:24.473701 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:00:24.475929 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:00:24.521970 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:00:24.523708 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:00:24.531935 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:00:24.533528 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:00:24.540563 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:00:24.543349 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m18:00:24.545251 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:00:24.549712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:24.552096 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:00:24.560456 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:00:24.565320 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:00:24.568854 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m18:00:24.574556 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m18:00:24.576438 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:24.578790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:24.584778 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.588130 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:00:24.589873 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:00:24.593308 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:00:24.595964 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:00:24.599784 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:24.601366 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.603136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.605853 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.617937 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m18:00:24.624537 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:00:24.629638 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.632600 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:00:24.637764 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m18:00:24.641662 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m18:00:24.646524 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:00:24.649660 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:24.653828 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.27s]
[0m18:00:24.659428 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m18:00:24.668201 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.674777 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:00:24.680894 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m18:00:24.681780 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.683412 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:00:24.692662 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:00:24.693822 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m18:00:24.699224 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:00:24.702461 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:00:24.705541 [info ] [Thread-4 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.31s]
[0m18:00:24.707996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m18:00:24.709918 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.711952 [info ] [Thread-3 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.27s]
[0m18:00:24.714978 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:00:24.717116 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:00:24.723697 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m18:00:24.726054 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:00:24.728300 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m18:00:24.742004 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:00:24.744493 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m18:00:24.746144 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m18:00:24.748803 [info ] [Thread-4 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m18:00:24.756021 [info ] [Thread-1 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.34s]
[0m18:00:24.763331 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m18:00:24.768367 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_revenue_daily)
[0m18:00:24.772518 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:00:24.775262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.dim_customer)
[0m18:00:24.780404 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m18:00:24.786564 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m18:00:24.789114 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:00:24.796574 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m18:00:24.806739 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m18:00:24.813876 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:00:24.822837 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m18:00:24.832741 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m18:00:24.858286 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:00:24.871786 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m18:00:24.874287 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m18:00:24.875505 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:00:24.879781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:24.886556 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:00:24.889178 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m18:00:24.890193 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:00:24.891460 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:24.893036 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m18:00:24.898672 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:24.901885 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.905810 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:00:24.908216 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:24.912350 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.917445 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:00:24.920121 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m18:00:24.921102 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:24.927542 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:00:24.929570 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m18:00:24.939268 [debug] [Thread-3 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m18:00:24.949768 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:00:24.951465 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m18:00:24.954615 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:24.961870 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:00:24.962519 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:24.963741 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m18:00:24.966451 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:00:24.969878 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:24.970944 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:00:24.979637 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:00:24.982088 [debug] [Thread-4 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m18:00:24.981465 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.27s]
[0m18:00:24.983630 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:00:24.992616 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:00:24.994396 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:00:24.996731 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:00:24.998071 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m18:00:25.000041 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m18:00:25.003565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:25.004569 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m18:00:25.013106 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.015279 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:00:25.017078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m18:00:25.022350 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m18:00:25.024781 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m18:00:25.026811 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m18:00:25.034654 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:00:25.037527 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:25.043487 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.045246 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m18:00:25.050153 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:00:25.057955 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:00:25.059572 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:00:25.061257 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:00:25.064942 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m18:00:25.069323 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a326e10d0>]}
[0m18:00:25.070454 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.075261 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1006[0m in 0.29s]
[0m18:00:25.077230 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m18:00:25.085949 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m18:00:25.088741 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m18:00:25.096799 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.098841 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:00:25.104476 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m18:00:25.111674 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:00:25.116199 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m18:00:25.117300 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.120255 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a28b595d0>]}
[0m18:00:25.122140 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m18:00:25.124971 [info ] [Thread-4 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4326[0m in 0.35s]
[0m18:00:25.128396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:25.131012 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m18:00:25.135011 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:00:25.138667 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m18:00:25.142117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m18:00:25.144059 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:00:25.157457 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:00:25.160141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:25.164625 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.167682 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m18:00:25.181757 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:00:25.195263 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:00:25.210173 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:00:25.211892 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m18:00:25.214221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:25.239421 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:25.243495 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:00:25.245719 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m18:00:25.252524 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:25.257112 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m18:00:25.259947 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m18:00:25.262311 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.12s]
[0m18:00:25.267802 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:00:25.298480 [debug] [Thread-1 (]: SQL status: SELECT 5717 in 0.0 seconds
[0m18:00:25.306781 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.308407 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m18:00:25.311804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:25.321448 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.323210 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m18:00:25.325284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:25.328734 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:00:25.330612 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.334626 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:00:25.341668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.348578 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m18:00:25.351584 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:00:25.352995 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m18:00:25.357680 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:00:25.361064 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m18:00:25.363865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb662707-b597-4ebf-8026-7865ae54a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a2b4e3490>]}
[0m18:00:25.366592 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5717[0m in 0.35s]
[0m18:00:25.368997 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m18:00:25.372972 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:00:25.374836 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m18:00:25.377215 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m18:00:25.379473 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:00:25.387061 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:00:25.400477 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:00:25.406187 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:00:25.418319 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:00:25.419801 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m18:00:25.421213 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:25.436906 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:25.438885 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:00:25.440985 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m18:00:25.445692 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:25.449174 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m18:00:25.451150 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m18:00:25.452783 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.08s]
[0m18:00:25.454702 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:00:25.460549 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.462056 [debug] [MainThread]: On master: BEGIN
[0m18:00:25.463188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:25.479795 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:25.482033 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.483777 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.486002 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.488046 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.489533 [debug] [MainThread]: On master: Close
[0m18:00:25.491996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:25.494146 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m18:00:25.495557 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m18:00:25.496802 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m18:00:25.498133 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m18:00:25.499991 [info ] [MainThread]: 
[0m18:00:25.502777 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m18:00:25.509394 [debug] [MainThread]: Command end result
[0m18:00:25.602584 [info ] [MainThread]: 
[0m18:00:25.605313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:25.608131 [info ] [MainThread]: 
[0m18:00:25.610232 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m18:00:25.613301 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0680456, "process_user_time": 4.215116, "process_kernel_time": 0.825036, "process_mem_max_rss": "116724", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:00:25.615525 [debug] [MainThread]: Command `dbt build` succeeded at 18:00:25.615097 after 5.07 seconds
[0m18:00:25.617839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a364a48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a36600490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796a36600ed0>]}
[0m18:00:25.619208 [debug] [MainThread]: Flushing usage events
[0m18:15:12.698177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82886c66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828879c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82886c6490>]}


============================== 18:15:12.706153 | 389e063c-8d33-45d3-8b83-4ffc39ffa0cf ==============================
[0m18:15:12.706153 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:15:12.708220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:15:12.948643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '389e063c-8d33-45d3-8b83-4ffc39ffa0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8288543090>]}
[0m18:15:13.768188 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n2kxd533'
[0m18:15:13.770953 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:15:13.971122 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:15:13.973604 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:15:14.068567 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:15:14.078862 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:15:23.469933 [info ] [MainThread]: Installed from version 1.3.1
[0m18:15:23.473966 [info ] [MainThread]: Up to date!
[0m18:15:23.476563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '389e063c-8d33-45d3-8b83-4ffc39ffa0cf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8289ba1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8288737910>]}
[0m18:15:23.482576 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 10.904924, "process_user_time": 4.486568, "process_kernel_time": 1.398197, "process_mem_max_rss": "94300", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m18:15:23.486699 [debug] [MainThread]: Command `dbt deps` succeeded at 18:15:23.486291 after 10.91 seconds
[0m18:15:23.490169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82885d32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828c4b06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828c634e90>]}
[0m18:15:23.492586 [debug] [MainThread]: Flushing usage events
[0m18:15:30.693146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641d682b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641d8540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641d682890>]}


============================== 18:15:30.702522 | e7004115-ccc2-4ff3-90e8-25d4c727949a ==============================
[0m18:15:30.702522 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:15:30.706651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:31.103641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641d5d5d90>]}
[0m18:15:31.240559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e64213a0790>]}
[0m18:15:31.243015 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:15:31.330951 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:15:33.753023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:33.754527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:33.825612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641bd896d0>]}
[0m18:15:34.156008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641b894950>]}
[0m18:15:34.158527 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m18:15:34.171308 [info ] [MainThread]: 
[0m18:15:34.176827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:15:34.200221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:15:34.202116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:15:34.307068 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:15:34.308011 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:15:34.310322 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:15:34.318780 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:15:34.330415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.339389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.371941 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:15:34.373301 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:15:34.376203 [debug] [ThreadPool]: On list_db: Close
[0m18:15:34.382351 [debug] [ThreadPool]: On list_db: Close
[0m18:15:34.392149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m18:15:34.393712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m18:15:34.415383 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:15:34.425268 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:15:34.429898 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:15:34.438922 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:15:34.443093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:34.447378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:34.472084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:15:34.475164 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:15:34.476330 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:15:34.479388 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:15:34.482668 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:15:34.488118 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:15:34.500293 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:15:34.504147 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:15:34.510079 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:15:34.517885 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:15:34.523937 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:15:34.526225 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:15:34.553934 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.556933 [debug] [MainThread]: On master: BEGIN
[0m18:15:34.560180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:34.585398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:15:34.591383 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.595804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:15:34.717534 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:15:34.725585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641b897ed0>]}
[0m18:15:34.734081 [debug] [MainThread]: On master: ROLLBACK
[0m18:15:34.739018 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.742068 [debug] [MainThread]: On master: BEGIN
[0m18:15:34.745380 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:15:34.751900 [debug] [MainThread]: On master: COMMIT
[0m18:15:34.754647 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.757681 [debug] [MainThread]: On master: COMMIT
[0m18:15:34.765078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:15:34.768858 [debug] [MainThread]: On master: Close
[0m18:15:34.771694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:34.777811 [info ] [MainThread]: 
[0m18:15:34.802618 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:15:34.804034 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:15:34.805390 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:15:34.808735 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m18:15:34.816748 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m18:15:34.824138 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m18:15:34.831121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m18:15:34.834743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m18:15:34.839525 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:15:34.842006 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:15:34.846311 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:15:34.848842 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:15:34.877869 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:15:34.881174 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:15:34.888925 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:15:34.900149 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:15:34.906041 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:15:34.913620 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:15:35.073474 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:15:35.077282 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:15:35.081760 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:15:35.098528 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:15:35.099867 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:15:35.101768 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:15:35.102709 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:15:35.105362 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:15:35.108386 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:35.110274 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:15:35.112613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:35.118394 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:15:35.133835 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:35.136194 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:15:35.138049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:35.139319 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:15:35.145183 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:35.146451 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:15:35.156936 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:15:35.160845 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:15:35.161955 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:15:35.163725 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:15:35.172323 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:15:35.204039 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:15:35.221730 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:15:35.226261 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:15:35.230607 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m18:15:35.252364 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:15:35.258439 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:15:35.261542 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:35.265837 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m18:15:35.275308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:35.280014 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:15:35.290298 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:35.292411 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:15:35.295182 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:15:35.303464 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:15:35.305575 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:15:35.310248 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:35.312956 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:15:35.317347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:35.347083 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:15:35.348952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:35.352088 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:15:35.354915 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:15:35.359913 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:15:35.362177 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:15:35.364366 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:15:35.366493 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:15:35.369566 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:15:35.374733 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:15:35.375707 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:15:35.383348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:15:35.390099 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:15:35.400819 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m18:15:35.407330 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:15:35.415836 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m18:15:35.430410 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:15:35.433037 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:15:35.435323 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:15:35.436840 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m18:15:35.439234 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:15:35.441556 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m18:15:35.445885 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:15:35.451246 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:15:35.458037 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:15:35.459214 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:15:35.463049 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:15:35.469197 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:15:35.473782 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e64183a2950>]}
[0m18:15:35.477586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641a5bb390>]}
[0m18:15:35.479558 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641a63a210>]}
[0m18:15:35.487741 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.64s]
[0m18:15:35.491238 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.65s]
[0m18:15:35.494454 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.64s]
[0m18:15:35.496455 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:15:35.498414 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:15:35.501695 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:15:35.505115 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:15:35.505956 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:15:35.506580 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:15:35.509684 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:15:35.512421 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m18:15:35.514546 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m18:15:35.520247 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m18:15:35.522489 [info ] [Thread-3 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m18:15:35.524550 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m18:15:35.527749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m18:15:35.530221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m18:15:35.533572 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m18:15:35.536616 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:15:35.538203 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:15:35.539626 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:15:35.540944 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:15:35.582585 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:15:35.588538 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:15:35.713232 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:15:35.722676 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:15:35.738631 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:15:35.739973 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:15:35.748982 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:15:35.749879 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:15:35.793545 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:15:35.808932 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:15:35.815120 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:15:35.822374 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:15:35.837874 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:15:35.838961 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:15:35.843161 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m18:15:35.844789 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:15:35.845983 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:15:35.847259 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m18:15:35.849790 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:35.852845 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m18:15:35.854363 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m18:15:35.855819 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:35.861060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:35.863471 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:15:35.874746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:35.879763 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:15:35.881587 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m18:15:35.883636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:35.884633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:35.888104 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:15:35.889049 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:35.890743 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:15:35.892831 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:35.895044 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m18:15:35.903951 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m18:15:35.905738 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:35.907971 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:15:35.912865 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m18:15:35.914017 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:35.915960 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m18:15:35.920475 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.39s]
[0m18:15:35.925826 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m18:15:35.930094 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:15:35.932658 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m18:15:35.934533 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:15:35.935413 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:35.936480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:35.939248 [info ] [Thread-3 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.41s]
[0m18:15:35.941222 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m18:15:35.946221 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m18:15:35.951699 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m18:15:35.954754 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:15:35.957132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:15:35.959162 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m18:15:35.960508 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m18:15:35.961621 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:15:35.963991 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:15:35.966833 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.44s]
[0m18:15:35.969242 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.44s]
[0m18:15:35.971232 [info ] [Thread-3 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m18:15:35.983269 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:15:35.985920 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:15:35.988552 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:15:35.990949 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m18:15:35.994183 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:15:35.996130 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:15:35.998970 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:15:36.001312 [info ] [Thread-4 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m18:15:36.003699 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m18:15:36.013362 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:15:36.018588 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:15:36.020979 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m18:15:36.023738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m18:15:36.056871 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:15:36.071239 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:15:36.075157 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:15:36.188869 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:15:36.211444 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:15:36.214189 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:15:36.216235 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:15:36.240904 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:15:36.259094 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m18:15:36.301402 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:15:36.307966 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:15:36.321414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:36.346825 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:15:36.385306 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:15:36.392284 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:15:36.405871 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m18:15:36.414396 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:36.416939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:36.424499 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:15:36.443919 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:15:36.457965 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:15:36.469483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:36.471053 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m18:15:36.476899 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:15:36.487179 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:15:36.488929 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:36.493315 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:15:36.495666 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:15:36.501897 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:36.508315 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m18:15:36.512636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:36.529524 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:36.530799 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m18:15:36.532244 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:36.541014 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m18:15:36.547085 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.59s]
[0m18:15:36.552497 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:15:36.555289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:36.556349 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m18:15:36.560354 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:15:36.562615 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m18:15:36.564265 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:15:36.568428 [info ] [Thread-3 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.58s]
[0m18:15:36.574646 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:15:36.585113 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m18:15:36.588247 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:15:36.590027 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:15:36.595346 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m18:15:36.597200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:36.598666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m18:15:36.601561 [info ] [Thread-3 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m18:15:36.607009 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:15:36.609288 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:15:36.611232 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:36.613803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_revenue_daily)
[0m18:15:36.616656 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:15:36.635795 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:15:36.641874 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m18:15:36.644148 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m18:15:36.647133 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.62s]
[0m18:15:36.652029 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m18:15:36.662618 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m18:15:36.664780 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:15:36.669817 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:15:36.668484 [info ] [Thread-4 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.65s]
[0m18:15:36.675062 [debug] [Thread-1 (]: Began running node model.api_bi_project.dim_customer
[0m18:15:36.686106 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:15:36.688599 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:15:36.691455 [info ] [Thread-1 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m18:15:36.692603 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m18:15:36.698239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.dim_customer)
[0m18:15:36.725795 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.dim_customer
[0m18:15:36.737469 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:15:36.763983 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m18:15:36.763429 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m18:15:36.765828 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:15:36.771371 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:36.785576 [debug] [Thread-1 (]: Began executing node model.api_bi_project.dim_customer
[0m18:15:36.788703 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:15:36.807919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:36.820520 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m18:15:36.822674 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m18:15:36.824869 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:15:36.835202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:36.841487 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:36.872949 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:36.887832 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:15:36.895422 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m18:15:36.921917 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:15:36.927865 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: BEGIN
[0m18:15:36.937468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:36.957325 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:36.964581 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:15:36.978573 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:15:36.983419 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.38s]
[0m18:15:36.986612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:36.997768 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:15:37.000331 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:15:37.003716 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m18:15:37.006064 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m18:15:37.009036 [info ] [Thread-4 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m18:15:37.023479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.fct_marketing_attribution)
[0m18:15:37.026143 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m18:15:37.042897 [debug] [Thread-1 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m18:15:37.044037 [debug] [Thread-3 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m18:15:37.039100 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m18:15:37.060628 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:15:37.069067 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:15:37.076437 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m18:15:37.080469 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m18:15:37.089164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:37.096405 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:37.116968 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:15:37.139070 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:15:37.158067 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m18:15:37.164486 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m18:15:37.179636 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m18:15:37.205921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:37.245233 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m18:15:37.268629 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:37.313440 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:15:37.373120 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:15:37.386681 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:15:37.412860 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:15:37.452369 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:15:37.471801 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:15:37.507586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:15:37.516209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:15:37.523447 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:15:37.535594 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m18:15:37.545876 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m18:15:37.550300 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m18:15:37.583386 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:15:37.590250 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:15:37.601647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:15:37.611910 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m18:15:37.614368 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m18:15:37.628242 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:15:37.633974 [debug] [Thread-1 (]: On model.api_bi_project.dim_customer: Close
[0m18:15:37.635097 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:15:37.637705 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:37.647090 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m18:15:37.648957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641e3684d0>]}
[0m18:15:37.657383 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:15:37.717440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641bd99210>]}
[0m18:15:37.726268 [info ] [Thread-1 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1006[0m in 0.95s]
[0m18:15:37.741627 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m18:15:37.745019 [info ] [Thread-3 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4326[0m in 1.10s]
[0m18:15:37.749027 [debug] [Thread-1 (]: Finished running node model.api_bi_project.dim_customer
[0m18:15:37.752112 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m18:15:37.757609 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:15:37.760214 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m18:15:37.766673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m18:15:37.769046 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:15:37.798255 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:15:37.823573 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:15:37.836529 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:15:37.849956 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:15:37.853669 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m18:15:37.856017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:37.888163 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:37.892445 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:15:37.901311 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m18:15:37.921814 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:37.929532 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m18:15:37.935088 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m18:15:37.938370 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.17s]
[0m18:15:38.018046 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:15:38.021318 [debug] [Thread-4 (]: SQL status: SELECT 5717 in 0.0 seconds
[0m18:15:38.055612 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:15:38.068316 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m18:15:38.094918 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:38.151155 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:15:38.190028 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m18:15:38.211426 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:15:38.227571 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:15:38.233828 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:15:38.239396 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:15:38.252777 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:15:38.276763 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m18:15:38.295035 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:15:38.309082 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m18:15:38.337582 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:15:38.362247 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m18:15:38.368183 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7004115-ccc2-4ff3-90e8-25d4c727949a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641d783c90>]}
[0m18:15:38.383256 [info ] [Thread-4 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5717[0m in 1.34s]
[0m18:15:38.393260 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m18:15:38.405970 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:15:38.427333 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m18:15:38.447349 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m18:15:38.472907 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:15:38.533261 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:15:38.657482 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:15:38.690881 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:15:38.756139 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:15:38.764938 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m18:15:38.776218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:38.806789 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:15:38.830994 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:15:38.844291 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m18:15:38.870623 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:15:38.902797 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m18:15:38.925602 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m18:15:39.031643 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.58s]
[0m18:15:39.050627 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:15:39.155226 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:39.282318 [debug] [MainThread]: On master: BEGIN
[0m18:15:39.443003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:39.495792 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:15:39.570674 [debug] [MainThread]: On master: COMMIT
[0m18:15:39.597509 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:39.605358 [debug] [MainThread]: On master: COMMIT
[0m18:15:39.615149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:15:39.632588 [debug] [MainThread]: On master: Close
[0m18:15:39.674057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:39.757708 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m18:15:39.787909 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m18:15:39.798067 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m18:15:39.832144 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m18:15:39.873212 [info ] [MainThread]: 
[0m18:15:39.898903 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m18:15:39.964363 [debug] [MainThread]: Command end result
[0m18:15:40.614971 [info ] [MainThread]: 
[0m18:15:40.627555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:40.636917 [info ] [MainThread]: 
[0m18:15:40.643892 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m18:15:40.661314 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.093741, "process_user_time": 6.599056, "process_kernel_time": 1.140921, "process_mem_max_rss": "116720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:15:40.716715 [debug] [MainThread]: Command `dbt build` succeeded at 18:15:40.716208 after 10.15 seconds
[0m18:15:40.754915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e642157fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6421488810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e641d677d10>]}
[0m18:15:40.775571 [debug] [MainThread]: Flushing usage events
[0m15:58:01.910700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794dfddb9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794dfdd76710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794dfddbaed0>]}


============================== 15:58:01.919020 | ac2e18a6-de8f-4543-a96b-ae8c953fa032 ==============================
[0m15:58:01.919020 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:58:01.921082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:02.163905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2e18a6-de8f-4543-a96b-ae8c953fa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794dfdc02310>]}
[0m15:58:02.800568 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1uo4u4zw'
[0m15:58:02.802446 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:58:03.442693 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:58:03.452346 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:58:03.741887 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:58:03.748752 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:58:22.524789 [info ] [MainThread]: Installed from version 1.3.1
[0m15:58:22.526952 [info ] [MainThread]: Up to date!
[0m15:58:22.529610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ac2e18a6-de8f-4543-a96b-ae8c953fa032', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794dff255a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794dfdc756d0>]}
[0m15:58:22.534701 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 20.916763, "process_user_time": 3.799298, "process_kernel_time": 2.096828, "process_mem_max_rss": "94236", "process_in_blocks": "92904", "process_out_blocks": "168"}
[0m15:58:22.547897 [debug] [MainThread]: Command `dbt deps` succeeded at 15:58:22.547405 after 20.93 seconds
[0m15:58:22.552063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794e01b606d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794e01ce4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794e01ce4cd0>]}
[0m15:58:22.562756 [debug] [MainThread]: Flushing usage events
[0m15:58:31.205778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df830627d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df8323c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df8322bc90>]}


============================== 15:58:31.214539 | 20b27a7e-49e0-4da6-95be-9835e617865b ==============================
[0m15:58:31.214539 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:58:31.218022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:31.701749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df81736f90>]}
[0m15:58:31.817634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df86da4710>]}
[0m15:58:31.820467 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:58:31.949448 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:58:38.063818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:38.069384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:38.214534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df81567290>]}
[0m15:58:38.899265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df8498d690>]}
[0m15:58:38.902224 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m15:58:38.904308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df81778510>]}
[0m15:58:38.914149 [info ] [MainThread]: 
[0m15:58:38.918570 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:38.936079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:58:38.938525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:58:39.174921 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:58:39.176176 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:58:39.219521 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:58:39.235983 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:58:39.252759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:39.302294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:39.477798 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:58:39.485291 [debug] [ThreadPool]: On list_db: Close
[0m15:58:39.486367 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:58:39.498672 [debug] [ThreadPool]: On list_db: Close
[0m15:58:39.511238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m15:58:39.516251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m15:58:39.577541 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m15:58:39.579543 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m15:58:39.582118 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m15:58:39.589073 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m15:58:39.596751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:39.604752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:39.627245 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:58:39.629858 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:58:39.633284 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m15:58:39.635798 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m15:58:39.641946 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:58:39.645213 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m15:58:39.709734 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:58:39.711342 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:58:39.724833 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m15:58:39.732401 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m15:58:39.735054 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m15:58:39.739347 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m15:58:39.766313 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:39.770010 [debug] [MainThread]: On master: BEGIN
[0m15:58:39.771675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:39.796874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:39.803623 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:39.812252 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:40.013467 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m15:58:40.018667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df80155390>]}
[0m15:58:40.022215 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:40.025298 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:40.027736 [debug] [MainThread]: On master: BEGIN
[0m15:58:40.030749 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:40.034702 [debug] [MainThread]: On master: COMMIT
[0m15:58:40.039110 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:40.041605 [debug] [MainThread]: On master: COMMIT
[0m15:58:40.045475 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:40.049086 [debug] [MainThread]: On master: Close
[0m15:58:40.052565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:40.059775 [info ] [MainThread]: 
[0m15:58:40.087096 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m15:58:40.089237 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m15:58:40.090510 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m15:58:40.094707 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m15:58:40.119179 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m15:58:40.131726 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m15:58:40.140156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m15:58:40.190381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m15:58:40.259073 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m15:58:40.388032 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m15:58:40.430294 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m15:58:40.490414 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m15:58:40.555510 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m15:58:40.569392 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m15:58:40.820974 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m15:58:41.296802 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m15:58:41.297973 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m15:58:41.420692 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m15:58:41.644147 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m15:58:41.652390 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m15:58:41.670560 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m15:58:41.791565 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:58:41.816516 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:58:41.820223 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m15:58:41.829982 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:58:41.836508 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m15:58:41.873767 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:41.882125 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m15:58:41.909223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.050849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:42.070752 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:42.120854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:42.140503 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:58:42.191540 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:58:42.213337 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:42.232179 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m15:58:42.241479 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m15:58:42.269919 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:58:42.308699 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m15:58:42.478189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:42.479321 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:42.512043 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:42.614098 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:58:42.633582 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:58:42.650162 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:58:42.661223 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:58:42.683854 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m15:58:42.692248 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m15:58:42.700721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:42.793139 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:42.826885 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:42.840477 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:58:42.893840 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:58:42.924312 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:58:42.930242 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:58:42.961682 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m15:58:42.978902 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m15:58:42.991142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:42.993474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:43.002964 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:43.147790 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m15:58:43.149691 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m15:58:43.150402 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m15:58:43.190534 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:58:43.201418 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:58:43.211431 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:58:43.216634 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m15:58:43.224715 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m15:58:43.227632 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m15:58:43.239497 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:43.243551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:43.265654 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:43.290239 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m15:58:43.315761 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m15:58:43.327229 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m15:58:43.355072 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:58:43.358017 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:58:43.362909 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:58:43.368900 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m15:58:43.371736 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m15:58:43.376605 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m15:58:43.387070 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:43.388204 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:43.389163 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:43.397288 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m15:58:43.402523 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m15:58:43.410525 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m15:58:43.419305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df801cf690>]}
[0m15:58:43.426681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df86d7b2d0>]}
[0m15:58:43.432733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df801e2ad0>]}
[0m15:58:43.444052 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 3.22s]
[0m15:58:43.454940 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 3.17s]
[0m15:58:43.460624 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 3.29s]
[0m15:58:43.467899 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m15:58:43.472887 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m15:58:43.478081 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m15:58:43.483166 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m15:58:43.494939 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m15:58:43.499726 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m15:58:43.507532 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m15:58:43.516369 [info ] [Thread-2 (]: 5 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m15:58:43.529855 [info ] [Thread-3 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m15:58:43.541275 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_revenue_daily'
[0m15:58:43.545244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m15:58:43.553939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.dim_customer)
[0m15:58:43.560293 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m15:58:43.565962 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m15:58:43.588027 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m15:58:43.610553 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m15:58:43.635682 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m15:58:43.645860 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m15:58:43.858394 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m15:58:43.859992 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m15:58:43.886447 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m15:58:43.994545 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m15:58:44.003030 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m15:58:44.004277 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m15:58:44.124973 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:58:44.176443 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m15:58:44.186467 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:58:44.193255 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:44.247448 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m15:58:44.252734 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:58:44.257529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:44.262661 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m15:58:44.279977 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:44.281214 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.284841 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:58:44.291634 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.292600 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m15:58:44.316958 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.337789 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:58:44.358647 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:58:44.367642 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m15:58:44.391387 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m15:58:44.496824 [debug] [Thread-3 (]: SQL status: SELECT 1006 in 0.0 seconds
[0m15:58:44.526079 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:58:44.571238 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m15:58:44.604411 [debug] [Thread-4 (]: SQL status: SELECT 4326 in 0.0 seconds
[0m15:58:44.611738 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.650989 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:58:45.258044 [debug] [Thread-2 (]: SQL status: SELECT 5717 in 1.0 seconds
[0m15:58:45.271230 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:58:45.335421 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m15:58:45.446480 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:58:45.569805 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m15:58:45.619864 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:45.637160 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m15:58:45.826154 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:46.148569 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:58:46.171932 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:46.251589 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m15:58:46.259669 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m15:58:46.323792 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:58:46.337764 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:58:46.359647 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:46.373745 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m15:58:46.377572 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m15:58:46.398858 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m15:58:46.407954 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:46.420061 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:58:46.425696 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m15:58:46.432445 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m15:58:46.468387 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:58:46.590783 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:46.607485 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m15:58:46.609828 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:46.643625 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m15:58:46.685520 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:46.761576 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m15:58:46.809211 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:58:46.857286 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m15:58:46.971465 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:58:47.009688 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m15:58:47.058300 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:58:47.061028 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m15:58:47.096442 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m15:58:47.102150 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:47.111629 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m15:58:47.115820 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:47.118158 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:47.124181 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df79766dd0>]}
[0m15:58:47.133363 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m15:58:47.140907 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m15:58:47.152514 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1006[0m in 3.57s]
[0m15:58:47.164751 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df80050fd0>]}
[0m15:58:47.178476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b27a7e-49e0-4da6-95be-9835e617865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df79775550>]}
[0m15:58:47.190370 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m15:58:47.197690 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4326[0m in 3.62s]
[0m15:58:47.216957 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5717[0m in 3.63s]
[0m15:58:47.227964 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m15:58:47.250548 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m15:58:47.264852 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:47.277024 [debug] [MainThread]: On master: BEGIN
[0m15:58:47.280645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:47.351210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:47.382274 [debug] [MainThread]: On master: COMMIT
[0m15:58:47.472914 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:47.525355 [debug] [MainThread]: On master: COMMIT
[0m15:58:47.532562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:47.534896 [debug] [MainThread]: On master: Close
[0m15:58:47.542860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:47.550523 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m15:58:47.558471 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m15:58:47.562574 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m15:58:47.577504 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m15:58:47.586561 [info ] [MainThread]: 
[0m15:58:47.595211 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m15:58:47.602600 [debug] [MainThread]: Command end result
[0m15:58:48.810827 [info ] [MainThread]: 
[0m15:58:48.815742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:48.819530 [info ] [MainThread]: 
[0m15:58:48.823903 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:58:48.833420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.827314, "process_user_time": 9.154907, "process_kernel_time": 1.961412, "process_mem_max_rss": "114128", "process_in_blocks": "7416", "process_out_blocks": "0"}
[0m15:58:48.838684 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:48.838149 after 17.83 seconds
[0m15:58:48.841847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df8323c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df86e94710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79df86ff0d50>]}
[0m15:58:48.844541 [debug] [MainThread]: Flushing usage events
[0m15:59:23.528599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acdb9eb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acd9d15c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acd9d17650>]}


============================== 15:59:23.536671 | b431d569-2b7b-44ac-8f35-c3402ce6c69c ==============================
[0m15:59:23.536671 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:59:23.538927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:59:23.729945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b431d569-2b7b-44ac-8f35-c3402ce6c69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acd9d43390>]}
[0m15:59:24.429060 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4ac9bqw1'
[0m15:59:24.431533 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:59:24.770194 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:59:24.773675 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:59:25.031454 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:59:25.041823 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:59:32.302471 [info ] [MainThread]: Installed from version 1.3.1
[0m15:59:32.304553 [info ] [MainThread]: Up to date!
[0m15:59:32.307200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b431d569-2b7b-44ac-8f35-c3402ce6c69c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acdb3ebdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acd9d17ed0>]}
[0m15:59:32.311456 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.976714, "process_user_time": 2.784779, "process_kernel_time": 0.938868, "process_mem_max_rss": "94284", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m15:59:32.313785 [debug] [MainThread]: Command `dbt deps` succeeded at 15:59:32.313442 after 8.98 seconds
[0m15:59:32.315997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acd9ea0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acddb30750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72acd9cd3fd0>]}
[0m15:59:32.317933 [debug] [MainThread]: Flushing usage events
[0m15:59:37.180701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3034a2ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b304844310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3034e1550>]}


============================== 15:59:37.187496 | a5998507-90f1-4383-8492-166f62f352f6 ==============================
[0m15:59:37.187496 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:59:37.189770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:59:37.484571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3033b8cd0>]}
[0m15:59:37.558497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3071b4e10>]}
[0m15:59:37.560624 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:59:37.640944 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:59:39.342621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:39.344560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:39.396288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b30193d1d0>]}
[0m15:59:39.598658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3016a0c90>]}
[0m15:59:39.600579 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m15:59:39.607700 [info ] [MainThread]: 
[0m15:59:39.610163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:39.618279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:59:39.620135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:59:39.685001 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:59:39.685573 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:59:39.686917 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:59:39.688511 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:59:39.691477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:39.692928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:39.711779 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:59:39.712408 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:59:39.714738 [debug] [ThreadPool]: On list_db: Close
[0m15:59:39.717452 [debug] [ThreadPool]: On list_db: Close
[0m15:59:39.723898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m15:59:39.725599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m15:59:39.735170 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m15:59:39.739206 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m15:59:39.741395 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m15:59:39.743504 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m15:59:39.745476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:39.747580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:39.763691 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:59:39.764638 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:59:39.766051 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m15:59:39.768006 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m15:59:39.770340 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:59:39.772153 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m15:59:39.781259 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:59:39.782164 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:59:39.785019 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m15:59:39.788174 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m15:59:39.790743 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m15:59:39.792463 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m15:59:39.813087 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:39.815194 [debug] [MainThread]: On master: BEGIN
[0m15:59:39.816208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:39.833144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:39.834784 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:39.836165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:39.871989 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m15:59:39.876086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b30188f010>]}
[0m15:59:39.878537 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:39.879918 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:39.880974 [debug] [MainThread]: On master: BEGIN
[0m15:59:39.882600 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:39.884338 [debug] [MainThread]: On master: COMMIT
[0m15:59:39.886391 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:39.887903 [debug] [MainThread]: On master: COMMIT
[0m15:59:39.889844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:59:39.891333 [debug] [MainThread]: On master: Close
[0m15:59:39.893616 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:39.896763 [info ] [MainThread]: 
[0m15:59:39.904660 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m15:59:39.905311 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m15:59:39.905922 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m15:59:39.907608 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m15:59:39.909700 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m15:59:39.913370 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m15:59:39.915326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m15:59:39.917803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m15:59:39.920395 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m15:59:39.922726 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m15:59:39.924174 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m15:59:39.925712 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m15:59:39.935457 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m15:59:39.942859 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m15:59:39.946680 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m15:59:39.954338 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m15:59:39.955241 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m15:59:39.962874 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m15:59:40.046995 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m15:59:40.048193 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m15:59:40.049252 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m15:59:40.058048 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:59:40.059418 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:59:40.061617 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m15:59:40.065491 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:59:40.067894 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m15:59:40.069951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:40.071945 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m15:59:40.074299 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:59:40.077551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:40.093882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.096752 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.099843 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:59:40.102809 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.103604 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:59:40.105380 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m15:59:40.107377 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:59:40.109027 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m15:59:40.112921 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m15:59:40.116940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:59:40.127752 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:59:40.129465 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:59:40.145541 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:59:40.155551 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:59:40.167329 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:59:40.168884 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:59:40.170189 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m15:59:40.171624 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m15:59:40.174975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:40.176241 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:40.177583 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:40.181597 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:59:40.187157 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:59:40.192104 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:59:40.194647 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:59:40.196142 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m15:59:40.197498 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m15:59:40.199778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:40.201622 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:40.203239 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:40.230806 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m15:59:40.232745 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m15:59:40.236639 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m15:59:40.238600 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:59:40.240046 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:59:40.241347 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:59:40.247256 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m15:59:40.248770 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m15:59:40.250229 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m15:59:40.264420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:40.265435 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:40.266373 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:40.276187 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m15:59:40.280524 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m15:59:40.284694 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m15:59:40.293542 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m15:59:40.295152 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m15:59:40.297098 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m15:59:40.298602 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m15:59:40.300348 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m15:59:40.301682 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m15:59:40.306364 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:59:40.308127 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:59:40.309234 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:59:40.311846 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m15:59:40.314472 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m15:59:40.316974 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m15:59:40.320125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3033215d0>]}
[0m15:59:40.322486 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b300266550>]}
[0m15:59:40.324839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3003b2a90>]}
[0m15:59:40.327130 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.40s]
[0m15:59:40.329673 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.40s]
[0m15:59:40.332287 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.41s]
[0m15:59:40.334408 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m15:59:40.336406 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m15:59:40.338127 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m15:59:40.341101 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m15:59:40.341785 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:59:40.342908 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m15:59:40.345369 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m15:59:40.347531 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m15:59:40.349404 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m15:59:40.351662 [info ] [Thread-3 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m15:59:40.354534 [info ] [Thread-2 (]: 7 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m15:59:40.357710 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m15:59:40.360278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m15:59:40.362592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m15:59:40.367760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m15:59:40.369783 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m15:59:40.371570 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:59:40.373130 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m15:59:40.374624 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m15:59:40.392543 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m15:59:40.402882 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:59:40.498474 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m15:59:40.513189 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m15:59:40.558053 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m15:59:40.559146 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:59:40.560190 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m15:59:40.572740 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m15:59:40.593912 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:59:40.595511 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m15:59:40.600028 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m15:59:40.605091 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m15:59:40.679586 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:59:40.680704 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m15:59:40.681623 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m15:59:40.682615 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m15:59:40.683747 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:59:40.685356 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:59:40.687480 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m15:59:40.689906 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m15:59:40.692556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:40.694764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:59:40.696928 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:40.698940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:40.717080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.720092 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.721701 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.722682 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.724128 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:59:40.727851 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m15:59:40.730480 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m15:59:40.732804 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m15:59:40.735263 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m15:59:40.737724 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m15:59:40.740140 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m15:59:40.742572 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:59:40.747012 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:40.747963 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:40.757571 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:59:40.759263 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:40.768128 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m15:59:40.772796 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:59:40.775745 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:59:40.776951 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:40.779984 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m15:59:40.781550 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.42s]
[0m15:59:40.783477 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m15:59:40.787529 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m15:59:40.790463 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.43s]
[0m15:59:40.792331 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:59:40.795240 [info ] [Thread-3 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.43s]
[0m15:59:40.798158 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m15:59:40.800157 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m15:59:40.802348 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m15:59:40.804642 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m15:59:40.806933 [info ] [Thread-2 (]: 7 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.44s]
[0m15:59:40.808287 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m15:59:40.810346 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m15:59:40.812380 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m15:59:40.815056 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m15:59:40.816609 [info ] [Thread-4 (]: 9 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m15:59:40.818495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m15:59:40.819819 [info ] [Thread-3 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m15:59:40.821448 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m15:59:40.825575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m15:59:40.827871 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m15:59:40.829561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m15:59:40.831152 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m15:59:40.833017 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m15:59:40.841484 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m15:59:40.842935 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m15:59:40.844237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m15:59:40.849778 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m15:59:40.861085 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m15:59:40.862932 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m15:59:40.877252 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m15:59:40.879677 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m15:59:40.881032 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m15:59:40.888247 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m15:59:40.890487 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m15:59:40.897180 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m15:59:40.901063 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m15:59:40.907730 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m15:59:40.917452 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m15:59:40.929785 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m15:59:40.931939 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m15:59:40.933848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:40.936869 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m15:59:40.939281 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m15:59:40.945704 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m15:59:40.948098 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m15:59:40.950983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:59:40.951927 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m15:59:40.953265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:40.954119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.959897 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m15:59:40.963495 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m15:59:40.965155 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:59:40.966844 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m15:59:40.970747 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.976301 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:40.978283 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.979172 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m15:59:40.983318 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m15:59:40.989240 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m15:59:40.991926 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:59:40.993387 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:40.997536 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m15:59:40.999094 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m15:59:41.007509 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m15:59:41.010802 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.19s]
[0m15:59:41.017017 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m15:59:41.018192 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:41.019725 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m15:59:41.024910 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m15:59:41.026639 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m15:59:41.027722 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:41.028838 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m15:59:41.029969 [info ] [Thread-1 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m15:59:41.036530 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m15:59:41.039540 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.19s]
[0m15:59:41.044318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m15:59:41.046647 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m15:59:41.051484 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m15:59:41.052730 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:41.054070 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m15:59:41.055941 [info ] [Thread-3 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.23s]
[0m15:59:41.058158 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m15:59:41.061802 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m15:59:41.068743 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m15:59:41.070293 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m15:59:41.071737 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m15:59:41.073816 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m15:59:41.079612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.dim_customer)
[0m15:59:41.082019 [info ] [Thread-4 (]: 9 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.26s]
[0m15:59:41.086301 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m15:59:41.088254 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m15:59:41.095922 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m15:59:41.098669 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m15:59:41.101488 [info ] [Thread-3 (]: 14 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m15:59:41.104162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.fct_marketing_attribution)
[0m15:59:41.106497 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m15:59:41.107608 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m15:59:41.108268 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m15:59:41.113300 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.117790 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m15:59:41.147113 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m15:59:41.155105 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m15:59:41.165521 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:59:41.169441 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.171431 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m15:59:41.173964 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m15:59:41.175721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:41.177532 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m15:59:41.180343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:41.184603 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.187761 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m15:59:41.189032 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:59:41.196317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:41.197218 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:41.198674 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m15:59:41.200461 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:59:41.202432 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:59:41.204444 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m15:59:41.206849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:41.212953 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.216573 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m15:59:41.226481 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:41.232155 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m15:59:41.233494 [debug] [Thread-2 (]: SQL status: SELECT 1013 in 0.0 seconds
[0m15:59:41.235858 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m15:59:41.244891 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:59:41.247741 [info ] [Thread-1 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.20s]
[0m15:59:41.252278 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m15:59:41.260181 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m15:59:41.262494 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:41.264204 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m15:59:41.270211 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:59:41.271897 [info ] [Thread-4 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m15:59:41.273735 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m15:59:41.276191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now model.api_bi_project.fct_revenue_daily)
[0m15:59:41.278530 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:41.279280 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m15:59:41.288500 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m15:59:41.294485 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.295970 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:59:41.298308 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m15:59:41.307000 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m15:59:41.314871 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.315440 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:41.321184 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m15:59:41.321825 [debug] [Thread-3 (]: SQL status: SELECT 5749 in 0.0 seconds
[0m15:59:41.329337 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m15:59:41.335801 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.336745 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.338066 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m15:59:41.339329 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m15:59:41.340365 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m15:59:41.343004 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:41.343750 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:59:41.349399 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.352278 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m15:59:41.355208 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:41.356386 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:59:41.359599 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m15:59:41.362015 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m15:59:41.366180 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:41.366970 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.370547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b301b62890>]}
[0m15:59:41.371863 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.373618 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m15:59:41.375814 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1013[0m in 0.29s]
[0m15:59:41.377412 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m15:59:41.381717 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m15:59:41.382759 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:41.393544 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m15:59:41.398442 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m15:59:41.400780 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m15:59:41.407801 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:59:41.415520 [debug] [Thread-3 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m15:59:41.417848 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3003ee0d0>]}
[0m15:59:41.422042 [info ] [Thread-3 (]: 14 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5749[0m in 0.31s]
[0m15:59:41.425456 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m15:59:41.430367 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m15:59:41.432897 [info ] [Thread-1 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m15:59:41.435188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m15:59:41.437667 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m15:59:41.444992 [debug] [Thread-4 (]: SQL status: SELECT 4348 in 0.0 seconds
[0m15:59:41.447468 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m15:59:41.460149 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.463154 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m15:59:41.465424 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:41.471536 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.473883 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m15:59:41.476618 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:41.480165 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m15:59:41.483472 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.485615 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m15:59:41.489076 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m15:59:41.491112 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:41.495197 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m15:59:41.502787 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m15:59:41.507368 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m15:59:41.509607 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m15:59:41.523184 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:59:41.527163 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m15:59:41.530129 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5998507-90f1-4383-8492-166f62f352f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3016e6010>]}
[0m15:59:41.532976 [info ] [Thread-4 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4348[0m in 0.25s]
[0m15:59:41.536092 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m15:59:41.539510 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m15:59:41.541214 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m15:59:41.543881 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m15:59:41.546270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:41.548129 [info ] [Thread-3 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m15:59:41.551846 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m15:59:41.554927 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m15:59:41.561449 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m15:59:41.563728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:41.565221 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m15:59:41.567091 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m15:59:41.571348 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:41.574712 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m15:59:41.576589 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m15:59:41.578447 [info ] [Thread-1 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.14s]
[0m15:59:41.581514 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m15:59:41.587991 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m15:59:41.599359 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m15:59:41.640487 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m15:59:41.641923 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m15:59:41.643608 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:59:41.659565 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:41.670958 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m15:59:41.675410 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m15:59:41.679760 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:59:41.683710 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m15:59:41.685262 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m15:59:41.686813 [info ] [Thread-3 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.14s]
[0m15:59:41.690816 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m15:59:41.696018 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:41.699346 [debug] [MainThread]: On master: BEGIN
[0m15:59:41.700507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:41.712234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:41.714108 [debug] [MainThread]: On master: COMMIT
[0m15:59:41.715703 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:41.717089 [debug] [MainThread]: On master: COMMIT
[0m15:59:41.718971 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:59:41.720377 [debug] [MainThread]: On master: Close
[0m15:59:41.721757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:41.722972 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m15:59:41.724008 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m15:59:41.725286 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m15:59:41.726825 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m15:59:41.728121 [info ] [MainThread]: 
[0m15:59:41.729527 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m15:59:41.737651 [debug] [MainThread]: Command end result
[0m15:59:41.844403 [info ] [MainThread]: 
[0m15:59:41.846398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:41.848768 [info ] [MainThread]: 
[0m15:59:41.852015 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m15:59:41.855466 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.7719407, "process_user_time": 4.003361, "process_kernel_time": 0.635454, "process_mem_max_rss": "116348", "process_in_blocks": "2112", "process_out_blocks": "0"}
[0m15:59:41.857126 [debug] [MainThread]: Command `dbt build` succeeded at 15:59:41.856966 after 4.77 seconds
[0m15:59:41.858536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3072a48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b307400490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b307400d90>]}
[0m15:59:41.860083 [debug] [MainThread]: Flushing usage events
[0m16:00:10.715619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76910666ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76910666a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769107ae88d0>]}


============================== 16:00:10.722381 | f6486594-4bdc-4649-854a-6f9a3e8ee747 ==============================
[0m16:00:10.722381 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:00:10.724604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:00:10.906942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6486594-4bdc-4649-854a-6f9a3e8ee747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7691066b8250>]}
[0m16:00:11.548576 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4bmt37us'
[0m16:00:11.551305 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:00:11.742146 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:00:11.744858 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:00:11.934304 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:00:11.948309 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:00:19.218076 [info ] [MainThread]: Installed from version 1.3.1
[0m16:00:19.219744 [info ] [MainThread]: Up to date!
[0m16:00:19.221849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f6486594-4bdc-4649-854a-6f9a3e8ee747', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769107e00350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7691066d9110>]}
[0m16:00:19.225998 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.608001, "process_user_time": 2.77131, "process_kernel_time": 0.874119, "process_mem_max_rss": "94396", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m16:00:19.228165 [debug] [MainThread]: Command `dbt deps` succeeded at 16:00:19.227808 after 8.61 seconds
[0m16:00:19.230330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7691066e4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76910a488810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76910a60cdd0>]}
[0m16:00:19.232208 [debug] [MainThread]: Flushing usage events
[0m16:00:23.700014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cf5c2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cf605f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cf8fc990>]}


============================== 16:00:23.708702 | 6a874cd3-05c2-4864-b501-84abab863dfa ==============================
[0m16:00:23.708702 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:00:23.711077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:00:23.966893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cdcd7c50>]}
[0m16:00:24.053413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cf790190>]}
[0m16:00:24.056663 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:24.120904 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:00:25.705829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:25.707396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:25.754966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cf5162d0>]}
[0m16:00:25.973447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cd7bd3d0>]}
[0m16:00:25.975417 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m16:00:25.982020 [info ] [MainThread]: 
[0m16:00:25.984824 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:25.996187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:00:25.998592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:00:26.061941 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:00:26.062544 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:00:26.063876 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:26.065444 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:26.067290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:26.068666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:26.088580 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:00:26.089661 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:00:26.093310 [debug] [ThreadPool]: On list_db: Close
[0m16:00:26.098750 [debug] [ThreadPool]: On list_db: Close
[0m16:00:26.104167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m16:00:26.105547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m16:00:26.117781 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:00:26.123092 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:00:26.125516 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m16:00:26.127071 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m16:00:26.128581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:26.129909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:26.142350 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.143819 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.145196 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:00:26.146756 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:00:26.148095 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:00:26.149703 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m16:00:26.158067 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:00:26.158821 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:00:26.163561 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m16:00:26.167326 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m16:00:26.171295 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m16:00:26.173284 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m16:00:26.198416 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:26.200589 [debug] [MainThread]: On master: BEGIN
[0m16:00:26.202191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:26.218079 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.220699 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:26.222571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:26.266896 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m16:00:26.269479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cdc80790>]}
[0m16:00:26.271906 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:26.275252 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:26.276549 [debug] [MainThread]: On master: BEGIN
[0m16:00:26.278148 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.279866 [debug] [MainThread]: On master: COMMIT
[0m16:00:26.281536 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:26.283494 [debug] [MainThread]: On master: COMMIT
[0m16:00:26.285089 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:26.286341 [debug] [MainThread]: On master: Close
[0m16:00:26.288229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:26.290600 [info ] [MainThread]: 
[0m16:00:26.299139 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m16:00:26.300021 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m16:00:26.300644 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m16:00:26.302038 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m16:00:26.304519 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m16:00:26.306783 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m16:00:26.308694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m16:00:26.311048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m16:00:26.312572 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m16:00:26.314121 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m16:00:26.316550 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m16:00:26.318958 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m16:00:26.329257 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m16:00:26.335518 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m16:00:26.338789 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m16:00:26.346806 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m16:00:26.348254 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m16:00:26.354526 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m16:00:26.401503 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m16:00:26.404534 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m16:00:26.408244 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m16:00:26.417046 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:00:26.418602 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:00:26.419997 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m16:00:26.420968 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:00:26.422546 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m16:00:26.423782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:26.424868 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m16:00:26.426296 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:00:26.429494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:26.442267 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.445149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.446373 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:00:26.448005 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.449252 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:00:26.450976 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m16:00:26.452907 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:00:26.454908 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m16:00:26.457880 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m16:00:26.462363 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:00:26.463848 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:00:26.471333 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:00:26.477518 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:00:26.481957 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:00:26.489245 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:00:26.492387 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m16:00:26.494011 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m16:00:26.495304 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m16:00:26.498123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:26.500767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:26.504459 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:26.510702 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:00:26.515910 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:00:26.521499 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:00:26.523310 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m16:00:26.525014 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:00:26.526608 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m16:00:26.528637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:26.529931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:26.531035 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:26.558082 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:00:26.558719 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:00:26.562081 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:00:26.563675 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:00:26.564966 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:00:26.566355 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:00:26.568402 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:00:26.570119 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:00:26.571459 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:00:26.575610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:26.576614 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:26.577283 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:26.587674 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m16:00:26.592130 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m16:00:26.596476 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m16:00:26.606796 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:00:26.608541 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:00:26.610305 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:00:26.611901 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m16:00:26.613739 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m16:00:26.615343 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m16:00:26.619695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:00:26.620828 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:00:26.621999 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:00:26.625476 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m16:00:26.628703 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m16:00:26.631943 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m16:00:26.635261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cc4ebbd0>]}
[0m16:00:26.637651 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cc373010>]}
[0m16:00:26.640082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cc37a310>]}
[0m16:00:26.642988 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.33s]
[0m16:00:26.645611 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.33s]
[0m16:00:26.648357 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.33s]
[0m16:00:26.651129 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m16:00:26.653280 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m16:00:26.655874 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m16:00:26.658729 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:00:26.659252 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:00:26.660287 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:00:26.662091 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:00:26.663592 [info ] [Thread-4 (]: 4 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m16:00:26.665855 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m16:00:26.667644 [info ] [Thread-3 (]: 6 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m16:00:26.669514 [info ] [Thread-2 (]: 7 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m16:00:26.671863 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_stg_customers_country.c13d2cd104'
[0m16:00:26.673815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:00:26.675188 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m16:00:26.676507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m16:00:26.677923 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:00:26.679145 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:00:26.680374 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:00:26.681402 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:00:26.695632 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:00:26.701417 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:00:26.712870 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:00:26.804673 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:00:26.814445 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:00:26.816780 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:00:26.837503 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:00:26.838806 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:00:26.848303 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:00:26.849041 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:00:26.853968 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:00:26.858593 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:00:26.868471 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:00:26.869619 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:00:26.871891 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m16:00:26.873193 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:00:26.876255 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:00:26.877187 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:00:26.879337 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:26.881747 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m16:00:26.883100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:26.885380 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:00:26.888205 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:26.894553 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:26.903127 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.906057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.906871 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:00:26.908163 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:00:26.910678 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m16:00:26.912581 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.913678 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:00:26.914528 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:26.917157 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:00:26.920322 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:26.922988 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:00:26.924394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:26.925773 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m16:00:26.936594 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m16:00:26.939631 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:00:26.942643 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:00:26.947182 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m16:00:26.951924 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:00:26.953683 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:26.956347 [info ] [Thread-4 (]: 4 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.28s]
[0m16:00:26.960861 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.29s]
[0m16:00:26.972058 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:00:26.977849 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:00:26.982681 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:00:26.984983 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:00:26.985786 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:26.986495 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:00:26.989144 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:00:26.991908 [info ] [Thread-3 (]: 6 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.32s]
[0m16:00:26.995179 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m16:00:26.997350 [info ] [Thread-4 (]: 8 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m16:00:26.999733 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m16:00:27.003401 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:00:27.006897 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m16:00:27.008378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m16:00:27.010242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m16:00:27.012078 [debug] [Thread-3 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:00:27.015061 [info ] [Thread-2 (]: 7 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.34s]
[0m16:00:27.017527 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:00:27.019675 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:00:27.022665 [info ] [Thread-3 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m16:00:27.025919 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:00:27.038009 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:00:27.045740 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:00:27.047623 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m16:00:27.050276 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:00:27.054323 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:00:27.056154 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m16:00:27.075399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m16:00:27.072681 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:00:27.078040 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:00:27.081707 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:00:27.082698 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:00:27.091721 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:00:27.099317 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:00:27.106523 [debug] [Thread-3 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:00:27.114238 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:00:27.131238 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:00:27.134177 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:00:27.136769 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m16:00:27.137935 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:00:27.140663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:27.142586 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:00:27.143602 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m16:00:27.146330 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:00:27.148179 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m16:00:27.150034 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:00:27.158996 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:00:27.160498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.161503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:27.165791 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:00:27.168827 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:00:27.175310 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:00:27.176138 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.181078 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m16:00:27.182257 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.183928 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:00:27.185949 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:27.187979 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:00:27.190483 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m16:00:27.197429 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m16:00:27.208760 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:27.214720 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m16:00:27.216197 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:27.218608 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.220528 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m16:00:27.225485 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m16:00:27.226655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:27.228068 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:00:27.230251 [info ] [Thread-4 (]: 8 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.22s]
[0m16:00:27.233747 [debug] [Thread-3 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m16:00:27.238866 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m16:00:27.240959 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m16:00:27.243247 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:00:27.245830 [info ] [Thread-3 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.20s]
[0m16:00:27.248865 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m16:00:27.251834 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:00:27.253184 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:27.254668 [debug] [Thread-3 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:00:27.256788 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.25s]
[0m16:00:27.259089 [info ] [Thread-4 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m16:00:27.264748 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m16:00:27.267661 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m16:00:27.270819 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:00:27.272782 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m16:00:27.275087 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m16:00:27.277734 [info ] [Thread-3 (]: 13 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m16:00:27.281542 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m16:00:27.283099 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:00:27.288530 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.21s]
[0m16:00:27.291249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m16:00:27.294590 [info ] [Thread-1 (]: 14 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m16:00:27.306745 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:00:27.308743 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:00:27.310416 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m16:00:27.313204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now model.api_bi_project.fct_marketing_attribution)
[0m16:00:27.321336 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m16:00:27.323126 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m16:00:27.328911 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.331172 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:00:27.335962 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:00:27.336440 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m16:00:27.338807 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m16:00:27.378474 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m16:00:27.381315 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.382423 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:00:27.387370 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m16:00:27.388919 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:00:27.392752 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:00:27.394302 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.395925 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m16:00:27.402467 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m16:00:27.404429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:27.405522 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.407021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:27.411467 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:00:27.414005 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:00:27.421599 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.424265 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:00:27.425275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.427092 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:27.428328 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m16:00:27.430316 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.434390 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m16:00:27.438679 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m16:00:27.440958 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m16:00:27.445244 [info ] [Thread-4 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.17s]
[0m16:00:27.448357 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:00:27.448992 [debug] [Thread-3 (]: SQL status: SELECT 1013 in 0.0 seconds
[0m16:00:27.451345 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m16:00:27.459427 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:00:27.461578 [info ] [Thread-2 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m16:00:27.463295 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m16:00:27.465184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m16:00:27.468731 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:27.469908 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m16:00:27.479490 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:00:27.484906 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.486983 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m16:00:27.490999 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:27.500184 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:00:27.501769 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:00:27.503794 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m16:00:27.504574 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:00:27.513419 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.524261 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.525704 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m16:00:27.526814 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:27.530916 [debug] [Thread-1 (]: SQL status: SELECT 5749 in 0.0 seconds
[0m16:00:27.531828 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:27.538480 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.542812 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m16:00:27.544850 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.546354 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m16:00:27.554408 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:00:27.555538 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.558046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:27.558620 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m16:00:27.559868 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m16:00:27.565592 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.575283 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m16:00:27.578084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:27.580832 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:00:27.582421 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.583670 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:00:27.631255 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:00:27.632491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:27.636223 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m16:00:27.640950 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m16:00:27.644085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cc2bda10>]}
[0m16:00:27.648817 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:00:27.650555 [info ] [Thread-3 (]: 13 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1013[0m in 0.35s]
[0m16:00:27.652440 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m16:00:27.654528 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m16:00:27.661692 [debug] [Thread-2 (]: SQL status: SELECT 4348 in 0.0 seconds
[0m16:00:27.666757 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.667901 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m16:00:27.671021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:27.677671 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.680317 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m16:00:27.683145 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:27.698753 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:00:27.702267 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.704263 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:00:27.709717 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:00:27.714694 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m16:00:27.716822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cc1349d0>]}
[0m16:00:27.719068 [info ] [Thread-1 (]: 14 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5749[0m in 0.40s]
[0m16:00:27.721335 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m16:00:27.724559 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:00:27.727254 [info ] [Thread-4 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m16:00:27.729701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m16:00:27.731485 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:00:27.738798 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:00:27.750990 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:00:27.755420 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:00:27.766467 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:00:27.768380 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m16:00:27.770418 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:00:27.783993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.785896 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:00:27.787742 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m16:00:27.791689 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:27.792571 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:27.797099 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m16:00:27.806830 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m16:00:27.810768 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:00:27.814918 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m16:00:27.816258 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m16:00:27.820718 [info ] [Thread-4 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.09s]
[0m16:00:27.824867 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:00:27.839652 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:00:27.842263 [debug] [Thread-2 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m16:00:27.844023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a874cd3-05c2-4864-b501-84abab863dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cc2bc290>]}
[0m16:00:27.849336 [info ] [Thread-2 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4348[0m in 0.38s]
[0m16:00:27.851122 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m16:00:27.853929 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:00:27.855284 [info ] [Thread-1 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m16:00:27.856686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m16:00:27.858128 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:00:27.865375 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:00:27.875096 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:00:27.880119 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:00:27.890736 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:00:27.892074 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m16:00:27.893306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:27.910031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.912122 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:00:27.914065 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m16:00:27.919685 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:27.924821 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m16:00:27.927926 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m16:00:27.931237 [info ] [Thread-1 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.07s]
[0m16:00:27.935866 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:00:27.941561 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.943577 [debug] [MainThread]: On master: BEGIN
[0m16:00:27.946912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:27.964206 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:27.966102 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.968079 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:27.969443 [debug] [MainThread]: On master: COMMIT
[0m16:00:27.970999 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:27.972257 [debug] [MainThread]: On master: Close
[0m16:00:27.973623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:27.978717 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m16:00:27.980309 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m16:00:27.981560 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m16:00:27.982730 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m16:00:27.984631 [info ] [MainThread]: 
[0m16:00:27.986610 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m16:00:27.996264 [debug] [MainThread]: Command end result
[0m16:00:28.095727 [info ] [MainThread]: 
[0m16:00:28.098154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:28.100504 [info ] [MainThread]: 
[0m16:00:28.102994 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m16:00:28.106115 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.51275, "process_user_time": 3.628467, "process_kernel_time": 0.552498, "process_mem_max_rss": "116812", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:00:28.107812 [debug] [MainThread]: Command `dbt build` succeeded at 16:00:28.107585 after 4.51 seconds
[0m16:00:28.109219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793d33c48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793cc513290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7793d3521410>]}
[0m16:00:28.110693 [debug] [MainThread]: Flushing usage events
[0m16:01:36.809483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac13492fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac134bc4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac13881e4d0>]}


============================== 16:01:36.832159 | 66a58d20-4966-4464-8aa1-7cd8aad14f65 ==============================
[0m16:01:36.832159 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:01:36.849891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:37.030009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66a58d20-4966-4464-8aa1-7cd8aad14f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac13492dc90>]}
[0m16:01:37.524948 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j06fnd1_'
[0m16:01:37.527000 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:01:37.928935 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:01:37.932147 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:01:38.152096 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:01:38.166670 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:01:47.948646 [info ] [MainThread]: Installed from version 1.3.1
[0m16:01:47.951058 [info ] [MainThread]: Up to date!
[0m16:01:47.953166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '66a58d20-4966-4464-8aa1-7cd8aad14f65', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac13482d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1360b4190>]}
[0m16:01:47.958032 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 11.304129, "process_user_time": 2.214765, "process_kernel_time": 0.929139, "process_mem_max_rss": "94724", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m16:01:47.960413 [debug] [MainThread]: Command `dbt deps` succeeded at 16:01:47.960120 after 11.31 seconds
[0m16:01:47.962171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac13497f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac13497f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1387607d0>]}
[0m16:01:47.967679 [debug] [MainThread]: Flushing usage events
[0m16:01:56.142174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d825a7af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d825aa74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d825aa7d10>]}


============================== 16:01:56.152696 | 1f7d3713-1982-4126-a91e-63dc16b3651c ==============================
[0m16:01:56.152696 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:01:56.155552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:01:56.441249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d8259c6810>]}
[0m16:01:56.526308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d8297b0f50>]}
[0m16:01:56.528918 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:01:56.596749 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:01:58.330714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:58.332293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:58.407927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d8240bbed0>]}
[0m16:01:58.686262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d823ca8fd0>]}
[0m16:01:58.694346 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m16:01:58.715769 [info ] [MainThread]: 
[0m16:01:58.723094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:58.738474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:01:58.740048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:01:58.840950 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:01:58.844043 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:01:58.846011 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:01:58.847757 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:01:58.848797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:58.850773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:58.868229 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:01:58.869971 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:01:58.872579 [debug] [ThreadPool]: On list_db: Close
[0m16:01:58.874620 [debug] [ThreadPool]: On list_db: Close
[0m16:01:58.880453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m16:01:58.882355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m16:01:58.893101 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:01:58.898830 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:01:58.900469 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m16:01:58.902533 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m16:01:58.904325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:58.908698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:58.929785 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:01:58.934221 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:01:58.935450 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:01:58.937001 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:01:58.938836 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:01:58.942231 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m16:01:58.947487 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:01:58.952530 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:01:58.957265 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m16:01:58.966741 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m16:01:58.977078 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m16:01:58.983076 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m16:01:59.024636 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.026886 [debug] [MainThread]: On master: BEGIN
[0m16:01:59.028354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:59.048052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:59.054197 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.056989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:59.114649 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m16:01:59.119215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d829785490>]}
[0m16:01:59.121295 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:59.124576 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.126207 [debug] [MainThread]: On master: BEGIN
[0m16:01:59.128106 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:59.132215 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.133849 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.135228 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.137290 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:01:59.139532 [debug] [MainThread]: On master: Close
[0m16:01:59.143222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:59.150147 [info ] [MainThread]: 
[0m16:01:59.162327 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m16:01:59.163372 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m16:01:59.164243 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m16:01:59.166534 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m16:01:59.169797 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m16:01:59.172078 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m16:01:59.175455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m16:01:59.178460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m16:01:59.180405 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m16:01:59.182653 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m16:01:59.184938 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m16:01:59.187943 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m16:01:59.200697 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m16:01:59.209525 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m16:01:59.217466 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m16:01:59.227083 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m16:01:59.228404 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m16:01:59.238468 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m16:01:59.355212 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m16:01:59.357800 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m16:01:59.353851 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m16:01:59.370076 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:01:59.371445 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:01:59.373140 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m16:01:59.377292 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:01:59.378270 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m16:01:59.380084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:59.381879 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m16:01:59.386719 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:01:59.403035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:59.407711 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:59.414657 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:01:59.416376 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m16:01:59.424170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:59.426682 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:01:59.434154 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:01:59.435187 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:59.461146 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:01:59.465978 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m16:01:59.471437 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:01:59.479269 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m16:01:59.487797 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m16:01:59.489224 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:01:59.492840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:59.503573 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:01:59.514234 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:01:59.523467 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:01:59.529843 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:01:59.531434 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m16:01:59.532911 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m16:01:59.534301 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m16:01:59.540600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:59.542533 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:59.544394 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:59.552611 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:01:59.588264 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:01:59.594595 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:01:59.596448 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:01:59.597792 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m16:01:59.599583 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:01:59.603477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:59.604976 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:59.606371 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:01:59.610811 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:01:59.614864 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:01:59.617545 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:01:59.620855 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:01:59.623091 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:01:59.624596 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:01:59.626431 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:59.629444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:59.637798 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:59.643189 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m16:01:59.648741 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m16:01:59.658544 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m16:01:59.676435 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:01:59.678014 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:01:59.679847 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:01:59.681977 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m16:01:59.685363 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m16:01:59.687043 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m16:01:59.692861 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:01:59.694301 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:01:59.696022 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:01:59.704116 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m16:01:59.707062 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m16:01:59.712867 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m16:01:59.718274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d8229b20d0>]}
[0m16:01:59.722882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d8229d3390>]}
[0m16:01:59.726810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d822a48990>]}
[0m16:01:59.736269 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.54s]
[0m16:01:59.743127 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.55s]
[0m16:01:59.748956 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.55s]
[0m16:01:59.751293 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m16:01:59.754429 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m16:01:59.756989 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m16:01:59.759355 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:01:59.760001 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:01:59.761826 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:01:59.765472 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:01:59.768088 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m16:01:59.772711 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m16:01:59.777115 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m16:01:59.780065 [info ] [Thread-3 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m16:01:59.785265 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m16:01:59.787673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m16:01:59.794157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m16:01:59.796680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m16:01:59.799317 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:01:59.801993 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:01:59.803756 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:01:59.805261 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:01:59.858116 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:01:59.861773 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:02:00.004523 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:02:00.013892 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:02:00.028593 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:02:00.057698 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:02:00.063515 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:02:00.079149 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:02:00.088186 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:02:00.109337 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:02:00.111043 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:02:00.127262 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:02:00.129278 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:02:00.131369 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:02:00.135564 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:02:00.137435 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m16:02:00.139670 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m16:02:00.144966 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m16:02:00.147651 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:00.150708 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:02:00.153961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:00.155583 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:02:00.178230 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.179322 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.183850 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m16:02:00.192129 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:02:00.194518 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.199388 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:02:00.201788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:00.204150 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m16:02:00.209240 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:02:00.212049 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m16:02:00.229675 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m16:02:00.240098 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.241426 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.246269 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.259817 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m16:02:00.267345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.278614 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m16:02:00.287293 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m16:02:00.299569 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m16:02:00.301210 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:02:00.308642 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m16:02:00.312446 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m16:02:00.320123 [info ] [Thread-3 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.52s]
[0m16:02:00.336100 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:02:00.340077 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.56s]
[0m16:02:00.357257 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.57s]
[0m16:02:00.373324 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:02:00.381580 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:02:00.384390 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:02:00.394300 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:02:00.398999 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:02:00.401173 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:02:00.407285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.411869 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m16:02:00.417306 [info ] [Thread-4 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m16:02:00.429905 [info ] [Thread-2 (]: 10 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m16:02:00.442526 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m16:02:00.446765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:02:00.455027 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m16:02:00.463516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m16:02:00.466680 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m16:02:00.470849 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:02:00.474723 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:02:00.482500 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:02:00.487327 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.69s]
[0m16:02:00.504028 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:02:00.525333 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:02:00.553249 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:02:00.554857 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:02:00.565880 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:02:00.569695 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m16:02:00.573510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m16:02:00.579256 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:02:00.580464 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:02:00.581408 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:02:00.588906 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:02:00.597950 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:02:00.604194 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:02:00.608978 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:02:00.617047 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:02:00.627699 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:02:00.629359 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:02:00.633158 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:02:00.634547 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:02:00.635308 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:02:00.636479 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:02:00.639383 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:00.641874 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m16:02:00.646741 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:02:00.650640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:00.653465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:00.668684 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:02:00.671625 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.672831 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.675237 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m16:02:00.676402 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.678519 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:02:00.680817 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:02:00.684672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:00.687263 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:02:00.689246 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:02:00.694581 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:02:00.699682 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m16:02:00.708020 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.710623 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.724981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:00.727579 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:02:00.743896 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:02:00.760542 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.767500 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:02:00.771771 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:02:00.775844 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:02:00.779105 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m16:02:00.780835 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m16:02:00.786387 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.34s]
[0m16:02:00.788751 [info ] [Thread-4 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.33s]
[0m16:02:00.793502 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m16:02:00.798415 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:02:00.800174 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:00.803331 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:02:00.806521 [info ] [Thread-2 (]: 10 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.34s]
[0m16:02:00.811923 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:02:00.817451 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m16:02:00.823573 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m16:02:00.827799 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:02:00.832941 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_sessions_session_id ............................. [RUN]
[0m16:02:00.836432 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m16:02:00.843544 [info ] [Thread-4 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m16:02:00.854341 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m16:02:00.859319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m16:02:00.862756 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.29s]
[0m16:02:00.867942 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_revenue_daily)
[0m16:02:00.870493 [info ] [Thread-2 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m16:02:00.876792 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:02:00.883315 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:02:00.885863 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m16:02:00.887762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now model.api_bi_project.dim_customer)
[0m16:02:00.898249 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:02:00.910240 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m16:02:00.913123 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m16:02:00.923598 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m16:02:00.932473 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m16:02:00.933631 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:02:00.934322 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m16:02:00.964792 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:02:00.988898 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m16:02:01.003808 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m16:02:01.015178 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:02:01.016700 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:02:01.020094 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m16:02:01.021479 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:02:01.023524 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m16:02:01.026074 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:01.029626 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m16:02:01.031622 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:01.039146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:01.053381 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.056537 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:02:01.059578 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.060606 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m16:02:01.063759 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.065708 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:02:01.068941 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:02:01.071057 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:02:01.076147 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m16:02:01.171531 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:01.174532 [debug] [Thread-2 (]: SQL status: SELECT 1013 in 0.0 seconds
[0m16:02:01.186289 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m16:02:01.190050 [debug] [Thread-4 (]: SQL status: SELECT 4348 in 0.0 seconds
[0m16:02:01.209533 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:02:01.216909 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m16:02:01.238964 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m16:02:01.241604 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:02:01.258252 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.40s]
[0m16:02:01.265633 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:01.267524 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m16:02:01.273069 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:02:01.305938 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:02:01.313963 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:01.323100 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m16:02:01.328816 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m16:02:01.344788 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:02:01.346530 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m16:02:01.349005 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:01.350373 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m16:02:01.354332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now model.api_bi_project.fct_marketing_attribution)
[0m16:02:01.368097 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:02:01.371819 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:01.372857 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m16:02:01.375079 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:02:01.380333 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:02:01.386535 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.390204 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:02:01.392623 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:02:01.397250 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:02:01.398703 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:02:01.407982 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m16:02:01.409898 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:02:01.419552 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:02:01.420090 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m16:02:01.427914 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m16:02:01.429274 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m16:02:01.437263 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.438831 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:02:01.442551 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m16:02:01.451362 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:01.453042 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:01.454294 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.456810 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m16:02:01.460250 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m16:02:01.463172 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m16:02:01.465859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d82292fd50>]}
[0m16:02:01.467790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d8229edc50>]}
[0m16:02:01.473049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:01.475142 [info ] [Thread-2 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1013[0m in 0.58s]
[0m16:02:01.477107 [info ] [Thread-4 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4348[0m in 0.60s]
[0m16:02:01.483564 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m16:02:01.485758 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m16:02:01.492144 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:02:01.494019 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m16:02:01.498493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.501453 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m16:02:01.503965 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.510399 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:02:01.512163 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m16:02:01.537341 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:02:01.564320 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:02:01.591381 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:02:01.630379 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:02:01.635451 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m16:02:01.636850 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:01.654960 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.657587 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:02:01.664843 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m16:02:01.671523 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:01.674352 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m16:02:01.676150 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m16:02:01.679830 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.18s]
[0m16:02:01.683129 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:02:01.719586 [debug] [Thread-1 (]: SQL status: SELECT 5749 in 0.0 seconds
[0m16:02:01.729069 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.733408 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m16:02:01.742464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:01.749471 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.751964 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m16:02:01.754243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:01.758587 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:02:01.761375 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.765808 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:02:01.779845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:02:01.786652 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m16:02:01.789838 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:02:01.791138 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m16:02:01.798486 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:01.801782 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m16:02:01.806098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7d3713-1982-4126-a91e-63dc16b3651c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d823cd8b50>]}
[0m16:02:01.808234 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5749[0m in 0.45s]
[0m16:02:01.810522 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m16:02:01.815077 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:02:01.817052 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m16:02:01.819092 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m16:02:01.825730 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:02:01.835112 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:02:01.848845 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:02:01.856814 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:02:01.874676 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:02:01.877898 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m16:02:01.879821 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:01.897731 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.900723 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:02:01.905745 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m16:02:01.911361 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:01.917124 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m16:02:01.925401 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m16:02:01.928776 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.11s]
[0m16:02:01.943869 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:02:01.950351 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:01.961716 [debug] [MainThread]: On master: BEGIN
[0m16:02:01.976225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:02.021625 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:02.038059 [debug] [MainThread]: On master: COMMIT
[0m16:02:02.043246 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:02.049868 [debug] [MainThread]: On master: COMMIT
[0m16:02:02.062212 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:02.066770 [debug] [MainThread]: On master: Close
[0m16:02:02.069462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:02.071899 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m16:02:02.075136 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m16:02:02.078076 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m16:02:02.080180 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m16:02:02.098339 [info ] [MainThread]: 
[0m16:02:02.106857 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m16:02:02.123088 [debug] [MainThread]: Command end result
[0m16:02:02.378946 [info ] [MainThread]: 
[0m16:02:02.381713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:02.384494 [info ] [MainThread]: 
[0m16:02:02.387649 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m16:02:02.394318 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.354947, "process_user_time": 5.99188, "process_kernel_time": 1.058296, "process_mem_max_rss": "116668", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:02:02.402525 [debug] [MainThread]: Command `dbt build` succeeded at 16:02:02.402068 after 6.36 seconds
[0m16:02:02.405236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d82998fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d829898810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d829a1d190>]}
[0m16:02:02.407926 [debug] [MainThread]: Flushing usage events
[0m16:15:07.183627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468aa64450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468a7cd410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468a7b6450>]}


============================== 16:15:07.216499 | 753ddeea-12db-4726-8870-a158b6f9b61c ==============================
[0m16:15:07.216499 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:15:07.218381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:15:07.354613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '753ddeea-12db-4726-8870-a158b6f9b61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468a60cc90>]}
[0m16:15:07.811544 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vty8qee6'
[0m16:15:07.813860 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:15:08.295643 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:15:08.298134 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:15:08.494438 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:15:08.501952 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:15:15.433821 [info ] [MainThread]: Installed from version 1.3.1
[0m16:15:15.436111 [info ] [MainThread]: Up to date!
[0m16:15:15.437920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '753ddeea-12db-4726-8870-a158b6f9b61c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468a62ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468bcc2d90>]}
[0m16:15:15.440401 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.379527, "process_user_time": 1.805444, "process_kernel_time": 0.74841, "process_mem_max_rss": "94636", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m16:15:15.441931 [debug] [MainThread]: Command `dbt deps` succeeded at 16:15:15.441663 after 8.38 seconds
[0m16:15:15.443066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468a94fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468e590850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73468e6ec450>]}
[0m16:15:15.444224 [debug] [MainThread]: Flushing usage events
[0m16:15:20.145561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dea1ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183e045c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dede3f90>]}


============================== 16:15:20.157883 | d0fc5670-c0dd-45ce-a823-21ec0a411e98 ==============================
[0m16:15:20.157883 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:15:20.160274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:15:20.508481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dea1cf50>]}
[0m16:15:20.598595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183e27886d0>]}
[0m16:15:20.605363 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:15:20.659559 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:15:22.460983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:22.463294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:22.525146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dd0f9c90>]}
[0m16:15:22.737711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dcc6c890>]}
[0m16:15:22.740118 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m16:15:22.751139 [info ] [MainThread]: 
[0m16:15:22.754567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:22.762092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:15:22.763943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:15:22.868554 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:15:22.869163 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:15:22.872522 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:15:22.874492 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:15:22.876053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:22.877994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:22.903428 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:15:22.904246 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:15:22.906824 [debug] [ThreadPool]: On list_db: Close
[0m16:15:22.911163 [debug] [ThreadPool]: On list_db: Close
[0m16:15:22.917611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m16:15:22.919214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m16:15:22.938388 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:15:22.935088 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:15:22.940068 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m16:15:22.941708 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m16:15:22.942941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:22.944602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:22.966324 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:15:22.967666 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:15:22.970497 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:15:22.973682 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:15:22.977549 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:15:22.979695 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m16:15:22.989841 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:15:22.990913 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:15:22.994425 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m16:15:22.999297 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m16:15:23.002643 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m16:15:23.004573 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m16:15:23.023989 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:23.026567 [debug] [MainThread]: On master: BEGIN
[0m16:15:23.028244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:23.047283 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:15:23.050987 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:23.053369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:23.108276 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m16:15:23.113059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dcca8f90>]}
[0m16:15:23.115646 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:23.118344 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:23.120266 [debug] [MainThread]: On master: BEGIN
[0m16:15:23.126291 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:15:23.129830 [debug] [MainThread]: On master: COMMIT
[0m16:15:23.131917 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:23.135399 [debug] [MainThread]: On master: COMMIT
[0m16:15:23.138095 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:15:23.140469 [debug] [MainThread]: On master: Close
[0m16:15:23.143903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:23.146997 [info ] [MainThread]: 
[0m16:15:23.164468 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m16:15:23.165779 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m16:15:23.172503 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m16:15:23.177199 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m16:15:23.181940 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m16:15:23.185131 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m16:15:23.190305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m16:15:23.193150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m16:15:23.196210 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m16:15:23.202358 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m16:15:23.205730 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m16:15:23.209223 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m16:15:23.241477 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m16:15:23.247969 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m16:15:23.253717 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m16:15:23.267495 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m16:15:23.269465 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m16:15:23.271750 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m16:15:23.376981 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m16:15:23.380110 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m16:15:23.380965 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m16:15:23.389783 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:15:23.390966 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:15:23.392816 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:15:23.393464 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m16:15:23.395455 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m16:15:23.397453 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m16:15:23.399301 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:15:23.401097 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:23.402681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:23.419937 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:23.424382 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:15:23.426703 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:23.428351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:23.429584 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m16:15:23.433189 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:15:23.435094 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:15:23.442541 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m16:15:23.445010 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m16:15:23.446948 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:15:23.459873 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:15:23.467684 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:15:23.471855 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:15:23.482217 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:15:23.493150 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:15:23.495321 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m16:15:23.497966 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m16:15:23.500063 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m16:15:23.503590 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:23.506685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:23.514892 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:23.513921 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:15:23.522843 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:15:23.531473 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:15:23.534180 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m16:15:23.535912 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:15:23.537538 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m16:15:23.540413 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:23.543252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:23.547091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:23.635848 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:15:23.637897 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:15:23.641244 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:15:23.643511 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:15:23.645086 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:15:23.646459 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:15:23.647793 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:15:23.649145 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:15:23.650382 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:15:23.653884 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:15:23.655062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:15:23.665839 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m16:15:23.666728 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:15:23.671443 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m16:15:23.681960 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:15:23.687281 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m16:15:23.693844 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:15:23.695460 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m16:15:23.697348 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:15:23.698837 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m16:15:23.700897 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m16:15:23.703932 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:15:23.709195 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m16:15:23.710301 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:15:23.711157 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:15:23.715062 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dc0f9910>]}
[0m16:15:23.718299 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m16:15:23.721991 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m16:15:23.724004 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.52s]
[0m16:15:23.726381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dcca9310>]}
[0m16:15:23.729157 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dc0f8890>]}
[0m16:15:23.731809 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m16:15:23.734484 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.54s]
[0m16:15:23.736983 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.54s]
[0m16:15:23.740499 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:15:23.741430 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:15:23.742794 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m16:15:23.744650 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m16:15:23.745849 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m16:15:23.747790 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m16:15:23.750729 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:15:23.753932 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:15:23.758341 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m16:15:23.760400 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m16:15:23.761933 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m16:15:23.763465 [info ] [Thread-2 (]: 7 of 17 START test not_null_stg_customers_country .............................. [RUN]
[0m16:15:23.765931 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:15:23.767830 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:15:23.769460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m16:15:23.770749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m16:15:23.794194 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:15:23.804713 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:15:23.806030 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:15:23.807380 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:15:23.822846 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:15:23.925818 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:15:23.933492 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:15:23.936922 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:15:23.962326 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:15:23.967991 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:15:23.970450 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:15:23.986362 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:15:23.987781 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:15:23.994746 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:15:23.996011 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:15:23.997312 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:15:24.000692 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:15:24.002129 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m16:15:24.004240 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m16:15:24.006367 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m16:15:24.007446 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:15:24.008918 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:24.010678 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:15:24.012214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:24.013568 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m16:15:24.020652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:24.029981 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.032399 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:15:24.033609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.037725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.040356 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m16:15:24.041635 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.043257 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:15:24.045094 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:15:24.048842 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:15:24.049855 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.051650 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m16:15:24.053353 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:24.055794 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m16:15:24.061852 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m16:15:24.069428 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.071510 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m16:15:24.074722 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m16:15:24.076986 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.32s]
[0m16:15:24.079220 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m16:15:24.081921 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:15:24.084784 [info ] [Thread-2 (]: 7 of 17 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.31s]
[0m16:15:24.089134 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:15:24.091738 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:15:24.092607 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.093837 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m16:15:24.096063 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:15:24.100699 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m16:15:24.102769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:15:24.104514 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_customers_customer_id ............................ [RUN]
[0m16:15:24.107111 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m16:15:24.108774 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:15:24.109609 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.110968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m16:15:24.113817 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.36s]
[0m16:15:24.124792 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:15:24.128218 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m16:15:24.129912 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:15:24.131854 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:15:24.135458 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m16:15:24.153909 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.38s]
[0m16:15:24.150602 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:15:24.148592 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:15:24.156957 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:15:24.158706 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:15:24.160904 [info ] [Thread-4 (]: 10 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m16:15:24.169406 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:15:24.171919 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:15:24.174227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m16:15:24.178451 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:15:24.177298 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m16:15:24.180643 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:15:24.190409 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:15:24.192432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m16:15:24.193563 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:15:24.209023 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:15:24.211901 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:15:24.214180 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:15:24.229506 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:15:24.231425 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:24.233427 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:15:24.234823 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:15:24.244434 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:15:24.246361 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:15:24.254364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:24.256349 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.259648 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:15:24.262291 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:15:24.269297 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:15:24.271289 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:15:24.272532 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:15:24.275823 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m16:15:24.277192 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.278739 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:24.280256 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.285236 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:15:24.292722 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:15:24.294126 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:15:24.296247 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:15:24.297560 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:24.300294 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m16:15:24.303163 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.20s]
[0m16:15:24.305919 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.310052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:24.312310 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:15:24.313053 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.314492 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:15:24.318496 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:15:24.323275 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:15:24.325865 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m16:15:24.328179 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_payments_payment_id ............................. [RUN]
[0m16:15:24.330577 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:15:24.332611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.336188 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m16:15:24.339169 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.23s]
[0m16:15:24.341519 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.342713 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:15:24.345464 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:15:24.348497 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:15:24.353318 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m16:15:24.355930 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m16:15:24.367137 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:15:24.369904 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m16:15:24.373279 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m16:15:24.377654 [info ] [Thread-2 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m16:15:24.378973 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.381440 [info ] [Thread-4 (]: 10 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded . [[32mPASS[0m in 0.21s]
[0m16:15:24.383206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now model.api_bi_project.fct_marketing_attribution)
[0m16:15:24.387188 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m16:15:24.389818 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:15:24.390815 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:15:24.392175 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m16:15:24.394062 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m16:15:24.395162 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m16:15:24.400430 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:15:24.407088 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.409412 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.22s]
[0m16:15:24.411237 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m16:15:24.417112 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:15:24.418978 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now model.api_bi_project.dim_customer)
[0m16:15:24.421944 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m16:15:24.428267 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m16:15:24.428988 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:15:24.430853 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m16:15:24.432250 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m16:15:24.457805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:24.464283 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m16:15:24.472726 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.480487 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m16:15:24.486582 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.489167 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:15:24.490932 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:15:24.493883 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.495172 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:15:24.496751 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m16:15:24.498203 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m16:15:24.499691 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:24.501131 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:24.510499 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.517877 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m16:15:24.519458 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.521673 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m16:15:24.522704 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.524421 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.526651 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.19s]
[0m16:15:24.528541 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:15:24.530557 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m16:15:24.534215 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:15:24.536384 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m16:15:24.539819 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m16:15:24.542776 [info ] [Thread-1 (]: 15 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m16:15:24.547066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now model.api_bi_project.fct_revenue_daily)
[0m16:15:24.549389 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m16:15:24.557162 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.557730 [debug] [Thread-4 (]: SQL status: SELECT 1013 in 0.0 seconds
[0m16:15:24.565724 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:15:24.567753 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m16:15:24.570262 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:24.576677 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:15:24.577473 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m16:15:24.578926 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m16:15:24.584349 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.586576 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:24.595986 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:15:24.597736 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:15:24.599618 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:15:24.602993 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.604463 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m16:15:24.606100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:24.610742 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:15:24.617108 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m16:15:24.624603 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:15:24.626230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.627395 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m16:15:24.628331 [debug] [Thread-2 (]: SQL status: SELECT 5749 in 0.0 seconds
[0m16:15:24.629653 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.637212 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.638712 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m16:15:24.640402 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m16:15:24.644926 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:24.653097 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:15:24.654940 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.657281 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m16:15:24.658908 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m16:15:24.661521 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183dd08c410>]}
[0m16:15:24.663944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:24.665256 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1013[0m in 0.24s]
[0m16:15:24.670733 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:15:24.672801 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m16:15:24.674082 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.676658 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:15:24.680297 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:15:24.685653 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m16:15:24.688221 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:15:24.689680 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m16:15:24.691490 [debug] [Thread-1 (]: SQL status: SELECT 4348 in 0.0 seconds
[0m16:15:24.697847 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.699383 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m16:15:24.701866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:24.709211 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.710007 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:15:24.711086 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m16:15:24.713444 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m16:15:24.715849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:24.716803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183de940a50>]}
[0m16:15:24.719658 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:15:24.721817 [info ] [Thread-2 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5749[0m in 0.33s]
[0m16:15:24.724063 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.727708 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m16:15:24.729265 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:15:24.731868 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:15:24.734850 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m16:15:24.735820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:15:24.737695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m16:15:24.746549 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m16:15:24.748086 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:15:24.750435 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:15:24.758091 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:15:24.760224 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m16:15:24.767796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:15:24.776026 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m16:15:24.779041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0fc5670-c0dd-45ce-a823-21ec0a411e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183df6f53d0>]}
[0m16:15:24.780277 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:15:24.782593 [info ] [Thread-1 (]: 15 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4348[0m in 0.23s]
[0m16:15:24.788514 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:15:24.791495 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m16:15:24.795348 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:15:24.797272 [info ] [Thread-2 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m16:15:24.799472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m16:15:24.801437 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:15:24.810108 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:15:24.813242 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:15:24.815119 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m16:15:24.816802 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:24.828492 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:15:24.836806 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:15:24.838626 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.841637 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:15:24.843585 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m16:15:24.848923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.852877 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m16:15:24.854991 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m16:15:24.855895 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:15:24.859386 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.12s]
[0m16:15:24.862992 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m16:15:24.865423 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:15:24.868305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:24.889016 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.891936 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:15:24.895257 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m16:15:24.899743 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:24.903605 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m16:15:24.913340 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m16:15:24.916997 [info ] [Thread-2 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.12s]
[0m16:15:24.920373 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:15:24.926261 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:24.929445 [debug] [MainThread]: On master: BEGIN
[0m16:15:24.931362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:24.949026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:15:24.951096 [debug] [MainThread]: On master: COMMIT
[0m16:15:24.952833 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:24.954401 [debug] [MainThread]: On master: COMMIT
[0m16:15:24.956319 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:15:24.958040 [debug] [MainThread]: On master: Close
[0m16:15:24.959763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:24.961708 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m16:15:24.963664 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m16:15:24.964969 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m16:15:24.966281 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m16:15:24.967836 [info ] [MainThread]: 
[0m16:15:24.969656 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m16:15:24.976278 [debug] [MainThread]: Command end result
[0m16:15:25.065600 [info ] [MainThread]: 
[0m16:15:25.068105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:25.070268 [info ] [MainThread]: 
[0m16:15:25.072479 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m16:15:25.075672 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0490823, "process_user_time": 3.719063, "process_kernel_time": 0.729666, "process_mem_max_rss": "116248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:15:25.077763 [debug] [MainThread]: Command `dbt build` succeeded at 16:15:25.077458 after 5.05 seconds
[0m16:15:25.079435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183e287c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183ded58ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7183e2b13910>]}
[0m16:15:25.082150 [debug] [MainThread]: Flushing usage events
[0m16:30:13.992656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495bdb2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495bdb2ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495bdb2dd0>]}


============================== 16:30:14.013937 | 4f45cf41-d237-423f-9823-8a49f12a66be ==============================
[0m16:30:14.013937 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:30:14.016097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:14.302469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f45cf41-d237-423f-9823-8a49f12a66be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495bc75110>]}
[0m16:30:15.146007 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2rj6k9q1'
[0m16:30:15.148192 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:30:13.044111 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:30:13.047014 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:30:13.280117 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:30:13.289235 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:30:23.834050 [info ] [MainThread]: Installed from version 1.3.1
[0m16:30:23.836061 [info ] [MainThread]: Up to date!
[0m16:30:23.844598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4f45cf41-d237-423f-9823-8a49f12a66be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495be23450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495d2c1d10>]}
[0m16:30:23.851469 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 12.417852, "process_user_time": 3.007461, "process_kernel_time": 1.031354, "process_mem_max_rss": "94816", "process_out_blocks": "168", "process_in_blocks": "0"}
[0m16:30:23.853939 [debug] [MainThread]: Command `dbt deps` succeeded at 16:30:23.853620 after 12.42 seconds
[0m16:30:23.859530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495fbd0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495c0ecc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78495c0ecd50>]}
[0m16:30:23.861187 [debug] [MainThread]: Flushing usage events
[0m16:30:30.522613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d50d43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d5119610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d511abd0>]}


============================== 16:30:30.530065 | 4d4afb0d-4403-4762-9464-69f9884c7b91 ==============================
[0m16:30:30.530065 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:30:30.532571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --fail-fast --profiles-dir /root/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:30:30.946266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d5017950>]}
[0m16:30:31.044818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d8e0c7d0>]}
[0m16:30:31.047899 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:30:31.104496 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:30:32.877949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:32.879451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:32.949161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d37247d0>]}
[0m16:30:33.130704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d33046d0>]}
[0m16:30:33.132818 [info ] [MainThread]: Found 6 models, 11 data tests, 531 macros
[0m16:30:33.141001 [info ] [MainThread]: 
[0m16:30:33.144449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:33.153585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:30:33.157459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:30:33.279028 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:30:33.280103 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:30:33.282188 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:30:33.285125 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:30:33.287567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:33.289185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:33.310656 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:30:33.314800 [debug] [ThreadPool]: On list_db: Close
[0m16:30:33.315570 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:30:33.320537 [debug] [ThreadPool]: On list_db: Close
[0m16:30:33.325494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m16:30:33.327298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m16:30:33.341782 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:30:33.345004 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:30:33.346225 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m16:30:33.347340 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m16:30:33.348692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:33.350317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:33.366325 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:30:33.367640 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:30:33.369546 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m16:30:33.371141 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m16:30:33.372754 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m16:30:33.374494 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:30:33.384113 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:30:33.384994 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:30:33.387817 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m16:30:33.390630 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m16:30:33.392394 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m16:30:33.393391 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m16:30:33.407530 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:33.408995 [debug] [MainThread]: On master: BEGIN
[0m16:30:33.410065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:33.424570 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:33.426576 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:33.428656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:33.463057 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m16:30:33.466199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d505e250>]}
[0m16:30:33.468691 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:33.470998 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:33.472477 [debug] [MainThread]: On master: BEGIN
[0m16:30:33.474354 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:33.477120 [debug] [MainThread]: On master: COMMIT
[0m16:30:33.479232 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:33.480879 [debug] [MainThread]: On master: COMMIT
[0m16:30:33.482892 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:33.484839 [debug] [MainThread]: On master: Close
[0m16:30:33.487475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:30:33.489426 [info ] [MainThread]: 
[0m16:30:33.498548 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m16:30:33.499263 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m16:30:33.499962 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m16:30:33.502325 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m16:30:33.505438 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m16:30:33.508113 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m16:30:33.510866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m16:30:33.513081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m16:30:33.515408 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m16:30:33.517123 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m16:30:33.520040 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m16:30:33.522411 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m16:30:33.533768 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m16:30:33.538825 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m16:30:33.543269 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m16:30:33.554358 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m16:30:33.555458 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m16:30:33.562822 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m16:30:33.785364 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m16:30:33.788232 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m16:30:33.790735 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m16:30:33.799965 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:30:33.801448 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:30:33.803557 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m16:30:33.805381 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:30:33.809716 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m16:30:33.813065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:33.814870 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m16:30:33.816993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:33.820538 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:30:33.839788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:33.843821 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:30:33.851433 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:33.852661 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:33.854948 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m16:30:33.859214 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:30:33.866883 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:30:33.871911 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m16:30:33.878485 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m16:30:33.879835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:30:33.893466 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:30:33.895409 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:30:33.930685 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:30:33.943111 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:30:33.973507 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:30:33.977002 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m16:30:33.982874 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m16:30:33.985926 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m16:30:33.993220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:33.996299 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:33.999235 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:34.013113 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:30:34.028306 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:30:34.043298 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:30:34.044507 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:30:34.046580 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m16:30:34.049096 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m16:30:34.052377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:34.055114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:34.059057 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:34.097448 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:30:34.094850 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:30:34.101005 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:30:34.103943 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:30:34.106410 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:30:34.108309 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:30:34.110015 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m16:30:34.111495 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m16:30:34.113333 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m16:30:34.129609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:34.131636 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:34.132843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:34.154243 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m16:30:34.161777 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m16:30:34.166582 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m16:30:34.177034 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m16:30:34.179158 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m16:30:34.182082 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m16:30:34.184948 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m16:30:34.187229 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m16:30:34.190546 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m16:30:34.211473 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:30:34.223689 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m16:30:34.228725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d20238d0>]}
[0m16:30:34.234475 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.71s]
[0m16:30:34.237276 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m16:30:34.240523 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:30:34.241529 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:30:34.243975 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m16:30:34.245904 [info ] [Thread-2 (]: 5 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m16:30:34.250078 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4'
[0m16:30:34.253657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m16:30:34.255330 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:30:34.256911 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:30:34.283204 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:30:34.296761 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:30:34.328311 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:30:34.330864 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m16:30:34.335770 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:30:34.338902 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d20815d0>]}
[0m16:30:34.346834 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m16:30:34.355439 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:30:34.350197 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.82s]
[0m16:30:34.363536 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:30:34.365810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d2080bd0>]}
[0m16:30:34.525515 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m16:30:34.526144 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:30:34.532919 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:30:34.535770 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.86s]
[0m16:30:34.538161 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:30:34.543794 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m16:30:34.546003 [info ] [Thread-3 (]: 6 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m16:30:34.548489 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:30:34.552817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m16:30:34.554284 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:30:34.555178 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:30:34.556775 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m16:30:34.558648 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:30:34.560802 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m16:30:34.562841 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m16:30:34.565145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m16:30:34.578962 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:30:34.581140 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:34.582774 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:30:34.584394 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:30:34.609010 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:30:34.611392 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:34.612512 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:34.614267 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:30:34.615959 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m16:30:34.619310 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m16:30:34.620722 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:30:34.628522 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:30:34.631109 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m16:30:34.633806 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m16:30:34.639029 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:30:34.648718 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:34.655791 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m16:30:34.656837 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:34.659497 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:30:34.661437 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:30:34.664460 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m16:30:34.665379 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m16:30:34.667259 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m16:30:34.669152 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m16:30:34.671703 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m16:30:34.673286 [info ] [Thread-2 (]: 5 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.42s]
[0m16:30:34.675071 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:30:34.677463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:34.679945 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.43s]
[0m16:30:34.681956 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m16:30:34.689158 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m16:30:34.706502 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:34.707865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:34.712231 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:30:34.715681 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:30:34.718014 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m16:30:34.721463 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m16:30:34.724827 [info ] [Thread-2 (]: 8 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m16:30:34.727775 [info ] [Thread-4 (]: 9 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m16:30:34.732938 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:30:34.735241 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m16:30:34.738776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m16:30:34.740957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m16:30:34.747066 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:30:34.749803 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:30:34.767869 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:34.766862 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:30:34.790486 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:34.791968 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:30:34.794496 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m16:30:34.801094 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m16:30:34.805722 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m16:30:34.807898 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m16:30:34.811905 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:30:34.810615 [info ] [Thread-3 (]: 6 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.26s]
[0m16:30:34.816300 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.25s]
[0m16:30:34.824250 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:30:34.834466 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:30:34.837393 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m16:30:34.840287 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m16:30:34.848218 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:30:34.852015 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:30:34.854489 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:30:34.857162 [info ] [Thread-3 (]: 10 of 17 START test not_null_stg_customers_country ............................. [RUN]
[0m16:30:34.859802 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m16:30:34.863080 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m16:30:34.865488 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:30:34.867571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:30:34.868756 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:30:34.870960 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:30:34.873468 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m16:30:34.879278 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:30:34.882496 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m16:30:34.899692 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:30:34.903285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:34.916456 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:30:34.919530 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:30:34.935164 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:30:34.943736 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:30:34.955609 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:30:34.957596 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:34.961124 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:34.970949 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:30:34.975354 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m16:30:34.979311 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m16:30:34.983099 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:30:34.986035 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m16:30:34.986963 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:30:34.987989 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:30:34.992115 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m16:30:34.993185 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:34.994375 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:30:34.995515 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:30:34.998074 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m16:30:35.000337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:35.003080 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m16:30:35.006268 [info ] [Thread-2 (]: 8 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.27s]
[0m16:30:35.012768 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m16:30:35.014514 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:30:35.017014 [info ] [Thread-2 (]: 12 of 17 START test unique_stg_customers_customer_id ........................... [RUN]
[0m16:30:35.019742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.021202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m16:30:35.022127 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.023874 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:30:35.025995 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:30:35.029640 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m16:30:35.033614 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:30:35.046021 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:30:35.046719 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:35.048174 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m16:30:35.053268 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m16:30:35.054535 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:35.057167 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m16:30:35.058502 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:35.060609 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:30:35.064699 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:30:35.063831 [info ] [Thread-4 (]: 9 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.32s]
[0m16:30:35.068974 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m16:30:35.071343 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:30:35.075434 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:30:35.077368 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m16:30:35.081633 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m16:30:35.083744 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.22s]
[0m16:30:35.086956 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m16:30:35.089799 [info ] [Thread-3 (]: 10 of 17 PASS not_null_stg_customers_country ................................... [[32mPASS[0m in 0.23s]
[0m16:30:35.092351 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:30:35.094574 [info ] [Thread-4 (]: 13 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m16:30:35.097367 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m16:30:35.100191 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m16:30:35.101966 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:30:35.103730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now model.api_bi_project.fct_revenue_daily)
[0m16:30:35.107044 [info ] [Thread-1 (]: 14 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m16:30:35.109429 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:30:35.112060 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m16:30:35.113821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.fct_marketing_attribution)
[0m16:30:35.116129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:35.126199 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.127893 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m16:30:35.139862 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.147440 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.149056 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m16:30:35.151054 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m16:30:35.151761 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m16:30:35.211828 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.215095 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.215628 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:30:35.221625 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:35.225579 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:30:35.226512 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.227458 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.229628 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:30:35.230663 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m16:30:35.231918 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m16:30:35.233986 [info ] [Thread-2 (]: 12 of 17 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.21s]
[0m16:30:35.236683 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:30:35.239237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:35.241944 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m16:30:35.249286 [debug] [Thread-3 (]: Began running node model.api_bi_project.dim_customer
[0m16:30:35.251037 [info ] [Thread-3 (]: 15 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m16:30:35.252856 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now model.api_bi_project.dim_customer)
[0m16:30:35.254475 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.dim_customer
[0m16:30:35.261253 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m16:30:35.263507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.264758 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.267021 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.268627 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.270250 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m16:30:35.271967 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m16:30:35.276415 [debug] [Thread-3 (]: Began executing node model.api_bi_project.dim_customer
[0m16:30:35.284564 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m16:30:35.297946 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:30:35.299925 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: BEGIN
[0m16:30:35.302375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:30:35.319750 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.322524 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:30:35.324247 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m16:30:35.331159 [debug] [Thread-4 (]: SQL status: SELECT 4348 in 0.0 seconds
[0m16:30:35.337414 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.339685 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m16:30:35.340344 [debug] [Thread-3 (]: SQL status: SELECT 1013 in 0.0 seconds
[0m16:30:35.342025 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:35.346453 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:30:35.351718 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.353001 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m16:30:35.354592 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m16:30:35.357572 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:35.358778 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:35.363105 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:30:35.370713 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:30:35.371296 [debug] [Thread-1 (]: SQL status: SELECT 5749 in 0.0 seconds
[0m16:30:35.372331 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m16:30:35.373621 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.379021 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.381108 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:35.382428 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m16:30:35.384121 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m16:30:35.388168 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:30:35.391718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:35.392511 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:30:35.397778 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.399461 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: COMMIT
[0m16:30:35.400769 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m16:30:35.403931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:35.407100 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:30:35.408226 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.409301 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m16:30:35.414709 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:35.415369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:35.415914 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:35.419938 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m16:30:35.426639 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m16:30:35.432023 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m16:30:35.437265 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m16:30:35.439310 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m16:30:35.440906 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m16:30:35.442335 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m16:30:35.443663 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m16:30:35.445218 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m16:30:35.453731 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:30:35.457747 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m16:30:35.459583 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d50c81d0>]}
[0m16:30:35.463496 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:30:35.464704 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:30:35.462259 [info ] [Thread-4 (]: 13 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 4348[0m in 0.36s]
[0m16:30:35.469176 [debug] [Thread-3 (]: On model.api_bi_project.dim_customer: Close
[0m16:30:35.473488 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m16:30:35.477377 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m16:30:35.481275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d218ba10>]}
[0m16:30:35.487767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4afb0d-4403-4762-9464-69f9884c7b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d1eb2e50>]}
[0m16:30:35.490690 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:30:35.492830 [info ] [Thread-3 (]: 15 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 1013[0m in 0.23s]
[0m16:30:35.495749 [info ] [Thread-1 (]: 14 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 5749[0m in 0.37s]
[0m16:30:35.498477 [info ] [Thread-2 (]: 16 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m16:30:35.500710 [debug] [Thread-3 (]: Finished running node model.api_bi_project.dim_customer
[0m16:30:35.504726 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m16:30:35.507787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m16:30:35.512245 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:30:35.513656 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:30:35.515207 [info ] [Thread-4 (]: 17 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m16:30:35.528553 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:30:35.530069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_revenue_daily, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m16:30:35.532629 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:30:35.539250 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:30:35.545428 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:30:35.546886 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:30:35.552684 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:30:35.572495 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:30:35.582033 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:30:35.583695 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:30:35.586525 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m16:30:35.589778 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m16:30:35.591935 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:30:35.593948 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:30:35.611061 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.614055 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m16:30:35.615321 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.617105 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m16:30:35.619171 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m16:30:35.624608 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m16:30:35.625603 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:35.630574 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m16:30:35.631845 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:35.634499 [debug] [Thread-2 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m16:30:35.637953 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m16:30:35.643831 [info ] [Thread-2 (]: 16 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.14s]
[0m16:30:35.710235 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m16:30:35.713806 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m16:30:35.717590 [info ] [Thread-4 (]: 17 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.19s]
[0m16:30:35.722441 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m16:30:35.728408 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:35.743273 [debug] [MainThread]: On master: BEGIN
[0m16:30:35.745082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:35.757713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:35.759938 [debug] [MainThread]: On master: COMMIT
[0m16:30:35.761616 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:35.763312 [debug] [MainThread]: On master: COMMIT
[0m16:30:35.765234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:35.767040 [debug] [MainThread]: On master: Close
[0m16:30:35.768953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:35.770636 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m16:30:35.771779 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m16:30:35.773052 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m16:30:35.774264 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m16:30:35.775480 [info ] [MainThread]: 
[0m16:30:35.777231 [info ] [MainThread]: Finished running 3 view models, 11 data tests, 3 table models in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m16:30:35.783793 [debug] [MainThread]: Command end result
[0m16:30:35.864982 [info ] [MainThread]: 
[0m16:30:35.867252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:35.871440 [info ] [MainThread]: 
[0m16:30:35.873940 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m16:30:35.877855 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.4654975, "process_user_time": 4.647571, "process_kernel_time": 0.680781, "process_mem_max_rss": "116808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:30:35.879885 [debug] [MainThread]: Command `dbt build` succeeded at 16:30:35.879709 after 5.47 seconds
[0m16:30:35.881361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d8febc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d8ef4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c51d50cbc10>]}
[0m16:30:35.883025 [debug] [MainThread]: Flushing usage events
