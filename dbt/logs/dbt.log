[0m18:40:12.855836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f96d0>]}


============================== 18:40:12.871351 | f9744f38-c30a-4bfe-a9ab-64432f3a73d5 ==============================
[0m18:40:12.871351 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:40:12.875622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:40:12.905924 [info ] [MainThread]: dbt version: 1.8.2
[0m18:40:12.911358 [info ] [MainThread]: python version: 3.11.9
[0m18:40:12.914776 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:40:12.917363 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m18:40:12.926036 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 7
  ------------------------------
  4  |     dev:
  5  |       type: postgres
  6  |       host: postgres
  7  |       user: {{ env_var('POSTGRES_USER') }}
  8  |       password: {{ env_var('POSTGRES_PASSWORD') }}
  9  |       port: 5432
  10 |       dbname: {{ env_var('POSTGRES_DB') }}
  
  Raw Error:
  ------------------------------
  while constructing a mapping
    in "<unicode string>", line 7, column 13
  found unhashable key
    in "<unicode string>", line 7, column 14
[0m18:40:12.931153 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.112251274, "process_user_time": 2.127118, "process_kernel_time": 0.336856, "process_mem_max_rss": "98236", "process_in_blocks": "192", "command_success": false, "process_out_blocks": "0"}
[0m18:40:12.934686 [debug] [MainThread]: Command `dbt debug` failed at 18:40:12.934104 after 0.12 seconds
[0m18:40:12.937532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec99c0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ec58f25d0>]}
[0m18:40:12.940137 [debug] [MainThread]: Flushing usage events
[0m18:44:46.842281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703d2c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5b890>]}


============================== 18:44:46.852333 | 44eb3e1a-3e47-4d17-a12f-e22dc7d028e4 ==============================
[0m18:44:46.852333 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:44:46.855284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:46.872514 [info ] [MainThread]: dbt version: 1.8.2
[0m18:44:46.874468 [info ] [MainThread]: python version: 3.11.9
[0m18:44:46.876570 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:44:46.878929 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m18:44:46.887525 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 8
  ------------------------------
  5  |       type: postgres
  6  |       host: postgres
  7  |       user: {{
  
  Raw Error:
  ------------------------------
  while parsing a flow node
  did not find expected node content
    in "<unicode string>", line 8, column 1
[0m18:44:46.893735 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.08303495, "process_user_time": 2.137301, "process_kernel_time": 0.293355, "process_mem_max_rss": "98540", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:44:46.895927 [debug] [MainThread]: Command `dbt debug` failed at 18:44:46.895694 after 0.09 seconds
[0m18:44:46.898267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c604d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b703c5a410>]}
[0m18:44:46.901012 [debug] [MainThread]: Flushing usage events
[0m18:54:56.576875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c733ff750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c73550ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c733ffb90>]}


============================== 18:54:56.598694 | e96bab67-7b8a-44f7-aa8e-0bb63317c1e0 ==============================
[0m18:54:56.598694 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:54:56.601738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:54:57.498599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7333ab90>]}
[0m18:54:57.688347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7520dcd0>]}
[0m18:54:57.693066 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:54:58.010532 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:54:58.018471 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:54:58.020752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7295edd0>]}
[0m18:54:58.862219 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:54:58.872352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e96bab67-7b8a-44f7-aa8e-0bb63317c1e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c721f2850>]}
[0m18:54:58.946351 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_customers' in the 'models' section of file 'models/models.yml'
[0m18:54:59.487133 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.api_bi_project.dim_customer' (models/marts/dim_customer.sql) depends on a node named 'stg_customers' which was not found
[0m18:54:59.498063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6772404, "process_user_time": 8.461257, "process_kernel_time": 1.87641, "process_mem_max_rss": "162112", "process_in_blocks": "6760", "process_out_blocks": "2432", "command_success": false}
[0m18:54:59.503026 [debug] [MainThread]: Command `dbt run` failed at 18:54:59.502623 after 4.68 seconds
[0m18:54:59.505558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c73442110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c73405050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746c7191add0>]}
[0m18:54:59.508451 [debug] [MainThread]: Flushing usage events
[0m18:55:13.316705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2843990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2842350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2a34950>]}


============================== 18:55:13.327585 | 2ccff660-5748-4493-9ac1-e5f12b461412 ==============================
[0m18:55:13.327585 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:55:13.330265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:13.550886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf2883b50>]}
[0m18:55:13.620054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf4596e10>]}
[0m18:55:13.622943 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:55:13.790843 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:55:13.796730 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:55:13.798176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf1ffe6d0>]}
[0m18:55:15.481995 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:55:15.483670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ccff660-5748-4493-9ac1-e5f12b461412', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf17cb1d0>]}
[0m18:55:15.498865 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_customers' in the 'models' section of file 'models/models.yml'
[0m18:55:15.750321 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.api_bi_project.dim_customer' (models/marts/dim_customer.sql) depends on a node named 'stg_customers' which was not found
[0m18:55:15.753186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5240617, "process_user_time": 4.92323, "process_kernel_time": 0.564835, "process_mem_max_rss": "162124", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:55:15.755244 [debug] [MainThread]: Command `dbt run` failed at 18:55:15.755049 after 2.53 seconds
[0m18:55:15.756903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf0f1f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf0f712d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cf29447d0>]}
[0m18:55:15.759589 [debug] [MainThread]: Flushing usage events
[0m18:57:39.508620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8ca52e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8ca7a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8ca92350>]}


============================== 18:57:39.517807 | ddfdf513-cf14-4f60-b3f8-9c704866948b ==============================
[0m18:57:39.517807 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:57:39.519321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --select stg_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:57:39.730819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8cb0ea50>]}
[0m18:57:39.886233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8e7bf810>]}
[0m18:57:39.888933 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:57:40.036819 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:57:40.040922 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:57:40.042436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8c18a1d0>]}
[0m18:57:41.230930 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:57:41.232989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8b9f0ad0>]}
[0m18:57:41.750864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8b9e14d0>]}
[0m18:57:41.966926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8d678dd0>]}
[0m18:57:41.969993 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:57:41.972709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8e484f50>]}
[0m18:57:41.980364 [info ] [MainThread]: 
[0m18:57:41.989144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:41.996912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:57:42.085111 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:57:42.086616 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:57:42.087764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:42.105996 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m18:57:42.109554 [debug] [ThreadPool]: On list_db: Close
[0m18:57:42.112721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m18:57:42.114905 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m18:57:42.123556 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:57:42.125071 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m18:57:42.126292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:42.139546 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m18:57:42.141528 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:57:42.143054 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m18:57:42.146868 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m18:57:42.149156 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:57:42.150573 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:57:42.152262 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:57:42.155136 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:57:42.156929 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m18:57:42.165751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_analytics)
[0m18:57:42.167400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m18:57:42.177090 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:42.181039 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:42.183361 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:57:42.185528 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:57:42.187365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:42.188691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:42.202900 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m18:57:42.204012 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:57:42.205893 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:42.207188 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:42.208508 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:57:42.209921 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:57:42.217854 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m18:57:42.218383 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:57:42.221085 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:57:42.224288 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:57:42.226102 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:57:42.227109 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:57:42.237739 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.239197 [debug] [MainThread]: On master: BEGIN
[0m18:57:42.240388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:42.253410 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m18:57:42.255547 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.257742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:42.287577 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m18:57:42.290737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb88c82410>]}
[0m18:57:42.292557 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:42.294914 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.296616 [debug] [MainThread]: On master: BEGIN
[0m18:57:42.299540 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:57:42.302136 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.304170 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.306687 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.309515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:42.311037 [debug] [MainThread]: On master: Close
[0m18:57:42.313095 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:42.317368 [info ] [MainThread]: 
[0m18:57:42.334797 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:57:42.337862 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:57:42.342377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m18:57:42.347504 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:57:42.369846 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:57:42.408892 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:57:42.529486 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:57:42.569338 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.571036 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:57:42.572662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:42.587773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m18:57:42.591099 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.593436 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:57:42.603351 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m18:57:42.613974 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.615609 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:57:42.620819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:57:42.644046 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:42.645804 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.647065 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:42.650730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:57:42.663647 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:57:42.675088 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:42.678185 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:57:42.683535 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:57:42.689610 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:57:42.694618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddfdf513-cf14-4f60-b3f8-9c704866948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb8b131490>]}
[0m18:57:42.697318 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.35s]
[0m18:57:42.700704 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:57:42.707258 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.709781 [debug] [MainThread]: On master: BEGIN
[0m18:57:42.711212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:42.726944 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m18:57:42.729399 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.731648 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:42.733773 [debug] [MainThread]: On master: COMMIT
[0m18:57:42.735878 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:42.738250 [debug] [MainThread]: On master: Close
[0m18:57:42.739760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:42.741486 [debug] [MainThread]: Connection 'list_db_public_analytics' was properly closed.
[0m18:57:42.742758 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:57:42.744875 [info ] [MainThread]: 
[0m18:57:42.751044 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m18:57:42.754942 [debug] [MainThread]: Command end result
[0m18:57:42.847969 [info ] [MainThread]: 
[0m18:57:42.850492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:42.852585 [info ] [MainThread]: 
[0m18:57:42.856768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:57:42.862209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4378366, "process_user_time": 4.895015, "process_kernel_time": 0.505442, "process_mem_max_rss": "122712", "process_in_blocks": "2040", "process_out_blocks": "0"}
[0m18:57:42.869491 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:42.865929 after 3.44 seconds
[0m18:57:42.880613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb90b21450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb90adf2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fb90b017d0>]}
[0m18:57:42.884649 [debug] [MainThread]: Flushing usage events
[0m18:57:50.714857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb59565f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5a907c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5a115310>]}


============================== 18:57:50.723203 | 5c274f54-5180-48a0-b576-b49ab3a6ab72 ==============================
[0m18:57:50.723203 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:57:50.725705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --select stg_customers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:50.914944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb589fc8d0>]}
[0m18:57:50.994951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5b2bb510>]}
[0m18:57:50.997253 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:57:51.150967 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:57:51.449188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:51.450934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:51.519298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb57d43bd0>]}
[0m18:57:51.684209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb581e88d0>]}
[0m18:57:51.686107 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:57:51.687842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5798c050>]}
[0m18:57:51.691632 [info ] [MainThread]: 
[0m18:57:51.693789 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:51.697531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:57:51.767868 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:57:51.769368 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:57:51.770563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:51.786384 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m18:57:51.789329 [debug] [ThreadPool]: On list_db: Close
[0m18:57:51.797997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m18:57:51.800001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m18:57:51.808706 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:51.812278 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:51.813945 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:57:51.815931 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:57:51.817603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:51.818964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:51.832257 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m18:57:51.834177 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:57:51.835965 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:57:51.838058 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:57:51.839908 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:57:51.841351 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:57:51.848190 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:57:51.849423 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:57:51.852383 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:57:51.854922 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:57:51.857109 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:57:51.858366 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:57:51.872217 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.874227 [debug] [MainThread]: On master: BEGIN
[0m18:57:51.876195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:51.888894 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m18:57:51.890648 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.892434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:51.921925 [debug] [MainThread]: SQL status: SELECT 1 in 0.028 seconds
[0m18:57:51.925026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb58918f50>]}
[0m18:57:51.926650 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:51.928510 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.929766 [debug] [MainThread]: On master: BEGIN
[0m18:57:51.931513 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:57:51.933613 [debug] [MainThread]: On master: COMMIT
[0m18:57:51.935468 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.936720 [debug] [MainThread]: On master: COMMIT
[0m18:57:51.938252 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:51.939481 [debug] [MainThread]: On master: Close
[0m18:57:51.941076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:51.942631 [info ] [MainThread]: 
[0m18:57:51.962130 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:57:51.964807 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:57:51.967806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m18:57:51.970023 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:57:51.980653 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:57:51.995585 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:57:52.102920 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:57:52.115035 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.116468 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:57:52.117777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:52.128974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:57:52.130896 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.132494 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:57:52.137223 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:57:52.145637 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.147043 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:57:52.149257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:57:52.153314 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.154371 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:57:52.155851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:57:52.172731 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:52.173979 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.174948 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:57:52.179155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:57:52.188217 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:57:52.195919 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:57:52.197277 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:57:52.204626 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m18:57:52.208976 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:57:52.212257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c274f54-5180-48a0-b576-b49ab3a6ab72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb56615250>]}
[0m18:57:52.214150 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.24s]
[0m18:57:52.216740 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:57:52.222064 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.223946 [debug] [MainThread]: On master: BEGIN
[0m18:57:52.225595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:52.240400 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m18:57:52.245021 [debug] [MainThread]: On master: COMMIT
[0m18:57:52.247185 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.248873 [debug] [MainThread]: On master: COMMIT
[0m18:57:52.250873 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:52.253012 [debug] [MainThread]: On master: Close
[0m18:57:52.255286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:52.256591 [debug] [MainThread]: Connection 'list_db_public_staging' was properly closed.
[0m18:57:52.258113 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:57:52.259829 [info ] [MainThread]: 
[0m18:57:52.261237 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m18:57:52.263564 [debug] [MainThread]: Command end result
[0m18:57:52.331767 [info ] [MainThread]: 
[0m18:57:52.333722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:52.335649 [info ] [MainThread]: 
[0m18:57:52.337380 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:57:52.340322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7041295, "process_user_time": 3.505124, "process_kernel_time": 0.50181, "process_mem_max_rss": "119352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:57:52.342559 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:52.342322 after 1.71 seconds
[0m18:57:52.344538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5d654290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5d64c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fb5d6da990>]}
[0m18:57:52.346206 [debug] [MainThread]: Flushing usage events
[0m18:58:24.783637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbf96bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbf96b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbf96bad0>]}


============================== 18:58:24.880207 | df65290b-011a-4f79-b180-771b7512f53b ==============================
[0m18:58:24.880207 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:58:24.897412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m18:58:25.528300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4d833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c526a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6291750>]}


============================== 18:58:25.542083 | d00eada9-057c-40cd-803e-12a0e3e4c779 ==============================
[0m18:58:25.542083 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:58:25.544913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m18:58:25.685497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbfa03c90>]}
[0m18:58:25.797081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc16bf450>]}
[0m18:58:25.799577 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:25.925005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4dc7010>]}
[0m18:58:26.005969 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:58:26.028370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6b0b9d0>]}
[0m18:58:26.032981 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:26.496318 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:58:27.167757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:27.169758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:27.333422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbe961390>]}
[0m18:58:27.564549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:27.569323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:27.720048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c35a2810>]}
[0m18:58:27.819935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbd913ed0>]}
[0m18:58:27.822208 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:58:27.824195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbe575290>]}
[0m18:58:27.835758 [info ] [MainThread]: 
[0m18:58:27.841813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:27.858773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:27.861467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:28.014300 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.015466 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.017762 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.022339 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.025134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.026986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.069380 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.044 seconds
[0m18:58:28.098726 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.132715 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.106 seconds
[0m18:58:28.137871 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.141057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m18:58:28.146063 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m18:58:28.157820 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:58:28.163778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c2d17fd0>]}
[0m18:58:28.166456 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m18:58:28.167034 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:58:28.171013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c397c910>]}
[0m18:58:28.170950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.181116 [info ] [MainThread]: 
[0m18:58:28.183648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:28.189025 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m18:58:28.191875 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:58:28.193625 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m18:58:28.197535 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:58:28.196744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:28.200569 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:58:28.202031 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:58:28.204090 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:58:28.208114 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:58:28.209826 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m18:58:28.198543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:58:28.217178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_staging)
[0m18:58:28.220091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m18:58:28.243451 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.250679 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.252425 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:58:28.255389 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:58:28.260407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.262781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.281708 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m18:58:28.284986 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.286128 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:58:28.287877 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:58:28.289844 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.293631 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:58:28.297286 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m18:58:28.301859 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:58:28.303165 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:58:28.304065 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:58:28.306983 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:58:28.311209 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:58:28.330699 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.331673 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.333198 [debug] [MainThread]: On master: BEGIN
[0m18:58:28.331672 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:58:28.335090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:28.333173 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.335563 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:58:28.337778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.340036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:28.355397 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m18:58:28.360578 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.363656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:28.369474 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.032 seconds
[0m18:58:28.370431 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.030 seconds
[0m18:58:28.385768 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.400516 [debug] [ThreadPool]: On list_db: Close
[0m18:58:28.424140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m18:58:28.426257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m18:58:28.440629 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.463416 [debug] [MainThread]: SQL status: SELECT 1 in 0.094 seconds
[0m18:58:28.454866 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.478698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbd941490>]}
[0m18:58:28.470247 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:58:28.497966 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:28.497436 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:58:28.562045 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.515216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.578264 [debug] [MainThread]: On master: BEGIN
[0m18:58:28.571545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:28.631628 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:58:28.656092 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m18:58:28.693459 [debug] [ThreadPool]: SQL status: BEGIN in 0.122 seconds
[0m18:58:28.687662 [debug] [MainThread]: On master: COMMIT
[0m18:58:28.818268 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:28.773800 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:28.799065 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:28.841515 [debug] [MainThread]: On master: COMMIT
[0m18:58:28.835796 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:58:28.862178 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:58:28.883372 [debug] [MainThread]: On master: Close
[0m18:58:28.861305 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:58:28.913452 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.030 seconds
[0m18:58:28.918288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:28.953505 [info ] [MainThread]: 
[0m18:58:28.921906 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m18:58:28.953578 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:58:29.158010 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:58:29.092214 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:58:29.162255 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:58:29.192652 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:58:29.257036 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:58:29.164198 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:58:29.238209 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:58:29.310472 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.302545 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m18:58:29.314233 [debug] [MainThread]: On master: BEGIN
[0m18:58:29.309555 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m18:58:29.325316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:29.313202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m18:58:29.321795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m18:58:29.328453 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:58:29.355556 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:58:29.333243 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:58:29.370309 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.378160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:29.344105 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:58:29.355749 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:58:29.424565 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:58:29.430983 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:58:29.437576 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:58:29.463364 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:58:29.507282 [debug] [MainThread]: SQL status: SELECT 1 in 0.121 seconds
[0m18:58:29.500144 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:58:29.552686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c178a6d0>]}
[0m18:58:29.569123 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:29.583185 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.622211 [debug] [MainThread]: On master: BEGIN
[0m18:58:29.628528 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:58:29.631293 [debug] [MainThread]: On master: COMMIT
[0m18:58:29.640166 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:29.629903 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:58:29.663717 [debug] [MainThread]: On master: COMMIT
[0m18:58:29.687423 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:58:29.696202 [debug] [MainThread]: On master: Close
[0m18:58:29.703894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:29.724818 [info ] [MainThread]: 
[0m18:58:29.785904 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:58:29.787276 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:58:29.788664 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:58:29.784388 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:58:29.789270 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:58:29.791718 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:58:29.806798 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m18:58:29.816396 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:58:29.821530 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m18:58:29.828072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m18:58:29.833450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m18:58:29.837007 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:58:29.853549 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:29.858582 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:58:29.861961 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:29.847166 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:58:29.868628 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:29.887595 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:58:29.852475 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:58:29.932912 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:29.866990 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:58:29.935139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:29.948550 [debug] [Thread-3 (]: SQL status: BEGIN in 0.077 seconds
[0m18:58:29.937679 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:58:29.955211 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:58:29.976238 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:58:30.005582 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:58:30.016657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m18:58:30.060952 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.114897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:30.125889 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.160601 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:58:30.142295 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:58:30.160597 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:58:30.164016 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:58:30.178647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.065 seconds
[0m18:58:30.212412 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m18:58:30.227438 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m18:58:30.216310 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:58:30.239545 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.302408 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.319993 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.349419 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:58:30.356039 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:58:30.381162 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:58:30.467207 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m18:58:30.488276 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:58:30.504179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:58:30.656712 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:58:30.528471 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.673592 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:58:30.677086 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:58:30.691337 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.715773 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:58:30.735146 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:58:30.792580 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.749658 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:58:30.771336 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:58:30.826411 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:58:30.828114 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:30.832968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:30.800857 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.837122 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:30.841653 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:58:30.827816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:58:30.882872 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:58:30.902593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:30.914984 [debug] [Thread-2 (]: SQL status: BEGIN in 0.082 seconds
[0m18:58:30.856236 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:58:30.926989 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:30.970425 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:30.882891 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:58:30.935381 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:58:30.980893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m18:58:30.985342 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:31.018524 [debug] [Thread-3 (]: SQL status: BEGIN in 0.091 seconds
[0m18:58:31.037846 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.024659 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:58:31.042236 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:58:31.038927 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.074424 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:31.113029 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:58:31.116471 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:58:31.125137 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:58:31.045827 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m18:58:31.147396 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m18:58:31.094365 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:58:31.141000 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m18:58:31.190981 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:31.218382 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:31.239955 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:58:31.220945 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m18:58:31.241475 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.123 seconds
[0m18:58:31.237455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m18:58:31.244291 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:58:31.294725 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "stg_sessions" already exists

[0m18:58:31.302518 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.258080 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m18:58:31.317772 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "stg_payments" already exists

[0m18:58:31.304495 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:58:31.328799 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: ROLLBACK
[0m18:58:31.338504 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:58:31.350933 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:58:31.336360 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:58:31.357162 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: ROLLBACK
[0m18:58:31.357652 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m18:58:31.362588 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:58:31.367202 [debug] [Thread-3 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m18:58:31.374584 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m18:58:31.378407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "stg_customers__dbt_backup" already exists

[0m18:58:31.381359 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m18:58:31.383166 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:58:31.395305 [debug] [Thread-3 (]: Postgres adapter: Rolling back transaction.
[0m18:58:31.398920 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: ROLLBACK
[0m18:58:31.394279 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:58:31.402198 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m18:58:31.399866 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:58:31.420796 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:58:31.429956 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m18:58:31.426309 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:58:31.467048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m18:58:31.434727 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:58:31.474735 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m18:58:31.444931 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:58:31.503381 [debug] [Thread-3 (]: Database Error in model stg_sessions (models/staging/stg_sessions.sql)
  relation "stg_sessions" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_sessions.sql
[0m18:58:31.479446 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc3b8450>]}
[0m18:58:31.494783 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:58:31.518982 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc32aad0>]}
[0m18:58:31.514082 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:58:31.526695 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 2.15s]
[0m18:58:31.536038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbe5cffd0>]}
[0m18:58:31.515738 [debug] [Thread-2 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "stg_payments" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_payments.sql
[0m18:58:31.539628 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 2.20s]
[0m18:58:31.546371 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:58:31.537545 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c168fcd0>]}
[0m18:58:31.553088 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 2.22s]
[0m18:58:31.552655 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "stg_customers__dbt_backup" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_customers.sql
[0m18:58:31.556488 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:58:31.555788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c178f7d0>]}
[0m18:58:31.561869 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m18:58:31.562264 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public_staging.stg_sessions ............... [[31mERROR[0m in 1.69s]
[0m18:58:31.569120 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:58:31.573951 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m18:58:31.569035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd00eada9-057c-40cd-803e-12a0e3e4c779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c2d37510>]}
[0m18:58:31.577851 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m18:58:31.585468 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m18:58:31.574661 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public_staging.stg_payments ............... [[31mERROR[0m in 1.73s]
[0m18:58:31.597310 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m18:58:31.584259 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:58:31.603655 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m18:58:31.602648 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public_staging.stg_customers .............. [[31mERROR[0m in 1.73s]
[0m18:58:31.620254 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m18:58:31.633812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m18:58:31.630832 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:58:31.649344 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m18:58:31.648722 [error] [MainThread]: CANCEL query model.api_bi_project.stg_customers ................................ [[31mCANCEL[0m]
[0m18:58:31.654459 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:58:31.653957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m18:58:31.674699 [error] [MainThread]: CANCEL query model.api_bi_project.stg_payments ................................. [[31mCANCEL[0m]
[0m18:58:31.656890 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m18:58:31.707060 [error] [MainThread]: CANCEL query model.api_bi_project.stg_sessions ................................. [[31mCANCEL[0m]
[0m18:58:31.714962 [info ] [MainThread]: 
[0m18:58:31.717973 [error] [MainThread]:   Database Error in model stg_sessions (models/staging/stg_sessions.sql)
  relation "stg_sessions" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_sessions.sql
[0m18:58:31.720828 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:31.697744 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.723210 [debug] [MainThread]: On master: BEGIN
[0m18:58:31.700063 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m18:58:31.725559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:31.723125 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.741747 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m18:58:31.759756 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m18:58:31.770176 [debug] [MainThread]: On master: COMMIT
[0m18:58:31.772524 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:31.774715 [debug] [MainThread]: On master: COMMIT
[0m18:58:31.777710 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m18:58:31.777849 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:58:31.782425 [debug] [MainThread]: On master: Close
[0m18:58:31.786060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:31.798106 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:58:31.800486 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m18:58:31.802143 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m18:58:31.809789 [info ] [MainThread]: 
[0m18:58:31.815283 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m18:58:31.820657 [debug] [MainThread]: Command end result
[0m18:58:31.809545 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m18:58:31.831658 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m18:58:31.853266 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.856464 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.876396 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m18:58:31.903134 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.907180 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m18:58:31.910636 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.914942 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:58:31.916132 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:31.926557 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m18:58:31.918781 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m18:58:31.929830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:31.932090 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:31.945043 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m18:58:31.950681 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:31.955788 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m18:58:31.961650 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m18:58:31.964200 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m18:58:31.967070 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:31.968720 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:31.972122 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m18:58:31.979628 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m18:58:32.007682 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.022 seconds
[0m18:58:32.024900 [info ] [MainThread]: 
[0m18:58:32.029553 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m18:58:32.033446 [info ] [MainThread]: 
[0m18:58:32.036539 [error] [MainThread]:   Database Error in model stg_sessions (models/staging/stg_sessions.sql)
  relation "stg_sessions" already exists
  compiled code at target/run/api_bi_project/models/staging/stg_sessions.sql
[0m18:58:32.033514 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:32.039740 [info ] [MainThread]: 
[0m18:58:32.040519 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m18:58:32.053400 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.054069 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:58:32.055407 [info ] [MainThread]: 
[0m18:58:32.057681 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.059627 [info ] [MainThread]: 
[0m18:58:32.072874 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.075508 [info ] [MainThread]: 
[0m18:58:32.075926 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:58:32.077641 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.077349 [debug] [Thread-3 (]: SQL status: SELECT 4334 in 0.085 seconds
[0m18:58:32.081337 [info ] [MainThread]: 
[0m18:58:32.085499 [error] [MainThread]:   Skipping due to fail_fast
[0m18:58:32.088550 [info ] [MainThread]: 
[0m18:58:32.098363 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 TOTAL=6
[0m18:58:32.102716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.0074825, "process_user_time": 8.175208, "process_kernel_time": 1.328208, "process_mem_max_rss": "162124", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:32.107311 [debug] [MainThread]: Command `dbt run` failed at 18:58:32.107026 after 7.01 seconds
[0m18:58:32.110606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c66a8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4ddea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c8be7310>]}
[0m18:58:32.113263 [debug] [MainThread]: Flushing usage events
[0m18:58:32.080518 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:32.301200 [debug] [Thread-4 (]: SQL status: SELECT 5677 in 0.330 seconds
[0m18:58:32.306987 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:32.308390 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:58:32.331972 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:32.333857 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m18:58:32.336519 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m18:58:32.337398 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:58:32.339200 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:58:32.340534 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:58:32.343932 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m18:58:32.347739 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:58:32.352984 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:58:32.361576 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:58:32.364085 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:32.367002 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:32.369321 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m18:58:32.371008 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:58:32.373331 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:58:32.377028 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:58:32.383517 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m18:58:32.384826 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m18:58:32.387611 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m18:58:32.393581 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m18:58:32.397591 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m18:58:32.399338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc312850>]}
[0m18:58:32.401783 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:58:32.404754 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:58:32.406854 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.75s]
[0m18:58:32.408565 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m18:58:32.409835 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m18:58:32.411553 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m18:58:32.413791 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:58:32.414975 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:58:32.418682 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m18:58:32.421738 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m18:58:32.423640 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbfa4dcd0>]}
[0m18:58:32.425093 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df65290b-011a-4f79-b180-771b7512f53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dbc334b50>]}
[0m18:58:32.426550 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4334[0m in 0.79s]
[0m18:58:32.428693 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5677[0m in 0.82s]
[0m18:58:32.430636 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m18:58:32.432498 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m18:58:32.438310 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:32.439682 [debug] [MainThread]: On master: BEGIN
[0m18:58:32.440955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:32.457809 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m18:58:32.460733 [debug] [MainThread]: On master: COMMIT
[0m18:58:32.462494 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:32.464277 [debug] [MainThread]: On master: COMMIT
[0m18:58:32.465941 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:58:32.468309 [debug] [MainThread]: On master: Close
[0m18:58:32.470358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:32.472172 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m18:58:32.476579 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m18:58:32.481738 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m18:58:32.484305 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m18:58:32.487708 [info ] [MainThread]: 
[0m18:58:32.491712 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m18:58:32.505632 [debug] [MainThread]: Command end result
[0m18:58:32.836516 [info ] [MainThread]: 
[0m18:58:32.844842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:32.849549 [info ] [MainThread]: 
[0m18:58:32.858277 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:58:32.865222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.294006, "process_user_time": 9.290483, "process_kernel_time": 1.348898, "process_mem_max_rss": "162112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:32.868127 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:32.867871 after 8.30 seconds
[0m18:58:32.870202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc38233d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc38a3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707dc37f1850>]}
[0m18:58:32.873351 [debug] [MainThread]: Flushing usage events
[0m18:58:42.097445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edeff510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edf3dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edeffe90>]}


============================== 18:58:42.107499 | 99bc51c4-4d7e-4194-b19b-66b14bc62a30 ==============================
[0m18:58:42.107499 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:58:42.110501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:58:42.461879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ef1e3e10>]}
[0m18:58:42.581837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595efc93890>]}
[0m18:58:42.584323 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:42.803295 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:58:43.790368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:43.792543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:43.886520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ecdc36d0>]}
[0m18:58:44.295238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ec5e7e50>]}
[0m18:58:44.298795 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m18:58:44.303179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ed592210>]}
[0m18:58:44.317154 [info ] [MainThread]: 
[0m18:58:44.321403 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:44.335216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m18:58:44.337767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m18:58:44.501386 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:44.502405 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:44.510961 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:58:44.513177 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:58:44.515016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:44.518138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:44.541520 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m18:58:44.548347 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:58:44.549267 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m18:58:44.551947 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:58:44.553653 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:58:44.555855 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:58:44.559732 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m18:58:44.564193 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m18:58:44.570136 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:58:44.574594 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:58:44.577502 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:58:44.582295 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:58:44.605459 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.609399 [debug] [MainThread]: On master: BEGIN
[0m18:58:44.613697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:44.634323 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m18:58:44.643287 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.646392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:44.741315 [debug] [MainThread]: SQL status: SELECT 3 in 0.090 seconds
[0m18:58:44.750320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bc51c4-4d7e-4194-b19b-66b14bc62a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595ec5be190>]}
[0m18:58:44.760538 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:44.776301 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.778704 [debug] [MainThread]: On master: BEGIN
[0m18:58:44.780867 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:58:44.783039 [debug] [MainThread]: On master: COMMIT
[0m18:58:44.784824 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:44.786013 [debug] [MainThread]: On master: COMMIT
[0m18:58:44.787627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:44.789302 [debug] [MainThread]: On master: Close
[0m18:58:44.791282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:44.792743 [info ] [MainThread]: 
[0m18:58:44.820499 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:44.822450 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:44.823854 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:44.825772 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:44.827838 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m18:58:44.830578 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m18:58:44.836737 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m18:58:44.847293 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m18:58:44.854541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m18:58:44.861396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m18:58:44.866817 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m18:58:44.870663 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m18:58:44.873309 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:44.877609 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:44.889674 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:44.894778 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:44.970026 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:44.977645 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.010864 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.015273 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.054293 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:45.070379 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:45.097859 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:45.113886 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.121828 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.137262 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:45.143508 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.153365 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:45.163570 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:45.165797 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m18:58:45.167156 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.170646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:45.172681 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.175463 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m18:58:45.177854 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.191773 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m18:58:45.202452 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:58:45.205080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:58:45.206386 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m18:58:45.209104 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:45.212001 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:58:45.214210 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:45.221063 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m18:58:45.225403 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m18:58:45.229383 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:58:45.230561 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m18:58:45.233894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m18:58:45.237080 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m18:58:45.238349 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:58:45.241264 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m18:58:45.242154 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:58:45.249657 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m18:58:45.252287 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m18:58:45.253886 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:58:45.255500 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m18:58:45.257250 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m18:58:45.258226 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m18:58:45.259304 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m18:58:45.263137 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.41s]
[0m18:58:45.265424 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.39s]
[0m18:58:45.271231 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:58:45.272253 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:58:45.275640 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:58:45.278954 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.286775 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m18:58:45.290311 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.291388 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m18:58:45.292897 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m18:58:45.295368 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m18:58:45.297331 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m18:58:45.300747 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m18:58:45.302436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m18:58:45.305506 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.44s]
[0m18:58:45.306966 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:58:45.309001 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m18:58:45.310179 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.312260 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:58:45.314692 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.317571 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.46s]
[0m18:58:45.338282 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.341628 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.356287 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.360274 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:58:45.366714 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m18:58:45.369948 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:45.371992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m18:58:45.374369 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m18:58:45.377197 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.378910 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.379877 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.381387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m18:58:45.387865 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.395213 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.406480 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.408183 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:45.419955 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.423356 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.426689 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m18:58:45.427797 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.431244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:45.437628 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m18:58:45.440027 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.443367 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:45.454564 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:45.473228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m18:58:45.493436 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.577579 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.594781 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:58:45.624224 [debug] [Thread-4 (]: SQL status: BEGIN in 0.170 seconds
[0m18:58:45.643117 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m18:58:45.655851 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:58:45.664627 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:58:45.666143 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:58:45.673223 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.677526 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m18:58:45.679297 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m18:58:45.682521 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m18:58:45.687755 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m18:58:45.690678 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.698745 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m18:58:45.702603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:45.705894 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.40s]
[0m18:58:45.711504 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:58:45.725435 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m18:58:45.742307 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:58:45.752430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:45.757599 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.45s]
[0m18:58:45.762164 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m18:58:45.765906 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:45.773181 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:58:45.777532 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:58:45.779554 [info ] [Thread-1 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m18:58:45.781722 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:45.783968 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m18:58:45.786330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m18:58:45.790618 [debug] [Thread-2 (]: SQL status: BEGIN in 0.038 seconds
[0m18:58:45.789471 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m18:58:45.797941 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:45.799390 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:58:45.801415 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:45.806526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m18:58:45.838574 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:45.849069 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m18:58:45.864199 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m18:58:45.878950 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:45.885874 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m18:58:45.901651 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:45.902459 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m18:58:45.904742 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.53s]
[0m18:58:45.910072 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:58:45.912313 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:45.914188 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:58:45.915648 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:45.917942 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:58:45.924724 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:45.926145 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.077180 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:46.086143 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.70s]
[0m18:58:46.097448 [info ] [Thread-3 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:58:46.104414 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:46.107503 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m18:58:46.111626 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:46.135606 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.161425 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m18:58:46.165533 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:46.178996 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.181099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:46.185556 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m18:58:46.192597 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:46.214934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m18:58:46.220467 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:58:46.224061 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.226005 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:58:46.227227 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m18:58:46.236162 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.240052 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:58:46.244904 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:58:46.254384 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:58:46.263111 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m18:58:46.276865 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m18:58:46.280642 [info ] [Thread-1 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.49s]
[0m18:58:46.289204 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:58:46.298646 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.032 seconds
[0m18:58:46.301828 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.307861 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m18:58:46.310532 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:58:46.315252 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m18:58:46.317393 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:46.322724 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.52s]
[0m18:58:46.332774 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:58:46.364405 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m18:58:46.378204 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:46.380439 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:58:46.420523 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.038 seconds
[0m18:58:46.423360 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:58:46.425042 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:58:46.427256 [info ] [Thread-3 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.32s]
[0m18:58:46.429849 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:58:46.434925 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:46.436778 [debug] [MainThread]: On master: BEGIN
[0m18:58:46.438576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:46.456154 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m18:58:46.460770 [debug] [MainThread]: On master: COMMIT
[0m18:58:46.463225 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:46.465267 [debug] [MainThread]: On master: COMMIT
[0m18:58:46.467163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:58:46.468446 [debug] [MainThread]: On master: Close
[0m18:58:46.469899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:46.471454 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m18:58:46.473103 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m18:58:46.474574 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:58:46.476475 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m18:58:46.477989 [info ] [MainThread]: 
[0m18:58:46.480170 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m18:58:46.486536 [debug] [MainThread]: Command end result
[0m18:58:45.140200 [info ] [MainThread]: 
[0m18:58:45.142777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:45.145825 [info ] [MainThread]: 
[0m18:58:45.162477 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:58:45.168659 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.752155, "process_user_time": 7.612468, "process_kernel_time": 0.946069, "process_mem_max_rss": "162124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:45.175858 [debug] [MainThread]: Command `dbt test` succeeded at 18:58:45.175461 after 4.76 seconds
[0m18:58:45.178170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595f1b974d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595edde5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595f1b984d0>]}
[0m18:58:45.180120 [debug] [MainThread]: Flushing usage events
[0m19:00:08.822446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faab7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faf98890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faadfed0>]}


============================== 19:00:08.831116 | 6740db6a-a7e6-42a7-abc7-36e0a4e71f71 ==============================
[0m19:00:08.831116 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:00:08.832490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m19:00:09.127439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faa42b10>]}
[0m19:00:09.247762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fc84b110>]}
[0m19:00:09.260894 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:00:09.433557 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:00:09.866180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:09.868534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:09.927811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f99c8090>]}
[0m19:00:10.077742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f9111390>]}
[0m19:00:10.079835 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:00:10.081295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fab30650>]}
[0m19:00:10.084745 [info ] [MainThread]: 
[0m19:00:10.086661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:10.092715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:10.094194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:10.172063 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:10.172622 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:10.174068 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:10.175581 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:10.177153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:10.178476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:10.193806 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m19:00:10.194469 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m19:00:10.196709 [debug] [ThreadPool]: On list_db: Close
[0m19:00:10.198963 [debug] [ThreadPool]: On list_db: Close
[0m19:00:10.205518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:00:10.206978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:00:10.216126 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:10.220589 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:10.222157 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:00:10.223576 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:00:10.224839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:10.225959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:10.240894 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m19:00:10.241806 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m19:00:10.243442 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:10.245125 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:10.246776 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:00:10.248581 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:00:10.257160 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m19:00:10.257807 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:00:10.260478 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:00:10.263499 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:00:10.265690 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:00:10.266820 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:00:10.277456 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.279104 [debug] [MainThread]: On master: BEGIN
[0m19:00:10.280786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:10.297967 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:00:10.300059 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.302215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:10.338300 [debug] [MainThread]: SQL status: SELECT 3 in 0.034 seconds
[0m19:00:10.341519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18faa267d0>]}
[0m19:00:10.343077 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:10.345316 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.346397 [debug] [MainThread]: On master: BEGIN
[0m19:00:10.348102 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:00:10.350257 [debug] [MainThread]: On master: COMMIT
[0m19:00:10.351977 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:10.353223 [debug] [MainThread]: On master: COMMIT
[0m19:00:10.354894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:10.356421 [debug] [MainThread]: On master: Close
[0m19:00:10.358505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:10.362518 [info ] [MainThread]: 
[0m19:00:10.375678 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:00:10.376509 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:00:10.377642 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:00:10.379240 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:00:10.380692 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:00:10.382214 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:00:10.383560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:00:10.384607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:00:10.386103 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:00:10.387457 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:00:10.388590 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:00:10.390075 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:00:10.398341 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:00:10.402110 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:00:10.405661 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:00:10.413177 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:00:10.414226 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:00:10.421216 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:00:10.468688 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:00:10.469360 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:00:10.474178 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:00:10.482409 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.484153 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.485723 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:00:10.486894 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.488773 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:00:10.490858 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:10.492964 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:00:10.494837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:10.497800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:10.509661 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m19:00:10.511529 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.512952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:00:10.513979 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:00:10.516088 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.517073 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:00:10.523837 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:00:10.525709 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:00:10.528538 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.539191 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.542544 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:00:10.544335 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:00:10.545074 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:00:10.548138 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.553110 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.553827 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:00:10.557664 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.559286 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:00:10.564568 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.566327 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:00:10.569069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.569892 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:00:10.572313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.575938 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.578383 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.598871 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:10.599621 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:00:10.603774 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.605162 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.608024 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:00:10.608848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:00:10.610746 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:10.613499 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.616283 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:10.621219 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:10.621933 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m19:00:10.623415 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.625309 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.634310 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:00:10.635843 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:10.637505 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:10.647514 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:10.651137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:00:10.652450 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m19:00:10.653359 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:00:10.658630 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:00:10.662876 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:00:10.667790 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:10.668587 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:00:10.670736 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:10.672310 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:00:10.677435 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:00:10.679368 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:00:10.684541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f74d05d0>]}
[0m19:00:10.685455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:00:10.689764 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.30s]
[0m19:00:10.690733 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:00:10.693768 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:00:10.695540 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:00:10.697986 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:00:10.699698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75d15d0>]}
[0m19:00:10.703493 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:00:10.705814 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75616d0>]}
[0m19:00:10.710876 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.32s]
[0m19:00:10.712679 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:00:10.714511 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.32s]
[0m19:00:10.716598 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:00:10.718732 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_revenue_daily'
[0m19:00:10.721471 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:00:10.724103 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:00:10.725185 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:00:10.727387 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:00:10.728660 [info ] [Thread-2 (]: 5 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:00:10.733040 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.735118 [info ] [Thread-1 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:00:10.737098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m19:00:10.739796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_marketing_attribution)
[0m19:00:10.741430 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:00:10.743134 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:00:10.750739 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:00:10.756232 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.757045 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:00:10.795267 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.796254 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:00:10.798376 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:00:10.804305 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.813846 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:00:10.816455 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.818884 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:00:10.821552 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.822909 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:10.825187 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:00:10.826634 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.830129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:10.833274 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:00:10.836780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:10.844416 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m19:00:10.847545 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.849077 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:00:10.850581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:00:10.852998 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.854787 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m19:00:10.856869 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:00:10.859860 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.863803 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:00:10.878921 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.012 seconds
[0m19:00:10.957136 [debug] [Thread-1 (]: SQL status: SELECT 5677 in 0.095 seconds
[0m19:00:10.957745 [debug] [Thread-4 (]: SQL status: SELECT 4334 in 0.106 seconds
[0m19:00:10.959905 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.963620 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.971971 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.973828 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:00:10.975237 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:00:10.976412 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:00:10.978060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.979104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:00:10.980436 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.984105 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:10.987891 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:10.991940 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:10.993397 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:00:10.995170 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:00:10.996434 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:00:10.998315 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:10.999559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:11.001321 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:00:11.007140 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:11.010300 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:11.013678 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:11.015297 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:11.016853 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:11.018370 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:11.019824 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:11.021129 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:11.022415 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:11.042618 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m19:00:11.044088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m19:00:11.044971 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m19:00:11.049235 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:00:11.054745 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:00:11.060977 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:00:11.068582 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:11.070923 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:11.073608 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:11.075560 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:00:11.077259 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:00:11.078634 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:00:11.085477 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:00:11.086328 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:00:11.087109 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:00:11.089737 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:00:11.092271 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:00:11.094708 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:00:11.097620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f74de210>]}
[0m19:00:11.099313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75f2610>]}
[0m19:00:11.101465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6740db6a-a7e6-42a7-abc7-36e0a4e71f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18f75d95d0>]}
[0m19:00:11.103687 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.36s]
[0m19:00:11.105793 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5677[0m in 0.36s]
[0m19:00:11.107682 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4334[0m in 0.38s]
[0m19:00:11.109927 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:00:11.112027 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:00:11.113844 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:00:11.121355 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:11.123258 [debug] [MainThread]: On master: BEGIN
[0m19:00:11.124926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:11.139597 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m19:00:11.141590 [debug] [MainThread]: On master: COMMIT
[0m19:00:11.143405 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:11.145004 [debug] [MainThread]: On master: COMMIT
[0m19:00:11.147167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:11.148650 [debug] [MainThread]: On master: Close
[0m19:00:11.150618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:11.152588 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:00:11.154343 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:00:11.155779 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m19:00:11.157168 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:00:11.159031 [info ] [MainThread]: 
[0m19:00:11.160887 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m19:00:11.164007 [debug] [MainThread]: Command end result
[0m19:00:11.258311 [info ] [MainThread]: 
[0m19:00:11.260180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:11.262479 [info ] [MainThread]: 
[0m19:00:11.264846 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:00:11.267194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5231435, "process_user_time": 4.620106, "process_kernel_time": 0.574659, "process_mem_max_rss": "162128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:11.268900 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:11.268714 after 2.52 seconds
[0m19:00:11.270454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fe750510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fe93aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fe9c7590>]}
[0m19:00:11.273328 [debug] [MainThread]: Flushing usage events
[0m19:00:17.579068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30e863290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3126483d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f310173d50>]}


============================== 19:00:17.593697 | a3ea5c44-01ad-4e27-b513-4ee41ab75508 ==============================
[0m19:00:17.593697 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:00:17.597698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:18.039783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30df69e10>]}
[0m19:00:18.129681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3105e6f90>]}
[0m19:00:18.132090 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:00:18.296542 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:00:18.695612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:18.697605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:18.777525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30d38de90>]}
[0m19:00:18.980829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30cbc37d0>]}
[0m19:00:18.983465 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:00:18.985627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30d3526d0>]}
[0m19:00:18.997568 [info ] [MainThread]: 
[0m19:00:19.001035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:19.012972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:00:19.017838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:00:19.153318 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:19.154158 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:19.155665 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:00:19.157856 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:00:19.159800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:19.161045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:19.175892 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m19:00:19.176805 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m19:00:19.178395 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:19.180299 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:19.181948 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:00:19.183535 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:00:19.189865 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:00:19.193904 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:00:19.195740 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:00:19.196515 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m19:00:19.203814 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:00:19.213805 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:00:19.227188 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.229176 [debug] [MainThread]: On master: BEGIN
[0m19:00:19.230627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:19.246903 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:00:19.248752 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.252638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:19.318491 [debug] [MainThread]: SQL status: SELECT 3 in 0.034 seconds
[0m19:00:19.321005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3ea5c44-01ad-4e27-b513-4ee41ab75508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30f489010>]}
[0m19:00:19.331754 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:19.343535 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.345309 [debug] [MainThread]: On master: BEGIN
[0m19:00:19.347774 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:00:19.350152 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.352611 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.353981 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.355647 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:19.357240 [debug] [MainThread]: On master: Close
[0m19:00:19.360000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:19.362357 [info ] [MainThread]: 
[0m19:00:19.379265 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.379958 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.380761 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.381950 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.383478 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:00:19.385008 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:00:19.386741 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:00:19.388389 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:00:19.390265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:00:19.392081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:00:19.394408 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:00:19.397600 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:00:19.399857 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.401859 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.403717 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.406037 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.452542 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.455535 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.470457 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.477161 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.487312 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.489430 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.497477 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.511064 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.515733 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.521241 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.530286 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.536522 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.547514 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.550381 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.551743 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:00:19.553092 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.554345 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.555616 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:00:19.557608 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:19.559136 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:00:19.560422 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:00:19.561991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:19.565019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:19.567114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:19.576863 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:00:19.580936 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:00:19.587444 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:00:19.589730 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m19:00:19.594045 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:00:19.595630 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:00:19.597399 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:00:19.598749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:00:19.601273 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:00:19.603763 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:00:19.613035 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:00:19.615260 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:00:19.618686 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:00:19.621687 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:00:19.623460 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:00:19.627279 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.23s]
[0m19:00:19.628863 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:00:19.635579 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:00:19.637106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m19:00:19.639685 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:00:19.642155 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:19.646090 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:00:19.648664 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:00:19.650136 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.033 seconds
[0m19:00:19.651259 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:00:19.653469 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:00:19.655155 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.26s]
[0m19:00:19.658455 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:00:19.660817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:00:19.663638 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.27s]
[0m19:00:19.665577 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:00:19.668073 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:00:19.669015 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:19.671207 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:00:19.673441 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:19.676431 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.28s]
[0m19:00:19.685681 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.687632 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:19.689399 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:00:19.691460 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:00:19.695382 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:00:19.697781 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:00:19.700490 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:19.703154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:00:19.705405 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:19.706788 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:19.708215 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:00:19.709741 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:19.718618 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.723474 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.725420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:00:19.734695 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.740605 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:19.750581 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.755816 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:19.757139 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.764648 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:19.763587 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.768274 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:00:19.770126 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:19.776391 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.778813 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:19.784612 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.795813 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.800927 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.803191 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:00:19.805012 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.806958 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:00:19.809431 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m19:00:19.810566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:19.812612 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:00:19.814572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:19.817161 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:00:19.820311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:19.823918 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:00:19.835690 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m19:00:19.845857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m19:00:19.864576 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m19:00:19.929361 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:00:19.941282 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:00:19.954069 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:00:19.964296 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:00:19.971306 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:00:19.974485 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:00:19.977511 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:00:19.979373 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:00:19.989445 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:00:19.990273 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:00:19.995160 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:00:19.996516 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:00:19.999419 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.34s]
[0m19:00:20.004482 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:00:20.018733 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:00:20.025780 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:00:20.032867 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:00:20.035915 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:00:20.038425 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:00:20.040370 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:00:20.041901 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.044887 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.35s]
[0m19:00:20.047891 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.34s]
[0m19:00:20.051643 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.33s]
[0m19:00:20.053856 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:00:20.056044 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:00:20.057729 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:00:20.059221 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:00:20.060840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:00:20.063173 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.064358 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.066351 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.067705 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:00:20.068824 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:00:20.078372 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.079994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:00:20.081139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:00:20.083306 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.084506 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.090472 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.100469 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.102882 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.105771 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.189454 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.197353 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.196728 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.205485 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.213813 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.215635 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.217566 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:00:20.218719 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.220683 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:00:20.223200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:20.225266 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:00:20.226439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:20.229464 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:20.245985 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m19:00:20.251698 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m19:00:20.253841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m19:00:20.255723 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:00:20.257566 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:00:20.259325 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:00:20.262022 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:00:20.264811 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:00:20.267293 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:00:20.272842 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:00:20.277239 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:00:20.282791 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:00:20.287168 [info ] [Thread-3 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.23s]
[0m19:00:20.291349 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m19:00:20.296338 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:00:20.303172 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:00:20.308610 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:00:20.313925 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.23s]
[0m19:00:20.319433 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:00:20.330161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m19:00:20.335997 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:00:20.338448 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:00:20.341992 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.26s]
[0m19:00:20.348680 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:00:20.354334 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.356309 [debug] [MainThread]: On master: BEGIN
[0m19:00:20.358508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:20.376554 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:00:20.379013 [debug] [MainThread]: On master: COMMIT
[0m19:00:20.380983 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.383323 [debug] [MainThread]: On master: COMMIT
[0m19:00:20.386279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:20.388038 [debug] [MainThread]: On master: Close
[0m19:00:20.389859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:20.391620 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:00:20.395044 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m19:00:20.397710 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:00:20.399670 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:00:20.401490 [info ] [MainThread]: 
[0m19:00:20.403774 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m19:00:20.409989 [debug] [MainThread]: Command end result
[0m19:00:20.478711 [info ] [MainThread]: 
[0m19:00:20.480396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:20.482311 [info ] [MainThread]: 
[0m19:00:20.484409 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:00:20.486693 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9928796, "process_user_time": 5.101693, "process_kernel_time": 0.714862, "process_mem_max_rss": "162136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:20.488386 [debug] [MainThread]: Command `dbt test` succeeded at 19:00:20.488192 after 2.99 seconds
[0m19:00:20.489743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30eb99490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f30e8bb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f312704790>]}
[0m19:00:20.491812 [debug] [MainThread]: Flushing usage events
[0m19:17:05.649561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7d5b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7d83990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba8edd290>]}


============================== 19:17:05.734559 | 86b06e64-5545-46ee-87d9-ba93b6910123 ==============================
[0m19:17:05.734559 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:17:05.736775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'send_anonymous_usage_stats': 'True'}
[0m19:17:06.175858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7d58250>]}
[0m19:17:06.268410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7df3750>]}
[0m19:17:06.270942 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:17:06.463527 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:17:07.179046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:07.181381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:07.346941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba71cc510>]}
[0m19:17:07.701684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba61e96d0>]}
[0m19:17:07.704706 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:17:07.714042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba697c990>]}
[0m19:17:07.728855 [info ] [MainThread]: 
[0m19:17:07.732088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:07.762708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:17:07.765334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:17:07.950683 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:17:07.951631 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:17:07.953056 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:17:07.954812 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:17:07.956984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:07.958803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:07.985609 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.024 seconds
[0m19:17:07.986809 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.028 seconds
[0m19:17:07.992390 [debug] [ThreadPool]: On list_db: Close
[0m19:17:07.997324 [debug] [ThreadPool]: On list_db: Close
[0m19:17:08.005590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:17:08.007010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:17:08.015965 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:08.020214 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:08.022081 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:17:08.023429 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:17:08.024665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:08.025805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:08.042405 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:17:08.043107 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m19:17:08.045301 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:08.047255 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:08.048710 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:17:08.050596 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:17:08.061536 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m19:17:08.062636 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m19:17:08.066072 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:17:08.069453 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:17:08.071446 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:17:08.073221 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:17:08.086703 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.089374 [debug] [MainThread]: On master: BEGIN
[0m19:17:08.090938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:08.105774 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:17:08.108101 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.110474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:08.168885 [debug] [MainThread]: SQL status: SELECT 3 in 0.056 seconds
[0m19:17:08.171495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba6190b90>]}
[0m19:17:08.173406 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:08.176096 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.178290 [debug] [MainThread]: On master: BEGIN
[0m19:17:08.180920 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:17:08.183285 [debug] [MainThread]: On master: COMMIT
[0m19:17:08.185210 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.187074 [debug] [MainThread]: On master: COMMIT
[0m19:17:08.189325 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:08.192203 [debug] [MainThread]: On master: Close
[0m19:17:08.195478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:08.207907 [info ] [MainThread]: 
[0m19:17:08.236940 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:17:08.238120 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:17:08.239626 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:17:08.241186 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:17:08.242824 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:17:08.244681 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:17:08.246857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:17:08.249584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:17:08.251836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_db, now model.api_bi_project.stg_sessions)
[0m19:17:08.253605 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:17:08.255329 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:17:08.257368 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:17:08.269471 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:17:08.273642 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:17:08.279726 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:17:08.290109 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:17:08.298695 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:17:08.300108 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:17:08.379290 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:17:08.381005 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:17:08.378656 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:17:08.389671 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.391344 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.392277 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.393415 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:17:08.394776 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:17:08.396209 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:17:08.397598 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:17:08.398827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:08.400016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:08.422614 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m19:17:08.428852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:08.431117 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.432594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m19:17:08.434355 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.436335 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:17:08.438465 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.440452 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:17:08.449744 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:17:08.454467 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m19:17:08.455163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:17:08.456389 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:17:08.466927 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.472112 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.478581 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.480339 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:17:08.481886 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:17:08.483370 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:17:08.486683 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.489626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.490641 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:17:08.495331 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.500480 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.509016 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.511352 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:17:08.513769 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:17:08.515794 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:17:08.518565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.521543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.523136 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:08.545375 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:17:08.547536 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:17:08.551084 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:17:08.552837 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.554646 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.556727 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.558575 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:17:08.560129 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:17:08.562067 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:17:08.568180 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m19:17:08.569340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:17:08.577607 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m19:17:08.592879 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:17:08.597375 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:17:08.601836 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:17:08.610919 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:17:08.612833 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:17:08.614663 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:17:08.616101 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:17:08.617707 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:17:08.619185 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:17:08.625600 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:17:08.626608 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m19:17:08.627258 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m19:17:08.631076 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:17:08.633963 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:17:08.636488 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:17:08.640086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba475dc50>]}
[0m19:17:08.642056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba4637850>]}
[0m19:17:08.648498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba475ea10>]}
[0m19:17:08.650336 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.39s]
[0m19:17:08.653020 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.39s]
[0m19:17:08.655422 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.40s]
[0m19:17:08.657751 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:17:08.660053 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:17:08.661765 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:17:08.663940 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m19:17:08.665821 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:17:08.667206 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:17:08.669097 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:17:08.670676 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:17:08.672246 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:17:08.673887 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m19:17:08.675670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m19:17:08.677551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m19:17:08.679825 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:17:08.684242 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:17:08.688312 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:17:08.698057 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:17:08.709592 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.722823 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.743720 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:17:08.752960 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:17:08.754016 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m19:17:08.831649 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.834481 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.861962 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:17:08.878813 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.881303 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.882518 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:17:08.883450 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:08.885634 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:17:08.887492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:08.889760 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:17:08.891579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:08.896054 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:17:08.907167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:17:08.913608 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:08.918655 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m19:17:08.927965 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:17:08.932544 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:08.933849 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m19:17:08.939325 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:17:08.942168 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:08.954265 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:17:09.075062 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.117 seconds
[0m19:17:09.305468 [debug] [Thread-1 (]: SQL status: SELECT 4334 in 0.369 seconds
[0m19:17:09.324835 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.335695 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.337336 [debug] [Thread-2 (]: SQL status: SELECT 5677 in 0.390 seconds
[0m19:17:09.340562 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:17:09.347828 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:17:09.370870 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.401342 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:17:09.414758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.418236 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:17:09.428775 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.444064 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.447941 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.449017 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:17:09.451688 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:17:09.460759 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.464779 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.467366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.469839 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:17:09.487090 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:17:09.492882 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:17:09.496477 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:09.498669 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.501608 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.506926 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:17:09.509587 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:17:09.511989 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:17:09.514634 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.519518 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:17:09.520720 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m19:17:09.522241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:17:09.530845 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m19:17:09.532165 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:17:09.539675 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:17:09.546978 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:17:09.555414 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:17:09.559083 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:17:09.562795 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:17:09.565432 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:17:09.567960 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:17:09.570159 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:17:09.585151 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m19:17:09.586404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m19:17:09.587594 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m19:17:09.592229 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:17:09.596718 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:17:09.603087 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m19:17:09.606098 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba4550910>]}
[0m19:17:09.616754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba4727390>]}
[0m19:17:09.621132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b06e64-5545-46ee-87d9-ba93b6910123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bba7dc24d0>]}
[0m19:17:09.625069 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5677[0m in 0.93s]
[0m19:17:09.631195 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4334[0m in 0.94s]
[0m19:17:09.636069 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.95s]
[0m19:17:09.639847 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:17:09.642664 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:17:09.645045 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m19:17:09.659640 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:09.665147 [debug] [MainThread]: On master: BEGIN
[0m19:17:09.667159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:09.688088 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:17:09.711727 [debug] [MainThread]: On master: COMMIT
[0m19:17:09.722377 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:09.728210 [debug] [MainThread]: On master: COMMIT
[0m19:17:09.731332 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:09.735817 [debug] [MainThread]: On master: Close
[0m19:17:09.741362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:09.743591 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m19:17:09.745893 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:17:09.748074 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:17:09.750222 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:17:09.752784 [info ] [MainThread]: 
[0m19:17:09.755013 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m19:17:09.759347 [debug] [MainThread]: Command end result
[0m19:17:10.031329 [info ] [MainThread]: 
[0m19:17:10.037118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:10.040797 [info ] [MainThread]: 
[0m19:17:10.046050 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:17:10.057317 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5796432, "process_user_time": 7.739481, "process_kernel_time": 2.538942, "process_mem_max_rss": "162176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:17:10.065273 [debug] [MainThread]: Command `dbt run` succeeded at 19:17:10.064860 after 4.59 seconds
[0m19:17:10.072288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbabc135d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbabc93550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bbabb48510>]}
[0m19:17:10.076890 [debug] [MainThread]: Flushing usage events
[0m19:17:20.052413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b1d72b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b226e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b31faf90>]}


============================== 19:17:20.064791 | 61d4581b-5781-49b4-b9f9-1cd62dab5ab6 ==============================
[0m19:17:20.064791 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:17:20.066667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:17:20.437410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b1d73e10>]}
[0m19:17:20.529528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b3adb890>]}
[0m19:17:20.531901 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:17:20.777729 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:17:21.854868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:21.857961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:22.005366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b23394d0>]}
[0m19:17:22.329695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b0dc0ed0>]}
[0m19:17:22.331697 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:17:22.333448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b0d66090>]}
[0m19:17:22.339160 [info ] [MainThread]: 
[0m19:17:22.341684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:22.351434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:17:22.353134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:17:22.437336 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:22.438602 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:22.440471 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:17:22.442551 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:17:22.448219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:22.450154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:22.473015 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m19:17:22.474775 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m19:17:22.476590 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:17:22.478338 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:17:22.480115 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:17:22.482459 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:17:22.492131 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:17:22.492978 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:17:22.497061 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:17:22.501415 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:17:22.503736 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:17:22.505483 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:17:22.523083 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.525365 [debug] [MainThread]: On master: BEGIN
[0m19:17:22.527125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:22.545205 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:17:22.547242 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.549080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:22.599282 [debug] [MainThread]: SQL status: SELECT 3 in 0.048 seconds
[0m19:17:22.603682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d4581b-5781-49b4-b9f9-1cd62dab5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b1553310>]}
[0m19:17:22.606058 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:22.608421 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.609901 [debug] [MainThread]: On master: BEGIN
[0m19:17:22.612217 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:17:22.614371 [debug] [MainThread]: On master: COMMIT
[0m19:17:22.616652 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:22.618360 [debug] [MainThread]: On master: COMMIT
[0m19:17:22.620488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:17:22.622135 [debug] [MainThread]: On master: Close
[0m19:17:22.624660 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:22.626579 [info ] [MainThread]: 
[0m19:17:22.645882 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:22.646814 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:22.647779 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:22.648986 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:22.650471 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:17:22.652380 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:17:22.653940 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:17:22.655297 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:17:22.657078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:17:22.658745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:17:22.660363 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:17:22.661834 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:17:22.663588 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:22.665581 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:22.667609 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:22.669127 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:22.696877 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.714786 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.736102 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.745708 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.779293 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:22.780359 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:22.787823 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:22.794642 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:22.828553 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.839527 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.843370 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.849485 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.859037 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.861383 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.862862 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.864027 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:17:22.865079 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.866737 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:17:22.869310 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:17:22.871984 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:17:22.874217 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:17:22.876136 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:17:22.878701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:22.882326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:22.899847 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:22.904450 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:22.906826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m19:17:22.917176 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:17:22.923049 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:17:22.924457 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m19:17:22.934524 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:17:22.937622 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:17:22.941493 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:17:22.948824 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:17:22.953502 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:17:22.976520 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:17:22.987599 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m19:17:23.012440 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.049 seconds
[0m19:17:23.018806 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m19:17:23.074254 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:17:23.080507 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.056 seconds
[0m19:17:23.089252 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:17:23.094527 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:17:23.098208 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:17:23.102816 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:17:23.106105 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:17:23.110525 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:17:23.115796 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.45s]
[0m19:17:23.120357 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:17:23.123676 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.46s]
[0m19:17:23.129263 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.47s]
[0m19:17:23.139923 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:17:23.145982 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.49s]
[0m19:17:23.151417 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:17:23.154232 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:17:23.158058 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.163957 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:17:23.166087 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.168475 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.170945 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:17:23.173820 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.176538 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:17:23.181660 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:17:23.185688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:17:23.187716 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:17:23.190195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:17:23.192387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:17:23.194339 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.197655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:17:23.199242 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.200846 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.209012 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.210488 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.216733 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.224323 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.232827 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.239262 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.240472 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.246005 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.246793 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.247369 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.251000 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.257349 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.261867 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.264406 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.267857 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:17:23.269191 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:17:23.271876 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.275181 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.276729 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.277937 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:17:23.279445 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:17:23.281197 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:17:23.282661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:17:23.286206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m19:17:23.287119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:23.288929 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:23.292241 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:17:23.298204 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:17:23.302072 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:23.306504 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:17:23.308566 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m19:17:23.310101 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:17:23.312136 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:17:23.313174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m19:17:23.314102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m19:17:23.316380 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.13s]
[0m19:17:23.318546 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:17:23.320547 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:17:23.322282 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:17:23.324658 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:17:23.328088 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:17:23.329697 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:17:23.330545 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:17:23.332344 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.338066 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:17:23.341047 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:17:23.342152 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m19:17:23.344154 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:17:23.349013 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:17:23.351590 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:17:23.354942 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:17:23.357122 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:17:23.359892 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:17:23.361940 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.17s]
[0m19:17:23.364344 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:17:23.366220 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.369156 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.17s]
[0m19:17:23.371471 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:17:23.374223 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.18s]
[0m19:17:23.389514 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.391028 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:17:23.392533 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.394317 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:17:23.397307 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.399564 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:17:23.403224 [info ] [Thread-2 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:17:23.405363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:17:23.407603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:17:23.408813 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.410890 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.413041 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.417131 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.426139 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.445603 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.455042 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.655124 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.656284 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.659573 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.661648 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:17:23.669021 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.671861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:17:23.679410 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.682183 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:17:23.683562 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.685435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:17:23.688349 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:17:23.690550 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:17:23.694324 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:17:23.700592 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:17:23.706665 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:17:23.714112 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m19:17:23.717700 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:17:23.718971 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:17:23.721855 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:17:23.724373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m19:17:23.729219 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:17:23.734763 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:17:23.741339 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:17:23.738653 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:17:23.746707 [info ] [Thread-3 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.39s]
[0m19:17:23.752755 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:17:23.755592 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m19:17:23.763755 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:17:23.767806 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:17:23.771268 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.37s]
[0m19:17:23.775085 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:17:23.795192 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.051 seconds
[0m19:17:23.801741 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:17:23.807193 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:17:23.810819 [info ] [Thread-2 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.40s]
[0m19:17:23.816418 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:17:23.824225 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.828033 [debug] [MainThread]: On master: BEGIN
[0m19:17:23.831393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:23.857376 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m19:17:23.860943 [debug] [MainThread]: On master: COMMIT
[0m19:17:23.863317 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.865715 [debug] [MainThread]: On master: COMMIT
[0m19:17:23.868837 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:23.871227 [debug] [MainThread]: On master: Close
[0m19:17:23.873774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:23.875883 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075' was properly closed.
[0m19:17:23.878959 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:17:23.881611 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:17:23.885036 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:17:23.887573 [info ] [MainThread]: 
[0m19:17:23.889692 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m19:17:23.895021 [debug] [MainThread]: Command end result
[0m19:17:23.967151 [info ] [MainThread]: 
[0m19:17:23.968824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:23.970144 [info ] [MainThread]: 
[0m19:17:23.971709 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:17:23.974419 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.0955963, "process_user_time": 7.380141, "process_kernel_time": 1.450621, "process_mem_max_rss": "162176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:17:23.976560 [debug] [MainThread]: Command `dbt test` succeeded at 19:17:23.976260 after 4.10 seconds
[0m19:17:23.977837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b5c28650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b5a43550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7b5a434d0>]}
[0m19:17:23.979035 [debug] [MainThread]: Flushing usage events
[0m17:21:47.709395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955bd1b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955bd1b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955c8d4290>]}


============================== 17:21:47.721033 | 96e3421e-6958-43b3-8f61-a5c885b326ef ==============================
[0m17:21:47.721033 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:21:47.723390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:48.409138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955bdec690>]}
[0m17:21:48.728181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955daaf550>]}
[0m17:21:48.734291 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:21:49.043175 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:21:49.781592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:49.784018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:49.848504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955abc3f90>]}
[0m17:21:50.189642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955a7b8850>]}
[0m17:21:50.192655 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m17:21:50.194397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955afa8790>]}
[0m17:21:50.199274 [info ] [MainThread]: 
[0m17:21:50.202324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:50.241967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:21:50.243347 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:21:50.334800 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:21:50.335362 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:21:50.337088 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:21:50.338982 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:21:50.340365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:50.342040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:50.366841 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m17:21:50.368068 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m17:21:50.372489 [debug] [ThreadPool]: On list_db: Close
[0m17:21:50.376658 [debug] [ThreadPool]: On list_db: Close
[0m17:21:50.383375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m17:21:50.385770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m17:21:50.400036 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:21:50.405067 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:21:50.407534 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:21:50.409030 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:21:50.411290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:50.413598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:50.432445 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m17:21:50.434850 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m17:21:50.435948 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:21:50.438741 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:21:50.441480 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:21:50.443101 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:21:50.459711 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m17:21:50.460950 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.014 seconds
[0m17:21:50.465293 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:21:50.471387 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:21:50.473587 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:21:50.476270 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:21:50.497119 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.498874 [debug] [MainThread]: On master: BEGIN
[0m17:21:50.500567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:50.517835 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:21:50.519790 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.522161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:50.578259 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m17:21:50.581908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955a31a3d0>]}
[0m17:21:50.583965 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:50.586582 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.588717 [debug] [MainThread]: On master: BEGIN
[0m17:21:50.591018 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:21:50.593069 [debug] [MainThread]: On master: COMMIT
[0m17:21:50.595317 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:50.596653 [debug] [MainThread]: On master: COMMIT
[0m17:21:50.598688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:21:50.601050 [debug] [MainThread]: On master: Close
[0m17:21:50.603396 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:50.608003 [info ] [MainThread]: 
[0m17:21:50.626822 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m17:21:50.627689 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m17:21:50.629066 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m17:21:50.631343 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m17:21:50.633430 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m17:21:50.635151 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m17:21:50.636514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m17:21:50.637918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m17:21:50.639557 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m17:21:50.641082 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m17:21:50.642522 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m17:21:50.643710 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m17:21:50.652121 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m17:21:50.655964 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m17:21:50.660070 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m17:21:50.669588 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m17:21:50.670463 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m17:21:50.679147 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m17:21:50.739140 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m17:21:50.740850 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m17:21:50.747033 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m17:21:50.771160 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.772392 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.774390 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m17:21:50.775899 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.778347 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m17:21:50.780916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:50.783474 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m17:21:50.785645 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:50.789684 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:50.801960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:21:50.804613 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.807020 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m17:21:50.808813 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m17:21:50.812142 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.814560 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m17:21:50.816907 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m17:21:50.818940 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.821413 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m17:21:50.843938 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m17:21:50.845684 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:21:50.847341 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m17:21:50.857933 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.864947 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.871003 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.872696 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:21:50.874619 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m17:21:50.876686 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:21:50.881447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:21:50.884214 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.884759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.890515 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.895215 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.902811 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.903915 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:21:50.905679 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m17:21:50.907612 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:21:50.909659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.911450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.912948 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:50.935217 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:21:50.937870 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:21:50.940280 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:21:50.941648 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.944108 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.945419 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.946688 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m17:21:50.947822 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m17:21:50.948860 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m17:21:50.952549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:50.953330 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:50.954682 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:21:50.963687 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m17:21:50.968258 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m17:21:50.973072 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m17:21:50.983047 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m17:21:50.985034 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m17:21:50.987706 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m17:21:50.989980 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:21:50.991393 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m17:21:50.992648 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m17:21:51.002457 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:21:51.003445 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:21:51.004158 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m17:21:51.008450 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m17:21:51.012007 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m17:21:51.014863 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m17:21:51.018482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759559b6e950>]}
[0m17:21:51.020514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955a33ac10>]}
[0m17:21:51.022886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955879db50>]}
[0m17:21:51.025287 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.38s]
[0m17:21:51.029061 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.38s]
[0m17:21:51.031591 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.39s]
[0m17:21:51.033534 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m17:21:51.035925 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m17:21:51.038084 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m17:21:51.040326 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.042219 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m17:21:51.044217 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m17:21:51.046045 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m17:21:51.047593 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m17:21:51.049124 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m17:21:51.050744 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m17:21:51.052802 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m17:21:51.056015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m17:21:51.057812 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.059323 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m17:21:51.060777 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m17:21:51.066615 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.072220 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.077169 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m17:21:51.100656 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m17:21:51.102095 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m17:21:51.103030 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.150654 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.155915 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m17:21:51.163522 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.182913 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.183928 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.184692 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.186025 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m17:21:51.187626 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m17:21:51.190536 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m17:21:51.193279 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:51.195483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:51.197256 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:51.215726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m17:21:51.219389 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m17:21:51.223839 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m17:21:51.226490 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.230205 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.232615 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.238358 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m17:21:51.241939 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m17:21:51.244850 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m17:21:51.283510 [debug] [Thread-2 (]: SQL status: SELECT 1007 in 0.035 seconds
[0m17:21:51.402869 [debug] [Thread-3 (]: SQL status: SELECT 4356 in 0.153 seconds
[0m17:21:51.405604 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.411354 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.412065 [debug] [Thread-4 (]: SQL status: SELECT 5706 in 0.161 seconds
[0m17:21:51.413204 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m17:21:51.414554 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m17:21:51.419365 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.421825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.423229 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.423831 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m17:21:51.429191 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.433447 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.435641 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.436359 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:21:51.438409 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m17:21:51.442973 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.444977 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.446709 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.447819 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m17:21:51.459208 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:21:51.463143 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:21:51.465935 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:51.466676 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.468025 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.471309 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:21:51.472584 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m17:21:51.474141 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m17:21:51.475795 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.478970 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:51.479659 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m17:21:51.480242 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:51.484817 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m17:21:51.489997 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m17:21:51.490622 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m17:21:51.495764 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m17:21:51.497844 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m17:21:51.502543 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m17:21:51.504234 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m17:21:51.505560 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m17:21:51.507488 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m17:21:51.511187 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m17:21:51.519476 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:21:51.520437 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m17:21:51.521165 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.012 seconds
[0m17:21:51.523552 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m17:21:51.525641 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m17:21:51.528569 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m17:21:51.530910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955854c650>]}
[0m17:21:51.532492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955afa2150>]}
[0m17:21:51.534043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e3421e-6958-43b3-8f61-a5c885b326ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759559b9fbd0>]}
[0m17:21:51.535787 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5706[0m in 0.48s]
[0m17:21:51.539943 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4356[0m in 0.48s]
[0m17:21:51.542342 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1007[0m in 0.48s]
[0m17:21:51.544664 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m17:21:51.546856 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m17:21:51.549513 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m17:21:51.555996 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:51.558313 [debug] [MainThread]: On master: BEGIN
[0m17:21:51.559960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:51.573954 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:21:51.576433 [debug] [MainThread]: On master: COMMIT
[0m17:21:51.578016 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:51.579594 [debug] [MainThread]: On master: COMMIT
[0m17:21:51.581653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:21:51.583274 [debug] [MainThread]: On master: Close
[0m17:21:51.585474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:51.586701 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m17:21:51.589668 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m17:21:51.591868 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m17:21:51.594879 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m17:21:51.597380 [info ] [MainThread]: 
[0m17:21:51.598876 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m17:21:51.601555 [debug] [MainThread]: Command end result
[0m17:21:51.779150 [info ] [MainThread]: 
[0m17:21:51.782508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:51.784209 [info ] [MainThread]: 
[0m17:21:51.787431 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:21:51.791075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3329277, "process_user_time": 5.759368, "process_kernel_time": 1.733841, "process_mem_max_rss": "156604", "process_in_blocks": "37048", "process_out_blocks": "0"}
[0m17:21:51.794442 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:51.794024 after 4.34 seconds
[0m17:21:51.798270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955fc2b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955fb5b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75955fb5b350>]}
[0m17:21:51.800171 [debug] [MainThread]: Flushing usage events
[0m17:21:59.548474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58293990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a582cc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58293610>]}


============================== 17:21:59.560141 | 2ad8e13c-8c55-4208-9442-0fb5219775b7 ==============================
[0m17:21:59.560141 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:21:59.562738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:59.904276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58312790>]}
[0m17:22:00.026173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a59ffb910>]}
[0m17:22:00.030633 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:22:00.188040 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:22:00.533474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:22:00.535391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:22:00.595542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58498c90>]}
[0m17:22:00.785376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a569aff90>]}
[0m17:22:00.788754 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m17:22:00.791926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a58eda590>]}
[0m17:22:00.799304 [info ] [MainThread]: 
[0m17:22:00.802021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:22:00.813090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m17:22:00.815672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m17:22:00.957165 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:22:00.958018 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:22:00.959623 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m17:22:00.962417 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m17:22:00.964977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:00.967170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:00.991121 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m17:22:00.996877 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m17:22:01.001063 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m17:22:01.005056 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m17:22:01.011393 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:22:01.018642 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m17:22:01.036997 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m17:22:01.038537 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m17:22:01.042552 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m17:22:01.049110 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m17:22:01.052068 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m17:22:01.055742 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m17:22:01.072126 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.074630 [debug] [MainThread]: On master: BEGIN
[0m17:22:01.076626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:01.098301 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m17:22:01.100927 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.102859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:22:01.148198 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m17:22:01.151184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad8e13c-8c55-4208-9442-0fb5219775b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a569eb010>]}
[0m17:22:01.152785 [debug] [MainThread]: On master: ROLLBACK
[0m17:22:01.155934 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.157436 [debug] [MainThread]: On master: BEGIN
[0m17:22:01.159385 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:22:01.161045 [debug] [MainThread]: On master: COMMIT
[0m17:22:01.162761 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.164516 [debug] [MainThread]: On master: COMMIT
[0m17:22:01.166203 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:22:01.167645 [debug] [MainThread]: On master: Close
[0m17:22:01.170272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:01.173808 [info ] [MainThread]: 
[0m17:22:01.193725 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.194856 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.195536 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.196131 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.197169 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m17:22:01.201791 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m17:22:01.204654 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m17:22:01.206870 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m17:22:01.211047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m17:22:01.213577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m17:22:01.215572 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m17:22:01.217486 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m17:22:01.220968 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.222908 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.224366 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.225897 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.253058 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.267014 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.279135 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.286921 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.311508 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.312510 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.343387 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.350501 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.351856 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.352545 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.359669 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.371651 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.383748 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.386335 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m17:22:01.388419 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:22:01.391007 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.395484 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m17:22:01.399646 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:22:01.404629 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.407448 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m17:22:01.415056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:01.416505 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.417874 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m17:22:01.420165 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m17:22:01.425164 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m17:22:01.427714 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m17:22:01.431721 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m17:22:01.433929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:01.435845 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m17:22:01.437884 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m17:22:01.442243 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m17:22:01.446205 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:22:01.449381 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m17:22:01.450793 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:22:01.461980 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m17:22:01.464913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:22:01.466717 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m17:22:01.472544 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m17:22:01.475661 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m17:22:01.478102 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m17:22:01.482399 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m17:22:01.486538 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.27s]
[0m17:22:01.489101 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m17:22:01.491549 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.27s]
[0m17:22:01.497932 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m17:22:01.502088 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m17:22:01.504856 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.507064 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.507986 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m17:22:01.509657 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m17:22:01.512622 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m17:22:01.516740 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m17:22:01.517971 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.037 seconds
[0m17:22:01.519305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m17:22:01.521944 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:22:01.524606 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m17:22:01.527177 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m17:22:01.529044 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.531052 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.533366 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.32s]
[0m17:22:01.535666 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m17:22:01.543619 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.551176 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.553063 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m17:22:01.556180 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.34s]
[0m17:22:01.559972 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.562240 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m17:22:01.564169 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m17:22:01.566269 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.568510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m17:22:01.570584 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m17:22:01.571981 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.573513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m17:22:01.582112 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.583756 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.585208 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.586978 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.597089 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.601455 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.607674 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.612910 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.619993 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.629038 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.634751 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.637493 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.638581 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.641553 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m17:22:01.643810 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:22:01.644845 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.647326 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:01.650504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:01.652932 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m17:22:01.658501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:01.662884 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.665182 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m17:22:01.666934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:22:01.670932 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m17:22:01.672194 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m17:22:01.674261 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:22:01.677343 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m17:22:01.679607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:22:01.681072 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:22:01.683003 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m17:22:01.684638 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m17:22:01.686790 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m17:22:01.690608 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m17:22:01.692491 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:22:01.693404 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:22:01.695466 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m17:22:01.701377 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:22:01.702407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:22:01.707229 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m17:22:01.709977 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m17:22:01.711713 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:22:01.715688 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m17:22:01.718496 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m17:22:01.721961 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:22:01.720859 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.20s]
[0m17:22:01.726776 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m17:22:01.729169 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.21s]
[0m17:22:01.734881 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m17:22:01.736979 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:22:01.739813 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.17s]
[0m17:22:01.745648 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m17:22:01.748058 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m17:22:01.749789 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:01.752310 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m17:22:01.754511 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:01.756348 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.18s]
[0m17:22:01.757463 [info ] [Thread-4 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m17:22:01.759791 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:01.761574 [info ] [Thread-3 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m17:22:01.763551 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m17:22:01.765054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m17:22:01.766419 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m17:22:01.768933 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m17:22:01.772421 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:01.774086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m17:22:01.775406 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:01.787510 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:01.789138 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:01.797153 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:01.807497 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:01.827908 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:01.829119 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:01.841994 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:01.936613 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:01.937800 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:01.945267 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:01.964103 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:01.965101 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:01.965899 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:01.967143 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:22:01.969321 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m17:22:01.971765 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m17:22:01.973375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:22:01.975398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:22:01.977182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:01.993616 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m17:22:01.995071 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m17:22:01.999025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m17:22:02.000555 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m17:22:02.002897 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m17:22:02.005055 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m17:22:02.007670 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:02.009420 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:02.011362 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:02.018056 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:22:02.030019 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:22:02.031893 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m17:22:02.034224 [info ] [Thread-4 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.27s]
[0m17:22:02.040067 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m17:22:02.041307 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m17:22:02.050629 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m17:22:02.055734 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m17:22:02.058399 [info ] [Thread-3 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.29s]
[0m17:22:02.061017 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m17:22:02.070367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m17:22:02.074609 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m17:22:02.076286 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m17:22:02.077970 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.30s]
[0m17:22:02.080308 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m17:22:02.085209 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:02.086682 [debug] [MainThread]: On master: BEGIN
[0m17:22:02.087957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:02.101223 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:22:02.103518 [debug] [MainThread]: On master: COMMIT
[0m17:22:02.105999 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:02.107921 [debug] [MainThread]: On master: COMMIT
[0m17:22:02.109966 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:22:02.111689 [debug] [MainThread]: On master: Close
[0m17:22:02.114830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:02.118166 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m17:22:02.121872 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m17:22:02.124091 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m17:22:02.126756 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m17:22:02.128855 [info ] [MainThread]: 
[0m17:22:02.131218 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m17:22:02.141177 [debug] [MainThread]: Command end result
[0m17:22:02.224541 [info ] [MainThread]: 
[0m17:22:02.227481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:02.230710 [info ] [MainThread]: 
[0m17:22:02.236199 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:22:02.239747 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7902374, "process_user_time": 4.901896, "process_kernel_time": 0.867624, "process_mem_max_rss": "156608", "process_in_blocks": "1224", "process_out_blocks": "0"}
[0m17:22:02.241524 [debug] [MainThread]: Command `dbt test` succeeded at 17:22:02.241359 after 2.79 seconds
[0m17:22:02.242950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a5c148650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a5bf63550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a5bf634d0>]}
[0m17:22:02.244870 [debug] [MainThread]: Flushing usage events
[0m18:41:22.861455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce73403730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce715e4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce715e7130>]}


============================== 18:41:22.869302 | 2c2d2177-7511-42f5-9857-353c50d08655 ==============================
[0m18:41:22.869302 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:41:22.871761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:23.211563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce73bd1f00>]}
[0m18:41:23.325445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce71689e70>]}
[0m18:41:23.328693 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:41:23.344938 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:41:23.465474 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:41:23.467557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6fd5eda0>]}
[0m18:41:25.389431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6ea90d90>]}
[0m18:41:25.618507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6fbcf2e0>]}
[0m18:41:25.620521 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:41:25.622380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6fbcea10>]}
[0m18:41:25.627126 [info ] [MainThread]: 
[0m18:41:25.631973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:25.636118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:41:25.638883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:41:25.674763 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:41:25.688728 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:41:25.689874 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:41:25.691547 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:41:25.693614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:25.696141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:25.718368 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:41:25.723105 [debug] [ThreadPool]: On list_db: Close
[0m18:41:25.723907 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:41:25.729485 [debug] [ThreadPool]: On list_db: Close
[0m18:41:25.734030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m18:41:25.735463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m18:41:25.737873 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m18:41:25.740477 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m18:41:25.752123 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:41:25.758147 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:41:25.760507 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m18:41:25.762387 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m18:41:25.764688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.766416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.785954 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.788388 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:41:25.791746 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m18:41:25.794232 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.798286 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:41:25.799451 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:41:25.803279 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:41:25.805574 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m18:41:25.807352 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m18:41:25.809989 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:41:25.810838 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m18:41:25.816157 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:41:25.820514 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m18:41:25.821747 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:41:25.823692 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m18:41:25.825495 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m18:41:25.829538 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:41:25.832651 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m18:41:25.839148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_analytics)
[0m18:41:25.841549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_staging)
[0m18:41:25.860528 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:41:25.865046 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:41:25.866992 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:41:25.868799 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:41:25.870372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.871599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:25.894489 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.898134 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:41:25.900646 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:41:25.902386 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.905223 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:41:25.906965 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:41:25.910844 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:25.914468 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:41:25.915274 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:25.917147 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:41:25.919834 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:41:25.923442 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:41:25.931375 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.932932 [debug] [MainThread]: On master: BEGIN
[0m18:41:25.934036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:25.946833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.949077 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.950892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:25.978247 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:25.980754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e8ff1c0>]}
[0m18:41:25.981843 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:25.983349 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.984478 [debug] [MainThread]: On master: BEGIN
[0m18:41:25.987146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:25.989455 [debug] [MainThread]: On master: COMMIT
[0m18:41:25.991208 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:25.992804 [debug] [MainThread]: On master: COMMIT
[0m18:41:25.994712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:25.996526 [debug] [MainThread]: On master: Close
[0m18:41:25.998437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:26.000271 [info ] [MainThread]: 
[0m18:41:26.021344 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m18:41:26.022259 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m18:41:26.023274 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m18:41:26.025367 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m18:41:26.028467 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m18:41:26.032511 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m18:41:26.036501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m18:41:26.051449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m18:41:26.056929 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m18:41:26.063732 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m18:41:26.067260 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m18:41:26.069918 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m18:41:26.088035 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m18:41:26.095784 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m18:41:26.100805 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m18:41:26.112346 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 18:41:26.072325 => 18:41:26.111211
[0m18:41:26.114656 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 18:41:26.089852 => 18:41:26.113910
[0m18:41:26.116059 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 18:41:26.097327 => 18:41:26.115494
[0m18:41:26.120688 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m18:41:26.123155 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m18:41:26.126088 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m18:41:26.267916 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m18:41:26.269809 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m18:41:26.273870 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m18:41:26.294353 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.295406 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.297113 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m18:41:26.299078 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m18:41:26.301056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:26.303467 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:41:26.306385 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.310097 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m18:41:26.316091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:26.318493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.322874 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.324066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.329337 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m18:41:26.331350 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.334365 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.337040 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m18:41:26.338780 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.339823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:26.342484 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m18:41:26.350287 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:26.354318 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.362661 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:26.366571 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.368418 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:41:26.373910 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.375373 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:41:26.377776 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:41:26.378560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.381355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.388801 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.403225 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:41:26.405917 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:41:26.408832 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:41:26.410050 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.411126 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.412499 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.414205 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m18:41:26.416611 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m18:41:26.419203 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m18:41:26.424673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.425645 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.426359 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.442481 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m18:41:26.447445 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m18:41:26.455070 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m18:41:26.465945 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m18:41:26.468813 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m18:41:26.471876 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m18:41:26.473720 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m18:41:26.475693 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m18:41:26.477226 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m18:41:26.479859 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:26.481810 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:26.486931 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 18:41:26.129490 => 18:41:26.486441
[0m18:41:26.487682 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:26.491007 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 18:41:26.159336 => 18:41:26.490663
[0m18:41:26.492772 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m18:41:26.496770 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 18:41:26.206569 => 18:41:26.496309
[0m18:41:26.498646 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m18:41:26.501199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e954f10>]}
[0m18:41:26.502938 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m18:41:26.505744 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e92cc10>]}
[0m18:41:26.508423 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.47s]
[0m18:41:26.512363 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e9eb3a0>]}
[0m18:41:26.515151 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.46s]
[0m18:41:26.517756 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m18:41:26.520868 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.46s]
[0m18:41:26.524590 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m18:41:26.528462 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m18:41:26.530435 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m18:41:26.535876 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m18:41:26.537459 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m18:41:26.546238 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m18:41:26.554867 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m18:41:26.561347 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m18:41:26.570240 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m18:41:26.577638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m18:41:26.581450 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m18:41:26.586671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m18:41:26.589144 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m18:41:26.598755 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m18:41:26.600513 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m18:41:26.607352 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.621756 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.641733 [debug] [Thread-2 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 18:41:26.611295 => 18:41:26.640884
[0m18:41:26.642735 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 18:41:26.603052 => 18:41:26.642203
[0m18:41:26.643546 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (compile): 18:41:26.591112 => 18:41:26.643149
[0m18:41:26.645749 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m18:41:26.648477 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m18:41:26.652759 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m18:41:26.704895 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.705922 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.711529 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m18:41:26.733482 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.734826 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.735810 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.737799 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m18:41:26.740043 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m18:41:26.742285 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m18:41:26.744959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:26.749453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:26.751317 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:41:26.770546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.771852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.773860 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.778996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:26.781189 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.784576 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m18:41:26.787229 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.789800 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m18:41:26.793341 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m18:41:26.803752 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:26.812375 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:26.814394 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.815125 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:26.835815 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.896648 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m18:41:26.905904 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.908256 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m18:41:26.912315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.922319 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m18:41:26.932903 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.943828 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:41:26.946525 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:26.951797 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:41:26.954593 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:26.959244 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:41:26.961237 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:26.962798 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m18:41:26.964432 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:26.965939 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m18:41:26.968698 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m18:41:26.970298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:26.973650 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:27.070243 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m18:41:27.070958 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:27.075208 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m18:41:27.079563 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m18:41:27.084263 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m18:41:27.087035 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m18:41:27.088458 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m18:41:27.090423 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m18:41:27.091716 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m18:41:27.093698 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:27.094191 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m18:41:27.096371 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:27.098586 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 18:41:26.679746 => 18:41:27.098322
[0m18:41:27.100652 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:27.103538 [debug] [Thread-2 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 18:41:26.655397 => 18:41:27.103299
[0m18:41:27.105226 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m18:41:27.107757 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (execute): 18:41:26.706285 => 18:41:27.107529
[0m18:41:27.109170 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m18:41:27.111400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e830f40>]}
[0m18:41:27.112606 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m18:41:27.114784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e87b310>]}
[0m18:41:27.116696 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.54s]
[0m18:41:27.121182 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2d2177-7511-42f5-9857-353c50d08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e831180>]}
[0m18:41:27.122798 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.53s]
[0m18:41:27.125203 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m18:41:27.127703 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.56s]
[0m18:41:27.130879 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m18:41:27.134550 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m18:41:27.142972 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:27.146501 [debug] [MainThread]: On master: BEGIN
[0m18:41:27.147835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:27.163828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:27.166269 [debug] [MainThread]: On master: COMMIT
[0m18:41:27.168356 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:27.172869 [debug] [MainThread]: On master: COMMIT
[0m18:41:27.175110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:27.176514 [debug] [MainThread]: On master: Close
[0m18:41:27.179124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:27.180869 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m18:41:27.182136 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m18:41:27.183172 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m18:41:27.184060 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m18:41:27.185349 [info ] [MainThread]: 
[0m18:41:27.187719 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m18:41:27.192984 [debug] [MainThread]: Command end result
[0m18:41:27.258335 [info ] [MainThread]: 
[0m18:41:27.260447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:27.263765 [info ] [MainThread]: 
[0m18:41:27.266493 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:41:27.272038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7244477, "process_user_time": 6.017698, "process_kernel_time": 0.746721, "process_mem_max_rss": "112664", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m18:41:27.274302 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:27.274045 after 4.73 seconds
[0m18:41:27.275914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce73403730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e860550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ce6e860970>]}
[0m18:41:27.277723 [debug] [MainThread]: Flushing usage events
[0m18:43:28.224946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ec07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7cde8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7cdeb130>]}


============================== 18:43:28.238699 | ce44aad2-e82c-4efc-bfc0-b5bb15dab15a ==============================
[0m18:43:28.238699 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:43:28.241323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:43:28.619213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7f3d5f00>]}
[0m18:43:28.757928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ce8de70>]}
[0m18:43:28.760687 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:43:28.777994 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:43:29.084883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:29.088076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:29.106085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b1ec0d0>]}
[0m18:43:29.147233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b2f2b00>]}
[0m18:43:29.151429 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:43:29.154435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b2f2c50>]}
[0m18:43:29.160637 [info ] [MainThread]: 
[0m18:43:29.164024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:29.170458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m18:43:29.173517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m18:43:29.197883 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:43:29.201738 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:43:29.203480 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m18:43:29.205342 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m18:43:29.208911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:29.213279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:29.235063 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.237266 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.238473 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m18:43:29.240200 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m18:43:29.241633 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:43:29.243831 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:43:29.252226 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:43:29.253098 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:43:29.255808 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m18:43:29.258645 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m18:43:29.260685 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m18:43:29.262278 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m18:43:29.276091 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.278149 [debug] [MainThread]: On master: BEGIN
[0m18:43:29.279606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:29.297610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.299846 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.301479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:29.339670 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:43:29.345316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce44aad2-e82c-4efc-bfc0-b5bb15dab15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b2f2680>]}
[0m18:43:29.347390 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:29.349830 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.352084 [debug] [MainThread]: On master: BEGIN
[0m18:43:29.355593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.357977 [debug] [MainThread]: On master: COMMIT
[0m18:43:29.359938 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:29.361527 [debug] [MainThread]: On master: COMMIT
[0m18:43:29.363633 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:29.365208 [debug] [MainThread]: On master: Close
[0m18:43:29.367725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:29.371233 [info ] [MainThread]: 
[0m18:43:29.393843 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.394947 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.395926 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.396870 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.398145 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m18:43:29.401420 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m18:43:29.408348 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m18:43:29.414915 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m18:43:29.419102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m18:43:29.424761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m18:43:29.430255 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m18:43:29.435639 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m18:43:29.438399 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.440414 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.442591 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.444083 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.493621 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.500428 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.517545 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.525551 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.550998 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (compile): 18:43:29.501202 => 18:43:29.549860
[0m18:43:29.552327 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (compile): 18:43:29.518816 => 18:43:29.551796
[0m18:43:29.554086 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.557178 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.571186 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (compile): 18:43:29.445598 => 18:43:29.570446
[0m18:43:29.572205 [debug] [Thread-2 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (compile): 18:43:29.469892 => 18:43:29.571716
[0m18:43:29.602904 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.607583 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.609038 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.610959 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.618647 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.625005 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.647220 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.649212 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.651678 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m18:43:29.654042 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m18:43:29.655468 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.657354 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.658484 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:43:29.660804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:43:29.662910 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m18:43:29.665528 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m18:43:29.672186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:29.680034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:29.685942 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.688232 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.690148 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m18:43:29.692932 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m18:43:29.695735 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m18:43:29.698235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.699979 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m18:43:29.704570 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m18:43:29.706224 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.708534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:29.711901 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m18:43:29.713000 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.717253 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (execute): 18:43:29.558977 => 18:43:29.716796
[0m18:43:29.719265 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m18:43:29.725248 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (execute): 18:43:29.585346 => 18:43:29.724280
[0m18:43:29.726379 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.728499 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m18:43:29.730765 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m18:43:29.732522 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m18:43:29.735763 [debug] [Thread-2 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (execute): 18:43:29.620290 => 18:43:29.735402
[0m18:43:29.737784 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m18:43:29.740588 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m18:43:29.742527 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m18:43:29.743982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:29.747393 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.32s]
[0m18:43:29.750945 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.32s]
[0m18:43:29.754889 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m18:43:29.761210 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (execute): 18:43:29.614560 => 18:43:29.760418
[0m18:43:29.764623 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m18:43:29.768041 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m18:43:29.772549 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.35s]
[0m18:43:29.780260 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m18:43:29.786005 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:29.789472 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:29.792854 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m18:43:29.796703 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m18:43:29.798670 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m18:43:29.801991 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m18:43:29.807954 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:29.816197 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.40s]
[0m18:43:29.821049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m18:43:29.827437 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:43:29.832284 [info ] [Thread-2 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m18:43:29.838241 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m18:43:29.841436 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:29.846128 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:29.850144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m18:43:29.854835 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:29.873234 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:29.896909 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:29.899263 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:29.902026 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m18:43:30.103368 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.106740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m18:43:30.110860 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:30.127206 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.130125 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 18:43:29.875662 => 18:43:30.129185
[0m18:43:30.132090 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (compile): 18:43:29.858094 => 18:43:30.131157
[0m18:43:30.133797 [debug] [Thread-2 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (compile): 18:43:29.912477 => 18:43:30.133235
[0m18:43:30.135976 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:30.138169 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:30.140854 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:30.151667 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:30.159965 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:30.165985 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.170165 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (compile): 18:43:30.112959 => 18:43:30.169175
[0m18:43:30.173073 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:30.191232 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.196140 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:30.197925 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.201364 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m18:43:30.211243 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:30.212402 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m18:43:30.217025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:30.219847 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m18:43:30.223255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:30.230159 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:30.231642 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.239033 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:43:30.241940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:30.245841 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.251200 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m18:43:30.254667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.256420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.258623 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m18:43:30.261414 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:43:30.263275 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m18:43:30.267245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.268490 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.270023 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:43:30.272857 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m18:43:30.275585 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m18:43:30.280651 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (execute): 18:43:30.153638 => 18:43:30.280305
[0m18:43:30.285169 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m18:43:30.286086 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.286750 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.288299 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m18:43:30.294227 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 18:43:30.142834 => 18:43:30.293705
[0m18:43:30.295247 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.297990 [debug] [Thread-2 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (execute): 18:43:30.161889 => 18:43:30.297667
[0m18:43:30.300090 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m18:43:30.301174 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m18:43:30.304264 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (execute): 18:43:30.175205 => 18:43:30.303790
[0m18:43:30.305906 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m18:43:30.310275 [info ] [Thread-3 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.49s]
[0m18:43:30.313457 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m18:43:30.315518 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:43:30.318403 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m18:43:30.320873 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m18:43:30.338506 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.329226 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:43:30.335676 [info ] [Thread-2 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.49s]
[0m18:43:30.324603 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.50s]
[0m18:43:30.345389 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m18:43:30.353046 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.25s]
[0m18:43:30.357688 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m18:43:30.364424 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:43:30.369223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m18:43:30.371860 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m18:43:30.374127 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.380979 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.384521 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.389607 [info ] [Thread-2 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m18:43:30.395957 [info ] [Thread-4 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:43:30.425807 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.427440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m18:43:30.431314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m18:43:30.435378 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.441373 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.460044 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.468728 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.476115 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (compile): 18:43:30.402364 => 18:43:30.475179
[0m18:43:30.478960 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.488913 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.491911 [debug] [Thread-4 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (compile): 18:43:30.461738 => 18:43:30.491042
[0m18:43:30.493662 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (compile): 18:43:30.443467 => 18:43:30.492788
[0m18:43:30.496004 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.498396 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.506398 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.511463 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.516150 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.518190 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m18:43:30.520303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:30.532281 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.534387 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.536310 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:43:30.538635 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m18:43:30.540783 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.542071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:30.545542 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:30.548131 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m18:43:30.553206 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:30.557684 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.567731 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (execute): 18:43:30.481543 => 18:43:30.566789
[0m18:43:30.569820 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.571131 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.572398 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m18:43:30.574360 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m18:43:30.575971 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m18:43:30.579355 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m18:43:30.580619 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:30.587205 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:30.594588 [info ] [Thread-3 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.22s]
[0m18:43:30.603139 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.605683 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m18:43:30.607223 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:43:30.612489 [debug] [Thread-4 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (execute): 18:43:30.500046 => 18:43:30.611707
[0m18:43:30.619313 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (execute): 18:43:30.507861 => 18:43:30.618418
[0m18:43:30.622626 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:43:30.628744 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m18:43:30.633602 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:43:30.636429 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m18:43:30.640399 [info ] [Thread-4 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.21s]
[0m18:43:30.652264 [info ] [Thread-2 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.22s]
[0m18:43:30.657576 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m18:43:30.663689 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m18:43:30.683880 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:30.688585 [debug] [MainThread]: On master: BEGIN
[0m18:43:30.692566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:30.719926 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.723191 [debug] [MainThread]: On master: COMMIT
[0m18:43:30.725574 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:30.727956 [debug] [MainThread]: On master: COMMIT
[0m18:43:30.731052 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:30.733630 [debug] [MainThread]: On master: Close
[0m18:43:30.739840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:30.742792 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m18:43:30.745812 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d' was properly closed.
[0m18:43:30.748686 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m18:43:30.753620 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:43:30.756745 [info ] [MainThread]: 
[0m18:43:30.759436 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m18:43:30.768105 [debug] [MainThread]: Command end result
[0m18:43:30.828587 [info ] [MainThread]: 
[0m18:43:30.832791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:30.842728 [info ] [MainThread]: 
[0m18:43:30.847002 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:43:30.852750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7141833, "process_user_time": 4.53214, "process_kernel_time": 0.621912, "process_mem_max_rss": "106684", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m18:43:30.862118 [debug] [MainThread]: Command `dbt test` succeeded at 18:43:30.860915 after 2.72 seconds
[0m18:43:30.865289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ec07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7b0f2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbb7ce8de70>]}
[0m18:43:30.869222 [debug] [MainThread]: Flushing usage events
[0m19:00:16.588724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741547d77730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741545fc76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741545fc7640>]}


============================== 19:00:16.622237 | 25ce20cc-8458-4e5e-b336-3459a6e5e091 ==============================
[0m19:00:16.622237 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:00:16.625391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:17.057277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154600dd50>]}
[0m19:00:17.281638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154607ec80>]}
[0m19:00:17.284922 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:00:17.313596 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:00:17.648072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:17.649784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:17.663583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415443540d0>]}
[0m19:00:17.712944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154451aaa0>]}
[0m19:00:17.716713 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:00:17.722117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154451abf0>]}
[0m19:00:17.730003 [info ] [MainThread]: 
[0m19:00:17.734148 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:17.747342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:17.750438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:00:17.799698 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:17.802592 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:00:17.804138 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:17.806373 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:17.809176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:17.811900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:17.840393 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:00:17.841446 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:00:17.844391 [debug] [ThreadPool]: On list_db: Close
[0m19:00:17.847236 [debug] [ThreadPool]: On list_db: Close
[0m19:00:17.852609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_staging)
[0m19:00:17.855185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_public_analytics)
[0m19:00:17.860067 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_staging"
"
[0m19:00:17.864671 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "public_analytics"
"
[0m19:00:17.876704 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:00:17.881101 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:00:17.882657 [debug] [ThreadPool]: On create_db_public_staging: BEGIN
[0m19:00:17.884209 [debug] [ThreadPool]: On create_db_public_analytics: BEGIN
[0m19:00:17.885639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:17.887718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:17.906771 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:17.911117 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:17.912383 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:00:17.914726 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:00:17.917112 [debug] [ThreadPool]: On create_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_staging"} */
create schema if not exists "public_staging"
[0m19:00:17.923202 [debug] [ThreadPool]: On create_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "create_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m19:00:17.926854 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:00:17.927747 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:00:17.931593 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:00:17.934780 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:00:17.938661 [debug] [ThreadPool]: Using postgres connection "create_db_public_staging"
[0m19:00:17.941310 [debug] [ThreadPool]: Using postgres connection "create_db_public_analytics"
[0m19:00:17.943955 [debug] [ThreadPool]: On create_db_public_staging: COMMIT
[0m19:00:17.948053 [debug] [ThreadPool]: On create_db_public_analytics: COMMIT
[0m19:00:17.953353 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:00:17.956135 [debug] [ThreadPool]: On create_db_public_staging: Close
[0m19:00:17.973333 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:00:17.975475 [debug] [ThreadPool]: On create_db_public_analytics: Close
[0m19:00:17.982250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_analytics, now list_db_public_staging)
[0m19:00:17.984706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_public_staging, now list_db_public_analytics)
[0m19:00:17.999702 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:18.003750 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:18.006171 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:00:18.008818 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:00:18.011050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:18.015397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:18.037657 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.040658 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:00:18.043289 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.046744 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:00:18.049770 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:00:18.058386 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:00:18.062197 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:18.070137 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:00:18.072523 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:18.073937 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:00:18.078004 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:00:18.087226 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:00:18.102121 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.104401 [debug] [MainThread]: On master: BEGIN
[0m19:00:18.106066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:18.128633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.131199 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.133842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:18.200204 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:18.203584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415443ba0e0>]}
[0m19:00:18.205265 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:18.206864 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.208755 [debug] [MainThread]: On master: BEGIN
[0m19:00:18.213114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.216382 [debug] [MainThread]: On master: COMMIT
[0m19:00:18.218420 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.220402 [debug] [MainThread]: On master: COMMIT
[0m19:00:18.222294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.223673 [debug] [MainThread]: On master: Close
[0m19:00:18.226144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:18.230132 [info ] [MainThread]: 
[0m19:00:18.256411 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:00:18.258481 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:00:18.260076 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:00:18.262750 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:00:18.268713 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:00:18.272918 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:00:18.277727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m19:00:18.282987 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m19:00:18.290159 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:00:18.292779 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:00:18.297222 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:00:18.299362 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:00:18.317043 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:00:18.321186 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:00:18.326400 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:00:18.342900 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 19:00:18.322903 => 19:00:18.341817
[0m19:00:18.344614 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 19:00:18.303474 => 19:00:18.343952
[0m19:00:18.348113 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:00:18.350501 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 19:00:18.317966 => 19:00:18.349830
[0m19:00:18.352262 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:00:18.384315 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:00:18.452060 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:00:18.455927 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:00:18.468302 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:00:18.478734 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.481398 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.482620 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:00:18.484531 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.486131 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:00:18.488976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:18.491294 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:00:18.494494 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:18.498053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:18.516752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.523266 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.526712 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.529023 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:18.531436 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:00:18.534556 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.536832 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.547540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:00:18.549743 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:00:18.551598 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:00:18.680913 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.687861 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:00:18.690421 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:00:18.692010 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:00:18.693235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:18.703433 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.713349 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.745286 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:00:18.746850 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:18.748958 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:00:18.751422 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:18.752431 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.758957 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:18.760406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:18.762660 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:00:18.764177 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.766941 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:18.770708 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:00:18.772454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.775256 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.823151 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.828190 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:00:18.829265 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:00:18.839890 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:00:18.851447 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:00:18.856688 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:00:18.858107 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:18.860423 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:00:18.863924 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:00:18.877066 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:00:18.881650 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:00:18.884787 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:00:18.888387 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:00:18.893673 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 19:00:18.414481 => 19:00:18.893401
[0m19:00:18.897369 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 19:00:18.353567 => 19:00:18.896727
[0m19:00:18.900664 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:00:18.902617 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:00:18.904563 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:00:18.909689 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:00:18.912029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544789270>]}
[0m19:00:18.918409 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7415444485e0>]}
[0m19:00:18.924763 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 19:00:18.456694 => 19:00:18.924055
[0m19:00:18.929425 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.64s]
[0m19:00:18.933362 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.63s]
[0m19:00:18.938407 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:00:18.942166 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:00:18.948065 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:00:18.952455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544403ac0>]}
[0m19:00:18.961295 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m19:00:18.965531 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:00:18.971667 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.67s]
[0m19:00:18.990966 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:00:18.995375 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:00:19.003417 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:00:19.008493 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m19:00:19.014990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_marketing_attribution)
[0m19:00:19.021658 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:00:19.023317 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:00:19.026176 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:00:19.030565 [info ] [Thread-3 (]: 6 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:00:19.050003 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:00:19.058782 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.061298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m19:00:19.068115 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:00:19.077709 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.082398 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 19:00:19.052440 => 19:00:19.081184
[0m19:00:19.084537 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (compile): 19:00:19.036623 => 19:00:19.083333
[0m19:00:19.087130 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:00:19.091179 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m19:00:19.099572 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 19:00:19.069901 => 19:00:19.098899
[0m19:00:19.138813 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:00:19.140549 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.143098 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:00:19.157059 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.164392 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.166169 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.169101 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:00:19.170681 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.172661 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:00:19.174956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:19.179955 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:00:19.190901 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:19.202559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:19.216483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.225480 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.233901 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.235371 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:00:19.238858 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.250367 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:00:19.255021 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.269871 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.271936 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:19.281288 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:00:19.307443 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.309550 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:19.325389 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:00:19.355115 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.367837 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:19.391042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:19.444367 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:00:19.510101 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.554120 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:19.561959 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:00:19.568291 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:19.601395 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:19.613385 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:19.636475 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.641298 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.651357 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:19.663474 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:00:19.666712 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:00:19.670152 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.675038 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:00:19.678568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.682426 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.692840 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.703300 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:00:19.712356 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:00:19.721144 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:00:19.736706 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:00:19.740923 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:00:19.757359 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:00:19.760619 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:00:19.763002 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:00:19.765027 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:00:19.768295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:00:19.773749 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:00:19.775971 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:00:19.779976 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 19:00:19.093257 => 19:00:19.779497
[0m19:00:19.784347 [debug] [Thread-4 (]: Timing info for model.api_bi_project.dim_customer (execute): 19:00:19.123821 => 19:00:19.783825
[0m19:00:19.790372 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 19:00:19.149618 => 19:00:19.789871
[0m19:00:19.792465 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:00:19.794480 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m19:00:19.797580 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:00:19.800294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74154465fe20>]}
[0m19:00:19.804211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544357b80>]}
[0m19:00:19.809484 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ce20cc-8458-4e5e-b336-3459a6e5e091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544519720>]}
[0m19:00:19.811348 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.79s]
[0m19:00:19.814405 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.80s]
[0m19:00:19.818835 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.75s]
[0m19:00:19.822455 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:00:19.826912 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m19:00:19.829587 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:00:19.844554 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.846425 [debug] [MainThread]: On master: BEGIN
[0m19:00:19.849079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:19.872290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:19.874493 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.878237 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:19.880677 [debug] [MainThread]: On master: COMMIT
[0m19:00:19.882814 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:19.884406 [debug] [MainThread]: On master: Close
[0m19:00:19.887249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:19.890905 [debug] [MainThread]: Connection 'model.api_bi_project.stg_payments' was properly closed.
[0m19:00:19.893254 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:00:19.895014 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:00:19.898424 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:00:19.900004 [info ] [MainThread]: 
[0m19:00:19.902255 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m19:00:19.908397 [debug] [MainThread]: Command end result
[0m19:00:19.961100 [info ] [MainThread]: 
[0m19:00:19.964402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:19.968068 [info ] [MainThread]: 
[0m19:00:19.973567 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:00:19.979195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4815907, "process_user_time": 6.438614, "process_kernel_time": 1.147517, "process_mem_max_rss": "107640", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m19:00:19.981341 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:19.981067 after 3.48 seconds
[0m19:00:19.983167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741547d77730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544357b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741544789270>]}
[0m19:00:19.985013 [debug] [MainThread]: Flushing usage events
[0m19:02:19.702835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fed5f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fcfb36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fcfb3640>]}


============================== 19:02:19.716073 | 87a57c52-b576-4f85-8c2a-b2c9923754a7 ==============================
[0m19:02:19.716073 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:02:19.719201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:02:20.262540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fcff5d50>]}
[0m19:02:20.500194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fd066c80>]}
[0m19:02:20.504518 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:02:20.554242 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:02:20.824612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:20.826338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:20.845785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb33c0d0>]}
[0m19:02:20.923744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb502aa0>]}
[0m19:02:20.928281 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:02:20.932707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb502bf0>]}
[0m19:02:20.942648 [info ] [MainThread]: 
[0m19:02:20.947958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:02:20.960964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:02:20.964056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:02:21.045478 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:02:21.054556 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:02:21.056010 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:02:21.058097 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:02:21.060483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:21.062971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:21.088078 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:02:21.089461 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:02:21.093786 [debug] [ThreadPool]: On list_db: Close
[0m19:02:21.097422 [debug] [ThreadPool]: On list_db: Close
[0m19:02:21.110180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:02:21.112752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:02:21.128639 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:02:21.134847 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:02:21.136824 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:02:21.139080 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:02:21.142186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:21.145441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:21.162789 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.165196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.167185 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:02:21.169943 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:02:21.172099 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:02:21.173829 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:02:21.184702 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:02:21.187412 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:02:21.191778 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:02:21.196120 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:02:21.198488 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:02:21.199992 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:02:21.219472 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.221933 [debug] [MainThread]: On master: BEGIN
[0m19:02:21.224127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:21.242752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.247693 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.251771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:02:21.310345 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m19:02:21.313453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb501480>]}
[0m19:02:21.315583 [debug] [MainThread]: On master: ROLLBACK
[0m19:02:21.317886 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.322206 [debug] [MainThread]: On master: BEGIN
[0m19:02:21.329041 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.332022 [debug] [MainThread]: On master: COMMIT
[0m19:02:21.334174 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:21.337526 [debug] [MainThread]: On master: COMMIT
[0m19:02:21.340417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:02:21.342997 [debug] [MainThread]: On master: Close
[0m19:02:21.347438 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:21.356319 [info ] [MainThread]: 
[0m19:02:21.392260 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:02:21.395755 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:02:21.398641 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:02:21.404301 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:02:21.414232 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:02:21.437676 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:02:21.444991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m19:02:21.449922 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:02:21.454889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m19:02:21.462170 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:02:21.466249 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:02:21.639111 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:02:21.674584 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:02:21.698793 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:02:21.712569 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:02:21.725834 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 19:02:21.646859 => 19:02:21.724851
[0m19:02:21.729466 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 19:02:21.706076 => 19:02:21.728371
[0m19:02:21.730983 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:02:21.732284 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 19:02:21.687994 => 19:02:21.731697
[0m19:02:21.734919 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:02:21.767529 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:02:21.863137 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:02:21.848086 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:02:21.864518 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:02:21.889427 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:21.890990 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:21.894674 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:02:21.908146 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:21.910121 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:02:21.912782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:21.914563 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:02:21.916209 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:02:21.922285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:21.936966 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.940396 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:21.945842 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.948165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:21.949713 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:02:21.955070 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:21.957793 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:21.962818 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:02:21.966701 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:02:21.969044 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:02:21.977427 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:02:21.978440 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:02:21.997640 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.010225 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.155311 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.157631 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:02:22.160573 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:02:22.163400 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:02:22.167410 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.169006 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.172048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.181927 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.192416 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.206738 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.209406 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:02:22.211419 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:02:22.216748 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:02:22.220589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.227716 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.239926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.339211 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:02:22.353752 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:02:22.366058 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:02:22.454551 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.456974 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.459680 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.463803 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:02:22.466423 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:02:22.468647 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:02:22.474918 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:22.475821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:22.476985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:22.491959 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:02:22.498451 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:02:22.506961 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:02:22.519193 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:02:22.521845 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:02:22.524364 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:02:22.527431 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:02:22.529064 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:02:22.530499 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:02:22.537662 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:02:22.539180 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:02:22.540353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:02:22.543624 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 19:02:21.837411 => 19:02:22.542970
[0m19:02:22.547774 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 19:02:21.737750 => 19:02:22.547495
[0m19:02:22.550852 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 19:02:21.797005 => 19:02:22.550550
[0m19:02:22.553703 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:02:22.556525 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:02:22.558095 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:02:22.559987 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fa223eb0>]}
[0m19:02:22.564319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb39da20>]}
[0m19:02:22.569075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fb35a0e0>]}
[0m19:02:22.571927 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 1.11s]
[0m19:02:22.575662 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 1.12s]
[0m19:02:22.584717 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 1.12s]
[0m19:02:22.587724 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:02:22.592169 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:02:22.595517 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:02:22.600494 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:02:22.604172 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:02:22.607591 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:02:22.614269 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:02:22.624742 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:02:22.634201 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:02:22.645281 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m19:02:22.651620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m19:02:22.656634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m19:02:22.660767 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:02:22.670068 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:02:22.675618 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:02:22.700897 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.714625 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.723252 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:02:22.741594 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 19:02:22.678041 => 19:02:22.740533
[0m19:02:22.747552 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (compile): 19:02:22.716219 => 19:02:22.745512
[0m19:02:22.749001 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 19:02:22.704202 => 19:02:22.748249
[0m19:02:22.750447 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:02:22.753609 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:02:22.756188 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:02:22.821382 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:02:22.824152 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.840264 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.850949 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.852267 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.854702 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:02:22.856050 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.857965 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:02:22.860423 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:22.863328 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:02:22.867022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:02:22.872644 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:02:22.887090 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:22.895435 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.899288 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:02:22.900663 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:22.903010 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:02:22.911148 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.914968 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:02:22.916820 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.919526 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:02:22.927214 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.930821 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:02:22.938273 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:02:22.944886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:22.956798 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:02:22.957898 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:02:22.959326 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:22.969456 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:22.986333 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:22.988777 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:02:22.991367 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:02:22.994229 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:02:22.998602 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.003197 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.007516 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.023329 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:02:23.033668 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:23.045538 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:23.048002 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:23.051243 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:02:23.054319 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:02:23.058388 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:02:23.063428 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.067419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:02:23.076279 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:02:23.077509 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.084554 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:02:23.087282 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:23.096149 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:02:23.098391 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:23.100765 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:02:23.107213 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:02:23.109623 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:02:23.113970 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:02:23.115470 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.119776 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.131746 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:02:23.136299 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:02:23.142268 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:02:23.145813 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (execute): 19:02:22.784299 => 19:02:23.145460
[0m19:02:23.148461 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:02:23.151187 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:02:23.153398 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:02:23.155956 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:02:23.158947 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:02:23.162163 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f811ff10>]}
[0m19:02:23.174512 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:02:23.173508 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 0[0m in 0.51s]
[0m19:02:23.177996 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:02:23.183537 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 19:02:22.760236 => 19:02:23.183174
[0m19:02:23.186796 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:02:23.192362 [debug] [Thread-3 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 19:02:22.824713 => 19:02:23.192086
[0m19:02:23.195242 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:02:23.198700 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:02:23.204298 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fa2afaf0>]}
[0m19:02:23.210051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a57c52-b576-4f85-8c2a-b2c9923754a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f81374c0>]}
[0m19:02:23.214152 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 0[0m in 0.56s]
[0m19:02:23.218039 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 0[0m in 0.56s]
[0m19:02:23.221528 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:02:23.224832 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:02:23.231445 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:23.235391 [debug] [MainThread]: On master: BEGIN
[0m19:02:23.237325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:23.262838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:02:23.267097 [debug] [MainThread]: On master: COMMIT
[0m19:02:23.270749 [debug] [MainThread]: Using postgres connection "master"
[0m19:02:23.277755 [debug] [MainThread]: On master: COMMIT
[0m19:02:23.280881 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:02:23.282806 [debug] [MainThread]: On master: Close
[0m19:02:23.285658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:23.287895 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m19:02:23.293918 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:02:23.296535 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:02:23.299482 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:02:23.301831 [info ] [MainThread]: 
[0m19:02:23.305022 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m19:02:23.313757 [debug] [MainThread]: Command end result
[0m19:02:23.372272 [info ] [MainThread]: 
[0m19:02:23.378336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:23.383744 [info ] [MainThread]: 
[0m19:02:23.390461 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:02:23.405628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7980118, "process_user_time": 6.272021, "process_kernel_time": 0.688575, "process_mem_max_rss": "109128", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m19:02:23.415658 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:23.415166 after 3.81 seconds
[0m19:02:23.418724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01fed5f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f81374c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a01f813e860>]}
[0m19:02:23.430707 [debug] [MainThread]: Flushing usage events
[0m19:07:58.013717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f9b78e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f7d4c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f7d4f130>]}


============================== 19:07:58.105012 | c896d151-7ffd-4f52-939b-5f8565c45b30 ==============================
[0m19:07:58.105012 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:07:58.107562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /usr/app --profiles-dir /usr/app/profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:07:58.111615 [info ] [MainThread]: dbt version: 1.7.4
[0m19:07:58.113444 [info ] [MainThread]: python version: 3.10.7
[0m19:07:58.116278 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:07:58.118444 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:07:58.352223 [info ] [MainThread]: Using profiles dir at /usr/app/profiles
[0m19:07:58.354868 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles/profiles.yml
[0m19:07:58.356686 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m19:07:58.359398 [info ] [MainThread]: adapter type: postgres
[0m19:07:58.361331 [info ] [MainThread]: adapter version: 1.7.4
[0m19:07:58.573490 [info ] [MainThread]: Configuration:
[0m19:07:58.576329 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:07:58.578907 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:07:58.581195 [info ] [MainThread]: Required dependencies:
[0m19:07:58.583420 [debug] [MainThread]: Executing "git --help"
[0m19:07:58.608000 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:07:58.611875 [debug] [MainThread]: STDERR: "b''"
[0m19:07:58.615075 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:07:58.619883 [info ] [MainThread]: Connection:
[0m19:07:58.622730 [info ] [MainThread]:   host: postgres
[0m19:07:58.626656 [info ] [MainThread]:   port: 5432
[0m19:07:58.630088 [info ] [MainThread]:   user: db_user
[0m19:07:58.632235 [info ] [MainThread]:   database: db
[0m19:07:58.634664 [info ] [MainThread]:   schema: public
[0m19:07:58.637566 [info ] [MainThread]:   connect_timeout: 10
[0m19:07:58.639831 [info ] [MainThread]:   role: None
[0m19:07:58.645176 [info ] [MainThread]:   search_path: None
[0m19:07:58.649730 [info ] [MainThread]:   keepalives_idle: 0
[0m19:07:58.655516 [info ] [MainThread]:   sslmode: None
[0m19:07:58.661416 [info ] [MainThread]:   sslcert: None
[0m19:07:58.673491 [info ] [MainThread]:   sslkey: None
[0m19:07:58.677939 [info ] [MainThread]:   sslrootcert: None
[0m19:07:58.684614 [info ] [MainThread]:   application_name: dbt
[0m19:07:58.686820 [info ] [MainThread]:   retries: 1
[0m19:07:58.690720 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:07:58.697212 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:07:58.700275 [debug] [MainThread]: Using postgres connection "debug"
[0m19:07:58.702872 [debug] [MainThread]: On debug: select 1 as id
[0m19:07:58.708693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:58.746097 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:07:58.749263 [debug] [MainThread]: On debug: Close
[0m19:07:58.755155 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:07:58.759187 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:07:58.765234 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.88369566, "process_user_time": 3.593291, "process_kernel_time": 0.717187, "process_mem_max_rss": "96188", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m19:07:58.769178 [debug] [MainThread]: Command `dbt debug` succeeded at 19:07:58.768773 after 0.89 seconds
[0m19:07:58.771464 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:07:58.775442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f9b78e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61fa38ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f6579420>]}
[0m19:07:58.778077 [debug] [MainThread]: Flushing usage events
[0m19:08:05.386724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066f10faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066d3835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066d383550>]}


============================== 19:08:05.394420 | 035a1bd5-1b4b-4772-bb14-c8a62d9ad104 ==============================
[0m19:08:05.394420 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:08:05.396621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /usr/app --profiles-dir /usr/app/profiles --fail-fast', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:08:05.701774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740671400100>]}
[0m19:08:05.823560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066ba580a0>]}
[0m19:08:05.826112 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:08:05.842491 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:08:06.121486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:08:06.123664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:08:06.135446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b72c0d0>]}
[0m19:08:06.211248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b8e2aa0>]}
[0m19:08:06.213656 [info ] [MainThread]: Found 6 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:08:06.219944 [info ] [MainThread]: 
[0m19:08:06.224177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:08:06.228523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:08:06.230776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:08:06.260983 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:08:06.257519 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:08:06.265431 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:08:06.267239 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:08:06.268870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:06.270248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:06.287359 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:08:06.290704 [debug] [ThreadPool]: On list_db: Close
[0m19:08:06.291315 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:08:06.295520 [debug] [ThreadPool]: On list_db: Close
[0m19:08:06.299349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:08:06.300580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:08:06.309271 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:08:06.314349 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:08:06.315995 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:08:06.317397 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:08:06.318731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:06.320049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:06.335953 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.337824 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:08:06.339827 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.340894 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:08:06.342779 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:08:06.346887 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:08:06.352892 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:08:06.354016 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:08:06.356406 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:08:06.358737 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:08:06.360151 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:08:06.361572 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:08:06.376247 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.377724 [debug] [MainThread]: On master: BEGIN
[0m19:08:06.379327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:06.391738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.393536 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.395763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:08:06.432439 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m19:08:06.435540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b8e12d0>]}
[0m19:08:06.437041 [debug] [MainThread]: On master: ROLLBACK
[0m19:08:06.438905 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.440266 [debug] [MainThread]: On master: BEGIN
[0m19:08:06.442079 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.444535 [debug] [MainThread]: On master: COMMIT
[0m19:08:06.446203 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.447549 [debug] [MainThread]: On master: COMMIT
[0m19:08:06.449313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.450732 [debug] [MainThread]: On master: Close
[0m19:08:06.452531 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:08:06.454356 [info ] [MainThread]: 
[0m19:08:06.470530 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:08:06.471799 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:08:06.473007 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:08:06.475539 [info ] [Thread-1 (]: 1 of 17 START sql view model public_staging.stg_customers ...................... [RUN]
[0m19:08:06.478576 [info ] [Thread-2 (]: 2 of 17 START sql view model public_staging.stg_payments ....................... [RUN]
[0m19:08:06.481508 [info ] [Thread-3 (]: 3 of 17 START sql view model public_staging.stg_sessions ....................... [RUN]
[0m19:08:06.486045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:08:06.490038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:08:06.494596 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:08:06.496654 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:08:06.498840 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:08:06.500355 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:08:06.513726 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:08:06.517814 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:08:06.524647 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:08:06.533562 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (compile): 19:08:06.501629 => 19:08:06.532904
[0m19:08:06.535001 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (compile): 19:08:06.515128 => 19:08:06.534310
[0m19:08:06.536958 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:08:06.538633 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (compile): 19:08:06.519614 => 19:08:06.537745
[0m19:08:06.540298 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:08:06.564784 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:08:06.598460 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:08:06.598913 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:08:06.607582 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:08:06.616869 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.618505 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.620412 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:08:06.621220 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.623001 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:08:06.624300 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:08:06.625604 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:08:06.627010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:06.629816 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:06.643881 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.646562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.647738 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.649145 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.650998 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.653391 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.656084 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:08:06.658359 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:08:06.661594 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:08:06.673138 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:06.676957 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:06.691009 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:06.697370 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.702591 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.710844 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.712372 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:08:06.714145 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:08:06.716124 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:08:06.719680 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.721486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.786488 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.789005 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.793539 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.798634 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.800030 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:08:06.801118 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:08:06.802709 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:08:06.806298 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.808761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.822085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:06.843427 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:08:06.846200 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:08:06.851692 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:08:06.854276 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.856203 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.858008 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.860117 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:08:06.862080 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:08:06.864868 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:08:06.873606 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.876032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.877241 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.893487 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:08:06.899417 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:08:06.903845 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:08:06.912062 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:08:06.914550 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:08:06.917414 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:08:06.918835 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:08:06.919946 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:08:06.921169 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:08:06.926912 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:06.928007 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:06.928555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:06.931833 [debug] [Thread-3 (]: Timing info for model.api_bi_project.stg_sessions (execute): 19:08:06.600265 => 19:08:06.931467
[0m19:08:06.936816 [debug] [Thread-2 (]: Timing info for model.api_bi_project.stg_payments (execute): 19:08:06.593384 => 19:08:06.936165
[0m19:08:06.941930 [debug] [Thread-1 (]: Timing info for model.api_bi_project.stg_customers (execute): 19:08:06.541540 => 19:08:06.941393
[0m19:08:06.944522 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:08:06.946304 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:08:06.947901 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:08:06.951135 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b660580>]}
[0m19:08:06.954630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b7812a0>]}
[0m19:08:06.957435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b717e50>]}
[0m19:08:06.960816 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public_staging.stg_sessions .................. [[32mCREATE VIEW[0m in 0.46s]
[0m19:08:06.964194 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public_staging.stg_payments .................. [[32mCREATE VIEW[0m in 0.47s]
[0m19:08:06.967002 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.47s]
[0m19:08:06.970360 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:08:06.973474 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:08:06.975990 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:08:06.979208 [debug] [Thread-4 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:06.980329 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:06.982577 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.074662 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.077342 [info ] [Thread-4 (]: 4 of 17 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:08:07.081551 [info ] [Thread-3 (]: 5 of 17 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:08:07.087567 [info ] [Thread-2 (]: 6 of 17 START test unique_stg_sessions_session_id .............................. [RUN]
[0m19:08:07.090424 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:08:07.094084 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab'
[0m19:08:07.096839 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:08:07.123130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:08:07.126233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:08:07.128702 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:07.131087 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:07.133488 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.136883 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.166991 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.184494 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.194613 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.202566 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.212040 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (compile): 19:08:07.185597 => 19:08:07.211250
[0m19:08:07.214480 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (compile): 19:08:07.167546 => 19:08:07.213564
[0m19:08:07.215916 [debug] [Thread-4 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (compile): 19:08:07.138544 => 19:08:07.215243
[0m19:08:07.217599 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.219306 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (compile): 19:08:07.195843 => 19:08:07.218723
[0m19:08:07.221402 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:07.223684 [debug] [Thread-4 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:07.248755 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.248261 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.255108 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.259483 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.264796 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.273548 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.275210 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.276113 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:08:07.277415 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.278513 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.279687 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:08:07.281245 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:07.282604 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:08:07.283978 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:08:07.285309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:07.288044 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:08:07.290300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.301537 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.303587 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:08:07.305499 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:08:07.307610 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.309687 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.311124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.313473 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:08:07.315383 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.316783 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:08:07.318543 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:08:07.320329 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:07.325473 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d (execute): 19:08:07.250866 => 19:08:07.325039
[0m19:08:07.327126 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:08:07.328718 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:08:07.331025 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:08:07.333633 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.335428 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.336572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.338738 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:08:07.340844 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_sessions_session_id.ce45726d03 (execute): 19:08:07.225472 => 19:08:07.340553
[0m19:08:07.343478 [debug] [Thread-4 (]: Timing info for test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab (execute): 19:08:07.256658 => 19:08:07.343111
[0m19:08:07.346454 [debug] [Thread-1 (]: Timing info for test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4 (execute): 19:08:07.260597 => 19:08:07.345947
[0m19:08:07.348574 [info ] [Thread-3 (]: 5 of 17 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.25s]
[0m19:08:07.350262 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:08:07.354149 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:08:07.356561 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:08:07.358997 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:08:07.361018 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:08:07.362667 [debug] [Thread-4 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:08:07.364297 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:08:07.365743 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.369081 [info ] [Thread-2 (]: 6 of 17 PASS unique_stg_sessions_session_id .................................... [[32mPASS[0m in 0.25s]
[0m19:08:07.373460 [info ] [Thread-4 (]: 4 of 17 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.28s]
[0m19:08:07.378622 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.25s]
[0m19:08:07.386308 [info ] [Thread-3 (]: 8 of 17 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:08:07.388693 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:08:07.391235 [debug] [Thread-4 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:08:07.393890 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:08:07.396025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:08:07.397797 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.400140 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.402854 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.404931 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.406484 [info ] [Thread-2 (]: 9 of 17 START test unique_stg_payments_payment_id .............................. [RUN]
[0m19:08:07.408028 [info ] [Thread-4 (]: 10 of 17 START test not_null_stg_customers_country ............................. [RUN]
[0m19:08:07.411886 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m19:08:07.422865 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.424516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_sessions_session_id.ce45726d03, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:08:07.426497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:08:07.429400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:08:07.432513 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.434039 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.436499 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.447392 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.456837 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (compile): 19:08:07.414156 => 19:08:07.456158
[0m19:08:07.461265 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.471817 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.475286 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.485415 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.489400 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 19:08:07.462676 => 19:08:07.488487
[0m19:08:07.490901 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (compile): 19:08:07.450547 => 19:08:07.490233
[0m19:08:07.492268 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (compile): 19:08:07.439324 => 19:08:07.491512
[0m19:08:07.493569 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.495465 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.497750 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.504023 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.505126 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.511533 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.519041 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.522460 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:08:07.526565 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:07.532848 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.536335 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:08:07.537613 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.539441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.540596 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.542330 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:08:07.544050 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.549665 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:08:07.552280 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:08:07.554849 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:08:07.557568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:07.562493 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:08:07.570927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.575575 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.576824 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:08:07.579125 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.588079 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075 (execute): 19:08:07.479585 => 19:08:07.583963
[0m19:08:07.589919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.591679 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:08:07.594112 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:08:07.596843 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:08:07.599227 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:08:07.602095 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:08:07.604227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.606487 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:08:07.608326 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:07.613659 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 19:08:07.499448 => 19:08:07.613117
[0m19:08:07.614904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.618538 [info ] [Thread-3 (]: 8 of 17 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.22s]
[0m19:08:07.622634 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:08:07.627657 [debug] [Thread-4 (]: Timing info for test.api_bi_project.not_null_stg_customers_country.c13d2cd104 (execute): 19:08:07.506434 => 19:08:07.627209
[0m19:08:07.628913 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.631518 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:08:07.634275 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:08:07.635331 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:08:07.637993 [debug] [Thread-2 (]: Timing info for test.api_bi_project.unique_stg_payments_payment_id.3744510712 (execute): 19:08:07.513546 => 19:08:07.637608
[0m19:08:07.641329 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.645314 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.22s]
[0m19:08:07.648672 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:08:07.651579 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:08:07.653855 [info ] [Thread-3 (]: 12 of 17 START test unique_stg_customers_customer_id ........................... [RUN]
[0m19:08:07.656570 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:08:07.660513 [info ] [Thread-4 (]: 10 of 17 PASS not_null_stg_customers_country ................................... [[32mPASS[0m in 0.23s]
[0m19:08:07.663955 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:08:07.667480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:08:07.670242 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:08:07.672568 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:08:07.675670 [info ] [Thread-2 (]: 9 of 17 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.25s]
[0m19:08:07.677752 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.680442 [info ] [Thread-1 (]: 13 of 17 START sql table model public_analytics.fct_marketing_attribution ...... [RUN]
[0m19:08:07.691254 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:08:07.706069 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.707791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.api_bi_project.fct_marketing_attribution)
[0m19:08:07.710641 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:08:07.715802 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:08:07.718276 [info ] [Thread-4 (]: 14 of 17 START sql table model public_analytics.fct_revenue_daily .............. [RUN]
[0m19:08:07.727380 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.731363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now model.api_bi_project.fct_revenue_daily)
[0m19:08:07.733378 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (compile): 19:08:07.693601 => 19:08:07.732590
[0m19:08:07.736805 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:08:07.739116 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.747626 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.752584 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.753393 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (compile): 19:08:07.720131 => 19:08:07.753064
[0m19:08:07.756382 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:08:07.800257 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.802516 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_revenue_daily (compile): 19:08:07.741322 => 19:08:07.801653
[0m19:08:07.803547 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.805924 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:08:07.808891 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:08:07.823923 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.825751 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:07.827404 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.831477 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:08:07.833168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.841662 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.844130 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:08:07.845785 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.846795 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:08:07.848856 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:08:07.852665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.853925 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:07.856252 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.860036 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:08:07.861412 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:07.866210 [debug] [Thread-3 (]: Timing info for test.api_bi_project.unique_stg_customers_customer_id.c7614daada (execute): 19:08:07.748905 => 19:08:07.865474
[0m19:08:07.868240 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.869485 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:08:07.872519 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.876313 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:08:07.877824 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:08:07.879664 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:08:07.881984 [info ] [Thread-3 (]: 12 of 17 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.22s]
[0m19:08:07.894869 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.899246 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:08:07.901687 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:08:07.904648 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:08:07.907506 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:08:07.908632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.911264 [info ] [Thread-2 (]: 15 of 17 START sql table model public_analytics.dim_customer ................... [RUN]
[0m19:08:07.920674 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.931248 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.934305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_payments_payment_id.3744510712, now model.api_bi_project.dim_customer)
[0m19:08:07.937372 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:08:07.939321 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:08:07.940997 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:08:07.944599 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.947811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.956485 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:08:07.963980 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.973145 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:08:07.975928 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:08:07.978813 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:07.981678 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:07.983106 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:08:07.988688 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:08:07.993194 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (compile): 19:08:07.949369 => 19:08:07.991857
[0m19:08:07.994603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:07.995453 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:07.997535 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:08:08.003445 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:08:08.005122 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:08:08.015908 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:08:08.024781 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:08:08.028178 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:08.029124 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:08:08.034336 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:08:08.039701 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:08:08.040557 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:08.042100 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:08:08.043903 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.046683 [debug] [Thread-1 (]: Timing info for model.api_bi_project.fct_marketing_attribution (execute): 19:08:07.757575 => 19:08:08.046386
[0m19:08:08.048934 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:08:08.050434 [debug] [Thread-1 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:08:08.052004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:08:08.052770 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:08.054763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b788370>]}
[0m19:08:08.059692 [debug] [Thread-4 (]: Timing info for model.api_bi_project.fct_revenue_daily (execute): 19:08:07.810941 => 19:08:08.059354
[0m19:08:08.062100 [info ] [Thread-1 (]: 13 of 17 OK created sql table model public_analytics.fct_marketing_attribution . [[32mSELECT 0[0m in 0.35s]
[0m19:08:08.064097 [debug] [Thread-4 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:08:08.066634 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:08:08.069721 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b782890>]}
[0m19:08:08.072374 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.074498 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.076128 [info ] [Thread-4 (]: 14 of 17 OK created sql table model public_analytics.fct_revenue_daily ......... [[32mSELECT 0[0m in 0.34s]
[0m19:08:08.080031 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.082003 [info ] [Thread-3 (]: 16 of 17 START test not_null_fct_marketing_attribution_session_day ............. [RUN]
[0m19:08:08.084482 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:08:08.087478 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:08:08.090650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.unique_stg_customers_customer_id.c7614daada, now test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e)
[0m19:08:08.094332 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.096937 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.100043 [info ] [Thread-1 (]: 17 of 17 START test not_null_fct_revenue_daily_order_day ....................... [RUN]
[0m19:08:08.108556 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:08:08.112839 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.114743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.fct_marketing_attribution, now test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da)
[0m19:08:08.122514 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.125117 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.127465 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:08:08.137180 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.139814 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:08.140820 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (compile): 19:08:08.102622 => 19:08:08.140441
[0m19:08:08.148220 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.149769 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.151392 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:08:08.156208 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.159522 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:08.161649 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (compile): 19:08:08.129020 => 19:08:08.161078
[0m19:08:08.168106 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:08:08.170366 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.172316 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.177196 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.180085 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:08:08.181078 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.185186 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:08:08.185965 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:08.187530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:08:08.193838 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:08:08.199288 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.201318 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:08:08.203101 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:08:08.204462 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:08:08.205813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:08.209948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.211338 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:08.213495 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:08:08.218405 [debug] [Thread-2 (]: Timing info for model.api_bi_project.dim_customer (execute): 19:08:08.006431 => 19:08:08.217869
[0m19:08:08.220172 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:08:08.221682 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:08:08.223284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.226537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035a1bd5-1b4b-4772-bb14-c8a62d9ad104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406685c3df0>]}
[0m19:08:08.227923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:08.230089 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:08:08.232285 [info ] [Thread-2 (]: 15 of 17 OK created sql table model public_analytics.dim_customer .............. [[32mSELECT 0[0m in 0.29s]
[0m19:08:08.237065 [debug] [Thread-3 (]: Timing info for test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e (execute): 19:08:08.152759 => 19:08:08.236402
[0m19:08:08.239186 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:08:08.241061 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:08:08.243008 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:08:08.247025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:08:08.250363 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:08:08.254304 [debug] [Thread-1 (]: Timing info for test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da (execute): 19:08:08.173678 => 19:08:08.253230
[0m19:08:08.257867 [info ] [Thread-3 (]: 16 of 17 PASS not_null_fct_marketing_attribution_session_day ................... [[32mPASS[0m in 0.17s]
[0m19:08:08.260110 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:08:08.264117 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:08:08.266772 [debug] [Thread-1 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:08:08.270756 [info ] [Thread-1 (]: 17 of 17 PASS not_null_fct_revenue_daily_order_day ............................. [[32mPASS[0m in 0.16s]
[0m19:08:08.273596 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:08:08.280318 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:08.282832 [debug] [MainThread]: On master: BEGIN
[0m19:08:08.284245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:08.300470 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:08.303108 [debug] [MainThread]: On master: COMMIT
[0m19:08:08.305038 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:08.306942 [debug] [MainThread]: On master: COMMIT
[0m19:08:08.309097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:08:08.310677 [debug] [MainThread]: On master: Close
[0m19:08:08.313541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:08.314927 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:08:08.316337 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da' was properly closed.
[0m19:08:08.317801 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e' was properly closed.
[0m19:08:08.319229 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:08:08.320988 [info ] [MainThread]: 
[0m19:08:08.322931 [info ] [MainThread]: Finished running 3 view models, 11 tests, 3 table models in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m19:08:08.332359 [debug] [MainThread]: Command end result
[0m19:08:08.369046 [info ] [MainThread]: 
[0m19:08:08.371565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:08:08.375266 [info ] [MainThread]: 
[0m19:08:08.378787 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m19:08:08.384050 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0959857, "process_user_time": 4.164596, "process_kernel_time": 0.474078, "process_mem_max_rss": "109868", "process_out_blocks": "56", "process_in_blocks": "0"}
[0m19:08:08.387359 [debug] [MainThread]: Command `dbt build` succeeded at 19:08:08.386861 after 3.10 seconds
[0m19:08:08.389433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066f10faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406683e8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74066b7163e0>]}
[0m19:08:08.392666 [debug] [MainThread]: Flushing usage events
[0m19:10:42.075756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835af23bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835af4b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835c9f0550>]}


============================== 19:10:42.087931 | 3cd20de9-cf10-4b0a-b39b-92fbb65a57cc ==============================
[0m19:10:42.087931 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:10:42.090080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:10:42.383200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd20de9-cf10-4b0a-b39b-92fbb65a57cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835b415f50>]}
[0m19:10:42.412174 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:10:42.424132 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:10:42.428091 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47026244, "process_user_time": 3.631879, "process_kernel_time": 1.46658, "process_mem_max_rss": "162240", "process_in_blocks": "2032", "process_out_blocks": "2432"}
[0m19:10:42.430311 [debug] [MainThread]: Command `dbt deps` succeeded at 19:10:42.430059 after 0.47 seconds
[0m19:10:42.431765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835c0b7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835af29050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72835adea7d0>]}
[0m19:10:42.433657 [debug] [MainThread]: Flushing usage events
[0m19:10:49.196809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7524b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7524b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7524b210>]}


============================== 19:10:49.206995 | 612ef697-3eba-4c45-a772-1b6f8ee166ca ==============================
[0m19:10:49.206995 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:10:49.209357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'fail_fast': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:10:49.444572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe749bfc90>]}
[0m19:10:49.549468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe74561650>]}
[0m19:10:49.561600 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:10:49.973070 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:10:50.107921 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:10:50.109639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe766ac410>]}
[0m19:10:51.603163 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:10:51.607057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe73932790>]}
[0m19:10:52.045252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe77307b10>]}
[0m19:10:52.265988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe7314fc10>]}
[0m19:10:52.269602 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:10:52.272851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe739d6750>]}
[0m19:10:52.280408 [info ] [MainThread]: 
[0m19:10:52.283138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:10:52.300528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:10:52.302689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:10:52.611711 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:10:52.613857 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:10:52.616089 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:10:52.620227 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:10:52.625316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:52.627682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:52.664173 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.036 seconds
[0m19:10:52.665508 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.040 seconds
[0m19:10:52.668704 [debug] [ThreadPool]: On list_db: Close
[0m19:10:52.674227 [debug] [ThreadPool]: On list_db: Close
[0m19:10:52.685652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:10:52.688485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:10:52.706360 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:10:52.713700 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:10:52.715600 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:10:52.718916 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:10:52.721766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:52.724514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:52.743228 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:10:52.744449 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m19:10:52.748148 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:10:52.750496 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:10:52.752229 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:10:52.754289 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:10:52.765157 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m19:10:52.768412 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:10:52.769978 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m19:10:52.771238 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:10:52.774109 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:10:52.781492 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:10:52.794172 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.796658 [debug] [MainThread]: On master: BEGIN
[0m19:10:52.797886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:52.814723 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:10:52.817269 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.819850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:10:52.853450 [debug] [MainThread]: SQL status: SELECT 3 in 0.032 seconds
[0m19:10:52.858100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70e32790>]}
[0m19:10:52.860039 [debug] [MainThread]: On master: ROLLBACK
[0m19:10:52.861442 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.862502 [debug] [MainThread]: On master: BEGIN
[0m19:10:52.864876 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:10:52.866934 [debug] [MainThread]: On master: COMMIT
[0m19:10:52.868780 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:52.870492 [debug] [MainThread]: On master: COMMIT
[0m19:10:52.874228 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:10:52.876542 [debug] [MainThread]: On master: Close
[0m19:10:52.878227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:52.880007 [info ] [MainThread]: 
[0m19:10:52.896741 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:10:52.897458 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:10:52.898073 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:10:52.899707 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:10:52.903636 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:10:52.905239 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:10:52.906613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_customers)
[0m19:10:52.908095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_payments)
[0m19:10:52.910967 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:10:52.912960 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:10:52.914459 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:10:52.916506 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:10:52.925212 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:10:52.928514 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:10:52.932368 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:10:52.940213 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:10:52.941235 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:10:52.948243 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:10:53.006012 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:10:53.004341 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:10:53.012390 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:10:53.020665 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.022279 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.023692 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:10:53.024554 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.025725 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:10:53.027275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:10:53.029084 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:10:53.030476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:53.032876 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:10:53.046267 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m19:10:53.049577 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.052484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m19:10:53.055342 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:10:53.057094 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m19:10:53.058888 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.062336 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.064939 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:10:53.066725 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:10:53.070046 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:10:53.079281 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:10:53.086415 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.104226 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m19:10:53.097779 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.106062 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:10:53.112804 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.114408 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:10:53.117426 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.118274 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:10:53.121482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.126314 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.129645 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.134294 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.136459 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:10:53.142558 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.144432 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:10:53.147691 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:10:53.149163 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:10:53.151363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.153013 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.189103 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:10:53.189884 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:10:53.194244 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:10:53.196726 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.198790 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.203614 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.211887 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:10:53.214683 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:10:53.217793 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:10:53.229705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:10:53.233386 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m19:10:53.234257 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m19:10:53.252868 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:10:53.260671 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:10:53.270793 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:10:53.289002 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:10:53.291150 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:10:53.296233 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:10:53.299265 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:10:53.300922 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:10:53.303241 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:10:53.308468 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:10:53.309923 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:10:53.311201 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:10:53.316036 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:10:53.319116 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:10:53.323592 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:10:53.328258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe74197b50>]}
[0m19:10:53.332203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe74194910>]}
[0m19:10:53.335370 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70fde550>]}
[0m19:10:53.337300 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.42s]
[0m19:10:53.339846 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.42s]
[0m19:10:53.342138 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.42s]
[0m19:10:53.343786 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:10:53.345574 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:10:53.347676 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:10:53.350795 [debug] [Thread-4 (]: Began running node model.api_bi_project.dim_customer
[0m19:10:53.352468 [debug] [Thread-1 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:10:53.354271 [debug] [Thread-2 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.355337 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:10:53.357400 [info ] [Thread-1 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:10:53.359852 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:10:53.361435 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.dim_customer'
[0m19:10:53.362669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_customers, now model.api_bi_project.fct_revenue_daily)
[0m19:10:53.363959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.fct_marketing_attribution)
[0m19:10:53.365150 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:10:53.366810 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:10:53.368629 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.373086 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:10:53.380198 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.385293 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.398234 [debug] [Thread-4 (]: Began executing node model.api_bi_project.dim_customer
[0m19:10:53.399032 [debug] [Thread-2 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.406376 [debug] [Thread-1 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:10:53.445384 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:10:53.448006 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.454651 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.466153 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.467762 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.470614 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:10:53.471882 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.473376 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:10:53.475096 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:10:53.477651 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:10:53.479580 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:10:53.482458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:53.498357 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m19:10:53.501014 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m19:10:53.517333 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.521300 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.526166 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:10:53.528932 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:10:53.533098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m19:10:53.543461 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.546284 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:10:53.547858 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.016 seconds
[0m19:10:53.559754 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.562625 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:10:53.567815 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:10:53.576698 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.579074 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:10:53.582610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.595112 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:10:53.598029 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.599603 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:10:53.602066 [debug] [Thread-1 (]: SQL status: SELECT 4332 in 0.052 seconds
[0m19:10:53.609079 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.609728 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m19:10:53.611121 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:10:53.620182 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:10:53.622461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.630763 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:10:53.637762 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.639795 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:10:53.642436 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:10:53.646994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.650375 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:10:53.656184 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:10:53.662355 [debug] [Thread-4 (]: On model.api_bi_project.dim_customer: Close
[0m19:10:53.663537 [debug] [Thread-2 (]: SQL status: SELECT 5707 in 0.123 seconds
[0m19:10:53.665494 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.668502 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70e09410>]}
[0m19:10:53.684730 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.686544 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:10:53.689828 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.31s]
[0m19:10:53.691671 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:10:53.694531 [debug] [Thread-4 (]: Finished running node model.api_bi_project.dim_customer
[0m19:10:53.695468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:10:53.698357 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.702770 [debug] [Thread-1 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:10:53.709733 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.711904 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:10:53.713163 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:10:53.714772 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:10:53.717579 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:10:53.721308 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:10:53.721931 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:10:53.723242 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.726421 [debug] [Thread-1 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:10:53.728033 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:10:53.729784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70ef31d0>]}
[0m19:10:53.734287 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:10:53.732963 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4332[0m in 0.37s]
[0m19:10:53.739960 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:10:53.741832 [debug] [Thread-1 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:10:53.744134 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:10:53.746519 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:10:53.751395 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:10:53.755172 [debug] [Thread-2 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:10:53.757152 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612ef697-3eba-4c45-a772-1b6f8ee166ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe70febcd0>]}
[0m19:10:53.758682 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5707[0m in 0.39s]
[0m19:10:53.760837 [debug] [Thread-2 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:10:53.765641 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:53.767184 [debug] [MainThread]: On master: BEGIN
[0m19:10:53.768415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:53.781866 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m19:10:53.783691 [debug] [MainThread]: On master: COMMIT
[0m19:10:53.785293 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:53.786471 [debug] [MainThread]: On master: COMMIT
[0m19:10:53.788751 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:10:53.790499 [debug] [MainThread]: On master: Close
[0m19:10:53.791960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:53.792964 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:10:53.793989 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:10:53.795076 [debug] [MainThread]: Connection 'model.api_bi_project.stg_sessions' was properly closed.
[0m19:10:53.796078 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:10:53.797976 [info ] [MainThread]: 
[0m19:10:53.800531 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m19:10:53.802802 [debug] [MainThread]: Command end result
[0m19:10:53.866519 [info ] [MainThread]: 
[0m19:10:53.868109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:10:53.869709 [info ] [MainThread]: 
[0m19:10:53.871636 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:10:53.873831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7688828, "process_user_time": 5.665403, "process_kernel_time": 0.854599, "process_mem_max_rss": "162240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:10:53.875023 [debug] [MainThread]: Command `dbt run` succeeded at 19:10:53.874901 after 4.77 seconds
[0m19:10:53.876205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe791035d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe79183550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fe79038510>]}
[0m19:10:53.877299 [debug] [MainThread]: Flushing usage events
[0m19:11:04.540531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08aa27210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08ad5d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08bdd8b50>]}


============================== 19:11:04.566239 | 032f9b2a-0c9a-44d4-95ff-9e783eceb43e ==============================
[0m19:11:04.566239 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:11:04.570389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:11:05.391589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08aa67250>]}
[0m19:11:05.485081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08c77b590>]}
[0m19:11:05.487938 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:11:05.717763 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:11:06.104582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:11:06.106649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:11:06.180082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c0899e6150>]}
[0m19:11:06.399542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08993e410>]}
[0m19:11:06.402121 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:11:06.404892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c089d56590>]}
[0m19:11:06.408743 [info ] [MainThread]: 
[0m19:11:06.412226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:11:06.421979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:11:06.423333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:11:06.522973 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:11:06.523648 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:11:06.524935 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:11:06.526284 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:11:06.527838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:06.529696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:06.548264 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:11:06.551316 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:11:06.553545 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:11:06.554769 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m19:11:06.558668 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:11:06.560764 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:11:06.568089 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m19:11:06.571355 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:11:06.572105 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m19:11:06.573618 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:11:06.576517 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:11:06.581518 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:11:06.595693 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.597577 [debug] [MainThread]: On master: BEGIN
[0m19:11:06.599989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:06.617472 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:11:06.619579 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.622122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:11:06.660602 [debug] [MainThread]: SQL status: SELECT 3 in 0.036 seconds
[0m19:11:06.663171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032f9b2a-0c9a-44d4-95ff-9e783eceb43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08a1819d0>]}
[0m19:11:06.664572 [debug] [MainThread]: On master: ROLLBACK
[0m19:11:06.665968 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.667781 [debug] [MainThread]: On master: BEGIN
[0m19:11:06.669895 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:11:06.671383 [debug] [MainThread]: On master: COMMIT
[0m19:11:06.673079 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:06.674904 [debug] [MainThread]: On master: COMMIT
[0m19:11:06.677756 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:11:06.679693 [debug] [MainThread]: On master: Close
[0m19:11:06.681211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:06.682630 [info ] [MainThread]: 
[0m19:11:06.698926 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:06.699804 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:06.700429 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:06.701029 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:06.701954 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:11:06.703699 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:11:06.705754 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:11:06.707196 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:11:06.708785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:11:06.710044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:11:06.711639 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:11:06.714003 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:11:06.715665 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:06.717011 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:06.718251 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:06.719356 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:06.742688 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.754600 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.806864 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.810744 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.821349 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:06.822495 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:06.830725 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:06.838121 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:06.864202 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.865111 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.870225 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.876584 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.885645 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.887888 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.890081 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:11:06.891346 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.892806 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.894616 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:11:06.896406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:11:06.898091 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:11:06.899665 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:11:06.901081 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:11:06.903526 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:11:06.910410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:06.919126 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m19:11:06.922114 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:11:06.926195 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:11:06.929708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m19:11:06.934544 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m19:11:06.936657 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:11:06.939026 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:11:06.941693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m19:11:06.945392 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:11:06.948640 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:11:06.954283 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:11:06.960359 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:11:06.961777 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:11:06.963995 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:11:06.972233 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.044 seconds
[0m19:11:06.975790 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:11:06.980425 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:11:06.989767 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:11:07.000946 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m19:11:07.004266 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:11:07.006214 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:11:07.009220 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:11:07.014006 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:11:07.018132 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.30s]
[0m19:11:07.020876 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.31s]
[0m19:11:07.023197 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.31s]
[0m19:11:07.026159 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:11:07.029180 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:11:07.031307 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:11:07.036942 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:11:07.039136 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.33s]
[0m19:11:07.045309 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.048529 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.051954 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.055967 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:11:07.057688 [info ] [Thread-4 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:11:07.059328 [info ] [Thread-3 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:11:07.062355 [info ] [Thread-2 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:11:07.065145 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.068661 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:11:07.071025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:11:07.073428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:11:07.074799 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:11:07.076252 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.077460 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.079003 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.082261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:11:07.088952 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.095199 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.101272 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.102774 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.113466 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.119727 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.121966 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.128412 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.127394 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.129477 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.134385 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.141434 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.149368 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.156906 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.158394 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.159510 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.160869 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:11:07.162502 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.164601 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:11:07.166458 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:11:07.168550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:11:07.170030 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:11:07.172441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:07.174015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:11:07.176750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:11:07.191563 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m19:11:07.194587 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:11:07.197158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m19:11:07.199122 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.201123 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:11:07.202296 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.204028 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:11:07.205708 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:11:07.208931 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:11:07.210589 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:11:07.212249 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:11:07.214359 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:11:07.216516 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:11:07.220716 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:11:07.225169 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:11:07.226360 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:11:07.227731 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:11:07.228935 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:11:07.230963 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:11:07.236025 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:11:07.241167 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:11:07.243788 [info ] [Thread-4 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.17s]
[0m19:11:07.246598 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:11:07.247891 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:11:07.249672 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:11:07.252130 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:11:07.256388 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.17s]
[0m19:11:07.259723 [info ] [Thread-3 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.19s]
[0m19:11:07.262886 [info ] [Thread-2 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.19s]
[0m19:11:07.270496 [debug] [Thread-4 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.275460 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:11:07.277992 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:11:07.281758 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:11:07.285847 [info ] [Thread-4 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:11:07.287959 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.289803 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.293927 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:11:07.295368 [info ] [Thread-1 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:11:07.296774 [info ] [Thread-3 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:11:07.298082 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.300480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:11:07.302402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:11:07.317179 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.319822 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.321855 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.337435 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.349297 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.351772 [debug] [Thread-4 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.360929 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.364606 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.449763 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.451639 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.456461 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.459003 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.461971 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:11:07.463792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:11:07.467492 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.470843 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:11:07.471908 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.473444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:07.475630 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:11:07.478654 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:11:07.482763 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m19:11:07.492535 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:11:07.495052 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:11:07.498659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.502818 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:11:07.504100 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m19:11:07.506601 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:11:07.509242 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:11:07.515232 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m19:11:07.517818 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:11:07.527690 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:11:07.533230 [debug] [Thread-4 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:11:07.538480 [info ] [Thread-4 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.24s]
[0m19:11:07.543249 [debug] [Thread-4 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:11:07.544473 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m19:11:07.552613 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:11:07.556753 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:11:07.560535 [info ] [Thread-1 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.26s]
[0m19:11:07.563260 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:11:07.583885 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.053 seconds
[0m19:11:07.588046 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:11:07.590739 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:11:07.593166 [info ] [Thread-3 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.29s]
[0m19:11:07.596437 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:11:07.602494 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:07.604946 [debug] [MainThread]: On master: BEGIN
[0m19:11:07.606445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:07.622736 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:11:07.625344 [debug] [MainThread]: On master: COMMIT
[0m19:11:07.627272 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:07.629630 [debug] [MainThread]: On master: COMMIT
[0m19:11:07.632598 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:11:07.634616 [debug] [MainThread]: On master: Close
[0m19:11:07.636984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:07.639674 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:11:07.642223 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075' was properly closed.
[0m19:11:07.644331 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:11:07.646269 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:11:07.648902 [info ] [MainThread]: 
[0m19:11:07.651468 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m19:11:07.657310 [debug] [MainThread]: Command end result
[0m19:11:07.758375 [info ] [MainThread]: 
[0m19:11:07.760646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:11:07.762203 [info ] [MainThread]: 
[0m19:11:07.763734 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:11:07.765783 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.3846645, "process_user_time": 6.286871, "process_kernel_time": 1.066627, "process_mem_max_rss": "162240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:11:07.768033 [debug] [MainThread]: Command `dbt test` succeeded at 19:11:07.767704 after 3.39 seconds
[0m19:11:07.769409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08aafc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08e8ce990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c08e814210>]}
[0m19:11:07.770877 [debug] [MainThread]: Flushing usage events
[0m19:15:10.224597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab2943a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab2943690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab2943c50>]}


============================== 19:15:10.238955 | d1654bf5-1821-4082-a08d-b1214a74a435 ==============================
[0m19:15:10.238955 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:15:10.242506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:15:10.479875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1654bf5-1821-4082-a08d-b1214a74a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab280f8d0>]}
[0m19:15:10.514606 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:15:10.528532 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:15:10.531323 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41587272, "process_user_time": 3.421852, "process_kernel_time": 0.635059, "process_mem_max_rss": "162276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:10.533523 [debug] [MainThread]: Command `dbt deps` succeeded at 19:15:10.533310 after 0.42 seconds
[0m19:15:10.535154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab29484d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab29ac290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79dab65db2d0>]}
[0m19:15:10.537655 [debug] [MainThread]: Flushing usage events
[0m19:15:15.463769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54c85a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54cc9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54ccb210>]}


============================== 19:15:15.476361 | 4a0eb178-a49d-4c9d-b26c-532ad52ec312 ==============================
[0m19:15:15.476361 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:15:15.479375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /usr/app --profiles-dir /opt/airflow/.dbt --fail-fast', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:15.722012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54742550>]}
[0m19:15:15.803856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a56a132d0>]}
[0m19:15:15.806872 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:15.966349 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:15:16.441988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:16.445192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:16.552244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53b45050>]}
[0m19:15:17.075524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53fc5050>]}
[0m19:15:17.079578 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:15:17.090188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54cca390>]}
[0m19:15:17.112348 [info ] [MainThread]: 
[0m19:15:17.115721 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:17.132656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:15:17.147635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m19:15:17.304576 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:15:17.305789 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m19:15:17.307219 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:17.310252 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:17.313514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:17.315024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:17.339323 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m19:15:17.340705 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m19:15:17.343445 [debug] [ThreadPool]: On list_db: Close
[0m19:15:17.347081 [debug] [ThreadPool]: On list_db: Close
[0m19:15:17.353346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_staging)
[0m19:15:17.354761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_public_analytics)
[0m19:15:17.367305 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:17.372779 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:17.376688 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:15:17.378797 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:15:17.380117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:17.381646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:17.402405 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:15:17.405944 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m19:15:17.407447 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:17.413684 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:17.415886 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:15:17.417973 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:15:17.427418 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m19:15:17.428063 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m19:15:17.433439 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:15:17.436841 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:15:17.441165 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:15:17.442663 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:15:17.460065 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.461799 [debug] [MainThread]: On master: BEGIN
[0m19:15:17.463413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:17.482667 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:15:17.486982 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.489069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:17.542848 [debug] [MainThread]: SQL status: SELECT 3 in 0.051 seconds
[0m19:15:17.545786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54d27e90>]}
[0m19:15:17.547048 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:17.550183 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.552220 [debug] [MainThread]: On master: BEGIN
[0m19:15:17.554387 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:15:17.557079 [debug] [MainThread]: On master: COMMIT
[0m19:15:17.560474 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:17.562395 [debug] [MainThread]: On master: COMMIT
[0m19:15:17.564032 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:15:17.566017 [debug] [MainThread]: On master: Close
[0m19:15:17.569452 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:17.570912 [info ] [MainThread]: 
[0m19:15:17.591472 [debug] [Thread-1 (]: Began running node model.api_bi_project.stg_customers
[0m19:15:17.592383 [debug] [Thread-2 (]: Began running node model.api_bi_project.stg_payments
[0m19:15:17.593802 [debug] [Thread-3 (]: Began running node model.api_bi_project.stg_sessions
[0m19:15:17.596893 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_customers ....................... [RUN]
[0m19:15:17.599563 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_payments ........................ [RUN]
[0m19:15:17.601462 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_sessions ........................ [RUN]
[0m19:15:17.604309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now model.api_bi_project.stg_customers)
[0m19:15:17.606593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now model.api_bi_project.stg_payments)
[0m19:15:17.608286 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.api_bi_project.stg_sessions'
[0m19:15:17.609669 [debug] [Thread-1 (]: Began compiling node model.api_bi_project.stg_customers
[0m19:15:17.610797 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.stg_payments
[0m19:15:17.613187 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.stg_sessions
[0m19:15:17.626351 [debug] [Thread-1 (]: Writing injected SQL for node "model.api_bi_project.stg_customers"
[0m19:15:17.629567 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.stg_payments"
[0m19:15:17.635647 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.stg_sessions"
[0m19:15:17.645879 [debug] [Thread-1 (]: Began executing node model.api_bi_project.stg_customers
[0m19:15:17.647185 [debug] [Thread-2 (]: Began executing node model.api_bi_project.stg_payments
[0m19:15:17.654657 [debug] [Thread-3 (]: Began executing node model.api_bi_project.stg_sessions
[0m19:15:17.747756 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.stg_sessions"
[0m19:15:17.752869 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.stg_payments"
[0m19:15:17.756219 [debug] [Thread-1 (]: Writing runtime sql for node "model.api_bi_project.stg_customers"
[0m19:15:17.766292 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.770000 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.771718 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: BEGIN
[0m19:15:17.774083 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.775708 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: BEGIN
[0m19:15:17.779253 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:15:17.781030 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: BEGIN
[0m19:15:17.782576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:17.787120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:17.801175 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m19:15:17.805157 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.808480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m19:15:17.810098 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m19:15:17.811045 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */

  create view "db"."public_staging"."stg_sessions__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.sessions
)
select
  session_id,
  nullif(customer_id::text,'')::uuid as customer_id,
  lower(source) as source,
  lower(medium) as medium,
  campaign,
  lower(device) as device,
  country,
  pageviews,
  session_duration_s,
  (bounced=1) as bounced,
  (converted=1) as converted,
  session_start::timestamp as session_start,
  updated_at::timestamp as updated_at,
  date_trunc('day', session_start)::date as session_day
from src
  );
[0m19:15:17.812789 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.816825 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.821045 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */

  create view "db"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.customers
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date::timestamp as signup_date,
  updated_at::timestamp as updated_at,
  is_churned::boolean as is_churned,
  date_trunc('month', signup_date)::date as signup_month
from src
  );
[0m19:15:17.826110 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */

  create view "db"."public_staging"."stg_payments__dbt_tmp"
    
    
  as (
    with src as (
  select * from raw.payments
), success as (
  select *, (amount - coalesce(fee,0) - coalesce(refunded_amount,0))::numeric as net_revenue
  from src
  where status = 'succeeded'
)
select
  payment_id,
  customer_id,
  product,
  amount,
  currency,
  status,
  refunded_amount,
  fee,
  payment_method,
  country,
  created_at::timestamp as created_at,
  updated_at::timestamp as updated_at,
  net_revenue,
  date_trunc('day', created_at)::date as order_day
from success
  );
[0m19:15:17.828001 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:15:17.842710 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m19:15:17.843859 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m19:15:17.851437 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.859991 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.867381 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.871388 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m19:15:17.874086 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:15:17.876003 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:15:17.880552 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:15:17.883488 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.886063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.894608 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.902306 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.912515 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.914170 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
alter table "db"."public_staging"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m19:15:17.918175 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
alter table "db"."public_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:15:17.919905 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
alter table "db"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:15:17.922331 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.923148 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.927080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:17.967981 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:15:17.976402 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:15:17.982827 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:15:17.984678 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:17.986088 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:17.988732 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:17.991755 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: COMMIT
[0m19:15:17.993601 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: COMMIT
[0m19:15:17.994957 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: COMMIT
[0m19:15:18.000095 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m19:15:18.001720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m19:15:18.017067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m19:15:18.018283 [debug] [Thread-3 (]: Applying DROP to: "db"."public_staging"."stg_sessions__dbt_backup"
[0m19:15:18.022562 [debug] [Thread-2 (]: Applying DROP to: "db"."public_staging"."stg_payments__dbt_backup"
[0m19:15:18.030301 [debug] [Thread-1 (]: Applying DROP to: "db"."public_staging"."stg_customers__dbt_backup"
[0m19:15:18.044305 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.stg_sessions"
[0m19:15:18.047125 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.stg_payments"
[0m19:15:18.049503 [debug] [Thread-1 (]: Using postgres connection "model.api_bi_project.stg_customers"
[0m19:15:18.050848 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_sessions"} */
drop view if exists "db"."public_staging"."stg_sessions__dbt_backup" cascade
[0m19:15:18.054001 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_payments"} */
drop view if exists "db"."public_staging"."stg_payments__dbt_backup" cascade
[0m19:15:18.057590 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.stg_customers"} */
drop view if exists "db"."public_staging"."stg_customers__dbt_backup" cascade
[0m19:15:18.066148 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m19:15:18.067379 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m19:15:18.068266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:15:18.075454 [debug] [Thread-3 (]: On model.api_bi_project.stg_sessions: Close
[0m19:15:18.078254 [debug] [Thread-2 (]: On model.api_bi_project.stg_payments: Close
[0m19:15:18.082842 [debug] [Thread-1 (]: On model.api_bi_project.stg_customers: Close
[0m19:15:18.089843 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a517caf90>]}
[0m19:15:18.094362 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53fdc350>]}
[0m19:15:18.099411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53788ad0>]}
[0m19:15:18.103715 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_sessions ................... [[32mCREATE VIEW[0m in 0.48s]
[0m19:15:18.107132 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_payments ................... [[32mCREATE VIEW[0m in 0.49s]
[0m19:15:18.110849 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.49s]
[0m19:15:18.113036 [debug] [Thread-3 (]: Finished running node model.api_bi_project.stg_sessions
[0m19:15:18.115110 [debug] [Thread-2 (]: Finished running node model.api_bi_project.stg_payments
[0m19:15:18.120202 [debug] [Thread-1 (]: Finished running node model.api_bi_project.stg_customers
[0m19:15:18.128673 [debug] [Thread-4 (]: Began running node model.api_bi_project.fct_marketing_attribution
[0m19:15:18.131920 [debug] [Thread-3 (]: Began running node model.api_bi_project.fct_revenue_daily
[0m19:15:18.134372 [debug] [Thread-2 (]: Began running node model.api_bi_project.dim_customer
[0m19:15:18.139312 [info ] [Thread-4 (]: 4 of 6 START sql table model public_analytics.fct_marketing_attribution ........ [RUN]
[0m19:15:18.145572 [info ] [Thread-3 (]: 5 of 6 START sql table model public_analytics.fct_revenue_daily ................ [RUN]
[0m19:15:18.149093 [info ] [Thread-2 (]: 6 of 6 START sql table model public_analytics.dim_customer ..................... [RUN]
[0m19:15:18.153419 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.api_bi_project.fct_marketing_attribution'
[0m19:15:18.163269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_sessions, now model.api_bi_project.fct_revenue_daily)
[0m19:15:18.173190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.api_bi_project.stg_payments, now model.api_bi_project.dim_customer)
[0m19:15:18.175464 [debug] [Thread-4 (]: Began compiling node model.api_bi_project.fct_marketing_attribution
[0m19:15:18.177561 [debug] [Thread-3 (]: Began compiling node model.api_bi_project.fct_revenue_daily
[0m19:15:18.180783 [debug] [Thread-2 (]: Began compiling node model.api_bi_project.dim_customer
[0m19:15:18.194935 [debug] [Thread-4 (]: Writing injected SQL for node "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.205944 [debug] [Thread-3 (]: Writing injected SQL for node "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.220005 [debug] [Thread-2 (]: Writing injected SQL for node "model.api_bi_project.dim_customer"
[0m19:15:18.232772 [debug] [Thread-4 (]: Began executing node model.api_bi_project.fct_marketing_attribution
[0m19:15:18.238599 [debug] [Thread-2 (]: Began executing node model.api_bi_project.dim_customer
[0m19:15:18.246787 [debug] [Thread-3 (]: Began executing node model.api_bi_project.fct_revenue_daily
[0m19:15:18.557963 [debug] [Thread-2 (]: Writing runtime sql for node "model.api_bi_project.dim_customer"
[0m19:15:18.563839 [debug] [Thread-4 (]: Writing runtime sql for node "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.571216 [debug] [Thread-3 (]: Writing runtime sql for node "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.588584 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.590161 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.599517 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: BEGIN
[0m19:15:18.602104 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.606118 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: BEGIN
[0m19:15:18.608896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:18.611820 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: BEGIN
[0m19:15:18.616438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:18.621165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:15:18.637132 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m19:15:18.642335 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.644983 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */

  
    

  create  table "db"."public_analytics"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    with c as (
  select * from "db"."public_staging"."stg_customers"
)
select
  customer_id,
  company_name,
  country,
  industry,
  company_size,
  signup_date,
  is_churned,
  signup_month
from c
  );
  
[0m19:15:18.647270 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m19:15:18.654204 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.655714 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m19:15:18.661333 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */

  
    

  create  table "db"."public_analytics"."fct_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "db"."public_staging"."stg_payments"
)
select
  order_day,
  product,
  country,
  sum(net_revenue) as net_revenue,
  count(*) as orders
from p
group by 1,2,3
  );
  
[0m19:15:18.664541 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.671360 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */

  
    

  create  table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp"
  
  
    as
  
  (
    with s as (
  select * from "db"."public_staging"."stg_sessions"
)
select
  session_day,
  source,
  medium,
  coalesce(campaign,'') as campaign,
  sum(converted::int) as conversions,
  avg((not bounced)::int)::float as engagement_rate
from s
group by 1,2,3,4
  );
  
[0m19:15:18.673053 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.021 seconds
[0m19:15:18.697320 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.707988 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer" rename to "dim_customer__dbt_backup"
[0m19:15:18.717966 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:18.756953 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.773677 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
alter table "db"."public_analytics"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m19:15:18.788244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:15:18.789965 [debug] [Thread-3 (]: SQL status: SELECT 4332 in 0.120 seconds
[0m19:15:18.814792 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:15:18.825038 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.827871 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.830674 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m19:15:18.838530 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: COMMIT
[0m19:15:18.846273 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:18.860881 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m19:15:18.875329 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.887424 [debug] [Thread-2 (]: Applying DROP to: "db"."public_analytics"."dim_customer__dbt_backup"
[0m19:15:18.900547 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
alter table "db"."public_analytics"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m19:15:18.927996 [debug] [Thread-2 (]: Using postgres connection "model.api_bi_project.dim_customer"
[0m19:15:18.931207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:18.935361 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.dim_customer"} */
drop table if exists "db"."public_analytics"."dim_customer__dbt_backup" cascade
[0m19:15:18.944367 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:15:18.948033 [debug] [Thread-4 (]: SQL status: SELECT 5707 in 0.271 seconds
[0m19:15:18.954817 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:18.963688 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.014 seconds
[0m19:15:18.973021 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:18.974839 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: COMMIT
[0m19:15:18.982702 [debug] [Thread-2 (]: On model.api_bi_project.dim_customer: Close
[0m19:15:18.984711 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution" rename to "fct_marketing_attribution__dbt_backup"
[0m19:15:18.992110 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m19:15:18.994770 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a517b8d90>]}
[0m19:15:18.999421 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:15:19.004554 [debug] [Thread-3 (]: Applying DROP to: "db"."public_analytics"."fct_revenue_daily__dbt_backup"
[0m19:15:19.009844 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_analytics.dim_customer ................ [[32mSELECT 1000[0m in 0.82s]
[0m19:15:19.018876 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:19.021037 [debug] [Thread-3 (]: Using postgres connection "model.api_bi_project.fct_revenue_daily"
[0m19:15:19.022923 [debug] [Thread-2 (]: Finished running node model.api_bi_project.dim_customer
[0m19:15:19.026371 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
alter table "db"."public_analytics"."fct_marketing_attribution__dbt_tmp" rename to "fct_marketing_attribution"
[0m19:15:19.028366 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_revenue_daily"} */
drop table if exists "db"."public_analytics"."fct_revenue_daily__dbt_backup" cascade
[0m19:15:19.031760 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:15:19.045575 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m19:15:19.044500 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:15:19.049016 [debug] [Thread-3 (]: On model.api_bi_project.fct_revenue_daily: Close
[0m19:15:19.051801 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:19.056303 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a52b8f610>]}
[0m19:15:19.064025 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: COMMIT
[0m19:15:19.071530 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public_analytics.fct_revenue_daily ........... [[32mSELECT 4332[0m in 0.89s]
[0m19:15:19.075963 [debug] [Thread-3 (]: Finished running node model.api_bi_project.fct_revenue_daily
[0m19:15:19.077050 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m19:15:19.093826 [debug] [Thread-4 (]: Applying DROP to: "db"."public_analytics"."fct_marketing_attribution__dbt_backup"
[0m19:15:19.096198 [debug] [Thread-4 (]: Using postgres connection "model.api_bi_project.fct_marketing_attribution"
[0m19:15:19.104007 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "model.api_bi_project.fct_marketing_attribution"} */
drop table if exists "db"."public_analytics"."fct_marketing_attribution__dbt_backup" cascade
[0m19:15:19.113810 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m19:15:19.120166 [debug] [Thread-4 (]: On model.api_bi_project.fct_marketing_attribution: Close
[0m19:15:19.122608 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0eb178-a49d-4c9d-b26c-532ad52ec312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53bae190>]}
[0m19:15:19.126847 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public_analytics.fct_marketing_attribution ... [[32mSELECT 5707[0m in 0.97s]
[0m19:15:19.131440 [debug] [Thread-4 (]: Finished running node model.api_bi_project.fct_marketing_attribution
[0m19:15:19.139493 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:19.141653 [debug] [MainThread]: On master: BEGIN
[0m19:15:19.145720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:19.166137 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:15:19.168726 [debug] [MainThread]: On master: COMMIT
[0m19:15:19.172693 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:19.175723 [debug] [MainThread]: On master: COMMIT
[0m19:15:19.184906 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:15:19.195433 [debug] [MainThread]: On master: Close
[0m19:15:19.201477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:19.204106 [debug] [MainThread]: Connection 'model.api_bi_project.stg_customers' was properly closed.
[0m19:15:19.207130 [debug] [MainThread]: Connection 'model.api_bi_project.dim_customer' was properly closed.
[0m19:15:19.211322 [debug] [MainThread]: Connection 'model.api_bi_project.fct_revenue_daily' was properly closed.
[0m19:15:19.213388 [debug] [MainThread]: Connection 'model.api_bi_project.fct_marketing_attribution' was properly closed.
[0m19:15:19.216399 [info ] [MainThread]: 
[0m19:15:19.219676 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m19:15:19.223155 [debug] [MainThread]: Command end result
[0m19:15:19.344884 [info ] [MainThread]: 
[0m19:15:19.350562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:19.352662 [info ] [MainThread]: 
[0m19:15:19.356614 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:15:19.359239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9947906, "process_user_time": 5.016837, "process_kernel_time": 0.756362, "process_mem_max_rss": "162280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:19.360892 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:19.360714 after 4.00 seconds
[0m19:15:19.362281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a54cd9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a58b3a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a58b3a650>]}
[0m19:15:19.366434 [debug] [MainThread]: Flushing usage events
[0m19:15:28.076103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b370837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b37083510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b37caa4d0>]}


============================== 19:15:28.090000 | c7a67ba8-8cd6-4395-ab5b-61963118ae1a ==============================
[0m19:15:28.090000 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:15:28.092200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /usr/app --profiles-dir /opt/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:15:28.337099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b37082c10>]}
[0m19:15:28.423197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b38e16dd0>]}
[0m19:15:28.426379 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:28.700863 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:15:30.743833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:30.774633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:30.954228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b35b116d0>]}
[0m19:15:31.617395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b353e3d10>]}
[0m19:15:31.624513 [info ] [MainThread]: Found 6 models, 11 data tests, 428 macros
[0m19:15:31.631792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b357bca90>]}
[0m19:15:31.642705 [info ] [MainThread]: 
[0m19:15:31.650535 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:31.663497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_staging'
[0m19:15:31.667786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_public_analytics'
[0m19:15:31.789199 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:31.790034 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:31.791171 [debug] [ThreadPool]: On list_db_public_staging: BEGIN
[0m19:15:31.792749 [debug] [ThreadPool]: On list_db_public_analytics: BEGIN
[0m19:15:31.796109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:31.797808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:31.817713 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:15:31.818799 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:15:31.824189 [debug] [ThreadPool]: Using postgres connection "list_db_public_staging"
[0m19:15:31.826673 [debug] [ThreadPool]: Using postgres connection "list_db_public_analytics"
[0m19:15:31.828674 [debug] [ThreadPool]: On list_db_public_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_staging"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:15:31.834196 [debug] [ThreadPool]: On list_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "list_db_public_analytics"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:15:31.850141 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.013 seconds
[0m19:15:31.851988 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m19:15:31.855371 [debug] [ThreadPool]: On list_db_public_staging: ROLLBACK
[0m19:15:31.862071 [debug] [ThreadPool]: On list_db_public_analytics: ROLLBACK
[0m19:15:31.864231 [debug] [ThreadPool]: On list_db_public_staging: Close
[0m19:15:31.865472 [debug] [ThreadPool]: On list_db_public_analytics: Close
[0m19:15:31.888155 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:31.890615 [debug] [MainThread]: On master: BEGIN
[0m19:15:31.896933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:31.919940 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:15:31.926534 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:31.929098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:32.006145 [debug] [MainThread]: SQL status: SELECT 3 in 0.071 seconds
[0m19:15:32.014483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a67ba8-8cd6-4395-ab5b-61963118ae1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b36fa6e90>]}
[0m19:15:32.022209 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:32.027448 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:32.032494 [debug] [MainThread]: On master: BEGIN
[0m19:15:32.039586 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:15:32.051412 [debug] [MainThread]: On master: COMMIT
[0m19:15:32.055332 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:32.066777 [debug] [MainThread]: On master: COMMIT
[0m19:15:32.086754 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:15:32.093642 [debug] [MainThread]: On master: Close
[0m19:15:32.100627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:32.118366 [info ] [MainThread]: 
[0m19:15:32.164276 [debug] [Thread-1 (]: Began running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.166307 [debug] [Thread-2 (]: Began running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.167655 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.170437 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.172990 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_payments_status__succeeded__failed__refunded  [RUN]
[0m19:15:32.182624 [info ] [Thread-2 (]: 2 of 11 START test accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [RUN]
[0m19:15:32.186024 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_marketing_attribution_session_day .............. [RUN]
[0m19:15:32.191558 [info ] [Thread-4 (]: 4 of 11 START test not_null_fct_revenue_daily_order_day ........................ [RUN]
[0m19:15:32.196476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_public_analytics, now test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4)
[0m19:15:32.201470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_public_staging, now test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab)
[0m19:15:32.203767 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e'
[0m19:15:32.208841 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da'
[0m19:15:32.211008 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.212655 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.215212 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.218576 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.274169 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.282763 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.302907 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.310192 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.319585 [debug] [Thread-1 (]: Began executing node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.320945 [debug] [Thread-2 (]: Began executing node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.323078 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.334228 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.359711 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.363980 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.367949 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.376784 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.386711 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.389876 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.392534 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: BEGIN
[0m19:15:32.394257 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.394958 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.396275 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: BEGIN
[0m19:15:32.399021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:32.401181 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: BEGIN
[0m19:15:32.403323 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: BEGIN
[0m19:15:32.406435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:32.411242 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:15:32.413169 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:15:32.428473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m19:15:32.431449 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"
[0m19:15:32.433332 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'succeeded','failed','refunded'
)



      
    ) dbt_internal_test
[0m19:15:32.437167 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m19:15:32.439858 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:15:32.442182 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"
[0m19:15:32.444903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m19:15:32.446281 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"
[0m19:15:32.449048 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        source as value_field,
        count(*) as n_records

    from "db"."public_staging"."stg_sessions"
    group by source

)

select *
from all_values
where value_field not in (
    'google','direct','facebook','linkedin','newsletter','referral','bing'
)



      
    ) dbt_internal_test
[0m19:15:32.450271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m19:15:32.451600 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"
[0m19:15:32.453751 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_day
from "db"."public_analytics"."fct_revenue_daily"
where order_day is null



      
    ) dbt_internal_test
[0m19:15:32.466838 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: ROLLBACK
[0m19:15:32.468430 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_day
from "db"."public_analytics"."fct_marketing_attribution"
where session_day is null



      
    ) dbt_internal_test
[0m19:15:32.471775 [debug] [Thread-1 (]: On test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4: Close
[0m19:15:32.477291 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m19:15:32.476217 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_payments_status__succeeded__failed__refunded .. [[32mPASS[0m in 0.28s]
[0m19:15:32.478703 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:15:32.485674 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: ROLLBACK
[0m19:15:32.489943 [debug] [Thread-1 (]: Finished running node test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4
[0m19:15:32.494026 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: ROLLBACK
[0m19:15:32.494758 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.039 seconds
[0m19:15:32.496409 [debug] [Thread-4 (]: On test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da: Close
[0m19:15:32.498155 [debug] [Thread-1 (]: Began running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.500581 [debug] [Thread-3 (]: On test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e: Close
[0m19:15:32.503146 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: ROLLBACK
[0m19:15:32.505770 [info ] [Thread-4 (]: 4 of 11 PASS not_null_fct_revenue_daily_order_day .............................. [[32mPASS[0m in 0.30s]
[0m19:15:32.507206 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_customers_country .............................. [RUN]
[0m19:15:32.510024 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_marketing_attribution_session_day .................... [[32mPASS[0m in 0.31s]
[0m19:15:32.512098 [debug] [Thread-2 (]: On test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab: Close
[0m19:15:32.514180 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da
[0m19:15:32.515920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_payments_status__succeeded__failed__refunded.5b10b937d4, now test.api_bi_project.not_null_stg_customers_country.c13d2cd104)
[0m19:15:32.517582 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e
[0m19:15:32.519341 [info ] [Thread-2 (]: 2 of 11 PASS accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing  [[32mPASS[0m in 0.32s]
[0m19:15:32.521162 [debug] [Thread-4 (]: Began running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.522751 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.524154 [debug] [Thread-3 (]: Began running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.525965 [debug] [Thread-2 (]: Finished running node test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab
[0m19:15:32.527619 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m19:15:32.535623 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.536885 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m19:15:32.538530 [debug] [Thread-2 (]: Began running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.539819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_revenue_daily_order_day.f07ee676da, now test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m19:15:32.542185 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_fct_marketing_attribution_session_day.d8b871604e, now test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075)
[0m19:15:32.543914 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_sessions_session_id ............................ [RUN]
[0m19:15:32.545826 [debug] [Thread-4 (]: Began compiling node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.547307 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.548976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.accepted_values_stg_sessions_source__google__direct__facebook__linkedin__newsletter__referral__bing.b8cbc1dfab, now test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d)
[0m19:15:32.556240 [debug] [Thread-1 (]: Began executing node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.557518 [debug] [Thread-4 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.564224 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.565650 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.570449 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.579117 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.586138 [debug] [Thread-3 (]: Began executing node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.587906 [debug] [Thread-4 (]: Began executing node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.592283 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.593348 [debug] [Thread-2 (]: Began executing node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.598747 [debug] [Thread-4 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.599810 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.605717 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.608450 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: BEGIN
[0m19:15:32.611327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:32.613893 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.615515 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.616651 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.618556 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m19:15:32.620601 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m19:15:32.621920 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m19:15:32.623219 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:32.624496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:32.625929 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:15:32.627566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:15:32.635502 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"
[0m19:15:32.637843 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_country.c13d2cd104"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from "db"."public_staging"."stg_customers"
where country is null



      
    ) dbt_internal_test
[0m19:15:32.642734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:15:32.646042 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m19:15:32.648199 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m19:15:32.652231 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: ROLLBACK
[0m19:15:32.654668 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m19:15:32.656651 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"
[0m19:15:32.658827 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"
[0m19:15:32.661584 [debug] [Thread-1 (]: On test.api_bi_project.not_null_stg_customers_country.c13d2cd104: Close
[0m19:15:32.663484 [debug] [Thread-4 (]: Using postgres connection "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m19:15:32.666325 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "db"."public_staging"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m19:15:32.669820 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "db"."public_staging"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m19:15:32.673209 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_customers_country .................................... [[32mPASS[0m in 0.16s]
[0m19:15:32.675055 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "db"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:15:32.679934 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:15:32.681654 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:15:32.684534 [debug] [Thread-1 (]: Finished running node test.api_bi_project.not_null_stg_customers_country.c13d2cd104
[0m19:15:32.689759 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m19:15:32.690605 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:15:32.695151 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m19:15:32.697196 [debug] [Thread-1 (]: Began running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.699361 [debug] [Thread-3 (]: On test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075: Close
[0m19:15:32.703647 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m19:15:32.705887 [debug] [Thread-2 (]: On test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d: Close
[0m19:15:32.707477 [info ] [Thread-1 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m19:15:32.710103 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.17s]
[0m19:15:32.712502 [debug] [Thread-4 (]: On test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m19:15:32.714288 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_sessions_session_id .................................. [[32mPASS[0m in 0.17s]
[0m19:15:32.715914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_customers_country.c13d2cd104, now test.api_bi_project.unique_stg_customers_customer_id.c7614daada)
[0m19:15:32.717963 [debug] [Thread-3 (]: Finished running node test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075
[0m19:15:32.722126 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.18s]
[0m19:15:32.724823 [debug] [Thread-2 (]: Finished running node test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d
[0m19:15:32.727205 [debug] [Thread-1 (]: Began compiling node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.730067 [debug] [Thread-3 (]: Began running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.732301 [debug] [Thread-4 (]: Finished running node test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m19:15:32.733963 [debug] [Thread-2 (]: Began running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.744347 [debug] [Thread-1 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.746257 [info ] [Thread-3 (]: 10 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m19:15:32.750036 [info ] [Thread-2 (]: 11 of 11 START test unique_stg_sessions_session_id ............................. [RUN]
[0m19:15:32.752812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_payments_payment_id.c19cc50075, now test.api_bi_project.unique_stg_payments_payment_id.3744510712)
[0m19:15:32.754905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.api_bi_project.not_null_stg_sessions_session_id.2e872a126d, now test.api_bi_project.unique_stg_sessions_session_id.ce45726d03)
[0m19:15:32.757082 [debug] [Thread-3 (]: Began compiling node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.758856 [debug] [Thread-2 (]: Began compiling node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.767085 [debug] [Thread-3 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.774311 [debug] [Thread-1 (]: Began executing node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.782998 [debug] [Thread-2 (]: Writing injected SQL for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.883258 [debug] [Thread-1 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.888611 [debug] [Thread-3 (]: Began executing node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.889863 [debug] [Thread-2 (]: Began executing node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.895207 [debug] [Thread-3 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.899853 [debug] [Thread-2 (]: Writing runtime sql for node "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.902664 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.905729 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m19:15:32.907188 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.909119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:32.910727 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.912263 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: BEGIN
[0m19:15:32.915308 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m19:15:32.917074 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:32.918980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:32.928591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:15:32.930750 [debug] [Thread-1 (]: Using postgres connection "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"
[0m19:15:32.932298 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:32.936465 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m19:15:32.938107 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m19:15:32.939013 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:15:32.940192 [debug] [Thread-3 (]: Using postgres connection "test.api_bi_project.unique_stg_payments_payment_id.3744510712"
[0m19:15:32.941721 [debug] [Thread-2 (]: Using postgres connection "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"
[0m19:15:32.944891 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m19:15:32.946798 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:32.948670 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "api_bi_profile", "target_name": "dev", "node_id": "test.api_bi_project.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "db"."public_staging"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:32.951044 [debug] [Thread-1 (]: On test.api_bi_project.unique_stg_customers_customer_id.c7614daada: Close
[0m19:15:32.955218 [info ] [Thread-1 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.24s]
[0m19:15:32.957394 [debug] [Thread-1 (]: Finished running node test.api_bi_project.unique_stg_customers_customer_id.c7614daada
[0m19:15:32.963405 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m19:15:32.967162 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m19:15:32.969348 [debug] [Thread-3 (]: On test.api_bi_project.unique_stg_payments_payment_id.3744510712: Close
[0m19:15:32.971272 [info ] [Thread-3 (]: 10 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.22s]
[0m19:15:32.973415 [debug] [Thread-3 (]: Finished running node test.api_bi_project.unique_stg_payments_payment_id.3744510712
[0m19:15:32.982297 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.029 seconds
[0m19:15:32.985130 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m19:15:32.987063 [debug] [Thread-2 (]: On test.api_bi_project.unique_stg_sessions_session_id.ce45726d03: Close
[0m19:15:32.988821 [info ] [Thread-2 (]: 11 of 11 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.23s]
[0m19:15:32.990499 [debug] [Thread-2 (]: Finished running node test.api_bi_project.unique_stg_sessions_session_id.ce45726d03
[0m19:15:32.995399 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:32.997273 [debug] [MainThread]: On master: BEGIN
[0m19:15:32.998719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:33.011296 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m19:15:33.013444 [debug] [MainThread]: On master: COMMIT
[0m19:15:33.015168 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:33.016561 [debug] [MainThread]: On master: COMMIT
[0m19:15:33.018484 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:15:33.020419 [debug] [MainThread]: On master: Close
[0m19:15:33.022878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:33.026029 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m19:15:33.028605 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m19:15:33.030318 [debug] [MainThread]: Connection 'test.api_bi_project.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m19:15:33.032806 [debug] [MainThread]: Connection 'test.api_bi_project.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
[0m19:15:33.034622 [info ] [MainThread]: 
[0m19:15:33.035961 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m19:15:33.039813 [debug] [MainThread]: Command end result
[0m19:15:33.125089 [info ] [MainThread]: 
[0m19:15:33.129897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:33.132669 [info ] [MainThread]: 
[0m19:15:33.134955 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:15:33.138684 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.1401386, "process_user_time": 5.08476, "process_kernel_time": 0.801475, "process_mem_max_rss": "162284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:33.141425 [debug] [MainThread]: Command `dbt test` succeeded at 19:15:33.140877 after 5.14 seconds
[0m19:15:33.144963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b3af05590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b3af93450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b3ad1c510>]}
[0m19:15:33.147500 [debug] [MainThread]: Flushing usage events
